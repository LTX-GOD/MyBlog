<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Basectf2024_crypto - Zsm Blog</title><meta name="Description" content="Zsm Blog,crypto,ctf,nodejs,wp,密码学,zsm"><meta property="og:url" content="https://www.zhuangsanmeng.xyz/basectf2024-crypto-wp/">
  <meta property="og:site_name" content="Zsm Blog">
  <meta property="og:title" content="Basectf2024_crypto">
  <meta property="og:description" content="week1の题目 你会算MD吗 task
1 2 3 4 5 6 7 8 9 10 11 12 13 import hashlib flag=&#39;BaseCTF{}&#39; output=[] for i in flag: my_md5=hashlib.md5() my_md5.update(i.encode()) output.append(my_md5.hexdigest()) print(&#34;output =&#34;,output) &#39;&#39;&#39; output = [&#39;9d5ed678fe57bcca610140957afab571&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;03c7c0ace395d80182db07ae2c30f034&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;0d61f8370cad1d412f80b84d143e1257&#39;, &#39;b9ece18c950afbfa6b0fdbfa4ff731d3&#39;, &#39;800618943025315f869e4e1f09471012&#39;, &#39;f95b70fdc3088560732a5ac135644506&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;eccbc87e4b5ce2fe28308fd9f2a7baf3&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;e4da3b7fbbce2345d7772b0674a318d5&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;eccbc87e4b5ce2fe28308fd9f2a7baf3&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;45c48cce2e2d7fbdea1afc51c7c6ad26&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;8f14e45fceea167a5a36dedd4bea2543&#39;, &#39;1679091c5a880faf6fb5e6087eb1b2dc&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;8277e0910d750195b448797616e091ad&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;c81e728d9d4c2f636f067f89cc14862c&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;c9f0f895fb98ab9159f51fd0297e236d&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;8277e0910d750195b448797616e091ad&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;45c48cce2e2d7fbdea1afc51c7c6ad26&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;c9f0f895fb98ab9159f51fd0297e236d&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;cbb184dd8e05c9709e5dcaedaa0495cf&#39;] &#39;&#39;&#39; 思路：直接利用哈希表去找字符串就行了 exp">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-12-12T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-07-15T13:53:04+08:00">
    <meta property="article:tag" content="Crypto">
    <meta property="og:image" content="https://www.zhuangsanmeng.xyz/">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://www.zhuangsanmeng.xyz/">
  <meta name="twitter:title" content="Basectf2024_crypto">
  <meta name="twitter:description" content="week1の题目 你会算MD吗 task
1 2 3 4 5 6 7 8 9 10 11 12 13 import hashlib flag=&#39;BaseCTF{}&#39; output=[] for i in flag: my_md5=hashlib.md5() my_md5.update(i.encode()) output.append(my_md5.hexdigest()) print(&#34;output =&#34;,output) &#39;&#39;&#39; output = [&#39;9d5ed678fe57bcca610140957afab571&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;03c7c0ace395d80182db07ae2c30f034&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;0d61f8370cad1d412f80b84d143e1257&#39;, &#39;b9ece18c950afbfa6b0fdbfa4ff731d3&#39;, &#39;800618943025315f869e4e1f09471012&#39;, &#39;f95b70fdc3088560732a5ac135644506&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;eccbc87e4b5ce2fe28308fd9f2a7baf3&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;e4da3b7fbbce2345d7772b0674a318d5&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;eccbc87e4b5ce2fe28308fd9f2a7baf3&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;45c48cce2e2d7fbdea1afc51c7c6ad26&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;8f14e45fceea167a5a36dedd4bea2543&#39;, &#39;1679091c5a880faf6fb5e6087eb1b2dc&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;8277e0910d750195b448797616e091ad&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;c81e728d9d4c2f636f067f89cc14862c&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;c9f0f895fb98ab9159f51fd0297e236d&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;8277e0910d750195b448797616e091ad&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;45c48cce2e2d7fbdea1afc51c7c6ad26&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;c9f0f895fb98ab9159f51fd0297e236d&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;cbb184dd8e05c9709e5dcaedaa0495cf&#39;] &#39;&#39;&#39; 思路：直接利用哈希表去找字符串就行了 exp">
<meta name="application-name" content="Zsm blog">
<meta name="apple-mobile-web-app-title" content="Zsm blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/logo.svg"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://www.zhuangsanmeng.xyz/basectf2024-crypto-wp/" /><link rel="prev" href="https://www.zhuangsanmeng.xyz/isctf2024_crypto/" /><link rel="next" href="https://www.zhuangsanmeng.xyz/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Basectf2024_crypto",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/www.zhuangsanmeng.xyz\/basectf2024-crypto-wp\/"
        },"genre": "posts","keywords": "crypto","wordcount":  9954 ,
        "url": "https:\/\/www.zhuangsanmeng.xyz\/basectf2024-crypto-wp\/","datePublished": "2024-12-12T00:00:00+00:00","dateModified": "2025-07-15T13:53:04+08:00","publisher": {
            "@type": "Organization",
            "name": "zsm"},"author": {
                "@type": "Person",
                "name": "Zsm"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Zsm Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/logo.png"
        data-srcset="/images/logo.png, /images/logo.png 1.5x, /images/logo.png 2x"
        data-sizes="auto"
        alt="/images/logo.png"
        title="/images/logo.png" /></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/" title="About"> 关于 </a><a class="menu-item" href="/friend/" title="Friend"> 友链 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Zsm Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/logo.png"
        data-srcset="/images/logo.png, /images/logo.png 1.5x, /images/logo.png 2x"
        data-sizes="auto"
        alt="/images/logo.png"
        title="/images/logo.png" /></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="About">关于</a><a class="menu-item" href="/friend/" title="Friend">友链</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
    <h2 class="toc-title">Contents</h2>
    <div class="toc-content" id="toc-content-auto"></div>
</div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Basectf2024_crypto</h1><div class="post-meta">
        <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Zsm</a></span>&nbsp;<span class="post-category">included in <a href="/categories/ctf/"><i class="far fa-folder fa-fw"
                    aria-hidden="true"></i>CTF</a></span></div>
        <div class="post-meta-line">
    

    
        

        
        
            <span id="busuanzi_container_value_page_pv"><i class="far fa-eye fa-fw"></i>
                
                <span id="busuanzi_value_page_pv"></span>&nbsp;views</span>
        
    

<i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-12-12">2024-12-12</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;9954 words&nbsp;
            <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;20 minutes&nbsp;<span id="/basectf2024-crypto-wp/" class="leancloud_visitors" data-flag-title="Basectf2024_crypto">
                <i class="far fa-eye fa-fw" aria-hidden="true"></i>&nbsp;<span
                    class=leancloud-visitors-count></span>&nbsp;views
            </span>&nbsp;</div>
    </div><div class="details toc" id="toc-static" data-kept="">
        <div class="details-summary toc-title">
            <span>Contents</span>
            <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
        </div>
        <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#week1の题目">week1の题目</a>
      <ul>
        <li><a href="#你会算md吗">你会算MD吗</a></li>
        <li><a href="#十七倍">十七倍</a></li>
        <li><a href="#babypack">babypack</a></li>
        <li><a href="#babyrsa">babyrsa</a></li>
        <li><a href="#ez_math">ez_math</a>
          <ul>
            <li><a href="#思路">思路：</a></li>
          </ul>
        </li>
        <li><a href="#mid_math">mid_math</a></li>
        <li><a href="#ez_rsa">ez_rsa</a></li>
        <li><a href="#hellocrypto">helloCrypto</a></li>
      </ul>
    </li>
    <li><a href="#week2の题目">week2の题目</a>
      <ul>
        <li><a href="#铜匠">铜匠</a></li>
        <li><a href="#basic">basic</a></li>
        <li><a href="#mid_math2">mid_math2</a></li>
        <li><a href="#random_primes">random_primes</a></li>
        <li><a href="#two_squares">two_squares</a></li>
        <li><a href="#try_to_factor">try_to_factor</a></li>
      </ul>
    </li>
    <li><a href="#week3の题目">week3の题目</a>
      <ul>
        <li><a href="#没有n啊">没有n啊</a></li>
        <li><a href="#没有n啊pro">没有n啊pro</a></li>
        <li><a href="#exgcd">exgcd</a></li>
        <li><a href="#ez_log">ez_log</a></li>
        <li><a href="#wiener">wiener</a></li>
      </ul>
    </li>
    <li><a href="#week3の题目-1">week3の题目</a>
      <ul>
        <li><a href="#哎呀数据丢失了">哎呀数据丢失了</a></li>
        <li><a href="#rabin">rabin</a></li>
        <li><a href="#extendmd5">extendmd5</a></li>
      </ul>
    </li>
    <li><a href="#fin">Fin</a>
      <ul>
        <li><a href="#の歪来">の歪来</a></li>
        <li><a href="#ecb是不安全的">ECB是不安全的</a></li>
        <li><a href="#猜猜看">猜猜看</a></li>
        <li><a href="#老涩批了">老涩批了</a></li>
        <li><a href="#pdp">PDP</a></li>
      </ul>
    </li>
    <li><a href="#总结">总结</a></li>
  </ul>
</nav></div>
    </div><div class="content" id="content"><h2 id="week1の题目">week1の题目</h2>
<h3 id="你会算md吗">你会算MD吗</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import hashlib
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag=&#39;BaseCTF{}&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">output=[]
</span></span><span class="line"><span class="cl">for i in flag:
</span></span><span class="line"><span class="cl">    my_md5=hashlib.md5()
</span></span><span class="line"><span class="cl">    my_md5.update(i.encode())
</span></span><span class="line"><span class="cl">    output.append(my_md5.hexdigest())
</span></span><span class="line"><span class="cl">print(&#34;output =&#34;,output)
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span><span class="line"><span class="cl">output = [&#39;9d5ed678fe57bcca610140957afab571&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;03c7c0ace395d80182db07ae2c30f034&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;0d61f8370cad1d412f80b84d143e1257&#39;, &#39;b9ece18c950afbfa6b0fdbfa4ff731d3&#39;, &#39;800618943025315f869e4e1f09471012&#39;, &#39;f95b70fdc3088560732a5ac135644506&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;eccbc87e4b5ce2fe28308fd9f2a7baf3&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;e4da3b7fbbce2345d7772b0674a318d5&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;eccbc87e4b5ce2fe28308fd9f2a7baf3&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;45c48cce2e2d7fbdea1afc51c7c6ad26&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;8f14e45fceea167a5a36dedd4bea2543&#39;, &#39;1679091c5a880faf6fb5e6087eb1b2dc&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;8277e0910d750195b448797616e091ad&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;c81e728d9d4c2f636f067f89cc14862c&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;c9f0f895fb98ab9159f51fd0297e236d&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;8277e0910d750195b448797616e091ad&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;45c48cce2e2d7fbdea1afc51c7c6ad26&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;c9f0f895fb98ab9159f51fd0297e236d&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;cbb184dd8e05c9709e5dcaedaa0495cf&#39;]
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：直接利用哈希表去找字符串就行了
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import hashlib
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">chars = &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&amp;*()-_=+[]{}|;:,.&lt;&gt;?/~`&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">hash_to_char = {}
</span></span><span class="line"><span class="cl">for char in chars:
</span></span><span class="line"><span class="cl">    md5_hash = hashlib.md5(char.encode()).hexdigest()
</span></span><span class="line"><span class="cl">    hash_to_char[md5_hash] = char
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">hashes = [&#39;9d5ed678fe57bcca610140957afab571&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;03c7c0ace395d80182db07ae2c30f034&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;0d61f8370cad1d412f80b84d143e1257&#39;, &#39;b9ece18c950afbfa6b0fdbfa4ff731d3&#39;, &#39;800618943025315f869e4e1f09471012&#39;, &#39;f95b70fdc3088560732a5ac135644506&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;eccbc87e4b5ce2fe28308fd9f2a7baf3&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;e4da3b7fbbce2345d7772b0674a318d5&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;eccbc87e4b5ce2fe28308fd9f2a7baf3&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;45c48cce2e2d7fbdea1afc51c7c6ad26&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;8f14e45fceea167a5a36dedd4bea2543&#39;, &#39;1679091c5a880faf6fb5e6087eb1b2dc&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;8277e0910d750195b448797616e091ad&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;c81e728d9d4c2f636f067f89cc14862c&#39;, &#39;336d5ebc5436534e61d16e63ddfca327&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;8fa14cdd754f91cc6554c9e71929cce7&#39;, &#39;c9f0f895fb98ab9159f51fd0297e236d&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;e1671797c52e15f763380b45e841ec32&#39;, &#39;a87ff679a2f3e71d9181a67b7542122c&#39;, &#39;8277e0910d750195b448797616e091ad&#39;, &#39;92eb5ffee6ae2fec3ad71c777531578f&#39;, &#39;45c48cce2e2d7fbdea1afc51c7c6ad26&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;c9f0f895fb98ab9159f51fd0297e236d&#39;, &#39;0cc175b9c0f1b6a831c399e269772661&#39;, &#39;cbb184dd8e05c9709e5dcaedaa0495cf&#39;]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 恢复 flag
</span></span><span class="line"><span class="cl">flag = &#39;&#39;.join(hash_to_char.get(h, &#39;?&#39;) for h in hashes)
</span></span><span class="line"><span class="cl">print(&#34;恢复的 flag =&#34;, flag)
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="十七倍">十七倍</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">flag</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&#34;BaseCTF{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">i</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">40</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">17</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">98</span><span class="p">)</span> <span class="p">{</span>  <span class="cm">/* �±��Ǵ� 0 ��ʼ�� */</span>
</span></span><span class="line"><span class="cl">        <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;CPU Error???</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">unsigned</span> <span class="kt">char</span> <span class="n">cipher</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="mi">98</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">148</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span>  <span class="mi">43</span><span class="p">,</span>   <span class="mi">9</span><span class="p">,</span>  <span class="mi">95</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">165</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span>  <span class="mi">79</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span>  <span class="mi">48</span><span class="p">,</span>  <span class="mi">79</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="mi">65</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span>  <span class="mi">46</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span>  <span class="mi">78</span><span class="p">,</span> <span class="mi">183</span><span class="p">,</span>  <span class="mi">79</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">180</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">148</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span>  <span class="mi">79</span><span class="p">,</span>  <span class="mi">78</span><span class="p">,</span>  <span class="mi">48</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span>  <span class="mi">77</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">40</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nf">printf</span><span class="p">(</span><span class="s">&#34;flag[%d] is wrong, expect %d, got %d.</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">cipher</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：有点像逆向，flag[i] 被乘以 17 得到 cipher[i]。
因为 flag[i] 是 unsigned char 类型，所以实际计算时会对 256 取模。
为了还原 flag，我们需要对 cipher[i] 除以 17，然后对结果取模 256。
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cipher = [
</span></span><span class="line"><span class="cl">    98, 113, 163, 181, 115, 148, 166,  43,   9,  95,
</span></span><span class="line"><span class="cl">    165, 146,  79, 115, 146, 233, 112, 180,  48,  79,
</span></span><span class="line"><span class="cl">    65, 181, 113, 146,  46, 249,  78, 183,  79, 133,
</span></span><span class="line"><span class="cl">    180, 113, 146, 148, 163,  79,  78,  48, 231,  77
</span></span><span class="line"><span class="cl">]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag = [(x * pow(17, -1, 256)) % 256 for x in cipher]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag_str = bytes(flag).decode(&#39;ascii&#39;)
</span></span><span class="line"><span class="cl">print(flag_str)
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="babypack">babypack</h3>
<p>tsak</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import random
</span></span><span class="line"><span class="cl">flag=b&#39;BaseCTF{}&#39;
</span></span><span class="line"><span class="cl">m=bytes_to_long(flag)
</span></span><span class="line"><span class="cl">bin_m=bin(m)[2:]
</span></span><span class="line"><span class="cl">length=len(bin_m)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">a=[1]
</span></span><span class="line"><span class="cl">sum=1
</span></span><span class="line"><span class="cl">for i in range(length-1):
</span></span><span class="line"><span class="cl">    temp=random.randint(2*sum+1,4*sum)
</span></span><span class="line"><span class="cl">    sum=sum+temp
</span></span><span class="line"><span class="cl">    a.append(temp)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">a=a[::-1]
</span></span><span class="line"><span class="cl">c=0
</span></span><span class="line"><span class="cl">for i in range(length):
</span></span><span class="line"><span class="cl">    if bin_m[i]==&#39;1&#39;:
</span></span><span class="line"><span class="cl">        c=c+a[i]
</span></span><span class="line"><span class="cl">print(&#34;a=&#34;,a)
</span></span><span class="line"><span class="cl">print(&#34;c=&#34;,c)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">a= [2487264674516612702148381262059366937897201508455413114345031288894980789076145147579418259432661232747375904997965581530362268904008339124626472045717075482791021095030019783589425299870946373246221582957232862473515, 491733695728183987781854883946776199363545034763223630648303216239781071808983441788738994635864262288104702316190256147614095355462666760091586746521889127102395089946736744234701020777747486645716679961505355358205, 110323038758283816811655397189354730775114318542406507944678995133064353922234139010858233544980338693080719766808774615216332973443076471838385315798081800456260331047745824029902641504699030254172864776140503685719, 21329601123439484788549839891633989762344638209267595412456647269024794605613697213699096256470155035750114059504925376661660484839061252258268241386676023785213539005867805566800471943519247336183762390966700950019, 7146972597944713271040951137457604863561388249875746261956055482229418349264570561740906104126974792505856583850338097727129246644471065603435449813884941071413766137227119139128098345457922432088128969598942863267, 1346101131622672931978096423414991055086097907048045187836881598919564312718270178534519827267497280433625574785132174894812908583233359458000469975702103413693480199742325839719191134247009906270778775450756715188, 431832097768527518676165198802192386603746291434967601504548859319580699889723090943427634867984592194172569910901514799190511020246917662162535632202054961537707269684557393598823535364874075052250490284484829188, 140385263282271996264759155211641776877746297983736897311922733831813190094504225023609340831846735540994403916688230922925129855025970272950216444321463493579227283703118512150491635819942098587286980862817753505, 34223371325515207445588748757581712557393912157235932688701226001484995652561037930828670928779595410194265999875772181711329727812185265441887453894003309876654082495957062628413923487565276953961953102939899664, 11277905223110088306111589808536546872836546320235997789453098291242971723694602770076671423955063276020078678714571127064308764611705435202479293805661470178917099557275252963592432838615626750886647727435412727, 2615533435460831263145388899927800470846179005257762751742107113431800042995970550154282940437470113325491219189765587324789634252029440596113709555932091761129000675863727140738692649309833681187804499985953136, 936680841170458882946412959909966575946011948314629933325082014426837165501136249855420901858482634295013806361789689361684904674438042695516337484436348646919308417999556756779144910987756875858573687134864914, 240803995584844951172124454225548986410808735949094019867567366838810221297826531921690948148961695516283629928962961745839887826049348862278548294987215333063020792491250359616172365439958324315638641990190536, 74980313650452416147684959971591530004150916322659108850519926847892455755211157414650129501071119906261853154503022754482691495645170933619292755026582075009055897885581671027043347130782615603358690889357969, 17373734350550516610959609643239951947839958095899981508834140825450716407631617618229082722622331706459216379319570540046133821392793975119423828799726656124807834541043219269949459907314628636546219059231483, 4383939698435145446949414991318424065438281430941348230548310095735465803169460840233678696507780083107318568406471009158126616954496458697727524252433591785759305622568557705826283690985480130620325779855269, 1070435075033499499988967771003353861621342562651011567215908784740129578236135452228720299864117045007232989018924013752836270314752592099997410344317383430641687448457000377071747633795773722163076615405153, 354613024399513291150023928129989293929227226203084151945112636505041432337820329935805740802403361855625313123094613318180050195219366366832494130593248906011113600242755768635094775633827342114020854687801, 82597124584081826710375601757684765457467298282386480837692933784824657535317108286212691529276214884031365269733862817274058538453459456296256548913748615606422415053313052283494323168620576805637766138197, 26135834190257866104316629323550052649627679758726229473294221139854796563641126471998920211481501156701889782668173105315082084500683017294728437322818254222939692828669475566191154442279318530752996234399, 5321914533271631715766698346734309258597941523919808971175049357994196078126479079595401724485236733828962687678778457409546781470810737250537642200901652790857563365204935103019528537962033407161035692676, 1401112116815344363602973427355047116358185953451255358550792547953394603648490800732761959337994181037602301212276448178218413428984435465643957862122433848889149559184391769249005008972240636924677483332, 340703164964920022751406615239919113589733348338271455697386514814772581315065581482054968704086006813510346859307625729162886049905513425065578320526943584411252201523709613325050800852296078315276309498, 87840565476176074750781589683807196881040923233689789764972859007886298300522765664170224177346224637510402223797751637511990096677274023769380478419759017880813713095034065541851821136431753956971681001, 19670793194720557916718563116693476958260133378839723765611437953301903581689095646338017322208705125479649557618768892326788688569445543579968049624743997901012938768052637463357937838813048475700143702, 4813717864536159278344281889539442680460787707429632446095662166356039450500759565004728794684170823084248242129657936118206321365817871353015182900801593481805141407218121604733002829781487535789180828, 1042206069053701098495071546906704343612504895408542932593774355364200288153617940373728364353536406373351075906293793845088075847011440543341941529120830192687505151588415115374221938124244686599669458, 194044946903756616103043562433809500007183272927392950867023951726626302681204141127037211903589021504233703959475286805099197368181117710043885464503673129287184477006142067195426098588591382748102539, 57242060503628134854797583503415516863794342630010325140908044397602380211468806869876771678223543893631961137313994861319272460663638480876700367769402916003571424012128837346480997355093988632012775, 10220201967005002779370447788097151915347020902180766203690278038856770790331091587750957262611786369059831723020056245241984653662463224025520044810966000669665537134571188694822388194379280786606327, 3267926212173074655716273983885176036956276231571067023300127600981173234474770474267538130720791055154389260987137327011230845199160118826368874310750622421181065045300794979970673152630315803973451, 664310922264744733608679352162235206229153782441085066286192469594499932348386155418089005696350197905438895173077254739918594652439993237866669330317791070351667267902119216464673735535997917820053, 157621450510303034999027157498529810254434467859123877137482107910574969124384732028159729373548578204828393076100787322321913754468400698891584836797607004658385107761645961934718993971913922689493, 39332477720879659647769207180648194166511069149312182714850691343807294060027257884701895063257342090729165323939249852666973310856943035346466688523098612569329263778095249692454805322913109933451, 8981431226314577645818078061310516067058739244501260778838272265495867618491462415652789974290152305589437388668252286740099675804549931870318361834902625342381411139234786285243806607019356580655, 2112396066721715241251602227199629841249291526749264633946336472170358658345723532373776051582626845585398413757777914886165302637471620129930025840435283626998895529130832700898103592084193587990, 469796330799746978963007177579525242476491475859713462679382870110198758612531699613499280185379426640464846165230615898408348461001941619050157303936273348173453633557613625134687931175489772308, 115039894603762374765072518903656214032673578314477265152318302986985809844170481821167559173999270345678822988509361838537021290790266729339932399789571955857561187896624119148469524606927195502, 29664847413037439140755929162295500789926130685594096951097063583886105875553862215342779333568726148068998390489061260679772397420854474310952173916283562144502155749545173676547095974974938801, 6556839835049647931901086051581445260744766665407776927047263448383041272915616955807464961262297820118065353994454969038345182131864552405100904248845811998006038518360062998811216993218123317, 1777902487663062541759851155686901732751487652837314110752529657038468352750515100993079307083868172100714925159868062197729467104948375724637901426300367514987134187716080043905739938236648704, 496319028827230065370808145407239788641593404351668605447266421139929451476993248197319730317200648698252327668625409509842367526798038085336803728242097138638139634601057690936621540950362878, 91859873982601930765698107766946424315968932113724973875252752520495744658349166435087906664763198237819106317321871232725285852613201351155535304791295392982339051653723048621713854087558299, 27416797198170440695880404003135961426335900780086489077063102228234854286849577430053665684665123525576025865136178905344946412182398068100227278108238228179476948006111402146551358956042173, 6618792570596090569883178232621713030844697317972184177900266954498675602890666553071207714570183352868264445779550306428622314821163774496224109073830696331713973117656394498431868066547419, 2170402078990376080093979069174241330730093169079857263825716044536454255816623476318486713531051261924372354329543376436907081387161693951811518904258013624768207438418761774847657241464116, 444068419739995022918617734805868711289130441640491361059833564963918508148289061718666452354434057970227476744547047349557417149242164606932560068546338531971271707670031796603537502372902, 116657711114961473575551110004924695540253659208616449841332120251303948007722209463493630964437083428655981974738051994193994806043789586554127478932520376572981058192629163539170482099439, 26060438230704097273528583087224964538829526126764669880723211182150736154082956489319587015488424248074673973497150602509972124276820315641896501503925719577821672512750083923483639733416, 6312791407424911633066282842976932623335914208291314848182683302453777089215292160945721990083867179076948154652506406356338815828714441906485780965753668277560566183244931348859397184996, 1692738421964980687206278894671327723911704272751755954222196367628340111939187266884312772028554097537058570911615150944663230388612366056826914851034642492298594744849153229556190046330, 467525048501123667461709936020772038812998605707446973687794928398759672463134111033796530786478727006399722869173671763892936977996495279695995929887621412909042553923445043307978487073, 100524774903368088338735495212617525628101069016243368191042349062731422745652851141040067275932170134907320208205726289799197848585810532178559348960204294517902672414604810447030596048, 27814678376250636475963101212563090069738325215292874239553841311037561288624279025540601779796471707609056593491462913915467359662214011975515860736192625178250236017806638891058352841, 6146583639189016851959336110111529802617165794295583668085087256400497268514196451801697302172354876150306785802188833007655768181472221094475392274540015787948511952367768046413009035, 1972647620592074216061102097901025152958921034850117568363055778941629490654706191168761681590445732321415108675787531563680577749629570660705072798303247953275401784690900022657739322, 371444236734952267365204917912482218024760669256564601735746557802172061599306636753624221981211002583971063750448869544186339158302695225083644994003958727288476784454648096424712122, 122254251587569792335530528509722911970032904171801982862469794399827245263786995733489731913997837358853070479769024383526380208988565918719151600653752397319872277146128837497328015, 37286085540618400296289156352820709922577362907484951458689730829327977274283958429361031670068907334172105855310654077662912181145565822690393824208950538512990718744603086462751297, 8960386121829638279311227577342777825734976587843199435094340053720338004424184197136819101116475086084110882985205105967675766957208204488229410580925549838579346975088433058825112, 2276020215301107373585539745757682715066838555468744061772014192384015274014672056309929648681686089838637957127768944113418121587630588726390948566064269910008396907056486696440621, 607349939368134408551415861865227396073824635286316486245465114777775395388058059102705505424561001490318248134384090100571125911216424062773005875309952406284203774537367839133285, 119036276576206703263155095063111697848826207711313825926870015597766389307963670003146886377762517538032971265642879985310317695973899218804472784113163457901422724084711780785647, 42030777748108550530459203444475857940945563824576240738615672332753050069206966495014628929275783847295884969372071131041457167837216841146848083118096773135990284469263324779443, 7801996642301319152692691810553695688255137357013588495692283033031549008190374987427339686278893185224986120367594016951691992507271905708595080902010159659368839867860433342236, 2208574074019210752518459502962754515153645798717698412888529548015314931730564928870825878207969197632997431492713572137381185806543942907257429896476484304820878553303138599159, 768875672280773738301803816415515519067859985949784777815605972358140605222957399855931295900483405997209014872309627261455336173608212560504792804732406159988744626008190591642, 213430837881757766520777720690227709564760977311522001626864091515991137423909703305978776728094360822736833235760061066314816749758660033547207607953805341923438394772222356568, 82360211831711259567147082155555818156999516949891879514305397375226376936714506922756403002876731807095740268483307937613566131364594612432398098476300712735589147781570183292, 17749505352232170648277795567698933594199437689182764405380407013992895289676270195878470798816715217377777574478356564936400974585960088437473753598924064324383361905659789789, 3427214394932046144638723931330597473316067571098072662894954825121393877991928319931449114219100671521983554547487355301825989691873309784465316768877146988849237541879345997, 1033902507229521469775736346351634090020261583833297661608844489398831364552754846127512235344097362890795464047384509362185144853214501000183283440093026203459311568816825264, 224896235915885231383021605802223120291823571580780275950317681857821908865357784480256946962966353978144999197255874549242776446126658379098611152585008158970159741029928166, 46029158819241197707530664166476597494824578315547299718547883731820892091315435238631987346971891025923179798692039448953613556744177038196467650472219486883115951311114343, 11947866502696456680811378187645438096064991719463034800178755900009558951200835612294081250719346343143340755576335021624771970543003065673188450976052831967872919086392740, 2920182352645954475250456149302161189384947754266138653194940049989939156554780361528842542799077656577372777863627070726368904843252451856963117841700429655465449705784298, 641622426678020294248348183140299041659157650855760105808225416711044677800278294044700367798760043786235745613510792462327964867426046011657009528106413572140156175050547, 139954746021857963632941471710740997948822448809029403690252968784849647633362222415971470082427919553489814062772632095710992183657541577740542585479640231081279442703729, 26951287563812328009402867445459718346022404035671471571180747182520664735617063468580188663385794364598479725800534646437082877207222254951262061856164914161401031069085, 7533585444288704788707326472044821719148563540561950589462107215132713320228676563974287003223326227564110259498308322080055316439031345783355395296729881160340610419798, 2276681583409260736395242645263289467585348662731848036224090877214770286189504748163492790260653720049576572250410962278647838121717162502347694787530301107754917965930, 474556448905745036966775435479094252142291985759634322576584740921367165655972599891226896859675668151114091970232772247346351748955558953513984653925641106869750480713, 127434337967780172994097939061090682233760718060985516805855544997040535343689397647620215878303719159525314116562161004671399396862283153119456440081266677387394513825, 26958440398830097157570752848820597974607321452122682350667898050790790872944229259301257843111978215025542048968699222294492807645241856446964337776714971381969501071, 5543555284065922229007474385783130130141655633965977061928013317537397727717406514000700955159647395591026117082092382033235800387850239860460046217510413778741145568, 1234762639172810584930296374422356813288496696923257612102992994614585199225028932857122231293467541131628736229833789522239025569090130126077017761481761935075168095, 355466248406445302867530536283270751070714127588124044114582631609659246249339560304163152323418724390561360227173698743244037301264764126798143323643968965204937509, 72700233281268425015457883799224003903351225804106120865021630177680188790291132871915896124460090399131402188231983457135950533458784941828330878270977967060216148, 17316325779212303492370685449752299828026183539683998725619992507954441121758510621171086796417805607101134043617316264832615245565516418608812080799316990851625705, 4045793926070659592750134404331599438619282956075192844401269281007613550701517318190039173492631001707043977026685514125253560526115949503328595814800145874763660, 711093850172488751248536015688936346283846062295071944527029992467516277719725837096755918337587878576030222851749327532666344838291776707230618144013255672878802, 265627118033654696712457079751401631255125309014812639375295118794146799198801006240800873274048170518660448221821727034749291649708953722421725907035286053353872, 56397799026942637682063511042055387061218525595156363606895648399263418939712512484112089481484737116602512227228360835774657959685026627558074305176995845647003, 14485314789957973511455116454157965523985421493897618644045918045972073878396047755360530791556364199120111093825046698573687446383611922050184839529827282440392, 3550955573839595298078922255066479093374448121222507459840552079059417076208499387361330875700156148993662311858100125881757983588374422578671684157194578005699, 845394743568277367630651838202283372116209637644259875312243046465466486130071115873693547193074995290146894807692302774606698607144257685615262061054213977420, 157730148886711208861332893525227881346167845596707482474187376786153504516831765170538422967044056418676212271368775137847308449974344069982254963969728576186, 54972881967813310263623651713923315210166704822071760933248319000133464676004646169143078394020203091841106960137380702725337793156762085219469872257140065395, 10729618624425932454603285350456338562675184367958955898413107388221142096410983819404349570576694967179369846493834859543515755779034404675292796271503098978, 2442709998183758153870663320358670148543830566673551209180788899834647749860789589565309923762896818608005296106561164431377898506019097822580641263331814899, 651590036376284619471743663785818577107718418313829721360265583261583596100827943422638184205536113868285291626431841044058974804223249221103868269005376657, 114607798091152645971169174208076386390725220406372401915445980825934238917993417913942451617626679858301802459311641056076814238046173194524157303256038150, 39902529162554510030314089494503111747276505091248405060746015077422014506338256115473236342993594864048856417342484086620483648018566663638691082167406896, 7696036409658331229292571646244718273466046087174912598857625566056708582171413470987556822776798859431848832604237853020082821687940873973792941059899704, 2124793715529138812294972358553948624813291392446651644830711957681124971135340690294893448419315140942986852615187098678211216431027229098600530178187333, 658384832743376570742078380839633081933064245096557997421967190397377225701314189557712470669358349072689322858650074777626830988174808516744296032918846, 207441722934708037755237631720378642887937120813748348023809687455047615244353892880515039372882445336126456679753369371480841621878413386189854105557570, 46120989258570141716198175239164426659655378133453203231982537688000264558364343582463401621127725393877459942514087061448921695021828660135004811441077, 8188249463851855339650372248928765967441086033339032675901168172673586603869217763697984051550480433177801759541580074823902608731330486865652085135044, 2937142904794524692633847174299189664745670816742834573158221153146769098153095208026269794290966633578370921776670433893125934429015973900770183068397, 733124926365921400367689082582974550222406734787055535605162687013854196685186803977001257147200683812867023143593280536908792623212121135546302252718, 163278402453599131564496240174531690514528227885644439879148727669198836851619817419582703102053351987308732391369947772790306377652049104175405389057, 30247650270830046327693354982611104496891052070130966758534212809812843335592964533296290766840765263207385481421035739473846342013342141171267959427, 10078130422940933339521748812234495734268808180137214319132992860890442263439248960992021699437860319479050323778157839338656439168670198619111143719, 2468880502161574512996214909253394046701372930781084997897282377444297398943413058653731620475409298189864459900922031063170285510529204509174601472, 607074026100427506196023135076433955199278835550407310798426497629249872001552107547116229667872950481628543662982580322754725261269013849906534673, 132740473918237042219883376937810235079740145884708583638955667277623190279830437900121550989480157388767941856419463040395910600481643868918183256, 31718510456640085593521631697634193356173604238387825664787000835659167411973149050707246808351118400835035866343214347384616969135648635282147931, 7013023279079169100512494613396045516189395791014739872279083083144940194186933569894993097804928064121695159201540587912810973411497923430308118, 1771185586112090213616219590319917086599723206748079096836927259082387415598439340193771966567407719988569555116938671184047274203791682665544114, 397374970256811388188624914624139083024782079917643579178513419907217677561151325006437923068157587425558261984085274694860016959461272906962347, 79357052331733760410996870451429462826990142415371259214931967883012213322689987714484368914655142353136743730816759493623445282698964105194007, 18024995037150399824560351471574943556440673595591374226442857720036395804619368162299007566488606118476181051500800792556435843369345814420200, 3672082813534614033824027501205682677746304198256311647201407880518658491065244877413146229442328563967205873649123895823789401080903874966058, 884390448367024106697977520994089114652140177186827650340642302821550463666402143376715117683073225822100147575051185094558637911933790548300, 188239732756327819809744123998273956373038631188535307108080455432157193929576323356894115167616675699250266852372722398883063108283627629142, 33288603989729116913271536956952173835445978966530730095436444955036538722332958231617041802341417062090911709863572792283326143337721274355, 11485733967829072841907653505652765367596185911550254707130569392647462332893031105105058197515848740962693154105512628726167266984356020289, 2403399291804759683718697201628718853672014990022411946032431974098338948608647899389041474778909482165700212670301626696886803147288043249, 511319889754958068650171413169799880502913743237143323338990019288960892229714861654882544537650773480294037968794797914167989453965720824, 108151236227275669723663372909233127249406930188286111418173641508503812685900937356143956513296377001193855340520507635261983173020133040, 29238304319413057053313068686030250753447165587962843793828466785518433534702764546822180884428461976687744929459281379124786742084937021, 8710806082582848713173281808121766793059207164795295196447513451552342446919958461280536897422363560410120915054864290671091109422830007, 2960745852030782790607427333914261375033099283529370879973360161495226124203100530063141357601421786632355173585713266548540973431376582, 604226789553326438591187728019722484152820159976600984629527520901554123057786334839341626845330699593003318860611284025243121271706983, 182601602703012851376129630760230344746014108213070190831158648995503303041568836468914587260292443510296580408749988987988496769980026, 45452114165544367630569931330797239179068892066478030202246828842399491816831847850747717090783448434947452983100492335497009639567888, 17121905765418035275547423058447462707899580001255272989656046701474401090015657327101125412277786884745764423250530487272209339058447, 3774603297652275052121496733944137560240160153708941233671122697937317529256966828765637412706299259386179629160090242954994907929332, 1060720547441758622170146447289706124200025617853186951481807263542360257370083864882158715152433273118314629121456220166038646613297, 221968014150998259820244482577203245639303312867709655818056071267607816968641371724863025295597993367786164837699315327363092768373, 48882714266352303994499906166362680249387918980441207673706748487810074857456907593421757139320785593117603391693650930762966455968, 16202448926627445820838961561455164462246910065772244580677765363543397691542726082412061203163218760307389834156275979660359394394, 2956163682419868606126264117158250029934298756926288053091609992334385653684466888852763393290616941805759810929196668548734379973, 947743414350088412833104395509485078494688169216314527117041568424743421788079617145817207736081707175649820823460623353469499129, 184945524926843220565904193572688427321550948207655453104873607656563645624884025013598624332554709507217938881998831490973926770, 56091241819606834802888641120709675472905317085277369060569812131174812302014447128355020686805930142925377568700991226583887786, 11342476554725825973899273577573419030806527097049265365675861670559660391106730894000199354064208522140305551746468882526930218, 2402177443476249504669747634772796049517512708172380623039160322117732888388776939986309881254003733945369109368480598991083692, 779694676467776330674778030069618028430247798034244061629255618166403221248637754838157860401196252119142530084615889227008718, 279805151354990313327069866270353558845137298807826578854001581649814949600343606775647790956175906533124785285484676594205727, 71475104043185673882357779032282210215441549654529833915666511795774890652222328738683786126978390540777959958334867072773903, 17943539235945014339231354558742830502206047263873390682998140665294407299445224663761111928004278268665005924991145357190559, 4644026442647371851471373522652996931494883964189143247893482852205071445064380253582641516905658082237627505163407862645664, 1409644155578077661014560265925065735043498896729842671302999827395230787557009605337358883198670470099670153973385533319619, 323096734145812043063935925026236730750028036642046031570292345040624480525514361785469029998625026693350812690921739556759, 66490109788591511799221912380563668027716398810544644123382175383682357229245468554339935745239347569290928368121481198120, 12656292548243054261915436732277320096081079272327419007058490559709461117024442299280829706525636594720337557745657188367, 3391681366475824837488092758715214360838073187075047614113065989329609613896833473414068502642149439870471691863634629122, 1171517421153263625675697419132009454686117107914679030403775353063155717395912120634642665620725468223446139999071277507, 283703308943571467555327320427163735194765821724187323544643973406396459830945519805247147967066979142358739388094356677, 68051202286065965847502158995164914066216566669074127539650532219749577216638549042842244710379907101440823172129217941, 13657391854992511108591836048816405373941724899814769682716923188133130484869138365241075289816576384008939639840185236, 2883783693644859186835460708048379333567917588026714123591585397758887606304693027342351097912118721134282551369664243, 799049413981621014519709854919842048905323519892313665984919603393072653972864233067257746232644641382453549991205564, 167323486728516981799615013230008131717839880066330604897780052101994505570227406902019168715315935265773326851501787, 36720821966367632835200966450053402442515187808387796741238632349642200514749124280117021313827183586060369692397742, 9231349669963900651759770670625059190403421490616649578654575717995018536450416781815824036250202148465899261409814, 1782108859562682583955834770956766771890605266822317978330465547356702234978432274339716401371413673051273821401047, 403558799957529775306903388246707975744649346938130151765107472774892029713724284184220469230250620098654222513187, 113610170795802770344935864787382347027936273326387062416574602249889635787754346617875788451115772661826280534521, 32055073799513070460127524930885397197257512625854036561086683809899754909243064094359316603350553060664792782962, 9032924934526196049960770072668776382612241442724751839457302023155061259650364280524549081144893790536494565021, 2017862790729520323724155794794272872202696299996991444268875260039652843714149080734888358373743815054699872032, 641989462295283575733593919337192523868529607267791351139020713122159499889249625918896534847416953951571198300, 128576036185681041874919451733195397084174018792730182604376427967040903314850718633946179141568345684439398601, 40372047007036282320578970360805818319565465833073029617047122562052782556856211341854983376957243551410081742, 12690329041364261531787667832647179962305068888653710915257119208086200721695307184639464428289081103144163044, 3561839882694824398822284966776610177573484210494611237706713481725365094327241161248699081978241602830178596, 1199938132534089466501994820759235969832300222872622731608847912038243599132645129289586987692172765041057363, 324263436138121201088338125064781061780131145213294921711639118717892670326681104392825089385185080492440484, 68312903907509568411987755477707268100466381276451833349595552008166402404491773244111478626617324226539375, 17644820024620964580235818915132121042107943132825887368503777072488644953818352369186661300059264368686602, 3506176982938427175993147412444392161707218066658168782915638022559988465482121419504891010260766228901318, 1066127911891872518349397911557440606663336809214920827134975446907327509548040800613223772158827103310018, 226192414853873324160991825316404956087309825251607871786471768482769238181939189651359979648153657144702, 45868481610678874924581859998825662511897619432776149300471637861901025934649825592930301843850526560482, 13790618957198333318923230203705633437848971510707911225277092048085966476634360389032477412386316672075, 2577037700547459915849817513069936580425167358802123937052546118913600453224885074049561249688358836828, 907316011507113096967526321014989153923826069305244388586962072152306166058795915708345202709057953005, 257655812504204080571300921288974779044004152926402846615682864861219686480771224251979519937398150021, 49251062839756470728155099947305937498531111600022908848098152154867828870296984401906907127621922967, 18003086576459067165101290934987020831800807030229687007784917512221091664668503037255416369751058381, 3931602604129427365537886268681901399659904652265314628365560645602702305389347981284422957262198925, 1024271243554288667730540660664163792950639594042380266463713922650987059456833218457318808946966091, 264399551848126394660403560510401104363977298239470868728218368941030448200247464958990623172466340, 91991457278474569364064153570190123603908094841658212918408559703533962838464377716405517361239718, 22400319343956127928389329988299680966797095025488025868862978943959831082472834977311350142227326, 4054933925260064992644878588484342847457594792015796931877255389193313381697255433801823807489993, 1563931191287550417926830376062569859269361644002382824954373333292013041945346281280805769011292, 343600935590550484460351833584964172817805330710096798788745676605896512317351762955463013247649, 63176100013413022744650607325631187438860827337150751513958540819158680919377176592820951694123, 21461895060447171957232560518498142689748550789857829420960180353599240337920080298104122001920, 5835166770039346718590125171268445418773015279002775708686914119655634953623824713817863325421, 1583080965885530423876853196443645139416147803583378489670913938148126388391843537295818940207, 392027882718889629138666367076395194013822284370187648811904450742968357888850048132707951624, 84773060845038628419287336751649666625561226450930810787040749330985148718455599359011719538, 20913329354023188439880157138010537207897970146456506518137268768176475768733880753458923347, 4311750805563893138689876217833463788577851583828477282279295599052168675043703275872499679, 853899685398867377607396879875326827128843982112866203167371936104484725330862023846437598, 177330267045126383717093581983187474779454406408201086941455408963372790398670000549267776, 53143647775046286515978817675952110384368487980955438888997975610432428251415059859228454, 10991259161865360146194812310045803635018376660538575719261554366173833834812335245373835, 4056765217542521288464908532309700817396778995632736813131981648221349714370388148127516, 804624166261647601714189486709310419472244009530705820922420809512944365943834561839229, 221209387838524016717980366851546408106123634464083126244578703480033718962945353384984, 44893426704852156297812963470050296993434463573414592728231358819460836492051444088309, 15097276880249572944791099185953982641176811310343688646744220558627388586126270884093, 3177547688411513827329112344846258118128928380413096551275296685970663730887380521208, 707854681966281587817169996379236533896940250761506339446186239585936846532007717960, 123430766712269269314015844444108981877839453341743217081639119599583069918979135631, 42727196484340883716428235074652898935106385756024360939020725643288512665432787419, 9795023686113954751639542218587813833546340682044130681106706094735594753449446343, 3333589652095912448402556417544763364674016013042330262047943676041390880358346180, 947455010581251264347248926744940190279860580467728251791365397084078291899564124, 268670018298046298594544067046438306285322924770238391595093977430279476868065240, 78094390422018068485749659108183366278694042747549744891971134188665400412950020, 18124918094760916369648633132238959364840331932070152769613739914614309846704031, 4241888706533610079212359644998015902376872441583028817350629704555219530448753, 1292864973632566395230008219224138571254648896695439011761255646000025705327047, 268748278858999280597005392622004242197468731403889200124673378952297248513604, 88509143938000904019404561563568039020388387086033088264015176342184836107961, 20193371122440969904693011623640235956008535236609083989796068753247319156032, 4038600180280215891988824178178278280373636611246918842044528278230564207261, 1107150907782944887892399335890628523766269912586346493641592121812091723247, 210625186186013434779241292600805721380717453215450496819990522919652412749, 52953910211550391007013147620224873533688473472101985821194501496064403298, 9097555221706291288743269232756819233000414675958515393645941994120605160, 3429649093597174301305755373533641028744892761855146399462989664052400884, 741640028601865737636894538300654069448568041784703865806900024636263858, 137111267993711698795554790044192357770629382096307382022924712860324239, 38616149627736424773611788634842959989120382193171456026729095563767415, 9431485520373346422889960992205054090491173749526200420980321805553690, 1992952778532071559000019699416705938136688490627773967637839059076015, 574194788106589082411518870360486672683587224354718671901248024476268, 102609620640057348696515220693089742351613040750651566890644962920462, 36268823254475267212915191076327557136209959811616783925907478300982, 7567999544690811975942075962292580482677577353162367723788797894980, 1874140527739488453786828468118120241481575966337619572680165251377, 453914446353792760975691426663914252084437914832347163629988619705, 165150650733410175597931630292861667062273243834275274945484646602, 34566163119600685975060339689452757045437083897698838710019239494, 7694148541008402030841753047537726531717215585386379181283251145, 1697576884850411658454847805622249167935227079092758267244556419, 472437807783179983228633641986010243354676995634705949446120356, 119409918075506001971427759705853133156186846892920587610723175, 25613263424766799565203791718547119460962423676387668942984591, 7805142960598461841091346841458786166600096726425068620929337, 2767230135693902128766236987544547378777436388091785064756910, 689644486314086496286093830416975206144754872092432108597436, 138642086125227682870831666630271950088954885603515871632201, 30047434693445231347602467117028303851832764185641774643468, 6851801387424175873694354145711254327404855789285230103013, 2120042874205307146695207067554609162977513984517631857617, 490320105846897857421254356104910632681008002313418940471, 126323731373804665276167034060996983366300068355660603173, 21699921539905324453875345006818945922412432384306278913, 7939681050823987735942326816454304705408373515598927024, 1704054406000164917101338955641076586996654015897777293, 674629720702507360892410918497513853241707768110535720, 130116804903893330957629746403630277914984408897684191, 36586674897705341032938585410676119549859764313014514, 6820517853488553816157069373430435510514248629408934, 1940615831245060580576779381334292194461763717429719, 486407487540373443078130965659847688641455681092783, 115503902548715291215146001384729209189201342203617, 20726453501406140054607926221786392225949497849620, 5795586010156766459954451266198423523738902544440, 1894126095992857664160110316211206136427948391401, 400235284644456465531456917507977101554184036138, 96821039379669584765064498053975819680674844391, 23003305579401059533778299981921977893360385917, 5228073966664279351555893540080524011514115962, 1242198234479925081489833339665036257581784830, 412185918978837707936146917867270887000813745, 100133634343775138722999743130814482251294603, 26059544917887755330857182088221243972088111, 5139528748995372887990321340679356174733638, 1253542354308041615766358708614160342158058, 255695244303425264981809526736239333102982, 61808370933695923699986081041674755242751, 12426096507290278206573602748929564597975, 2986453750810080523307169404271220297061, 642144302488057714162005557670195083334, 130361391592026886001154254666792730817, 38722902212652057786773086799878934378, 7692285091800305362911294817569041066, 2668441901840977427307689562983863761, 627879703191450992712744583653335581, 143466848278452388635765854137055267, 40114449315047293082657646359855538, 9604649217508319090540717981276261, 2160954625898663094838587676686854, 663518655289550974870054172122371, 165231181091826810616798470843406, 32017505733146837917121936265672, 6710170503572414769550988030906, 2193907060628154300461720427652, 655138594818423378286082953437, 128372286376670762441323321515, 34081674525017606572942142473, 9410152783640368288366142632, 2828735859241558188208098320, 551007171562149788272788426, 123790351812017402954987183, 26171709615346256252881994, 5974406115827778237616062, 1129305631130982975444977, 309305180419035303006618, 63076647774929269450546, 17802308053095636943505, 5708739899619810440888, 1717642617243788103954, 487452007321104273269, 128040514304008259695, 22395338754966061650, 6980614247696882509, 1954726203330249242, 521378690601084559, 136837526017031961, 29173740577404415, 7191768065683254, 1621292657659019, 549037231011822, 141224784287699, 28266584508619, 8568210839573, 1730361037440, 343914088335, 79692432578, 29986725790, 6384194185, 1319027283, 483793159, 103505140, 22103086, 7280487, 2401760, 411716, 143073, 37097, 10436, 1884, 649, 134, 40, 14, 3, 1]
</span></span><span class="line"><span class="cl">c= 2488656295807929935404316556194747314175977860755594014838879551525915558042003735363919054632036359039039831854134957725034750353847782168033537523854288427613513938991943920607437000388885418821419115067060003426834
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：经典超递增序列01背包
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">m = []
</span></span><span class="line"><span class="cl">for i in a:
</span></span><span class="line"><span class="cl">    if c &gt;= i:
</span></span><span class="line"><span class="cl">        m.append(&#39;1&#39;)
</span></span><span class="line"><span class="cl">        c -= i
</span></span><span class="line"><span class="cl">    else:
</span></span><span class="line"><span class="cl">        m.append(&#39;0&#39;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag = &#39;&#39;.join(m)
</span></span><span class="line"><span class="cl">m = int(flag, 2)
</span></span><span class="line"><span class="cl">flag = long_to_bytes(m)
</span></span><span class="line"><span class="cl">print(flag)
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="babyrsa">babyrsa</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag=b&#39;BaseCTF{}&#39;
</span></span><span class="line"><span class="cl">m=bytes_to_long(flag)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">n=getPrime(1024)
</span></span><span class="line"><span class="cl">e=65537
</span></span><span class="line"><span class="cl">c=pow(m,e,n)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(&#34;n =&#34;,n)
</span></span><span class="line"><span class="cl">print(&#34;e =&#34;,e)
</span></span><span class="line"><span class="cl">print(&#34;c =&#34;,c)
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">n = 104183228088542215832586853960545770129432455017084922666863784677429101830081296092160577385504119992684465370064078111180392569428724567004127219404823572026223436862745730173139986492602477713885542326870467400963852118869315846751389455454901156056052615838896369328997848311481063843872424140860836988323
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">c = 82196463059676486575535008370915456813185183463924294571176174789532397479953946434034716719910791511862636560490018194366403813871056990901867869218620209108897605739690399997114809024111921392073218916312505618204406951839504667533298180440796183056408632017397568390899568498216649685642586091862054119832
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：n为素数，直接对n求phi求解
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">n = 104183228088542215832586853960545770129432455017084922666863784677429101830081296092160577385504119992684465370064078111180392569428724567004127219404823572026223436862745730173139986492602477713885542326870467400963852118869315846751389455454901156056052615838896369328997848311481063843872424140860836988323
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">c = 82196463059676486575535008370915456813185183463924294571176174789532397479953946434034716719910791511862636560490018194366403813871056990901867869218620209108897605739690399997114809024111921392073218916312505618204406951839504667533298180440796183056408632017397568390899568498216649685642586091862054119832
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">phi=n-1
</span></span><span class="line"><span class="cl">d=inverse(e,phi)
</span></span><span class="line"><span class="cl">m=pow(c,d,n)
</span></span><span class="line"><span class="cl">print(long_to_bytes(m))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="ez_math">ez_math</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import numpy as np
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">a, b, c, d = [getPrime(128) for _ in range(4)]
</span></span><span class="line"><span class="cl">point1 = a * d
</span></span><span class="line"><span class="cl">point2 = b * c
</span></span><span class="line"><span class="cl">matrix2 = [[0, a, b], [0, c, d]]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag = b&#34;flag{test_flag}&#34;
</span></span><span class="line"><span class="cl">flag = bytes_to_long(flag)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def randomArray():
</span></span><span class="line"><span class="cl">    upper = [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
</span></span><span class="line"><span class="cl">    low = [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
</span></span><span class="line"><span class="cl">    for i in range(3):
</span></span><span class="line"><span class="cl">        for j in range(i+1, 3):
</span></span><span class="line"><span class="cl">            upper[i][j] = getPrime(128)
</span></span><span class="line"><span class="cl">            low[j][i] = getPrime(128)
</span></span><span class="line"><span class="cl">    result = np.array(upper) @ np.array(low)
</span></span><span class="line"><span class="cl">    return result
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">A = np.array([[flag, 0, 0]] + matrix2)
</span></span><span class="line"><span class="cl">B = randomArray()
</span></span><span class="line"><span class="cl">MAT = A @ B
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(point1)
</span></span><span class="line"><span class="cl">print(point2)
</span></span><span class="line"><span class="cl">print(MAT)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span><span class="line"><span class="cl">85763755029292607594055805804755756282473763031524911851356658672180185707477
</span></span><span class="line"><span class="cl">70470862191594893036733540494554536608294230603070251013536189798304544579643
</span></span><span class="line"><span class="cl">[[73595299897883318809385485549070133693240974831930302408429664709375267345973630251242462442287906226820558620868020093702204534513147710406187365838820773200509683489479230005270823245
</span></span><span class="line"><span class="cl">  46106113894293637419638880781044700751458754728940339402825975283562443072980134956975133603010158365617690455079648357103963721564427583836974868790823082218575195867647267322046726830
</span></span><span class="line"><span class="cl">  161159443444728507357705839523372181165265338895748546250868368998015829266587881868060439602487400399254839839711192069105943123376622497847079185]
</span></span><span class="line"><span class="cl"> [13874395612510317401724273626815493897470313869776776437748145979913315379889260408106588331541371806148807844847909
</span></span><span class="line"><span class="cl">  17025249852164087827929313934411832021160463738288565876371918871371314930048841650464137478757581505369909723030523
</span></span><span class="line"><span class="cl">  59510107422473463833740668736202898422777415868238817665123293560097821015330]
</span></span><span class="line"><span class="cl"> [11314088133820151155755028207579196628679021106024798818326096960197933616112389017957501267749946871903275867785729
</span></span><span class="line"><span class="cl">  13883500421020573457778249958402264688539607625195400103961001780695107955462968883861677871644577542226749179056659
</span></span><span class="line"><span class="cl">  48528427402189936709203219516777784993195743269405968907408051071264464132448]]
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="思路">思路：</h4>
<p>1.非预期直接乘开，可以发现矩阵中flag为公因子，直接GCD</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import numpy as np
</span></span><span class="line"><span class="cl">from Crypto.Util.number import GCD, long_to_bytes
</span></span><span class="line"><span class="cl">MAT = np.array([
</span></span><span class="line"><span class="cl">    [73595299897883318809385485549070133693240974831930302408429664709375267345973630251242462442287906226820558620868020093702204534513147710406187365838820773200509683489479230005270823245,
</span></span><span class="line"><span class="cl">     46106113894293637419638880781044700751458754728940339402825975283562443072980134956975133603010158365617690455079648357103963721564427583836974868790823082218575195867647267322046726830,
</span></span><span class="line"><span class="cl">     161159443444728507357705839523372181165265338895748546250868368998015829266587881868060439602487400399254839839711192069105943123376622497847079185],
</span></span><span class="line"><span class="cl">    [13874395612510317401724273626815493897470313869776776437748145979913315379889260408106588331541371806148807844847909,
</span></span><span class="line"><span class="cl">     17025249852164087827929313934411832021160463738288565876371918871371314930048841650464137478757581505369909723030523,
</span></span><span class="line"><span class="cl">     59510107422473463833740668736202898422777415868238817665123293560097821015330],
</span></span><span class="line"><span class="cl">    [11314088133820151155755028207579196628679021106024798818326096960197933616112389017957501267749946871903275867785729,
</span></span><span class="line"><span class="cl">     13883500421020573457778249958402264688539607625195400103961001780695107955462968883861677871644577542226749179056659,
</span></span><span class="line"><span class="cl">     48528427402189936709203219516777784993195743269405968907408051071264464132448]
</span></span><span class="line"><span class="cl">])
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag = GCD(MAT[0, 0], MAT[0, 1], MAT[0, 2])
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(long_to_bytes(flag))
</span></span></code></pre></td></tr></table>
</div>
</div><p>2.预期做法：利用矩阵的性质，矩阵A计算行列式就是flag*(ad-bc)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import sympy as sp
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl"># 定义矩阵
</span></span><span class="line"><span class="cl">c = sp.Matrix([
</span></span><span class="line"><span class="cl">    [73595299897883318809385485549070133693240974831930302408429664709375267345973630251242462442287906226820558620868020093702204534513147710406187365838820773200509683489479230005270823245,
</span></span><span class="line"><span class="cl">  46106113894293637419638880781044700751458754728940339402825975283562443072980134956975133603010158365617690455079648357103963721564427583836974868790823082218575195867647267322046726830,
</span></span><span class="line"><span class="cl">  161159443444728507357705839523372181165265338895748546250868368998015829266587881868060439602487400399254839839711192069105943123376622497847079185],
</span></span><span class="line"><span class="cl"> [13874395612510317401724273626815493897470313869776776437748145979913315379889260408106588331541371806148807844847909,
</span></span><span class="line"><span class="cl">  17025249852164087827929313934411832021160463738288565876371918871371314930048841650464137478757581505369909723030523,
</span></span><span class="line"><span class="cl">  59510107422473463833740668736202898422777415868238817665123293560097821015330],
</span></span><span class="line"><span class="cl"> [11314088133820151155755028207579196628679021106024798818326096960197933616112389017957501267749946871903275867785729,
</span></span><span class="line"><span class="cl">  13883500421020573457778249958402264688539607625195400103961001780695107955462968883861677871644577542226749179056659,
</span></span><span class="line"><span class="cl">  48528427402189936709203219516777784993195743269405968907408051071264464132448],
</span></span><span class="line"><span class="cl">])
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 计算行列式
</span></span><span class="line"><span class="cl">det_c = c.det()
</span></span><span class="line"><span class="cl">print(det_c)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">p1=85763755029292607594055805804755756282473763031524911851356658672180185707477
</span></span><span class="line"><span class="cl">p2=70470862191594893036733540494554536608294230603070251013536189798304544579643
</span></span><span class="line"><span class="cl">det_mat = 9313002751216096594915402453370329931226821399439699822628002249141348324178462337738486667684233746504726090537569307569303180884280092449454960379622660268012818162867848151377052210
</span></span><span class="line"><span class="cl">flag=det_mat//(p1-p2)
</span></span><span class="line"><span class="cl">print(long_to_bytes(flag))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="mid_math">mid_math</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import numpy as np
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">a, b, c, d = [getPrime(128) for _ in range(4)]
</span></span><span class="line"><span class="cl">point1 = a * d
</span></span><span class="line"><span class="cl">point2 = b * c
</span></span><span class="line"><span class="cl">matrix2 = [[0, a, b], [0, c, d]]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag = b&#34;flag{test_flag}&#34;
</span></span><span class="line"><span class="cl">flag = bytes_to_long(flag)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def randomArray():
</span></span><span class="line"><span class="cl">    upper = [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
</span></span><span class="line"><span class="cl">    low = [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
</span></span><span class="line"><span class="cl">    for i in range(3):
</span></span><span class="line"><span class="cl">        for j in range(i+1, 3):
</span></span><span class="line"><span class="cl">            upper[i][j] = getPrime(128)
</span></span><span class="line"><span class="cl">            low[j][i] = getPrime(128)
</span></span><span class="line"><span class="cl">    result = np.array(upper) @ np.array(low)
</span></span><span class="line"><span class="cl">    return result
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">A = np.array([[flag, 0, 0]] + matrix2)
</span></span><span class="line"><span class="cl">B = randomArray()
</span></span><span class="line"><span class="cl">C = randomArray()
</span></span><span class="line"><span class="cl">MAT = C @ A @ B
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(point1)
</span></span><span class="line"><span class="cl">print(point2)
</span></span><span class="line"><span class="cl">print(MAT)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span><span class="line"><span class="cl">65540596822333029826884315503808996273733737079814345540607878287618419734231
</span></span><span class="line"><span class="cl">45151244176940366132774311848077675849486332018843894072137609985463616792271
</span></span><span class="line"><span class="cl">[[9259505595451159514948336330303511539525155092949382077995385373332083424570340733825203563332256599256361679775371565817159463557158551820090084800254999338417057682355404780422980119717238594927467956675771042145306399815569005775907169857728757334979422594358
</span></span><span class="line"><span class="cl">  3700462282298785820527479428312072678870010244861115107206951164684911761755437333209293039456840068340334559453608012512177623936248784897843503284633804083281388001236742261832974291349480314135560368365574114042082002559069958228523318326290833422846224288247
</span></span><span class="line"><span class="cl">  20791012146351643571145217310876690226642338279942557085580439219377325884045305279931904540467264182713135410067252835618936836675270813727053937054168296298149405902638242278868020381541490973458957704137657413376043351193]
</span></span><span class="line"><span class="cl"> [3802535350808074374431476757195874789213113083310705049856269457737583463559458126494122484246497049005001474007088865512110432486291568737501434666990689483191924384489484665070592656641925905986397402822195880143437724155134584374613878027218950975919679551229
</span></span><span class="line"><span class="cl">  1519642544380087919293814751485424198320747098741960781639133554268321708273309194651985562222274023623071346914239982055028526526058064787882720065775210796950963778381575914964024929110539407721461321785325399699126116201001806816030960662346173275101476487421
</span></span><span class="line"><span class="cl">  8538097185709421082644083672229287227818939415260987123718318427750267353075860559170390896769087600458156859498331152566368881938040799840806164389020986990994328370205184734637870147251004626759120887684269603636183629300]
</span></span><span class="line"><span class="cl"> [17987668490992083132878642797176089621188858356259455169173987325310681186627844776077058221612169421636403546746899152917309634315569997105261046388995579843528014810244648968375990949478033964619008761814039733347955609163
</span></span><span class="line"><span class="cl">  7188579142941521685422767412932555782658469950638690886255638896617687421517941457682493542615460990114218059246938237257830976937359020731335958068934235967457123039874441635435388736524907036941379695243043923900290273902
</span></span><span class="line"><span class="cl">  40388963560266769813551191613694768219344365780650048155838802242681775019274045964917142477325170274191702615504062392461666558731638338001971723737440974198823443420018559746335727687]]
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：和上面的一样
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import sympy as sp
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl"># 定义矩阵
</span></span><span class="line"><span class="cl">c = sp.Matrix([
</span></span><span class="line"><span class="cl">    [
</span></span><span class="line"><span class="cl">        9259505595451159514948336330303511539525155092949382077995385373332083424570340733825203563332256599256361679775371565817159463557158551820090084800254999338417057682355404780422980119717238594927467956675771042145306399815569005775907169857728757334979422594358,
</span></span><span class="line"><span class="cl">        3700462282298785820527479428312072678870010244861115107206951164684911761755437333209293039456840068340334559453608012512177623936248784897843503284633804083281388001236742261832974291349480314135560368365574114042082002559069958228523318326290833422846224288247,
</span></span><span class="line"><span class="cl">        20791012146351643571145217310876690226642338279942557085580439219377325884045305279931904540467264182713135410067252835618936836675270813727053937054168296298149405902638242278868020381541490973458957704137657413376043351193
</span></span><span class="line"><span class="cl">    ],
</span></span><span class="line"><span class="cl">    [
</span></span><span class="line"><span class="cl">        3802535350808074374431476757195874789213113083310705049856269457737583463559458126494122484246497049005001474007088865512110432486291568737501434666990689483191924384489484665070592656641925905986397402822195880143437724155134584374613878027218950975919679551229,
</span></span><span class="line"><span class="cl">        1519642544380087919293814751485424198320747098741960781639133554268321708273309194651985562222274023623071346914239982055028526526058064787882720065775210796950963778381575914964024929110539407721461321785325399699126116201001806816030960662346173275101476487421,
</span></span><span class="line"><span class="cl">        8538097185709421082644083672229287227818939415260987123718318427750267353075860559170390896769087600458156859498331152566368881938040799840806164389020986990994328370205184734637870147251004626759120887684269603636183629300
</span></span><span class="line"><span class="cl">    ],
</span></span><span class="line"><span class="cl">    [
</span></span><span class="line"><span class="cl">        17987668490992083132878642797176089621188858356259455169173987325310681186627844776077058221612169421636403546746899152917309634315569997105261046388995579843528014810244648968375990949478033964619008761814039733347955609163,
</span></span><span class="line"><span class="cl">        7188579142941521685422767412932555782658469950638690886255638896617687421517941457682493542615460990114218059246938237257830976937359020731335958068934235967457123039874441635435388736524907036941379695243043923900290273902,
</span></span><span class="line"><span class="cl">        40388963560266769813551191613694768219344365780650048155838802242681775019274045964917142477325170274191702615504062392461666558731638338001971723737440974198823443420018559746335727687
</span></span><span class="line"><span class="cl">    ]
</span></span><span class="line"><span class="cl">])
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 计算行列式
</span></span><span class="line"><span class="cl">det_c = c.det()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">point1=65540596822333029826884315503808996273733737079814345540607878287618419734231
</span></span><span class="line"><span class="cl">point2=45151244176940366132774311848077675849486332018843894072137609985463616792271
</span></span><span class="line"><span class="cl">det_mat = 12416623806712274482740909003669421596552351680515913271674471565471952501600504988055167637820756187403758815447101587045195028050992184593439775164673988145813365041363928168256318440
</span></span><span class="line"><span class="cl">flag=det_mat//(point1-point2)
</span></span><span class="line"><span class="cl">print(long_to_bytes(flag))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="ez_rsa">ez_rsa</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import gmpy2
</span></span><span class="line"><span class="cl">m=bytes_to_long(b&#39;BaseCTF{th1s_is_fake_fl4g}&#39;)
</span></span><span class="line"><span class="cl">e=65537
</span></span><span class="line"><span class="cl">p=getPrime(512)
</span></span><span class="line"><span class="cl">q=getPrime(512)
</span></span><span class="line"><span class="cl">n=p*q
</span></span><span class="line"><span class="cl">not_phi=(p+2)*(q+2)
</span></span><span class="line"><span class="cl">c=pow(m,e,n)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(n)
</span></span><span class="line"><span class="cl">print(not_phi)
</span></span><span class="line"><span class="cl">print(c)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span><span class="line"><span class="cl">96557532552764825748472768984579682122986562613246880628804186193992067825769559200526147636851266716823209928173635593695093547063827866240583007222790344897976690691139671461342896437428086142262969360560293350630096355947291129943172939923835317907954465556018515239228081131167407674558849860647237317421
</span></span><span class="line"><span class="cl">96557532552764825748472768984579682122986562613246880628804186193992067825769559200526147636851266716823209928173635593695093547063827866240583007222790384900615665394180812810697286554008262030049280213663390855887077502992804805794388166197820395507600028816810471093163466639673142482751115353389655533205
</span></span><span class="line"><span class="cl">37077223015399348092851894372646658604740267343644217689655405286963638119001805842457783136228509659145024536105346167019011411567936952592106648947994192469223516127472421779354488529147931251709280386948262922098480060585438392212246591935850115718989480740299246709231437138646467532794139869741318202945
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：解方程
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">n=96557532552764825748472768984579682122986562613246880628804186193992067825769559200526147636851266716823209928173635593695093547063827866240583007222790344897976690691139671461342896437428086142262969360560293350630096355947291129943172939923835317907954465556018515239228081131167407674558849860647237317421
</span></span><span class="line"><span class="cl">j=96557532552764825748472768984579682122986562613246880628804186193992067825769559200526147636851266716823209928173635593695093547063827866240583007222790384900615665394180812810697286554008262030049280213663390855887077502992804805794388166197820395507600028816810471093163466639673142482751115353389655533205
</span></span><span class="line"><span class="cl">c=37077223015399348092851894372646658604740267343644217689655405286963638119001805842457783136228509659145024536105346167019011411567936952592106648947994192469223516127472421779354488529147931251709280386948262922098480060585438392212246591935850115718989480740299246709231437138646467532794139869741318202945
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">from sympy import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">p,q=symbols(&#39;p q&#39;)
</span></span><span class="line"><span class="cl">eq1=Eq(p*q,n)
</span></span><span class="line"><span class="cl">eq2=Eq((p+2)*(q+2),j)
</span></span><span class="line"><span class="cl">sol=solve((eq1,eq2),(p,q))
</span></span><span class="line"><span class="cl">print(sol)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">p=8141718443899971866435611383307659937822484107070436226370768656806495239448624178566680116128893503281864119780033117546021082236554869984932214653357543
</span></span><span class="line"><span class="cl">q=11859601043451548704239065811750630150121409048356115322381859833767027517389301429046456876409906319499766276197893850146733170630849226147814156555750347
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">phi=(p-1)*(q-1)
</span></span><span class="line"><span class="cl">d=inverse(65537,phi)
</span></span><span class="line"><span class="cl">m=pow(c,d,n)
</span></span><span class="line"><span class="cl">print(long_to_bytes(m))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="hellocrypto">helloCrypto</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">from Crypto.Cipher import AES
</span></span><span class="line"><span class="cl">from Crypto.Util.Padding import pad
</span></span><span class="line"><span class="cl">import random
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag=b&#39;BaseCTF{}&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">key=random.randbytes(16)
</span></span><span class="line"><span class="cl">print(bytes_to_long(key))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">my_aes=AES.new(key=key,mode=AES.MODE_ECB)
</span></span><span class="line"><span class="cl">print(my_aes.encrypt(pad(flag,AES.block_size)))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># key1 = 208797759953288399620324890930572736628
</span></span><span class="line"><span class="cl"># c = b&#39;U\xcd\xf3\xb1 r\xa1\x8e\x88\x92Sf\x8a`Sk],\xa3(i\xcd\x11\xd0D\x1edd\x16[&amp;\x92@^\xfc\xa9(\xee\xfd\xfb\x07\x7f:\x9b\x88\xfe{\xae&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：简单的AES解密
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import long_to_bytes
</span></span><span class="line"><span class="cl">from Crypto.Cipher import AES
</span></span><span class="line"><span class="cl">from Crypto.Util.Padding import unpad
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">key1 = 208797759953288399620324890930572736628
</span></span><span class="line"><span class="cl">ciphertext = b&#39;U\xcd\xf3\xb1 r\xa1\x8e\x88\x92Sf\x8a`Sk],\xa3(i\xcd\x11\xd0D\x1edd\x16[&amp;\x92@^\xfc\xa9(\xee\xfd\xfb\x07\x7f:\x9b\x88\xfe{\xae&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">key = long_to_bytes(key1)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">my_aes = AES.new(key=key, mode=AES.MODE_ECB)
</span></span><span class="line"><span class="cl">plaintext = unpad(my_aes.decrypt(ciphertext), AES.block_size)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(plaintext)
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h2 id="week2の题目">week2の题目</h2>
<h3 id="铜匠">铜匠</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import getPrime, bytes_to_long
</span></span><span class="line"><span class="cl">#from secret import flag
</span></span><span class="line"><span class="cl">flag=b&#39;XXXX&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">p = getPrime(1024)
</span></span><span class="line"><span class="cl">q = getPrime(1024)
</span></span><span class="line"><span class="cl">n = p * q
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">hint1 = p &gt;&gt; 721
</span></span><span class="line"><span class="cl">hint2 = q % (2 ** 266)
</span></span><span class="line"><span class="cl">ct = pow(bytes_to_long(flag), e, n)
</span></span><span class="line"><span class="cl">print(hint1)
</span></span><span class="line"><span class="cl">print(hint2)
</span></span><span class="line"><span class="cl">print(n)
</span></span><span class="line"><span class="cl">print(ct)
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span><span class="line"><span class="cl">hint1 = 14439249591349619691972392177790365247490839237199085979433418493254022567815148979672690178
</span></span><span class="line"><span class="cl">hint2 = 90063199151369157959005663017593053931871580139169245885113098598755909124764417
</span></span><span class="line"><span class="cl">n = 18347545778876678838092757800261556931131930866012101566000425608407193858675622059415995283684230959320874387944052648148677918542763633503231962873204645415818139345588988936580526094727943067102768943117592654029397879665312089518191052154267343886226820785206334238961064175118262578895847281575656290248049404047727756356910896332939145136942219317065063060070725033146788186604738271846183709127655298440696824683099637827282095133642324657860714680107691622056420045091586609974536644773286992447027164350612852922016376888380895187804771279035652496676089183636450028327097084911908336202253562671798012457461
</span></span><span class="line"><span class="cl">ct = 15659576879410368237140555530527974801613150473447768911067611094143466009251385693099110691602954207905029692682380253595062935017486879899242785756448973466690818942065250284891341066578689696180061755610538867770441139827574063212967027249650509215685566103350688284041405586915563454117672061141919712416360596137520514412607512596079964611672166435592936417138352662031529414118312166411150736015788925026636845744110093161894267707446937939130745326244186579516665160036229715964182962542836836457885170975474737620430886449029488829662146456489724775166105816909257516908496172172266375617868819982791477888289
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>分析：很经典的一种copper，入门不难，原题应该是一个复原后差了五六位的题，还需要爆破，懒得写脚本，就用那个题的了
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import long_to_bytes, inverse
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 给出的线索和密文
</span></span><span class="line"><span class="cl">h1 = 14439249591349619691972392177790365247490839237199085979433418493254022567815148979672690178
</span></span><span class="line"><span class="cl">h2 = 90063199151369157959005663017593053931871580139169245885113098598755909124764417
</span></span><span class="line"><span class="cl">n = 18347545778876678838092757800261556931131930866012101566000425608407193858675622059415995283684230959320874387944052648148677918542763633503231962873204645415818139345588988936580526094727943067102768943117592654029397879665312089518191052154267343886226820785206334238961064175118262578895847281575656290248049404047727756356910896332939145136942219317065063060070725033146788186604738271846183709127655298440696824683099637827282095133642324657860714680107691622056420045091586609974536644773286992447027164350612852922016376888380895187804771279035652496676089183636450028327097084911908336202253562671798012457461
</span></span><span class="line"><span class="cl">c = 15659576879410368237140555530527974801613150473447768911067611094143466009251385693099110691602954207905029692682380253595062935017486879899242785756448973466690818942065250284891341066578689696180061755610538867770441139827574063212967027249650509215685566103350688284041405586915563454117672061141919712416360596137520514412607512596079964611672166435592936417138352662031529414118312166411150736015788925026636845744110093161894267707446937939130745326244186579516665160036229715964182962542836836457885170975474737620430886449029488829662146456489724775166105816909257516908496172172266375617868819982791477888289
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">mod=1&lt;&lt;266
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;sage
</span></span><span class="line"><span class="cl">mod = 1&lt;&lt;266
</span></span><span class="line"><span class="cl">pl = n*inverse_mod(h2, mod) % mod
</span></span><span class="line"><span class="cl">pbar = (h1 &lt;&lt; 721) + pl
</span></span><span class="line"><span class="cl">print(pbar)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mod=1&lt;&lt;266
</span></span><span class="line"><span class="cl">pbar=159283759372043950279417056412033091802265743745598264436861098130148724970544195213191649166147459982084533577625625008771745438626676361992622620990322639458220384654337631035952464187940654223018174399784470272274817163374085649033913063346035230347024202079916218850411102021956717312895699841307436573429
</span></span><span class="line"><span class="cl">PR.&lt;x&gt; = PolynomialRing(Zmod(n))
</span></span><span class="line"><span class="cl">for i in range(64):
</span></span><span class="line"><span class="cl">    f=pbar+(x*mod*64)+(i&lt;&lt;266)
</span></span><span class="line"><span class="cl">    f=f.monic()
</span></span><span class="line"><span class="cl">    pp=f.small_roots(X=2^454, beta=0.4)
</span></span><span class="line"><span class="cl">    if pp:
</span></span><span class="line"><span class="cl">        print(pp[0])
</span></span><span class="line"><span class="cl">        break 
</span></span><span class="line"><span class="cl">        &#39;&#39;&#39;
</span></span><span class="line"><span class="cl">pbar=159283759372043950279417056412033091802265743745598264436861098130148724970544195213191649166147459982084533577625625008771745438626676361992622620990322639458220384654337631035952464187940654223018174399784470272274817163374085649033913063346035230347024202079916218850411102021956717312895699841307436573429
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pp=1317672026563593300129371951763859479585160722329901241239307279046431808747274589154524298333672617428259572485443245960732849991509463
</span></span><span class="line"><span class="cl">p=pbar+pp*mod*64
</span></span><span class="line"><span class="cl">q=n//p
</span></span><span class="line"><span class="cl">phi=(p-1)*(q-1)
</span></span><span class="line"><span class="cl">d=inverse(e,phi)
</span></span><span class="line"><span class="cl">m=pow(c,d,n)
</span></span><span class="line"><span class="cl">print(long_to_bytes(m))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="basic">basic</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import socketserver
</span></span><span class="line"><span class="cl">import os
</span></span><span class="line"><span class="cl">import random
</span></span><span class="line"><span class="cl">import base64
</span></span><span class="line"><span class="cl">import string
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag = os.getenv(&#39;GZCTF_FLAG&#39;).encode()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">class Task(socketserver.BaseRequestHandler):
</span></span><span class="line"><span class="cl">    def _recvall(self):
</span></span><span class="line"><span class="cl">        BUFF_SIZE = 2048
</span></span><span class="line"><span class="cl">        data = b&#39;&#39;
</span></span><span class="line"><span class="cl">        while True:
</span></span><span class="line"><span class="cl">            part = self.request.recv(BUFF_SIZE)
</span></span><span class="line"><span class="cl">            data += part
</span></span><span class="line"><span class="cl">            if len(part) &lt; BUFF_SIZE:
</span></span><span class="line"><span class="cl">                break
</span></span><span class="line"><span class="cl">        return data.strip()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    def send(self, msg, newline=True):
</span></span><span class="line"><span class="cl">        try:
</span></span><span class="line"><span class="cl">            if newline:
</span></span><span class="line"><span class="cl">                msg += b&#39;\n&#39;
</span></span><span class="line"><span class="cl">            self.request.sendall(msg)
</span></span><span class="line"><span class="cl">        except:
</span></span><span class="line"><span class="cl">            pass
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    def recv(self):
</span></span><span class="line"><span class="cl">        return self._recvall()
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    def handle(self):
</span></span><span class="line"><span class="cl">        printable_chars = string.ascii_letters + string.digits + string.punctuation
</span></span><span class="line"><span class="cl">        optional=[b&#39;A&#39;,b&#39;B&#39;,b&#39;C&#39;,b&#39;D&#39;]
</span></span><span class="line"><span class="cl">        for _ in range(100):
</span></span><span class="line"><span class="cl">            secret= &#39;&#39;.join(random.choices(printable_chars, k=16)).encode()
</span></span><span class="line"><span class="cl">            select=random.choice(optional)
</span></span><span class="line"><span class="cl">            self.send(select)
</span></span><span class="line"><span class="cl">            enc=b&#39;&#39;
</span></span><span class="line"><span class="cl">            if select==b&#39;A&#39;:
</span></span><span class="line"><span class="cl">                enc=base64.b64encode(secret)
</span></span><span class="line"><span class="cl">            elif select==b&#39;B&#39;:
</span></span><span class="line"><span class="cl">                enc=secret.hex().encode()
</span></span><span class="line"><span class="cl">            elif select==b&#39;C&#39;:
</span></span><span class="line"><span class="cl">                enc=bytes_to_long(secret)
</span></span><span class="line"><span class="cl">                enc=str(enc).encode()
</span></span><span class="line"><span class="cl">            elif select==b&#39;D&#39;:
</span></span><span class="line"><span class="cl">                enc=[i for i in secret]
</span></span><span class="line"><span class="cl">                enc=str(enc).encode()
</span></span><span class="line"><span class="cl">            self.send(enc)
</span></span><span class="line"><span class="cl">            client_send=self.recv()
</span></span><span class="line"><span class="cl">            if client_send!=secret:
</span></span><span class="line"><span class="cl">                self.send(&#34;\nYou wrong!!!!!&#34;)
</span></span><span class="line"><span class="cl">                exit()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        self.send(flag)
</span></span><span class="line"><span class="cl">        self.send(b&#34;\nConnection has been closed  =.=  &#34;)
</span></span><span class="line"><span class="cl">        self.request.close()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">class ThreadedServer(socketserver.ThreadingMixIn, socketserver.TCPServer):
</span></span><span class="line"><span class="cl">    pass
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">class ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer):
</span></span><span class="line"><span class="cl">    pass
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if __name__ == &#34;__main__&#34;:
</span></span><span class="line"><span class="cl">    HOST, PORT = &#39;0.0.0.0&#39;, 9999
</span></span><span class="line"><span class="cl">    server = ForkedServer((HOST, PORT), Task)
</span></span><span class="line"><span class="cl">    server.allow_reuse_address = True
</span></span><span class="line"><span class="cl">    server.serve_forever()
</span></span></code></pre></td></tr></table>
</div>
</div><p>分析：一个要用pwn去交互的题，给了四种加密方式，他给什么，你返回什么的解密答案，然后一百次就行了，直接写脚本，如果没有win环境没有安装pwn的话pip install pwntools
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from pwn import *
</span></span><span class="line"><span class="cl">import base64
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 连接到服务端
</span></span><span class="line"><span class="cl">p = remote(&#39;challenge.basectf.fun&#39;,42917)
</span></span><span class="line"><span class="cl">def decode(secret, select):
</span></span><span class="line"><span class="cl">    if select == b&#39;A&#39;:
</span></span><span class="line"><span class="cl">        return base64.b64decode(secret)
</span></span><span class="line"><span class="cl">    elif select == b&#39;B&#39;:
</span></span><span class="line"><span class="cl">        return bytes.fromhex(secret.decode())
</span></span><span class="line"><span class="cl">    elif select == b&#39;C&#39;:
</span></span><span class="line"><span class="cl">        return long_to_bytes(int(secret.decode()))
</span></span><span class="line"><span class="cl">    else:
</span></span><span class="line"><span class="cl">        return bytes(map(int, secret.decode()[1:-1].split(&#39;, &#39;)))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">try:
</span></span><span class="line"><span class="cl">    for _ in range(100):
</span></span><span class="line"><span class="cl">        # 接收编码方式
</span></span><span class="line"><span class="cl">        encoding_method = p.recv().strip()
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        # 接收编码后的“秘密”
</span></span><span class="line"><span class="cl">        encoded_secret = p.recv().strip()
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        # 解码“秘密”
</span></span><span class="line"><span class="cl">        secret = decode(encoded_secret, encoding_method)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        # 发送解码后的“秘密”以验证
</span></span><span class="line"><span class="cl">        p.sendline(secret)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # 成功时，接收并打印 flag
</span></span><span class="line"><span class="cl">    flag = p.recv().strip()
</span></span><span class="line"><span class="cl">    print(f&#34;Flag: {flag}&#34;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">finally:
</span></span><span class="line"><span class="cl">    p.close()
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="mid_math2">mid_math2</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import numpy as np
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">a, b, c = [getPrime(128) for _ in range(3)]
</span></span><span class="line"><span class="cl">d, e, f, h, i, j = [getPrime(1024) for _ in range(6)]
</span></span><span class="line"><span class="cl">A = [[a, b, c], [d, e, f], [h, i, j]]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag = b&#34;flag{test_flag}&#34;
</span></span><span class="line"><span class="cl">flag = bytes_to_long(flag)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def prod(myList):
</span></span><span class="line"><span class="cl">    result = 1
</span></span><span class="line"><span class="cl">    for i in myList:
</span></span><span class="line"><span class="cl">        result = result * i
</span></span><span class="line"><span class="cl">    return result
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def randomArray():
</span></span><span class="line"><span class="cl">    upper = [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
</span></span><span class="line"><span class="cl">    low = [[1, 0, 0], [0, 1, 0], [0, 0, 1]]
</span></span><span class="line"><span class="cl">    for i in range(3):
</span></span><span class="line"><span class="cl">        for j in range(i+1, 3):
</span></span><span class="line"><span class="cl">            upper[i][j] = getPrime(128)
</span></span><span class="line"><span class="cl">            low[j][i] = getPrime(128)
</span></span><span class="line"><span class="cl">    result = np.array(upper) @ np.array(low)
</span></span><span class="line"><span class="cl">    return result
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">e = getPrime(18)
</span></span><span class="line"><span class="cl">N = getPrime(1024)
</span></span><span class="line"><span class="cl">C = randomArray()
</span></span><span class="line"><span class="cl">#MAT = C @ A @ B
</span></span><span class="line"><span class="cl">MAT = C @ A
</span></span><span class="line"><span class="cl">c = pow(flag, e, prod(A[0]))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(MAT)
</span></span><span class="line"><span class="cl">print(f&#39;c = {c}&#39;)
</span></span><span class="line"><span class="cl">print(f&#39;e = {e}&#39;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span><span class="line"><span class="cl">[[9194428734244577957135736828947112370812209206819996917633266069359894211949655026549592464237531352518967649750275097282532736237822915630766535634248987628113137246739472264614337707439494149796414126558156060870508338278038269649101921703583149322486905552569052814106532234864028314925118581658029792157851338427975728108000711353532410024128431635933014226306706319591106081211872
</span></span><span class="line"><span class="cl">  7052600738698435126221697697810087514520765619736355003187836563546493264420232197860875416948961661231812045406188307561458872254314061097960625042149316957446344556490001927621879295417925720004568332344856366002394724202261454916368122811414228043610804718983599804179657247820737462743875143882925818085495573474169110616761320858675303922740882169073395416895304752909979711051264
</span></span><span class="line"><span class="cl">  13094262565727554986668133240216117564284263232131011542877585146452802164148464500319291219458081531317231044962383872061004846788004747813785963603455919882739054992075130196548494850105124430477756818974520035883861936342117869122455996838023977818945511119955390136020375974150407580576040034808588694313922810340598787633148909527275716235390356737099830131958338026891256778602432]
</span></span><span class="line"><span class="cl"> [7291452286171544741377496447735677778433522048452394999757158120018504601116506253897733192493798837108269469756414516913436198353934250444263790689101779479157541198872731006007031448329354826004420971505929629537584453480285628607579031078497417101681028600589030661495031531644755072500393418929237208836713910921969937998825721580514845395852889662758886414966066733340052235985735
</span></span><span class="line"><span class="cl">  5592919719754926663830816961667268104316637431189640788304536404157195458040686322901848820171568258023938724485177544141303597034389473064509506247034833050568643394732003598890104462382321956436508366359718039669456303596542945687737870352569084995858128262046585579724537002100295978230177579835256681774512205534970583421138287684468047290246482431883957170924203400422234299829407
</span></span><span class="line"><span class="cl">  10384135162743100269852365857770153822630076412853981379757028821332622753962517667857057209221058533163475030678127399042436975886694593504673386134198042731671320468065688239424934644173240507619471360908786669070898288638067852779718549009532013299792474712979659423962779677856135791013599792822988457540442172903145046394648862567656330868441373023488569784114231877910285319620037]
</span></span><span class="line"><span class="cl"> [34946383530632295853235791100380055176686898072752599942691162027311662041417740482507624946631032260410440329949488242706004902881977357811370156793240362927747354453547446315050117795844866771053429455608334265986953931753411938119703800489233043034369650346216548318254326462336573090313788936967898128977445514764945671848611612198443909056919
</span></span><span class="line"><span class="cl">  26805677375585831510259621878357023272222175103906204143689109861471123435549853025410319713500257027420994041712736040084303902812241806295302385126726161281240831030434347236854521776375408982352155894199700974681768432734155312616453345950508256035721377179651166114898547487082749355033867559583905997404388549346221139007108462958001461826337
</span></span><span class="line"><span class="cl">  49768956277664050500387501949373949828589012443212214016088015478826178759698946452495063308332332373728223252613132611904477061717762261927498754849913008747980442098787524359755695519989286304445175440218168145037681791003471134417445542856715034633656861298596197935068562189476201463465706711744838395255326376049859058504891392128431832044455]]
</span></span><span class="line"><span class="cl">c = 11781599055433308033432930805524658061560499523533841161297213162869735414528038973998414585008473948613388691447093
</span></span><span class="line"><span class="cl">e = 160907
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>分析：和第一周的mid_math不同，这个更像是格而不是线代了，可以用LLL求解，但是也可以发现里面的数据bits并不大，那么我们可以直接忽略一些数据进行计算，从而得到flag，有点非预期
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">MAT=[[9194428734244577957135736828947112370812209206819996917633266069359894211949655026549592464237531352518967649750275097282532736237822915630766535634248987628113137246739472264614337707439494149796414126558156060870508338278038269649101921703583149322486905552569052814106532234864028314925118581658029792157851338427975728108000711353532410024128431635933014226306706319591106081211872,
</span></span><span class="line"><span class="cl">  7052600738698435126221697697810087514520765619736355003187836563546493264420232197860875416948961661231812045406188307561458872254314061097960625042149316957446344556490001927621879295417925720004568332344856366002394724202261454916368122811414228043610804718983599804179657247820737462743875143882925818085495573474169110616761320858675303922740882169073395416895304752909979711051264,
</span></span><span class="line"><span class="cl">  13094262565727554986668133240216117564284263232131011542877585146452802164148464500319291219458081531317231044962383872061004846788004747813785963603455919882739054992075130196548494850105124430477756818974520035883861936342117869122455996838023977818945511119955390136020375974150407580576040034808588694313922810340598787633148909527275716235390356737099830131958338026891256778602432],
</span></span><span class="line"><span class="cl"> [7291452286171544741377496447735677778433522048452394999757158120018504601116506253897733192493798837108269469756414516913436198353934250444263790689101779479157541198872731006007031448329354826004420971505929629537584453480285628607579031078497417101681028600589030661495031531644755072500393418929237208836713910921969937998825721580514845395852889662758886414966066733340052235985735,
</span></span><span class="line"><span class="cl">  5592919719754926663830816961667268104316637431189640788304536404157195458040686322901848820171568258023938724485177544141303597034389473064509506247034833050568643394732003598890104462382321956436508366359718039669456303596542945687737870352569084995858128262046585579724537002100295978230177579835256681774512205534970583421138287684468047290246482431883957170924203400422234299829407,
</span></span><span class="line"><span class="cl">  10384135162743100269852365857770153822630076412853981379757028821332622753962517667857057209221058533163475030678127399042436975886694593504673386134198042731671320468065688239424934644173240507619471360908786669070898288638067852779718549009532013299792474712979659423962779677856135791013599792822988457540442172903145046394648862567656330868441373023488569784114231877910285319620037],
</span></span><span class="line"><span class="cl"> [34946383530632295853235791100380055176686898072752599942691162027311662041417740482507624946631032260410440329949488242706004902881977357811370156793240362927747354453547446315050117795844866771053429455608334265986953931753411938119703800489233043034369650346216548318254326462336573090313788936967898128977445514764945671848611612198443909056919,
</span></span><span class="line"><span class="cl">  26805677375585831510259621878357023272222175103906204143689109861471123435549853025410319713500257027420994041712736040084303902812241806295302385126726161281240831030434347236854521776375408982352155894199700974681768432734155312616453345950508256035721377179651166114898547487082749355033867559583905997404388549346221139007108462958001461826337,
</span></span><span class="line"><span class="cl">  49768956277664050500387501949373949828589012443212214016088015478826178759698946452495063308332332373728223252613132611904477061717762261927498754849913008747980442098787524359755695519989286304445175440218168145037681791003471134417445542856715034633656861298596197935068562189476201463465706711744838395255326376049859058504891392128431832044455]]
</span></span><span class="line"><span class="cl">enc = 11781599055433308033432930805524658061560499523533841161297213162869735414528038973998414585008473948613388691447093
</span></span><span class="line"><span class="cl">e = 160907
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">u13=MAT[0][2]//MAT[2][2]
</span></span><span class="line"><span class="cl">u23=MAT[1][2]//MAT[2][2]
</span></span><span class="line"><span class="cl">u12=((MAT[0][0]*u23-MAT[1][0]*u13)//(MAT[1][0]-MAT[2][0]*u23)+u13)//u23
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">MAT=matrix(MAT)
</span></span><span class="line"><span class="cl">MAT=matrix(ZZ,[[1,u12,u13],[0,1,u23],[0,0,1]]).inverse()*MAT
</span></span><span class="line"><span class="cl">a,b,c=list(MAT[0])
</span></span><span class="line"><span class="cl">print(a,b,c)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(long_to_bytes(power_mod(enc, inverse_mod(e, (a-1)*(b-1)*(c-1)),a*b*c)))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="random_primes">random_primes</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import random
</span></span><span class="line"><span class="cl">def gen_n():
</span></span><span class="line"><span class="cl">    primes=[getPrime(128) for _ in range(256)]
</span></span><span class="line"><span class="cl">    n = 1
</span></span><span class="line"><span class="cl">    for i in range(100):
</span></span><span class="line"><span class="cl">        n *= primes[random.randint(0,127)]
</span></span><span class="line"><span class="cl">    return primes,n
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag=b&#39;BaseCTF{}&#39;
</span></span><span class="line"><span class="cl">m=bytes_to_long(flag)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">assert len(flag)==45
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">primes,n = gen_n()
</span></span><span class="line"><span class="cl">e = 0x010001
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c=pow(m,e,n)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(&#34;n =&#34;,n)
</span></span><span class="line"><span class="cl">print(&#34;e =&#34;,e)
</span></span><span class="line"><span class="cl">print(&#34;c =&#34;,c)
</span></span><span class="line"><span class="cl">print(&#34;primes =&#34;,primes)
</span></span></code></pre></td></tr></table>
</div>
</div><p>分析：没啥好说的，直接写就行了，127个随机数中随机抽了100轮，直接用n去%这些随机数，然后算新的n和phi
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">n = 78300669134090137852678272985826748552135227276632141248987049792032006306302216838913764274866303353208450204056303587307590215658369546155011362928706987241738494219541640893624036978156512506828463680671263486243620357332029975262649036988429673099480612452108805474703908926666372276084227948945557265663478215385708377783788570365632616043692339165126905185780780266966306548390661933964569191558132570743049563034138454687784280737515786647554373002062073506433019576711216881997114922882459590300118573321037403610889041169358378723253785685185468195113769538654602557963324567374538144099228383454092513581001676844948371535253876783418313588527754932166605066901072445123419390582818421290114496685300926300428214457517990285819930164112928731952543551128353453115448896272534889430898972420106066951673716649898254901175990616932072274131352817500432771246120044877003878221635833566879303044541045834038388997926347179939044765998585225912825579716411592564742018931576637831147018364052669287568321730785094397048548966924521616592554123755297954204221563101170233500051950508111908253332306439556638016218903032470713009804240601585082087048162066169084662644707376647151608352036058459491394516846894878416951958668053255135013274125427380981145860643060541753558111657169642936860264070256441807766713460296249602643758686033797758071121020245797758472562524923801634553187959279204425077723939301840341779998492203869115635533331664608105795918593153796830400602836307602218542060655621724654663459491663959746624660378618696497713505280314029154654750144247111545203758654611758984447921004347657793617842564871769622784844341157861486787088384957424536581508067582989224734241742351249915951485225249670040001204171856547596397427658888879993013652971335861824416084725435327931256774534973698438003593122194474117269397752225948596514379988893089239094703410940035417268946100231522267605729519374566776171026410423486906556493370843386314649478106704968479881781695360132024826936593194324539644886241562342997299649076507105518992946223028855705189458007533521138703343150937158114114218932400728424949936286443583797118636171187082834662757985896337364138817400612718422265665198024836586611857266616428913152399750688461692677751727389476785588380514444593900569311496880422405988762554852121131345538798688587092154717384294801026132314002251890156123191210398076704434510182202143578810771596233936298462366674592585338029819643973999567268938697218329734244529139548760101393715777276776940762681748317493543343685273831243829694914274003574509516149595004243952747746644961308054952235256037171151695870643020625268635139422461824974663101258586488528601193378268634713686606488503649923013225514905688326248009253372769118830036659383418890729585564557376820890036155588551064419189532686009173215470250197488274429655669070803391973941917017493224972246331391152287082983301776505925295294164201606063028946348118492358755684668733095242911870636074134633575423928967453742150728552560370847186174905012586984090885433727025000206871702482359563400504600567763564582739694873656581728461491373440639163666040518508819641244084238867282549191870081112768586762540287977817548140346798817430775010275964061529114139424317686620296832033309265702409802876815255731607798400127673166880859281784259402995434972992131101158600882460475931695668710417351337637612478180964570698492610372677176847071937542439765750578751925220375723373827393178629810215549480885217514819316424426943459039642952096990941480059597449017550988311939357225101582029418355438775525606571176735588489070335070244453533520858832311313682516805060002632168734723995449881138047136306876918900826798316113276424022400544205104057777588615149030045126315192448561606146254432070045197349283823967140032987449249831755565764939530383006495743
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">c = 1093256121418811691349633884423021356633978134292966489553874542781791238358295335426668415023166027954996625051420577493667824501649432869528057686451750288316816910397382629774298441937547233956753065529097877191699918039115202957337087658469098304374696277563020457331278140075969310150315715843020746656167994646063024677105714238622574336597601173953997036582942407796229805377339006787815702404915271846770376106312644390819144016155830513829761647568620243654068928415623802444953011361211378013499713469372806125474734994287518083907329841838337717556241874324440340626885553763322954232400855565339807071892321582386180978536483407197865884342435897670134641970372091590178581326892854820705050227840462139458418313478056939546089488178689697927788133612008061739961796780717135680690059059843521460548943400440075072549263642778142322553681107266326899389399400224420049958868630481920741293895509509786744023698063926664818702849276103941412666213912301512015982875337927624885673329513416992222855651023180889148449319496283772492522626881480405730489310544315066415406419791190663101607618436762339809465699249346219280236246798494923574248758432354732450859901402315454165220861852940020724189284384978436094976303046718818115920223875761763369205054892082583399430768426962644539683767683622215674622364530161306440520074932775203726898254313918302918158338893115967835907921400822151110065285755016823481526036112086877396184474779772672777884312990976267562132296839364269838737667955289273381304280292531609850947774380025541448760290985029328831136155532030110660328741793152955524993218772392841301083853407843632521944959421101063922926408630857942155173553265649994782728054809833578075255522763473867570242922191690258610960429527917825954799350243215320860648845823888406079144360733120892758516436394283721941074591992068709056978434144249946370176209580261992712491146585486352865467853012283982569783829897373148685163663183813646084064010686825626422454984021416402862127889251773565118407053577546260937996800783904867497317512257427384881412920876851185681901360445996414854617735746124849305097724462381788049919520369827437945533718238301976608693210822883549849346914749712641177399278642094159972818771839223940037362062271618565492364129165948546330822175641999869293182574801410909568799887485687799830413460992606782188190161078789803079204468693865791568886757702397226751678303106993202727687413409748299454409517072068313199302592993167348776456703605936302216362148170559954097296263965296226759555059786981274338884349876203756741105449671416827010661253266421028866463837188482523849379185098341631154586750782372250753953789082447013115491415875557484766163997419331193733180948335725001700381759888109481542481560084404144004112246764995544553798311119720361550478239142333177065617369951724788288789091898104014990085985609531302672876148454755584802296948087896190960286862545509803680907635139069769773489974690789281850253441901658186053827023495071972754442328786102677924620742574365171969462047797683507872502560411636054630326651806741191565960549277521714122075001246821117983391397806797612028499867676071294152880791421912694378781390703123405056446531600817818157671340725736220061182015810279092548335683818151707498767164622121926625237321182816937233802267205025138008023815746402851176062360192537976175702542328058732539514446727425707394730057315691659046002877368113680075447504177622678838170749340265685373340874438362777036176293805138792214226140580946132386530852126980325547324038761178186444019589823730620635017784138099601753640268173837644549341739416563571709247391327046697023194351531203111048984847048754457714313305254115325718812624677601983165234723923006394872649966184045387413721873049174098054565879297120256469204258468893249797880459716409176351490537
</span></span><span class="line"><span class="cl">primes = [255675877315683439181791416047922719357, 180461111025833129025002455435975940971, 337490274732450824975483083220272824199, 304456281514261901091507788207898547903, 254797576342247974393400562686432925229, 183131976400038388097951032415099792851, 187104898097787470482482874168168046723, 300625339408843701719323023799725058313, 293895810597575199851257228961757849961, 197370673648293754589174456296168807801, 214231100175566513755789399545798257027, 299940533764670809123600295354236009687, 329911008919678926860313614132444450849, 292789028093982326052555296040896616647, 267992025172569093811940290026790452689, 192120589915828510906490323831586947847, 208470412662206941915861109996165224771, 195723355777376859063723356742829282943, 195479450259644250739997899829659598467, 225273608271867864202603965232709350643, 297983612753980801299047698668400172129, 289863711883286870918208567358762217117, 320181619705477005993614485764800027801, 274756647552045078797369358162815740121, 208678800821922117897086572764543689257, 274510151199776127157320013074195989531, 270061041585244138305865647463819178071, 231693016600939448457585159254864460211, 221276763231716810367704255896280432977, 284588387935614601031451184436365997027, 190107678698149330362585520776807817237, 244360771516251060479861295353775315223, 184597108435320085388683362929647254859, 214993743235105601056961433866767506839, 319622401044815459679561340300419077137, 312048738778225034570138647462191322423, 192343262692325176379644178905323471293, 217411522139037534713431287902356703153, 203269104665429435826852242437943175799, 197694542080431775212389192687346023837, 170754527923440727794804968936874697237, 199565850096248778954713726823038799169, 329479041983980219266962570620791190271, 336543942677902368237166971184411120319, 296349049540412710059375861980880864529, 276958785496368109105253052397588113011, 236061938563845834433725013690718000077, 175132351377019405283465079997063887583, 210382170435243156571657554946080029177, 179295658173078371976938970235081809653, 221499702407155816778095037176350210511, 273750615951477382944958796366722325273, 215400010676152024850087488645214675509, 242104770580865606729511928881839588399, 237832832377832763447973839385045714547, 240569613888482344825828531593242970283, 188780850815328211058185207879562258749, 236351101956411494065697625496351792553, 234848091988225252588700833488573195973, 216111241348931999833159262144497816823, 248635261568172677022024655836676274851, 175169438550312686771927355949990675153, 222945249317916941175129207081724296809, 272123250140823727659430614318422459467, 321040760103571995807993446246308239643, 244443756627073674223172405572152750757, 231281757931881868821441147678670578293, 212608548905981265953338769409211557953, 262334849743113291736207517444943890093, 221968375825210657749121344978372971509, 284590253068157230941830678792449649633, 300977729071492709020945132474829506297, 305429273614180801706392853095181679257, 335939257455017842008237083398243135951, 294393337682220551877311202846160164539, 300751607582285572452649226924384213987, 177342562402002655670186066181715938647, 314293624358674993004107306426510931177, 192176341797009660053769692734114433539, 219685065300219568101641511794459670373, 311600604660297404708381142674858758433, 189258688382892886748712093669349354607, 265765352209342630144326504781080544103, 233694355945946803066419059858430846563, 223443907562486442160842066195579310831, 182987294835928563972108625144731142337, 214137187246441738588307243392955884313, 251175687278238637206326829923211055529, 280606397834257483599650477170805542213, 233315167891969517243554909836441514543, 189298893622248669462727814260415085983, 248568957395290350328195179867090245057, 292645643756069284722532228739967572339, 179447399460747583275629697319304390429, 179645924152591342445122478862459911921, 332356391092472452305991116186146584177, 245901581082639772431455170863897420347, 205817781083003905754490509387056092343, 240380627852067724273161876175750141361, 268700167965406311300179029348879484383, 213345040113356686319409599805587957227, 251674200978198716465773971152251242983, 179180641720352444750737502831482762429, 306320532661676131438858609804319013343, 256526510096408769263055362633154848279, 205959060854084755092268947433148347151, 291927192797043538420569211955680836527, 204978877621419749982721876460562600659, 332399656527167823296930534887330184167, 280595736375324905544725725979456898547, 300213915091486506011056425480272542643, 318558817334795356700066397524785435681, 319436460864579377450478049744976231249, 243133148342749788432705330633449318989, 322207542584548294558453923911981520623, 320850760899167598764295789802781069077, 319881693868123342340868542828982909581, 206495732343577870213482544631201066371, 242791194590408310278390962600348350913, 251698935174714138851501858575403291023, 336741296937713120832285756167770151171, 315930741679982320652758472398428972349, 308738538640639393614807292598596283683, 242935142876894679332147837418000898919, 320412254452324446540182603262368766623, 244141238875170898148081089385979949403, 213402860730186872545578995830820087021, 257839149567099022202819187898373109541, 205790643921760418513647126480621419031, 198756405484996593521220520853141427989, 294805620517257214889752595599972901633, 255265348017204260362764409566933677153, 274956788729771493245467759809121243433, 207307664273912902821847768063880326327, 228782470653856387114481087524374601589, 327491405235009262853431015300186498577, 173419211471119738399569200317219003511, 266492438299975532333886393820275910943, 276688137488059756944807773426416608851, 189140053313243747387509835884240226891, 184847492345401269770088588442458737119, 333210953053056282315216794932763359439, 214889588455292527477541347807824233317, 215229626238372443203352172982941095611, 321221012891336284787614820604143303369, 199400757934809114495211412464158118397, 178651685535715756785532928453093603903, 220776757717693008935011794749825325367, 303675938617156800143972318322678387193, 327088681522055240658148530499087069577, 335783766579434559780651762543581106409, 259404300424171457987268194257725139933, 179840475811181163398944717514437142491, 297175485665739288479300848974745531391, 237485053681467543059304786336620370377, 297758270183402970750961370350920892967, 287801215974478613717591686806352676563, 310730027586487200761300572073383664977, 276935537099897424875065059267639595933, 251308797428280999427269663339682237319, 217181290779624781624389434069663308189, 278483889173395237559970658394075421689, 204589549925569581630736863023597052269, 226032820526239722979885626335569166693, 307616487066170583892695494367464641267, 222259520009563764167811735543215104543, 264617923645991453974534495741056598021, 300871024629133281254211035867737539223, 170303240421348821459663263562155031807, 194456703515031789312329705897177851253, 327369717787718586651743316493134914089, 313093229847313153837631186419773330871, 224824444829441039679277741769033772991, 224589292446640473576473771583959436463, 214868884335325091682110394113205785173, 281852933308534953139887124628766315043, 225661596373287038911910532148417025369, 197435393688129783450788260536037003399, 266167151841181488476394288675916455947, 179215005575751890101294918245131012843, 181845510055827963079718687867786713537, 257637102334933109362889675555405989789, 211635849392838491382106919488103885767, 186185061420106956824801515596528043351, 285418977308105637920637161558618377271, 333320927697115374794556799401253359593, 188501857269628483380021948001960729951, 333805438111531260206119448902819218463, 207203219305023873959844954660799240249, 243125622633677038874854389025310242579, 216464412848635515952075334791481048513, 215209416857176076836597526059188595229, 214612926530046226231879587951703041239, 211839237456343309131155436452991652823, 243378322702585683775212046627894119463, 300569560524099180847101362636309727649, 277442530432004673254582623587364635427, 264039335285085705456044566498360689059, 336941745040225044220256680095943361963, 294351957900120820634469984437616730183, 193397784957516885417425615607279607259, 172625665034500456784052580259369183617, 171214762299612221823796960282578324943, 194792374409055048312123241531481499583, 214020514849615741103085838425694524869, 217152285242353248407824271751534124093, 310504460995069986330272047239018516719, 257283037178296965441561511618312400677, 196379023990504203398232036900292068109, 208338219265141175146204974249461481119, 180313228114558484028748815066535513471, 293814076002148382129879416847624489347, 217981245083649644743701945778358819867, 198894611219128734462943250308461071371, 190754795019022912784187412387261424293, 273263914687122798746013275553691541621, 319875887014797059887738138214903974573, 280433942775269696096083027024527213553, 339832090471957335839878188583478605273, 245482340001475388718217992653932933781, 195945871414379770821529324478394520901, 203621853598394319877751491201563422297, 285527901432745514886361613743984147931, 284721811618834957831167749970526496317, 327215978662725442740036051250620691291, 221299321558362891869402561537662340987, 252585072729486722478056993406814970147, 280264567326332248237425051940201458271, 241027648066340372998036400876879511133, 209093079608768177230455678431608454539, 340235244837800791530469709812216931327, 318370869089270734010914463566452904391, 218007259061353959833958121965586715759, 320702628326860753372843359167209806577, 280574097974570759348625351607802595079, 228292038707075332622237132594473246261, 246482905608669854259984848561724759323, 281771843261446623855706740146832822043, 241444581355719829115072364769273312223, 309029268537775236744873599480649785803, 293169195958605701684834829075351077843, 240056552101889027428780330876207267181, 206667506718454166578882634113592471317, 295377459264316749259598713099825801289, 334341534141831513237527215426279900591, 263440016933436744959242384953581131709, 327921668846632014434297416582771393151, 179743859120339282852666034250891124503, 212172965192102954961276830300925726343, 325170702322845184523697390427992449689, 271105603309076479942153666379400527383, 271642757529104184378772507234018239527, 244844048330592276234702305193952823371, 270007525941420385852467420335121485863, 290899364033417721623974853950097454643, 279919385326960469749295500025219756669]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">from Crypto.Util.number import inverse, long_to_bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">phi=1
</span></span><span class="line"><span class="cl">cnt=1
</span></span><span class="line"><span class="cl">s=[]
</span></span><span class="line"><span class="cl">for i in primes:
</span></span><span class="line"><span class="cl">    if n%i==0:
</span></span><span class="line"><span class="cl">        phi*=(i-1)
</span></span><span class="line"><span class="cl">        cnt*=i
</span></span><span class="line"><span class="cl">        n//=i
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">d=inverse(e,phi)
</span></span><span class="line"><span class="cl">m=pow(c,d,cnt)
</span></span><span class="line"><span class="cl">print(long_to_bytes(m))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="two_squares">two_squares</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">flag=b&#39;BaseCTF{}&#39;
</span></span><span class="line"><span class="cl">m=bytes_to_long(flag)
</span></span><span class="line"><span class="cl">p=getPrime(128)
</span></span><span class="line"><span class="cl">q=getPrime(128)
</span></span><span class="line"><span class="cl">n=p*q
</span></span><span class="line"><span class="cl">e=65537
</span></span><span class="line"><span class="cl">c=pow(m,e,n)
</span></span><span class="line"><span class="cl">x=p^2+q^2
</span></span><span class="line"><span class="cl">print(&#34;e =&#34;,e)
</span></span><span class="line"><span class="cl">print(&#34;c =&#34;,c)
</span></span><span class="line"><span class="cl">print(&#34;x =&#34;,x)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">c = 42330675787206041757903427737108553993012805007294570657461042152628982126538
</span></span><span class="line"><span class="cl">x = 209479773119142584969854470862023704936857416491817498021871883305658177375498
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>分析：最简单的一个，sagemath里面有two_squares的函数，甚至还有3次方的
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">c = 42330675787206041757903427737108553993012805007294570657461042152628982126538
</span></span><span class="line"><span class="cl">x = 209479773119142584969854470862023704936857416491817498021871883305658177375498
</span></span><span class="line"><span class="cl">#p,q=two_squares(x)
</span></span><span class="line"><span class="cl">#print(p,q)
</span></span><span class="line"><span class="cl">p=312730551067949919826003024531506165487
</span></span><span class="line"><span class="cl">q=334184642896526518753506901808151350573
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">n=p*q
</span></span><span class="line"><span class="cl">m=pow(c,inverse(e,(p-1)*(q-1)),n)
</span></span><span class="line"><span class="cl">print(long_to_bytes(m))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="try_to_factor">try_to_factor</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import random
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag=b&#39;BaseCTF{}&#39;+random.randbytes(64)
</span></span><span class="line"><span class="cl">m=bytes_to_long(flag)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">p,q,r,s,t=[getStrongPrime(512) for _ in range(5)]
</span></span><span class="line"><span class="cl">N=p*q*r*s*t
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">n=p*q
</span></span><span class="line"><span class="cl">e=65537
</span></span><span class="line"><span class="cl">c=pow(m,e,n)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gift=random.randint(2,n)*(p-1)*(q-1)*(r-1)*(s-1)*(t-1)
</span></span><span class="line"><span class="cl">while gift%2==0:
</span></span><span class="line"><span class="cl">    gift//=2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(&#34;N =&#34;,N)
</span></span><span class="line"><span class="cl">print(&#34;c =&#34;,c)
</span></span><span class="line"><span class="cl">print(&#34;gift =&#34;,gift)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">N = 162692163428762295773992659007654377270271126313772302197255271375236131917158614424426498628778734679898165422129699410934825650141972454562350664161510689489443251515884304101827584411577749250383438126881931889798597627663578045519256806107514170414321556291545302688028088470848270636776466672843710163017531472049823632822203461654253767303314505996071453898533003519236112138591066133289040889933161978131399309340741554076140734156174295730180874473301361701867633594222054688204666518058106672165786417002466165926062199279674267145233283545524775943767021416906072142236079753359492846480515376121887507681663761713445807717270089017438999615422884163666812016989696908657065537508715229685120221307021151610089917537155165897740417480127289719971512938348936259
</span></span><span class="line"><span class="cl">c = 113962118676826667648935023618252851875440854724310328843964819392166304653581141146631375503931008732348730639629174670963727399860571217264854300057305570824097216782800531930906801885967717639795643406206813677461127762087560021634738167845077869308515223303820469892552545806179267969169748886980836435095
</span></span><span class="line"><span class="cl">gift = 863514692222931709925579242743251211976114217396765747601042357918763818732391790491059528595917786523674732369068315533549380754409535403506339052401422249684188032949680148055803474336983973622610403448963752802490806614810077181934627694570685722842963961551889267501616799757825675192653489096007790143775773378495299981666657347802233798206597104474595281241837323214457344961462510183726339545608046357281265026013496037522835659867389206279894057481600882665189079672009577651494435000349624334685832217586703242422260870866432379257259316411280539845741932725104662417642890238587876489774492067722351467773093391502588019563488688309892102039611978767690653206664257400163618467825666105966072942726011447079204869750153256054140924951306811971422635104088608275908232688385437145325481792836532453258784103533536292492138405929815964841772656055397705840797739586953744563989819811944946916720655079908564653686456283647030055622241840292127096994325415897266379446446435164189216562921252341705747891518007710533906231225283309180960546212899099652226954393826875
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>分析：本来这应该是n和phi已知直接去套模板分解的，但是naby师傅魔改了一下，将phi中的2除完了，那就导致无法直接使用，然后给了一个<a href="https://link.springer.com/content/pdf/10.1007/3-540-36492-7_25.pdf" title="论文" target="_blank" rel="noopener noreffer ">论文</a>，在里面讲了一个算法，自己没有看到太懂，大概的意思是我们要找的是非平凡平方根，那么这个数用a来表示，就是</p>
$$
a^2-1=(a+1)(a-1)=0 mod N ,(a+1)(a-1)=kN
$$<p>那么我们求解直接已知一个另一个gcd就好了
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">N = 162692163428762295773992659007654377270271126313772302197255271375236131917158614424426498628778734679898165422129699410934825650141972454562350664161510689489443251515884304101827584411577749250383438126881931889798597627663578045519256806107514170414321556291545302688028088470848270636776466672843710163017531472049823632822203461654253767303314505996071453898533003519236112138591066133289040889933161978131399309340741554076140734156174295730180874473301361701867633594222054688204666518058106672165786417002466165926062199279674267145233283545524775943767021416906072142236079753359492846480515376121887507681663761713445807717270089017438999615422884163666812016989696908657065537508715229685120221307021151610089917537155165897740417480127289719971512938348936259
</span></span><span class="line"><span class="cl">c = 113962118676826667648935023618252851875440854724310328843964819392166304653581141146631375503931008732348730639629174670963727399860571217264854300057305570824097216782800531930906801885967717639795643406206813677461127762087560021634738167845077869308515223303820469892552545806179267969169748886980836435095
</span></span><span class="line"><span class="cl">gift = 863514692222931709925579242743251211976114217396765747601042357918763818732391790491059528595917786523674732369068315533549380754409535403506339052401422249684188032949680148055803474336983973622610403448963752802490806614810077181934627694570685722842963961551889267501616799757825675192653489096007790143775773378495299981666657347802233798206597104474595281241837323214457344961462510183726339545608046357281265026013496037522835659867389206279894057481600882665189079672009577651494435000349624334685832217586703242422260870866432379257259316411280539845741932725104662417642890238587876489774492067722351467773093391502588019563488688309892102039611978767690653206664257400163618467825666105966072942726011447079204869750153256054140924951306811971422635104088608275908232688385437145325481792836532453258784103533536292492138405929815964841772656055397705840797739586953744563989819811944946916720655079908564653686456283647030055622241840292127096994325415897266379446446435164189216562921252341705747891518007710533906231225283309180960546212899099652226954393826875
</span></span><span class="line"><span class="cl">fac=[]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">for i in range(2,10):
</span></span><span class="line"><span class="cl">    tmp=GCD(N, pow(i, gift,N)-1)
</span></span><span class="line"><span class="cl">    if isPrime(tmp) and tmp not in fac:
</span></span><span class="line"><span class="cl">        fac.append(tmp)
</span></span><span class="line"><span class="cl">    else:
</span></span><span class="line"><span class="cl">        for f in fac:
</span></span><span class="line"><span class="cl">            if tmp%f==0:
</span></span><span class="line"><span class="cl">                tmp//=f
</span></span><span class="line"><span class="cl">            if isPrime(tmp) and tmp not in fac:
</span></span><span class="line"><span class="cl">                fac.append(tmp)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">for i in range(2,10):
</span></span><span class="line"><span class="cl">    tmp=GCD(N, pow(3, gift*2**i,N)-1)
</span></span><span class="line"><span class="cl">    if isPrime(tmp) and tmp not in fac:
</span></span><span class="line"><span class="cl">        fac.append(tmp)
</span></span><span class="line"><span class="cl">    else:
</span></span><span class="line"><span class="cl">        for f in fac:
</span></span><span class="line"><span class="cl">            if tmp%f==0:
</span></span><span class="line"><span class="cl">                tmp//=f
</span></span><span class="line"><span class="cl">            if isPrime(tmp) and tmp not in fac:
</span></span><span class="line"><span class="cl">                fac.append(tmp)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">for p in fac:
</span></span><span class="line"><span class="cl">    for q in fac:
</span></span><span class="line"><span class="cl">        if b&#39;BaseCTF&#39; in long_to_bytes(pow(c, inverse(65537, (p-1)*(q-1)),p*q)):
</span></span><span class="line"><span class="cl">            print(long_to_bytes(pow(c, inverse(65537, (p-1)*(q-1)),p*q)))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h2 id="week3の题目">week3の题目</h2>
<h3 id="没有n啊">没有n啊</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import gmpy2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag=b&#39;BaseCTF{}&#39;
</span></span><span class="line"><span class="cl">m=bytes_to_long(flag)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">p=getPrime(512)
</span></span><span class="line"><span class="cl">q=getPrime(512)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">n=p*q
</span></span><span class="line"><span class="cl">e=65537
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">phi=(p-1)*(q-1)
</span></span><span class="line"><span class="cl">d=gmpy2.invert(e,phi)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c=pow(m,e,n)
</span></span><span class="line"><span class="cl">x=pow(n,e,c)
</span></span><span class="line"><span class="cl">print(&#34;c =&#34;,c)
</span></span><span class="line"><span class="cl">print(&#34;e =&#34;,e)
</span></span><span class="line"><span class="cl">print(&#34;d =&#34;,d)
</span></span><span class="line"><span class="cl">print(&#34;x =&#34;,x)
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span><span class="line"><span class="cl">c = 52453423663797600504896811946820841317615798875871627840172711423749946998217916744135290476795328543876098295227017753117609268701786914053599060330837226980969490439739651088710549890669593587642238827462108900683237797139569260570711611781514337884756698142193277516649805710242748531658979160170193283558
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">d = 54297831548863701092644190086258072883163378307246681513317422545902442650340916001357605211715836911877651782099787873046987096258918495734824011752504203578982947618784736181975847356304742402103468329660346526185908618978851982007496096394151821403282347897417590596861323293706611997134962231129075032641
</span></span><span class="line"><span class="cl">x = 40635864473997460751766935373772107585133301579524000836637683731949939348171187931595274511243052505604832873086269554842194695737052043633079044688826020656068356561856848814530947955429343483847291398607359454851926470168457852479044154798114087493843073091985855839008222762224952503563764527380033064437
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：西瓜杯的原题，二项式定理
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">phic=euler_phi(c)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">dc=inverse_mod(e,phic)
</span></span><span class="line"><span class="cl">a=pow(hint,dc,c)
</span></span><span class="line"><span class="cl">n=int(a)+int(c)
</span></span><span class="line"><span class="cl">m=power_mod(c,d,n)
</span></span><span class="line"><span class="cl">print(long_to_bytes(m))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="没有n啊pro">没有n啊pro</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import gmpy2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag=b&#39;BaseCTF{}&#39;
</span></span><span class="line"><span class="cl">m=bytes_to_long(flag)
</span></span><span class="line"><span class="cl">p=getPrime(128)
</span></span><span class="line"><span class="cl">q=getPrime(128)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(p,q)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">n=p*q
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">e=65537
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">phi=(p-1)*(q-1)
</span></span><span class="line"><span class="cl">d=gmpy2.invert(e,phi)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">assert d&lt;phi
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c=pow(m,e,n)
</span></span><span class="line"><span class="cl">print(&#34;c =&#34;,c)
</span></span><span class="line"><span class="cl">print(&#34;e =&#34;,e)
</span></span><span class="line"><span class="cl">print(&#34;d =&#34;,d)
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">c = 78919950899709764543039048006935881842075789773495004639436106636461009323420
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">d = 13002488326322253055272696035053386340217207134816593767440035447757509399233
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：分解之后去和他爆了
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import long_to_bytes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c = 78919950899709764543039048006935881842075789773495004639436106636461009323420
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">d = 13002488326322253055272696035053386340217207134816593767440035447757509399233
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def find(factors):
</span></span><span class="line"><span class="cl">    dic={1:[]}
</span></span><span class="line"><span class="cl">    for factor in factors:
</span></span><span class="line"><span class="cl">        for f in list(dic.keys()):
</span></span><span class="line"><span class="cl">            ff=f*factor
</span></span><span class="line"><span class="cl">            if ff not in dic:
</span></span><span class="line"><span class="cl">                dic[ff]=dic[f]+[factor]
</span></span><span class="line"><span class="cl">    return dic
</span></span><span class="line"><span class="cl">for k in range(2,e):
</span></span><span class="line"><span class="cl">    if (e*d-1)%k==0:
</span></span><span class="line"><span class="cl">        phi=(e*d-1)//k
</span></span><span class="line"><span class="cl">        if phi.nbits()==256 and d&lt;phi and phi&gt;c:
</span></span><span class="line"><span class="cl">            fac=list(factor(phi))
</span></span><span class="line"><span class="cl">            factors=[]
</span></span><span class="line"><span class="cl">            for f in fac:
</span></span><span class="line"><span class="cl">                ep=f[1]
</span></span><span class="line"><span class="cl">                for _ in range(ep):
</span></span><span class="line"><span class="cl">                    factors.append(f[0])
</span></span><span class="line"><span class="cl">            dic=find(factors)
</span></span><span class="line"><span class="cl">            for p_1 in list(dic.keys()):
</span></span><span class="line"><span class="cl">                pp=p_1+1
</span></span><span class="line"><span class="cl">                if is_prime(p_1+1) and pp.nbits()==128:
</span></span><span class="line"><span class="cl">                    q_1=phi//p_1
</span></span><span class="line"><span class="cl">                    if is_prime(q_1+1):
</span></span><span class="line"><span class="cl">                        print(&#39;find!&#39;)
</span></span><span class="line"><span class="cl">                        p=p_1+1
</span></span><span class="line"><span class="cl">                        q=q_1+1
</span></span><span class="line"><span class="cl">                        m=power_mod(c, d,p*q)
</span></span><span class="line"><span class="cl">                        print(long_to_bytes(m))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="exgcd">exgcd</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag=b&#39;BaseCTF{}&#39;
</span></span><span class="line"><span class="cl">m=bytes_to_long(flag)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">p=getPrime(1024)
</span></span><span class="line"><span class="cl">q=getPrime(1024)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">n=p*q
</span></span><span class="line"><span class="cl">e1=3747
</span></span><span class="line"><span class="cl">e2=2991
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c1=pow(m,e1,n)
</span></span><span class="line"><span class="cl">c2=pow(m,e2,n)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(&#34;n =&#34;,n)
</span></span><span class="line"><span class="cl">print(&#34;e1 =&#34;,e1)
</span></span><span class="line"><span class="cl">print(&#34;e2 =&#34;,e2)
</span></span><span class="line"><span class="cl">print(&#34;c1 =&#34;,c1)
</span></span><span class="line"><span class="cl">print(&#34;c2 =&#34;,c2)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">n = 27855350163093443890983002241607629119744539643165776358993469078731521668677421483556132628708836721737685936980427467856642738196111748018522018598646125626995613169001111504706363742194664774823604738939411512861441742683157275818500991834651769368178320088982759626122029956515159435424882855075032400667120376075618896752694718491438251810609878021717559466498493103257912108879328270813061231904227056671621363669388496383136964549879459562004569059185078204867346250733489663015417879915436157806942021693920206071715538430633494012923651469196048546309592946901609803631751035364478773126967010589504275776307
</span></span><span class="line"><span class="cl">e1 = 3747
</span></span><span class="line"><span class="cl">e2 = 2991
</span></span><span class="line"><span class="cl">c1 = 24426579024062518665031958216110619832653602343205488454298659533869220501923184793828421371206493659949730138867555889074137026401207985428160803910695088081370233571905915349589146504374710444468715701305061060934519410886010929009297226496448218819742287990364436349188987723637449590579092391100714056589967894609950537021838172987840638735592599678186555961654312442380755963257875487240962193060914793587712733601168204859917001269928487633954556221987632934190217367502677285906521385169669644977192556145782303526375491484736352799180747403161343130663661867413380222714012960607473395828938694285120527085083
</span></span><span class="line"><span class="cl">c2 = 6932145147126610816836065944280934160173362059462927112752295077225965836502881335565881607385328990881865436690904056577675885697508058289570333933837515526915707121125766720407153139160751343352211421901876051228566093038929625042619250168565502734932197817082848506826847112949495527533238122893297049985517280574646627011986403578166952789317461581409161873814203023736604394085875778774834314777046086921852377348590998381648241629124408514875110073073851913857329679268519229436092660959841766848676678740851087184214283196544821779336090434587905158006710112461778939184327386306992082433561460542130441825293
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：共模攻击，但是gcd(e1,e2)=3，再开根号
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from gmpy2 import*
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">def egcd(a, b):
</span></span><span class="line"><span class="cl">	if a == 0:
</span></span><span class="line"><span class="cl">		return (b, 0, 1)
</span></span><span class="line"><span class="cl">	else:
</span></span><span class="line"><span class="cl">		g, y, x = egcd(b % a, a)
</span></span><span class="line"><span class="cl">		return (g, x - (b // a) * y, y)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">n = 27855350163093443890983002241607629119744539643165776358993469078731521668677421483556132628708836721737685936980427467856642738196111748018522018598646125626995613169001111504706363742194664774823604738939411512861441742683157275818500991834651769368178320088982759626122029956515159435424882855075032400667120376075618896752694718491438251810609878021717559466498493103257912108879328270813061231904227056671621363669388496383136964549879459562004569059185078204867346250733489663015417879915436157806942021693920206071715538430633494012923651469196048546309592946901609803631751035364478773126967010589504275776307
</span></span><span class="line"><span class="cl">e1 = 3747
</span></span><span class="line"><span class="cl">e2 = 2991
</span></span><span class="line"><span class="cl">c1 = 24426579024062518665031958216110619832653602343205488454298659533869220501923184793828421371206493659949730138867555889074137026401207985428160803910695088081370233571905915349589146504374710444468715701305061060934519410886010929009297226496448218819742287990364436349188987723637449590579092391100714056589967894609950537021838172987840638735592599678186555961654312442380755963257875487240962193060914793587712733601168204859917001269928487633954556221987632934190217367502677285906521385169669644977192556145782303526375491484736352799180747403161343130663661867413380222714012960607473395828938694285120527085083
</span></span><span class="line"><span class="cl">c2 = 6932145147126610816836065944280934160173362059462927112752295077225965836502881335565881607385328990881865436690904056577675885697508058289570333933837515526915707121125766720407153139160751343352211421901876051228566093038929625042619250168565502734932197817082848506826847112949495527533238122893297049985517280574646627011986403578166952789317461581409161873814203023736604394085875778774834314777046086921852377348590998381648241629124408514875110073073851913857329679268519229436092660959841766848676678740851087184214283196544821779336090434587905158006710112461778939184327386306992082433561460542130441825293
</span></span><span class="line"><span class="cl">print(gcd(e1,e2))
</span></span><span class="line"><span class="cl">s = egcd(e1, e2)
</span></span><span class="line"><span class="cl">s1 = s[1]
</span></span><span class="line"><span class="cl">s2 = s[2]
</span></span><span class="line"><span class="cl">if s1&lt;0:
</span></span><span class="line"><span class="cl">	s1 = - s1
</span></span><span class="line"><span class="cl">	c1 =invert(c1, n)
</span></span><span class="line"><span class="cl">elif s2&lt;0:
</span></span><span class="line"><span class="cl">	s2 = - s2
</span></span><span class="line"><span class="cl">	c2 =invert(c2, n)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">m = pow(c1,s1,n)*pow(c2,s2,n) % n
</span></span><span class="line"><span class="cl">print(long_to_bytes(iroot(m,3)[0]))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="ez_log">ez_log</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import bytes_to_long as b2l, long_to_bytes as l2b, getPrime
</span></span><span class="line"><span class="cl">from Crypto.Cipher import AES
</span></span><span class="line"><span class="cl">from random import randint
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag = b&#34;flag{test_flag}&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">pad = lambda x: x+b&#39;\x00&#39;*(16-len(x)%16)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def encrypt(KEY):
</span></span><span class="line"><span class="cl">    cipher= AES.new(KEY,AES.MODE_ECB)
</span></span><span class="line"><span class="cl">    encrypted =cipher.encrypt(flag)
</span></span><span class="line"><span class="cl">    return encrypted
</span></span><span class="line"><span class="cl">def decrypt(KEY):
</span></span><span class="line"><span class="cl">    cipher= AES.new(KEY,AES.MODE_ECB)
</span></span><span class="line"><span class="cl">    decrypted =cipher.decrypt(enc)
</span></span><span class="line"><span class="cl">    return decrypted
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag = pad(flag)
</span></span><span class="line"><span class="cl">x = randint(10 ** 7, 10 ** 8)
</span></span><span class="line"><span class="cl">y = randint(10 ** 7, 10 ** 8)
</span></span><span class="line"><span class="cl">n = getPrime(28)
</span></span><span class="line"><span class="cl">z = pow(y, x, n)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">enc = encrypt(pad(l2b(x)))
</span></span><span class="line"><span class="cl">print(f&#39;enc = {b2l(enc)}&#39;)
</span></span><span class="line"><span class="cl">print(f&#39;y = {y}&#39;)
</span></span><span class="line"><span class="cl">print(f&#39;n = {n}&#39;)
</span></span><span class="line"><span class="cl">print(f&#39;z = {z}&#39;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span><span class="line"><span class="cl">enc = 33416570913716503492297352041317858420349510954381249751537743898024527101872454706181188441210166165803904185550746
</span></span><span class="line"><span class="cl">y = 82941012
</span></span><span class="line"><span class="cl">n = 228338567
</span></span><span class="line"><span class="cl">z = 51306718
</span></span><span class="line"><span class="cl">&#39;&#39;&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：就是离散对数，练一下脚本吧(所以没用sagemath)
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import long_to_bytes as l2b
</span></span><span class="line"><span class="cl">from Crypto.Cipher import AES
</span></span><span class="line"><span class="cl">from math import isqrt
</span></span><span class="line"><span class="cl">from sympy import mod_inverse
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># 已知值
</span></span><span class="line"><span class="cl">y = 82941012
</span></span><span class="line"><span class="cl">n = 228338567
</span></span><span class="line"><span class="cl">z = 51306718
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def baby_step_giant_step(y, z, n):
</span></span><span class="line"><span class="cl">    # m 为 sqrt(n) 的上界
</span></span><span class="line"><span class="cl">    m = isqrt(n) + 1
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    # 计算 Baby steps: (y^j) % n for j in range(m)
</span></span><span class="line"><span class="cl">    baby_steps = {}
</span></span><span class="line"><span class="cl">    current = 1
</span></span><span class="line"><span class="cl">    for j in range(m):
</span></span><span class="line"><span class="cl">        baby_steps[current] = j
</span></span><span class="line"><span class="cl">        current = (current * y) % n
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    # 计算 Giant steps: (z * y^(-m))^i % n
</span></span><span class="line"><span class="cl">    y_m_inv = mod_inverse(pow(y, m, n), n)  # y^-m (mod n)
</span></span><span class="line"><span class="cl">    giant_step = z
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    for i in range(m):
</span></span><span class="line"><span class="cl">        if giant_step in baby_steps:
</span></span><span class="line"><span class="cl">            return i * m + baby_steps[giant_step]
</span></span><span class="line"><span class="cl">        giant_step = (giant_step * y_m_inv) % n
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    return None  # 未找到
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">x = baby_step_giant_step(y, z, n)
</span></span><span class="line"><span class="cl">if x is not None:
</span></span><span class="line"><span class="cl">    print(f&#39;Found x: {x}&#39;)
</span></span><span class="line"><span class="cl">else:
</span></span><span class="line"><span class="cl">    print(&#39;No solution found&#39;)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">if x is not None:
</span></span><span class="line"><span class="cl">    KEY = l2b(x) + b&#39;\x00&#39; * (16 - len(l2b(x)) % 16)
</span></span><span class="line"><span class="cl">    enc = 33416570913716503492297352041317858420349510954381249751537743898024527101872454706181188441210166165803904185550746
</span></span><span class="line"><span class="cl">    cipher = AES.new(KEY, AES.MODE_ECB)
</span></span><span class="line"><span class="cl">    decrypted_flag = cipher.decrypt(l2b(enc))
</span></span><span class="line"><span class="cl">    print(f&#39;Decrypted flag: {decrypted_flag}&#39;)
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="wiener">wiener</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import decimal
</span></span><span class="line"><span class="cl">flag=b&#34;BaseCTF{}&#34;
</span></span><span class="line"><span class="cl">m = bytes_to_long(flag)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">p = getPrime(1024)
</span></span><span class="line"><span class="cl">q = getPrime(1024)
</span></span><span class="line"><span class="cl">n=p*q
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">e=65537
</span></span><span class="line"><span class="cl">c=pow(m,e,n)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(&#34;e =&#34;,e)
</span></span><span class="line"><span class="cl">print(&#34;c =&#34;,c)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">decimal.getcontext().prec = 648
</span></span><span class="line"><span class="cl">P=decimal.Decimal(p)
</span></span><span class="line"><span class="cl">Q=decimal.Decimal(q)
</span></span><span class="line"><span class="cl">leak=decimal.Decimal((3*P*Q-1)/(3*Q*Q))
</span></span><span class="line"><span class="cl">print(&#34;leak =&#34;,leak)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">c = 11032748573623426359632659657114807044712138586316710250985606809252700461490504487308849626514319062562557448839550994242999334882617031487618174168038491566640081840111747765753878087564318833273878755416584962921669911444225959335274753391800995531023212276838665202257007640354237043291129197348884914956663597240094662207929658519596987351984403258345205873566463643624175318315064440456858013874962784792564480286904620663695194689839431808082976248378509181327101557380978849545906691903896662095520288964101796965095129861467059775556110616007889846240936219381379219605528051627402300580239311202137582442057
</span></span><span class="line"><span class="cl">leak = 0.829374344780877053838760251345359097311540811993463349625630085472892814959843248358036249898871908548743719153319438638517170060651237635838827482534816419091949205584951292517303330452910012749674475329235689229498752425379611083979518257734473992186831474208400813283887045691145481237726578827559198828469462343342343287720369159899636816373592067698883361360269728719786071024354151682314608072902347335691012713629816579496252896260869382806838857194293618332286500427694077400072428506897829689703872985954772105672992293334668485358785863779749153981721900135318166811250762946069962348114491411585418993494561587403918162681937152503739843
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：直接pq连分数，去爆破或者是搜索都行
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from gmpy2 import *
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">e = 65537
</span></span><span class="line"><span class="cl">c = 11032748573623426359632659657114807044712138586316710250985606809252700461490504487308849626514319062562557448839550994242999334882617031487618174168038491566640081840111747765753878087564318833273878755416584962921669911444225959335274753391800995531023212276838665202257007640354237043291129197348884914956663597240094662207929658519596987351984403258345205873566463643624175318315064440456858013874962784792564480286904620663695194689839431808082976248378509181327101557380978849545906691903896662095520288964101796965095129861467059775556110616007889846240936219381379219605528051627402300580239311202137582442057
</span></span><span class="line"><span class="cl">leak = 0.829374344780877053838760251345359097311540811993463349625630085472892814959843248358036249898871908548743719153319438638517170060651237635838827482534816419091949205584951292517303330452910012749674475329235689229498752425379611083979518257734473992186831474208400813283887045691145481237726578827559198828469462343342343287720369159899636816373592067698883361360269728719786071024354151682314608072902347335691012713629816579496252896260869382806838857194293618332286500427694077400072428506897829689703872985954772105672992293334668485358785863779749153981721900135318166811250762946069962348114491411585418993494561587403918162681937152503739843
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">con=continued_fraction(leak)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">for i in range(0, len(con)):
</span></span><span class="line"><span class="cl">    q = con.denominator(i)
</span></span><span class="line"><span class="cl">    p = con.numerator(i)
</span></span><span class="line"><span class="cl">    if is_prime(q) and is_prime(p):
</span></span><span class="line"><span class="cl">        print(long_to_bytes(power_mod(c, inverse(e, q-1),q)))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h2 id="week3の题目-1">week3の题目</h2>
<h3 id="哎呀数据丢失了">哎呀数据丢失了</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-----BEGIN RSA PRIVATE KEY-----
</span></span><span class="line"><span class="cl">MIICXAIBAAKBgQC9J4SEEirvmmnsZHKQIZ3tBu3St2EXIbMmhQsvUGDa7tdpQ1Zm
</span></span><span class="line"><span class="cl">fEecqcy2lp9Pvm3H+mdZrKIdipaogajkoCF3MnV+ZJ1QMZFRH6ltpC7R2i+jvIyc
</span></span><span class="line"><span class="cl">ZfvZwN1vQwNZrEXkVdMsWw6inSHmR/+A5Qq8u4D3attnAHoE6F2660yPHQIDAQAB
</span></span><span class="line"><span class="cl">AoGAImXjVVkwca41AQYrR0a1v3r5GM68W0aHm8OqCwqk8mtoxP234p9LLpQ6ZCH0
</span></span><span class="line"><span class="cl">Cr5onGtPDCG2wYSIbVBW9GyiaQhUDsB7gq1H5meXGgH6xhYuk6f8Ya7VZg+Cauuj
</span></span><span class="line"><span class="cl">TXiszRj8WeeSFwHxD/UdUog3BrhkKHz9s04wnJOCnSnYZ8kCQQDG4J**********
</span></span><span class="line"><span class="cl">****************************************************************
</span></span><span class="line"><span class="cl">****************************************************************
</span></span><span class="line"><span class="cl">****************************************************************
</span></span><span class="line"><span class="cl">****************************************************************
</span></span><span class="line"><span class="cl">****************************************************************
</span></span><span class="line"><span class="cl">****************************************************************
</span></span><span class="line"><span class="cl">****************************************************************
</span></span><span class="line"><span class="cl">-----END RSA PRIVATE KEY-----
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c=5350934245443624615705634168321364454795591666560826831012326948814964674913623395481194876787286689366750529186073548501661956439774413391667376304378756290912469006122113210585561764352070241110069022406544206322583369771609766119501319329839086445136604208397605143623014788767486449680728261586601862940
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：经典的部分pem丢失，整体转16进制后按照02分割
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">30
</span></span><span class="line"><span class="cl">82 025c
</span></span><span class="line"><span class="cl">0201 00
</span></span><span class="line"><span class="cl">n 028181 0x00bd278484122aef9a69ec647290219ded06edd2b7611721b326850b2f5060daeed7694356667c479ca9ccb6969f4fbe6dc7fa6759aca21d8a96a881a8e4a0217732757e649d503191511fa96da42ed1da2fa3bc8c9c65fbd9c0dd6f430359ac45e455d32c5b0ea29d21e647ff80e50abcbb80f76adb67007a04e85dbaeb4c8f1d
</span></span><span class="line"><span class="cl">e 0203 0x010001
</span></span><span class="line"><span class="cl">d 028180 0x2265e355593071ae3501062b4746b5bf7af918cebc5b46879bc3aa0b0aa4f26b68c4fdb7e29f4b2e943a6421f40abe689c6b4f0c21b6c184886d5056f46ca26908540ec07b82ad47e667971a01fac6162e93a7fc61aed5660f826aeba34d78accd18fc59e7921701f10ff51d52883706b864287cfdb34e309c93829d29d867c9
</span></span><span class="line"><span class="cl">024100c6e0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">e=0x10001
</span></span><span class="line"><span class="cl">d=0x2265e355593071ae3501062b4746b5bf7af918cebc5b46879bc3aa0b0aa4f26b68c4fdb7e29f4b2e943a6421f40abe689c6b4f0c21b6c184886d5056f46ca26908540ec07b82ad47e667971a01fac6162e93a7fc61aed5660f826aeba34d78accd18fc59e7921701f10ff51d52883706b864287cfdb34e309c93829d29d867c9
</span></span><span class="line"><span class="cl">n=0xbd278484122aef9a69ec647290219ded06edd2b7611721b326850b2f5060daeed7694356667c479ca9ccb6969f4fbe6dc7fa6759aca21d8a96a881a8e4a0217732757e649d503191511fa96da42ed1da2fa3bc8c9c65fbd9c0dd6f430359ac45e455d32c5b0ea29d21e647ff80e50abcbb80f76adb67007a04e85dbaeb4c8f1d
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c=5350934245443624615705634168321364454795591666560826831012326948814964674913623395481194876787286689366750529186073548501661956439774413391667376304378756290912469006122113210585561764352070241110069022406544206322583369771609766119501319329839086445136604208397605143623014788767486449680728261586601862940
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">m=pow(c,d,n)
</span></span><span class="line"><span class="cl">print(long_to_bytes(m))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="rabin">rabin</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag=b&#34;BaseCTF{}&#34;
</span></span><span class="line"><span class="cl">m = bytes_to_long(flag)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">p = getPrime(512)
</span></span><span class="line"><span class="cl">q = getPrime(512)
</span></span><span class="line"><span class="cl">assert p%4==3 and q%4==3
</span></span><span class="line"><span class="cl">n = p*q
</span></span><span class="line"><span class="cl">e = 4
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c = pow(m,e,n)
</span></span><span class="line"><span class="cl">print(&#34;p=&#34;,p)
</span></span><span class="line"><span class="cl">print(&#34;q=&#34;,q)
</span></span><span class="line"><span class="cl">print(&#34;n=&#34;,n)
</span></span><span class="line"><span class="cl">print(&#34;c=&#34;,c)
</span></span><span class="line"><span class="cl">print(&#34;e=&#34;,e)
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span><span class="line"><span class="cl">p= 8531212975719216550108614256955774722172741885676113601617182716356239301381951899737237219659253655889636684200345109462928796329670321336864298557778843
</span></span><span class="line"><span class="cl">q= 7443256287912111739335729314443559886458007838130371799255078565502662459436043455787869631999073617967343884377537828940738213460508765519478956421282871
</span></span><span class="line"><span class="cl">n= 63500004625039456439237191267891267558404574431112995926594213383621331385226487443753506088788203040258384788149958095020759745138424276657604371402824844725005596890673468964961037168078105356669148960568974603581485045691990626520286184874115519591663033533771400334558853058140717812903874350138362098253
</span></span><span class="line"><span class="cl">c= 51452608438757130697131508192775727191605112918772187364577097224326062184288501602000700342623122861398852536963355962672293705131887315354242193416090384360837672258861475017098419459125395949090523474744886423754439919504732741712693909507972791203801494594878447921609420574365853676576693694677914169353
</span></span><span class="line"><span class="cl">e= 4
</span></span><span class="line"><span class="cl">&#34;&#34;&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：经典rabin板子，不会的去搜原理
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">from gmpy2 import iroot, invert
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">p= 8531212975719216550108614256955774722172741885676113601617182716356239301381951899737237219659253655889636684200345109462928796329670321336864298557778843
</span></span><span class="line"><span class="cl">q= 7443256287912111739335729314443559886458007838130371799255078565502662459436043455787869631999073617967343884377537828940738213460508765519478956421282871
</span></span><span class="line"><span class="cl">n= 63500004625039456439237191267891267558404574431112995926594213383621331385226487443753506088788203040258384788149958095020759745138424276657604371402824844725005596890673468964961037168078105356669148960568974603581485045691990626520286184874115519591663033533771400334558853058140717812903874350138362098253
</span></span><span class="line"><span class="cl">c= 51452608438757130697131508192775727191605112918772187364577097224326062184288501602000700342623122861398852536963355962672293705131887315354242193416090384360837672258861475017098419459125395949090523474744886423754439919504732741712693909507972791203801494594878447921609420574365853676576693694677914169353
</span></span><span class="line"><span class="cl">e= 4
</span></span><span class="line"><span class="cl">inv_p = invert(p, q)
</span></span><span class="line"><span class="cl">inv_q = invert(q, p)
</span></span><span class="line"><span class="cl">mp = pow(c, (p + 1) // 4, p)
</span></span><span class="line"><span class="cl">mq = pow(c, (q + 1) // 4, q)
</span></span><span class="line"><span class="cl">a = (inv_p * p * mq + inv_q * q * mp) % n
</span></span><span class="line"><span class="cl">b = n - int(a)
</span></span><span class="line"><span class="cl">c = (inv_p * p * mq - inv_q * q * mp) % n
</span></span><span class="line"><span class="cl">d = n - int(c)
</span></span><span class="line"><span class="cl"># 因为rabin 加密有四种结果，全部列出。
</span></span><span class="line"><span class="cl">aa = [a, b, c, d]
</span></span><span class="line"><span class="cl">for i in aa:
</span></span><span class="line"><span class="cl">    # print(i)
</span></span><span class="line"><span class="cl">    print(long_to_bytes(int(iroot(i,2)[0])))
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="extendmd5">extendmd5</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">Crypto</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">number</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">socketserver</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="k">signal</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">os</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">random</span> 
</span></span><span class="line"><span class="cl"><span class="n">flag</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;GZCTF_FLAG&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="n">Task</span><span class="p">(</span><span class="n">socketserver</span><span class="o">.</span><span class="n">BaseRequestHandler</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">_recvall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">BUFF_SIZE</span> <span class="o">=</span> <span class="mi">2048</span>
</span></span><span class="line"><span class="cl">        <span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">part</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">BUFF_SIZE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">data</span> <span class="o">+=</span> <span class="n">part</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">part</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">BUFF_SIZE</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="n">True</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">newline</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">msg</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">pass</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">recv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_recvall</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">my_md5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">mymd5</span><span class="o">=</span><span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">mymd5</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">mymd5</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">signal</span><span class="o">.</span><span class="n">alarm</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="n">c</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">want</span><span class="o">=</span><span class="n">random</span><span class="o">.</span><span class="n">randbytes</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">want_md5</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">my_md5</span><span class="p">(</span><span class="n">want</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">want_md5</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">True</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">Please input the secret:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">secret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">            <span class="n">final</span><span class="o">=</span><span class="n">want</span><span class="o">+</span><span class="n">secret</span>
</span></span><span class="line"><span class="cl">            <span class="n">final_md5</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">my_md5</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">Please input your md5:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">your_md5</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span>  <span class="n">final_md5</span> <span class="o">==</span> <span class="n">your_md5</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">flag</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">Connection has been closed  =.=  &#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="n">ThreadedServer</span><span class="p">(</span><span class="n">socketserver</span><span class="o">.</span><span class="n">ThreadingMixIn</span><span class="p">,</span> <span class="n">socketserver</span><span class="o">.</span><span class="n">TCPServer</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="n">ForkedServer</span><span class="p">(</span><span class="n">socketserver</span><span class="o">.</span><span class="n">ForkingMixIn</span><span class="p">,</span> <span class="n">socketserver</span><span class="o">.</span><span class="n">TCPServer</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">pass</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span> <span class="o">=</span> <span class="s1">&#39;0.0.0.0&#39;</span><span class="p">,</span> <span class="mi">9999</span>
</span></span><span class="line"><span class="cl">    <span class="n">server</span> <span class="o">=</span> <span class="n">ForkedServer</span><span class="p">((</span><span class="n">HOST</span><span class="p">,</span> <span class="n">PORT</span><span class="p">),</span> <span class="n">Task</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">server</span><span class="o">.</span><span class="n">allow_reuse_address</span> <span class="o">=</span> <span class="n">True</span>
</span></span><span class="line"><span class="cl">    <span class="n">server</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：密码里面的md5拓展，不是web的！但是要解一百次。
此处用naby师傅的exp：原理：</p>
<p>首先需要从md5加密过程开始说起，md5加密是分组进行加密的，每组512bits。在一开始，需要对明文进行填充，如果最后分组不满512bits的需要填充到512bits；如果原始内容刚刚好可以分组，那也需要填充一个512bits的分组。md5扩展攻击最重要的就是理解填充规则。</p>
<p>填充规则：</p>
<p>首先添加一个固定字节b&rsquo;\x80&rsquo;，之后需要填充由原始明文长度计算得来的8个字节，这8个字节是一定需要填充的，所以如果这个时候明文已经到达了57bytes，再填充8字节就会不再是刚好的64bytes(512bits)，所以这时候我们要新添一个分组。最后八字节为原始明文长度，填充方式为小端序。</p>
<p>比如len=10，先填上个b&rsquo;\x80&rsquo;，这时候长度为11，可以填充8字节，那么再填充b&rsquo;\x00&rsquo;*(64-8-1-10)，64为一个分组的字节数，8为最后需要填充的数据，1是最开始填充的b&rsquo;\x80&rsquo;，最后填充八个字节为b&rsquo;\x50\x00\x00\x00\x00\x00\x00\x00&rsquo;。</p>
<p>比如len=33，先填上个b&rsquo;\x80&rsquo;，那么再填充b&rsquo;\x00&rsquo;*(64-8-1-33)，最后填充八个字节为b&rsquo;\x08\x01\x00\x00\x00\x00\x00\x00&rsquo;。原始数据为264bits，验证：0x108=264</p>
<p>比如len=56，先填上个b&rsquo;\x80&rsquo;，这时候有57字节，再填充8字节的话为65字节，那么不满足分组条件，所以这时候我们需要再填充b&rsquo;\x00&rsquo;<em>(64</em>2-8-1-56)，也就是63个0字节，最后填充八个字节为b&rsquo;\xc0\x01\x00\x00\x00\x00\x00\x00。原始数据为448bits，验证：0x01c0=448</p>
<p>当我们填充完数据后，从第一个分组开始进行md5加密，加密过程可以不用在意，只需知道每次加密后得到32个16六进制，加密后的结果分成四组，当成下一个分组加密的IV，这是攻击的关键。</p>
<p>一开始，我们知道原始内容的md5值，并且原始内容长度小于64字节。这时候，服务器我们可以在原始内容后面添加自定义数据，那么最重要的就是，根据填充规则，我们只要知道原始内容长度，我们就可以自己进行填充，只要我们自己填充的数据与md5加密时一样，最后计算出的md5值也会一样，那么这个结果是作为下一组内容加密时的IV。</p>
<p>所以我们像服务器发送数据为：填充内容+任意内容</p>
<p>最后发送 任意内容的md5结果，当然这里需要根据服务器一开始传来的md5值作为IV来进行加密</p>
<p>这里我用GPT生成了一份md5加密代码，在加密时传送进去IV值，最重要的是，我这份源码是原始的md5加密代码，我们需要在”任意内容“前填上64bytes*分组数，而且在加密函数(my_md5)中，我们只要最后一个分组的结果，所以我们需要跳过前面几个分组（在代码中skip变量处体现）
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">struct</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">math</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 定义MD5所需的常量</span>
</span></span><span class="line"><span class="cl"><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="ne">int</span><span class="p">(</span><span class="mi">4294967296</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 定义左旋转函数</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">left_rotate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">c</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">c</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 定义MD5主循环所需的四个基本函数</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">z</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">y</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span> <span class="o">^</span> <span class="n">y</span> <span class="o">^</span> <span class="n">z</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">I</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">y</span> <span class="o">^</span> <span class="p">(</span><span class="n">x</span> <span class="o">|</span> <span class="o">~</span><span class="n">z</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 定义MD5算法</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">my_md5</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">skip</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 初始化变量</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="c1"># 填充消息</span>
</span></span><span class="line"><span class="cl">    <span class="n">original_length</span> <span class="o">=</span> <span class="n">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">    <span class="n">message</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x80</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="o">%</span> <span class="mi">512</span> <span class="o">!=</span> <span class="mi">448</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">message</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">message</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;Q&#39;</span><span class="p">,</span> <span class="n">original_length</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="c1"># 处理每个512位（64字节）块</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 跳过前几个分组</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span> <span class="o">*</span> <span class="n">skip</span><span class="p">,</span> <span class="n">len</span><span class="p">(</span><span class="n">message</span><span class="p">),</span> <span class="mi">64</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">block</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">64</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">X</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;16I&#39;</span><span class="p">,</span> <span class="n">block</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="c1"># 备份当前的a, b, c, d值</span>
</span></span><span class="line"><span class="cl">        <span class="n">AA</span><span class="p">,</span> <span class="n">BB</span><span class="p">,</span> <span class="n">CC</span><span class="p">,</span> <span class="n">DD</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># 进行四轮操作，每轮16步</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">15</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">k</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="k">func</span> <span class="o">=</span> <span class="n">i</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">22</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">],</span> <span class="n">F</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="mi">16</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">31</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">k</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="k">func</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">20</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">],</span> <span class="n">G</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="mi">32</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">47</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">k</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="k">func</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">23</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">],</span> <span class="n">H</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="mi">48</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">63</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">k</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="k">func</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="mi">16</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">21</span><span class="p">][</span><span class="n">i</span> <span class="o">%</span> <span class="mi">4</span><span class="p">],</span> <span class="n">I</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">            <span class="n">temp</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">left_rotate</span><span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="k">func</span> <span class="o">+</span> <span class="n">X</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="p">,</span> <span class="n">temp</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="c1"># 将结果加到当前的a, b, c, d</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">AA</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">BB</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">CC</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">        <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span> <span class="o">+</span> <span class="n">DD</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 返回哈希结果</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;4I&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span><span class="o">.</span><span class="n">hex</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">rem</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s2">&#34;challenge.basectf.fun&#34;</span><span class="p">,</span> <span class="mi">33573</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">want_md5</span> <span class="o">=</span> <span class="n">rem</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">32</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>  <span class="c1"># 接收原始数据的md5</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="c1"># 计算成iv</span>
</span></span><span class="line"><span class="cl">    <span class="n">iv</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">tmp</span> <span class="o">+=</span> <span class="n">want_md5</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">-</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">:(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span> <span class="o">-</span> <span class="n">j</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">iv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="ne">int</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="c1"># 爆破长度</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">rem</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Please input the secret:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="c1"># 填充消息</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload_length</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x80</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="p">((</span><span class="n">i</span> <span class="o">+</span> <span class="n">len</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="o">%</span> <span class="mi">512</span> <span class="o">!=</span> <span class="mi">448</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\x00</span><span class="s1">&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;Q&#39;</span><span class="p">,</span> <span class="n">payload_length</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39;naby&#39;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="n">rem</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="c1"># 计算填充数据后的有几个分组，需要跳过计算</span>
</span></span><span class="line"><span class="cl">        <span class="n">skip</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">len</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">//</span> <span class="mi">64</span>
</span></span><span class="line"><span class="cl">        <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">iv</span>
</span></span><span class="line"><span class="cl">        <span class="n">message</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;a&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="mi">64</span> <span class="o">*</span> <span class="n">skip</span><span class="p">)</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;naby&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="n">my_md5</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">skip</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">rem</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">&#34;Please input your md5:&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">rem</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">rem</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">m</span> <span class="o">=</span> <span class="n">rem</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="sa">b</span><span class="s1">&#39;correct&#39;</span> <span class="ow">in</span> <span class="n">m</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">want_md5</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">rem</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h2 id="fin">Fin</h2>
<h3 id="の歪来">の歪来</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">from gmpy2 import *
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag=b&#39;&#39;
</span></span><span class="line"><span class="cl">assert len(flag)==28
</span></span><span class="line"><span class="cl">m=bytes_to_long(flag)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">n=getPrime(2048)
</span></span><span class="line"><span class="cl">e=32
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">c=pow(m,e,n)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">print(&#34;n =&#34;,n)
</span></span><span class="line"><span class="cl">print(&#34;e =&#34;,e)
</span></span><span class="line"><span class="cl">print(&#34;c =&#34;,c)
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：AMM
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">n = 17363249226879909675667629533972233798566313669420563155296918020175446973456428454735263489044575257132690882883587342817653451483222705760704890265900885255972067349104579938808591608382992680533327518070878297438339884996059309549300942570104747348751766711833983705979880714174709047335147739991850385244159235504375559144283494800573079055547597410783559965162216203307100248001158445665271438067670522510991047688414176659907164436539491205637933681658814267567385232097679554282863595183422504494357205180093828786415060565003183966959273253039416986816444073158723191290806413175478175738266995214965220231649
</span></span><span class="line"><span class="cl">e = 32
</span></span><span class="line"><span class="cl">c = 6840453756562205147103219479843999687625029691496635689045074720240615321966887831642035124198445485320265097191334720798522097422084141332044111764558336174743819347952914775206809737198058220362381349481027893609144697054465070779290329222696236671374412706789862193871687821041053566873553189148668599841084370137084893575567622972476409755187388121177923217208552049876944055745912987536390075417261016809335539362984984190264791744790640858201038207982043569204062714722892105134794280417020318408200038144689432974312283915592134911446185412636709207566063730723406969727969141426530341540330398465744403597273
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import gmpy2
</span></span><span class="line"><span class="cl">import time
</span></span><span class="line"><span class="cl">import random
</span></span><span class="line"><span class="cl">def AMM(o, r, q):
</span></span><span class="line"><span class="cl">    start = time.time()
</span></span><span class="line"><span class="cl">    print(&#39;\n----------------------------------------------------------------------------------&#39;)
</span></span><span class="line"><span class="cl">    print(&#39;Start to run Adleman-Manders-Miller Root Extraction Method&#39;)
</span></span><span class="line"><span class="cl">    print(&#39;Try to find one {:#x}th root of {} modulo {}&#39;.format(r, o, q))
</span></span><span class="line"><span class="cl">    g = GF(q)
</span></span><span class="line"><span class="cl">    o = g(o)
</span></span><span class="line"><span class="cl">    p = g(random.randint(1, q))
</span></span><span class="line"><span class="cl">    while p ^ ((q-1) // r) == 1:
</span></span><span class="line"><span class="cl">        p = g(random.randint(1, q))
</span></span><span class="line"><span class="cl">    print(&#39;[+] Find p:{}&#39;.format(p))
</span></span><span class="line"><span class="cl">    t = 0
</span></span><span class="line"><span class="cl">    s = q - 1
</span></span><span class="line"><span class="cl">    while s % r == 0:
</span></span><span class="line"><span class="cl">        t += 1
</span></span><span class="line"><span class="cl">        s = s // r
</span></span><span class="line"><span class="cl">    print(&#39;[+] Find s:{}, t:{}&#39;.format(s, t))
</span></span><span class="line"><span class="cl">    k = 1
</span></span><span class="line"><span class="cl">    while (k * s + 1) % r != 0:
</span></span><span class="line"><span class="cl">        k += 1
</span></span><span class="line"><span class="cl">    alp = (k * s + 1) // r
</span></span><span class="line"><span class="cl">    print(&#39;[+] Find alp:{}&#39;.format(alp))
</span></span><span class="line"><span class="cl">    a = p ^ (r**(t-1) * s)
</span></span><span class="line"><span class="cl">    b = o ^ (r*alp - 1)
</span></span><span class="line"><span class="cl">    c = p ^ s
</span></span><span class="line"><span class="cl">    h = 1
</span></span><span class="line"><span class="cl">    for i in range(1, t):
</span></span><span class="line"><span class="cl">        d = b ^ (r^(t-1-i))
</span></span><span class="line"><span class="cl">        if d == 1:
</span></span><span class="line"><span class="cl">            j = 0
</span></span><span class="line"><span class="cl">        else:
</span></span><span class="line"><span class="cl">            print(&#39;[+] Calculating DLP...&#39;)
</span></span><span class="line"><span class="cl">            j = - discrete_log(a, d)
</span></span><span class="line"><span class="cl">            print(&#39;[+] Finish DLP...&#39;)
</span></span><span class="line"><span class="cl">        b = b * (c^r)^j
</span></span><span class="line"><span class="cl">        h = h * c^j
</span></span><span class="line"><span class="cl">        c = c ^ r
</span></span><span class="line"><span class="cl">    result = o^alp * h
</span></span><span class="line"><span class="cl">    end = time.time()
</span></span><span class="line"><span class="cl">    print(&#34;Finished in {} seconds.&#34;.format(end - start))
</span></span><span class="line"><span class="cl">    print(&#39;Find one solution: {}&#39;.format(result))
</span></span><span class="line"><span class="cl">    return result
</span></span><span class="line"><span class="cl">def findAllPRoot(p, e):
</span></span><span class="line"><span class="cl">    print(&#34;Start to find all the Primitive {:#x}th root of 1 modulo {}.&#34;.format(e, p))
</span></span><span class="line"><span class="cl">    start = time.time()
</span></span><span class="line"><span class="cl">    proot = set()
</span></span><span class="line"><span class="cl">    while len(proot) &lt; e:
</span></span><span class="line"><span class="cl">        proot.add(pow(random.randint(2, p-1), (p-1)//e, p))
</span></span><span class="line"><span class="cl">    end = time.time()
</span></span><span class="line"><span class="cl">    print(&#34;Finished in {} seconds.&#34;.format(end - start))
</span></span><span class="line"><span class="cl">    return proot
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">def findAllSolutions(mp, proot, cp, p):
</span></span><span class="line"><span class="cl">    print(&#34;Start to find all the {:#x}th root of {} modulo {}.&#34;.format(e, cp, p))
</span></span><span class="line"><span class="cl">    start = time.time()
</span></span><span class="line"><span class="cl">    all_mp = set()
</span></span><span class="line"><span class="cl">    for root in proot:
</span></span><span class="line"><span class="cl">        mp2 = mp * root % p
</span></span><span class="line"><span class="cl">        assert(pow(mp2, e, p) == cp)
</span></span><span class="line"><span class="cl">        all_mp.add(mp2)
</span></span><span class="line"><span class="cl">    end = time.time()
</span></span><span class="line"><span class="cl">    print(&#34;Finished in {} seconds.&#34;.format(end - start))
</span></span><span class="line"><span class="cl">    return all_mp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mp = AMM(c,e,n)
</span></span><span class="line"><span class="cl">p_proot = findAllPRoot(n, e)
</span></span><span class="line"><span class="cl">mps = findAllSolutions(mp, p_proot, c, n)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">for i in mps:
</span></span><span class="line"><span class="cl">	flag = long_to_bytes(int(i))
</span></span><span class="line"><span class="cl">	if b&#39;BaseCTF{&#39; in flag:
</span></span><span class="line"><span class="cl">		print(flag)
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="ecb是不安全的">ECB是不安全的</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">from Crypto.Util.Padding import *
</span></span><span class="line"><span class="cl">from Crypto.Cipher import AES
</span></span><span class="line"><span class="cl">import socketserver
</span></span><span class="line"><span class="cl">import os
</span></span><span class="line"><span class="cl">import base64
</span></span><span class="line"><span class="cl">flag = os.getenv(&#39;GZCTF_FLAG&#39;).encode()
</span></span><span class="line"><span class="cl">class Task(socketserver.BaseRequestHandler):
</span></span><span class="line"><span class="cl">    def _recvall(self):
</span></span><span class="line"><span class="cl">        BUFF_SIZE = 2048
</span></span><span class="line"><span class="cl">        data = b&#39;&#39;
</span></span><span class="line"><span class="cl">        while True:
</span></span><span class="line"><span class="cl">            part = self.request.recv(BUFF_SIZE)
</span></span><span class="line"><span class="cl">            data += part
</span></span><span class="line"><span class="cl">            if len(part) &lt; BUFF_SIZE:
</span></span><span class="line"><span class="cl">                break
</span></span><span class="line"><span class="cl">        return data.strip()
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    def send(self, msg, newline=True):
</span></span><span class="line"><span class="cl">        try:
</span></span><span class="line"><span class="cl">            if newline:
</span></span><span class="line"><span class="cl">                msg += b&#39;\n&#39;
</span></span><span class="line"><span class="cl">            self.request.sendall(msg)
</span></span><span class="line"><span class="cl">        except:
</span></span><span class="line"><span class="cl">            pass
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    def recv(self):
</span></span><span class="line"><span class="cl">        return self._recvall()
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    def handle(self):
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        self.send(b&#34;the server will connect you entered to the front of flag.&#34;)
</span></span><span class="line"><span class="cl">        self.send(b&#34;then you will receive ciphertext(b64encode) encrypted by AES-ECB.&#34;)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        key=os.urandom(16)
</span></span><span class="line"><span class="cl">        my_aes=AES.new(key=key,mode=AES.MODE_ECB)
</span></span><span class="line"><span class="cl">        self.send(base64.b64encode(my_aes.encrypt(pad(flag,AES.block_size))))
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        while True:
</span></span><span class="line"><span class="cl">            self.send(b&#39;:&#39;)
</span></span><span class="line"><span class="cl">            cin=self.recv()
</span></span><span class="line"><span class="cl">            final=cin+flag
</span></span><span class="line"><span class="cl">            self.send(base64.b64encode(my_aes.encrypt(pad(final,AES.block_size))))
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        self.send(b&#34;\nConnection has been closed  =.=  &#34;)
</span></span><span class="line"><span class="cl">        self.request.close()
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">class ThreadedServer(socketserver.ThreadingMixIn, socketserver.TCPServer):
</span></span><span class="line"><span class="cl">    pass
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">class ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer):
</span></span><span class="line"><span class="cl">    pass
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">if __name__ == &#34;__main__&#34;:
</span></span><span class="line"><span class="cl">    HOST, PORT = &#39;0.0.0.0&#39;, 9999
</span></span><span class="line"><span class="cl">    server = ForkedServer((HOST, PORT), Task)
</span></span><span class="line"><span class="cl">    server.allow_reuse_address = True
</span></span><span class="line"><span class="cl">    server.serve_forever()
</span></span><span class="line"><span class="cl"> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：ECB模式中，算法对每一个分组进行加密，与前后分组无关，当密钥固定之后，只要这一个分组的明文相同，那么加密之后的密文也相同。
比如flag是BaseCTF{0123456789}，长度为19.一开始服务器给我们发送密文（base64解密之后）为32字节，为两个AES-ECB分组。我们给服务器依次发送1-16字节的数据，发送一个1字节时，服务器加密20字节，最后密文还是32字节；当发送14字节时，服务器加密33字节，最后密文为48字节，发生了变化，在这时，我们就可以计算出flag长度为32-(14-1)=19。
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">pwn</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">Crypto</span><span class="o">.</span><span class="n">Util</span><span class="o">.</span><span class="n">number</span> <span class="n">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">base64</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">=</span><span class="n">remote</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span><span class="o">=</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="n">length1</span><span class="o">=</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>    <span class="c1"># b&#34;:\n&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="n">i</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="o">=</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">!=</span><span class="n">len</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">length1</span><span class="o">=</span><span class="n">i</span>
</span></span><span class="line"><span class="cl">        <span class="k">break</span>
</span></span><span class="line"><span class="cl"><span class="n">length_flag</span><span class="o">=</span><span class="n">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">-</span><span class="n">length1</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">length_flag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="c1"># 从前往后爆破flag</span>
</span></span><span class="line"><span class="cl"><span class="n">payload_length</span><span class="o">=</span><span class="n">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">+</span><span class="mi">16</span>     <span class="c1"># 多一个分组保容错</span>
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">payload_length</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">payload_length</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">length_flag</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>    <span class="c1"># b&#34;:\n&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="n">i</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">d</span><span class="o">=</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">33</span><span class="p">,</span><span class="mi">128</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()</span>    <span class="c1"># b&#34;:\n&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">payload1</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;a&#39;</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="n">flag</span><span class="o">+</span><span class="n">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">e</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">recvline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">e</span><span class="o">=</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">e</span><span class="o">=</span><span class="n">e</span><span class="p">[</span><span class="n">payload_length</span><span class="o">-</span><span class="mi">16</span><span class="p">:</span><span class="n">payload_length</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">flag</span><span class="o">+=</span><span class="n">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="猜猜看">猜猜看</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import socketserver
</span></span><span class="line"><span class="cl">import numpy as np
</span></span><span class="line"><span class="cl">import random
</span></span><span class="line"><span class="cl">import ast
</span></span><span class="line"><span class="cl">import os
</span></span><span class="line"><span class="cl">flag = os.getenv(&#39;GZCTF_FLAG&#39;).encode()
</span></span><span class="line"><span class="cl">class Task(socketserver.BaseRequestHandler):
</span></span><span class="line"><span class="cl">    def _recvall(self):
</span></span><span class="line"><span class="cl">        BUFF_SIZE = 2048
</span></span><span class="line"><span class="cl">        data = b&#39;&#39;
</span></span><span class="line"><span class="cl">        while True:
</span></span><span class="line"><span class="cl">            part = self.request.recv(BUFF_SIZE)
</span></span><span class="line"><span class="cl">            data += part
</span></span><span class="line"><span class="cl">            if len(part) &lt; BUFF_SIZE:
</span></span><span class="line"><span class="cl">                break
</span></span><span class="line"><span class="cl">        return data.strip()
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    def send(self, msg, newline=True):
</span></span><span class="line"><span class="cl">        try:
</span></span><span class="line"><span class="cl">            if newline:
</span></span><span class="line"><span class="cl">                msg += b&#39;\n&#39;
</span></span><span class="line"><span class="cl">            self.request.sendall(msg)
</span></span><span class="line"><span class="cl">        except:
</span></span><span class="line"><span class="cl">            pass
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    def recv(self):
</span></span><span class="line"><span class="cl">        return self._recvall()
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    def handle(self):
</span></span><span class="line"><span class="cl">        assert len(flag)==45
</span></span><span class="line"><span class="cl">        self.send(b&#34;hello.&#34;)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        m=bytes_to_long(flag)
</span></span><span class="line"><span class="cl">        m=bin(m)[2:]
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        length=len(m)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        x=np.array([int(i) for i in m])
</span></span><span class="line"><span class="cl">        T=np.array([[random.getrandbits(1) for _ in range(length)] for __ in range(length)])
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        y=np.dot(x,T)
</span></span><span class="line"><span class="cl">        self.send(str(list(y)).encode())
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        while True:
</span></span><span class="line"><span class="cl">            user_input=ast.literal_eval(self.recv().strip().decode(&#39;utf-8&#39;))
</span></span><span class="line"><span class="cl">            if isinstance(user_input,list):
</span></span><span class="line"><span class="cl">                try:
</span></span><span class="line"><span class="cl">                    mat=np.array(user_input)
</span></span><span class="line"><span class="cl">                    res=list(np.dot(mat,T))
</span></span><span class="line"><span class="cl">                    self.send(str(res).encode())
</span></span><span class="line"><span class="cl">                except:
</span></span><span class="line"><span class="cl">                    self.send(b&#39;wrong!!&#39;)
</span></span><span class="line"><span class="cl">            else:
</span></span><span class="line"><span class="cl">                self.send(b&#39;wrong!&#39;)
</span></span><span class="line"><span class="cl">                break
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        self.send(b&#34;\nConnection has been closed  =.=  &#34;)
</span></span><span class="line"><span class="cl">        self.request.close()
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">class ThreadedServer(socketserver.ThreadingMixIn, socketserver.TCPServer):
</span></span><span class="line"><span class="cl">    pass
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">class ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer):
</span></span><span class="line"><span class="cl">    pass
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">if __name__ == &#34;__main__&#34;:
</span></span><span class="line"><span class="cl">    HOST, PORT = &#39;0.0.0.0&#39;, 9999
</span></span><span class="line"><span class="cl">    server = ForkedServer((HOST, PORT), Task)
</span></span><span class="line"><span class="cl">    server.allow_reuse_address = True
</span></span><span class="line"><span class="cl">    server.serve_forever()
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：利用矩阵乘法的性质，一个矩阵只有一个1，其他都是零，当他是左乘时就可以得到右乘矩阵的一行
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import numpy as np
</span></span><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">from pwn import *
</span></span><span class="line"><span class="cl">p=remote()
</span></span><span class="line"><span class="cl">p.recvline()
</span></span><span class="line"><span class="cl">flag=eval(p.recvline())
</span></span><span class="line"><span class="cl">length=45*8-1
</span></span><span class="line"><span class="cl">T=[]
</span></span><span class="line"><span class="cl">for i in range(length):
</span></span><span class="line"><span class="cl">    x=[0]*i+[1]+[0]*(length-1-i)
</span></span><span class="line"><span class="cl">    p.sendline(str(x).encode())
</span></span><span class="line"><span class="cl">    T.append(eval(p.recvline()))
</span></span><span class="line"><span class="cl">T=np.array(T)
</span></span><span class="line"><span class="cl">t_ni=np.linalg.inv(T)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">m=np.dot(flag,t_ni)
</span></span><span class="line"><span class="cl">m=np.round(m)
</span></span><span class="line"><span class="cl">flag=&#34;&#34;
</span></span><span class="line"><span class="cl">for i in m:
</span></span><span class="line"><span class="cl">    if i==1:
</span></span><span class="line"><span class="cl">        flag+=&#39;1&#39;
</span></span><span class="line"><span class="cl">    else:
</span></span><span class="line"><span class="cl">        flag+=&#39;0&#39;
</span></span><span class="line"><span class="cl">print(long_to_bytes(int(flag,2)))
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">p.interactive()
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="老涩批了">老涩批了</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import socketserver
</span></span><span class="line"><span class="cl">import os
</span></span><span class="line"><span class="cl">import uuid 
</span></span><span class="line"><span class="cl">flag = os.getenv(&#39;GZCTF_FLAG&#39;).encode()
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">class Task(socketserver.BaseRequestHandler):
</span></span><span class="line"><span class="cl">    def _recvall(self):
</span></span><span class="line"><span class="cl">        BUFF_SIZE = 2048
</span></span><span class="line"><span class="cl">        data = b&#39;&#39;
</span></span><span class="line"><span class="cl">        while True:
</span></span><span class="line"><span class="cl">            part = self.request.recv(BUFF_SIZE)
</span></span><span class="line"><span class="cl">            data += part
</span></span><span class="line"><span class="cl">            if len(part) &lt; BUFF_SIZE:
</span></span><span class="line"><span class="cl">                break
</span></span><span class="line"><span class="cl">        return data.strip()
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    def send(self, msg, newline=True):
</span></span><span class="line"><span class="cl">        try:
</span></span><span class="line"><span class="cl">            if newline:
</span></span><span class="line"><span class="cl">                msg += b&#39;\n&#39;
</span></span><span class="line"><span class="cl">            self.request.sendall(msg)
</span></span><span class="line"><span class="cl">        except:
</span></span><span class="line"><span class="cl">            pass
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    def recv(self):
</span></span><span class="line"><span class="cl">        return self._recvall()
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    def handle(self):
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        p=getPrime(256)
</span></span><span class="line"><span class="cl">        q=getPrime(256)
</span></span><span class="line"><span class="cl">        n=p*q
</span></span><span class="line"><span class="cl">        e=65537
</span></span><span class="line"><span class="cl">        d=inverse(e,(p-1)*(q-1))
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        text=b&#39;BaseCTF{&#39;+str(uuid.uuid4()).encode()+b&#39;}&#39;
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        m1=bytes_to_long(text[:len(text)//2])
</span></span><span class="line"><span class="cl">        c1=pow(m1,e,n)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        m2=bytes_to_long(text[len(text)//2:])
</span></span><span class="line"><span class="cl">        c2=pow(m2,e,n)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        self.send(b&#39;n = &#39;+str(n).encode())
</span></span><span class="line"><span class="cl">        self.send(b&#39;e = &#39;+str(e).encode())
</span></span><span class="line"><span class="cl">        self.send(b&#39;c1 = &#39;+str(c1).encode())
</span></span><span class="line"><span class="cl">        self.send(b&#39;c2 = &#39;+str(c2).encode())
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        while True:
</span></span><span class="line"><span class="cl">            select=self.recv().strip()
</span></span><span class="line"><span class="cl">            if select==b&#39;1&#39;:
</span></span><span class="line"><span class="cl">                c=int(self.recv().decode().strip())
</span></span><span class="line"><span class="cl">                m=pow(c,d,n)
</span></span><span class="line"><span class="cl">                res=m&amp;1
</span></span><span class="line"><span class="cl">            elif select==b&#39;2&#39;:
</span></span><span class="line"><span class="cl">                c=int(self.recv().decode().strip())
</span></span><span class="line"><span class="cl">                m=pow(c,d,n)
</span></span><span class="line"><span class="cl">                res=long_to_bytes(m,64)[0]
</span></span><span class="line"><span class="cl">            elif select==b&#39;3&#39;:
</span></span><span class="line"><span class="cl">                user_text=self.recv().strip()
</span></span><span class="line"><span class="cl">                if user_text==text:
</span></span><span class="line"><span class="cl">                    self.send(flag)
</span></span><span class="line"><span class="cl">                    break
</span></span><span class="line"><span class="cl">                else:
</span></span><span class="line"><span class="cl">                    self.send(b&#39;try again&#39;)
</span></span><span class="line"><span class="cl">                    break
</span></span><span class="line"><span class="cl">            else :
</span></span><span class="line"><span class="cl">                self.send(b&#39;wrong&#39;)
</span></span><span class="line"><span class="cl">                break
</span></span><span class="line"><span class="cl">            self.send(str(res).encode())
</span></span><span class="line"><span class="cl">        self.send(b&#34;\nConnection has been closed  =.=  &#34;)
</span></span><span class="line"><span class="cl">        self.request.close()
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">class ThreadedServer(socketserver.ThreadingMixIn, socketserver.TCPServer):
</span></span><span class="line"><span class="cl">    pass
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">class ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer):
</span></span><span class="line"><span class="cl">    pass
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">if __name__ == &#34;__main__&#34;:
</span></span><span class="line"><span class="cl">    HOST, PORT = &#39;0.0.0.0&#39;, 9999
</span></span><span class="line"><span class="cl">    server = ForkedServer((HOST, PORT), Task)
</span></span><span class="line"><span class="cl">    server.allow_reuse_address = True
</span></span><span class="line"><span class="cl">    server.serve_forever()
</span></span><span class="line"><span class="cl"> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：不太会，再学学
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">import decimal
</span></span><span class="line"><span class="cl">from pwn import *
</span></span><span class="line"><span class="cl">from time import *
</span></span><span class="line"><span class="cl">rem=remote()
</span></span><span class="line"><span class="cl">rem.recvuntil(b&#39;n = &#39;)
</span></span><span class="line"><span class="cl">n=int(rem.recvline().decode().strip())
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">rem.recvuntil(b&#39;e = &#39;)
</span></span><span class="line"><span class="cl">e=int(rem.recvline().decode().strip())
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">rem.recvuntil(b&#39;c1 = &#39;)
</span></span><span class="line"><span class="cl">c1=int(rem.recvline().decode().strip())
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">rem.recvuntil(b&#39;c2 = &#39;)
</span></span><span class="line"><span class="cl">c2=int(rem.recvline().decode().strip())
</span></span><span class="line"><span class="cl">def server_decode1(c):
</span></span><span class="line"><span class="cl">    rem.sendline(b&#39;1&#39;)
</span></span><span class="line"><span class="cl">    sleep(0.01)
</span></span><span class="line"><span class="cl">    rem.sendline(str(c).encode())
</span></span><span class="line"><span class="cl">    rec=rem.recvline().strip()
</span></span><span class="line"><span class="cl">    return rec
</span></span><span class="line"><span class="cl">kbits = n.bit_length()
</span></span><span class="line"><span class="cl">decimal.getcontext().prec = kbits
</span></span><span class="line"><span class="cl">L = decimal.Decimal(0)
</span></span><span class="line"><span class="cl">R = decimal.Decimal(int(n))
</span></span><span class="line"><span class="cl">for i in range(kbits):
</span></span><span class="line"><span class="cl">    c1 = (c1 * pow(2, e, n)) % n
</span></span><span class="line"><span class="cl">    recv = server_decode1(c1)
</span></span><span class="line"><span class="cl">    if recv == b&#39;1&#39;:
</span></span><span class="line"><span class="cl">        L = (L + R) // 2
</span></span><span class="line"><span class="cl">    else:
</span></span><span class="line"><span class="cl">        R = (L + R) // 2
</span></span><span class="line"><span class="cl">flag1=long_to_bytes(int((R)))
</span></span><span class="line"><span class="cl">print(flag1)
</span></span><span class="line"><span class="cl">sleep(0.01)
</span></span><span class="line"><span class="cl">def server_decode2(c):
</span></span><span class="line"><span class="cl">    rem.sendline(b&#39;2&#39;)
</span></span><span class="line"><span class="cl">    sleep(0.01)
</span></span><span class="line"><span class="cl">    rem.sendline(str(c).encode())
</span></span><span class="line"><span class="cl">    rec=rem.recvline().strip()
</span></span><span class="line"><span class="cl">    return rec
</span></span><span class="line"><span class="cl">k=1
</span></span><span class="line"><span class="cl">while True:
</span></span><span class="line"><span class="cl">    c22 = (c2 * pow(2, e*k, n)) % n
</span></span><span class="line"><span class="cl">    res=server_decode2(c22)
</span></span><span class="line"><span class="cl">    res=int(res)
</span></span><span class="line"><span class="cl">    if res&amp;1:
</span></span><span class="line"><span class="cl">        break
</span></span><span class="line"><span class="cl">    k=k+1
</span></span><span class="line"><span class="cl">L=2**(k-1)
</span></span><span class="line"><span class="cl">R=2**k
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">while True:
</span></span><span class="line"><span class="cl">    if R-L==1:
</span></span><span class="line"><span class="cl">        break
</span></span><span class="line"><span class="cl">    x=(L+R)//2
</span></span><span class="line"><span class="cl">    c22 = (c2 * pow(x, e, n)) % n
</span></span><span class="line"><span class="cl">    res=server_decode2(c22)
</span></span><span class="line"><span class="cl">    res=int(res)
</span></span><span class="line"><span class="cl">    if res:
</span></span><span class="line"><span class="cl">        R=x
</span></span><span class="line"><span class="cl">    else :
</span></span><span class="line"><span class="cl">        L=x
</span></span><span class="line"><span class="cl">flag2=(2**(kbits-8)//L)
</span></span><span class="line"><span class="cl">print(long_to_bytes(flag2))
</span></span><span class="line"><span class="cl">user_text=flag1[:-1]+b&#39;-&#39;+long_to_bytes(flag2)
</span></span><span class="line"><span class="cl">print(user_text)
</span></span><span class="line"><span class="cl">rem.sendline(b&#39;3&#39;)
</span></span><span class="line"><span class="cl">sleep(0.01)
</span></span><span class="line"><span class="cl">rem.sendline(user_text)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">rem.interactive()
</span></span><span class="line"><span class="cl"> 
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h3 id="pdp">PDP</h3>
<p>task</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">from gmpy2 import *
</span></span><span class="line"><span class="cl">import hashlib
</span></span><span class="line"><span class="cl">import hmac
</span></span><span class="line"><span class="cl">from Crypto.Cipher import AES
</span></span><span class="line"><span class="cl">from Crypto.Util.Padding import pad
</span></span><span class="line"><span class="cl">from random import *
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">def KeyGen():
</span></span><span class="line"><span class="cl">    while True:
</span></span><span class="line"><span class="cl">        pp=getPrime(512)
</span></span><span class="line"><span class="cl">        p=2*pp+1
</span></span><span class="line"><span class="cl">        while not isPrime(p):
</span></span><span class="line"><span class="cl">            pp=getPrime(512)
</span></span><span class="line"><span class="cl">            p=2*pp+1
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        qq=getPrime(512)
</span></span><span class="line"><span class="cl">        q=2*qq+1
</span></span><span class="line"><span class="cl">        while not isPrime(q):
</span></span><span class="line"><span class="cl">            qq=getPrime(512)
</span></span><span class="line"><span class="cl">            q=2*qq+1
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        if pp!=qq:
</span></span><span class="line"><span class="cl">            break
</span></span><span class="line"><span class="cl">    n=p*q
</span></span><span class="line"><span class="cl">    phi=(p-1)*(q-1)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    e=getPrime(1024)
</span></span><span class="line"><span class="cl">    d=invert(e,phi)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    v=getRandomNBitInteger(128)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    g=e**2%n
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    return (n,g,e,d,v)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">def TagBlock(n,g,d,v):
</span></span><span class="line"><span class="cl">    f=open(&#34;ABigFile&#34;,&#39;rb&#39;)
</span></span><span class="line"><span class="cl">    F=f.read()
</span></span><span class="line"><span class="cl">    f.close()
</span></span><span class="line"><span class="cl">    b_size=64   # 64B
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    block_count=len(F)//b_size + (0 if len(F)%b_size==0 else 1)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    W=[]
</span></span><span class="line"><span class="cl">    tags=[]
</span></span><span class="line"><span class="cl">    for i in range(block_count):
</span></span><span class="line"><span class="cl">        Wi=str(v)+str(i)
</span></span><span class="line"><span class="cl">        W.append(Wi)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        block=bytes_to_long(F[i*b_size:(i+1)*b_size])
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        my_md5=hashlib.md5()
</span></span><span class="line"><span class="cl">        my_md5.update(Wi.encode())
</span></span><span class="line"><span class="cl">        tags.append(pow((int(my_md5.hexdigest(),16)*pow(g,block,n))%n,d,n))
</span></span><span class="line"><span class="cl">    return (W,tags)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">def GenProof(n,g):
</span></span><span class="line"><span class="cl">    c=randint(400,500)
</span></span><span class="line"><span class="cl">    k1=getRandomNBitInteger(256)
</span></span><span class="line"><span class="cl">    k2=getRandomNBitInteger(160)
</span></span><span class="line"><span class="cl">    s=getRandomNBitInteger(16)
</span></span><span class="line"><span class="cl">    return (c,k1,k2,s,pow(g,s,n))
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">def gen_proof(n,tags,c,k1,k2,gs,judge=0):
</span></span><span class="line"><span class="cl">    f=open(&#34;ABigFile&#34;,&#39;rb&#39;)
</span></span><span class="line"><span class="cl">    F=f.read()
</span></span><span class="line"><span class="cl">    f.close()
</span></span><span class="line"><span class="cl">    b_size=64   # 64B
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    if judge:
</span></span><span class="line"><span class="cl">        listF=list(F)
</span></span><span class="line"><span class="cl">        X=[]
</span></span><span class="line"><span class="cl">        for i in range(len(F)//100):
</span></span><span class="line"><span class="cl">            x=randint(0,len(F)-1)
</span></span><span class="line"><span class="cl">            while listF[x]==0:
</span></span><span class="line"><span class="cl">                x=randint(0,len(F)-1)
</span></span><span class="line"><span class="cl">            X.append(x)
</span></span><span class="line"><span class="cl">            listF[x]=0
</span></span><span class="line"><span class="cl">        F=b&#39;&#39;
</span></span><span class="line"><span class="cl">        for i in listF:
</span></span><span class="line"><span class="cl">            F+=long_to_bytes(i)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    block_count=len(F)//b_size + (0 if len(F)%b_size==0 else 1)
</span></span><span class="line"><span class="cl">    T=1
</span></span><span class="line"><span class="cl">    temp=0
</span></span><span class="line"><span class="cl">    for j in range(c):
</span></span><span class="line"><span class="cl">        my_aes=AES.new(long_to_bytes(k1),mode=AES.MODE_ECB)
</span></span><span class="line"><span class="cl">        i=my_aes.encrypt(pad(long_to_bytes(j),AES.block_size))
</span></span><span class="line"><span class="cl">        i=bytes_to_long(i)%block_count
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        my_sha256=hashlib.sha256
</span></span><span class="line"><span class="cl">        my_hmac=hmac.new(long_to_bytes(k2),digestmod=my_sha256)
</span></span><span class="line"><span class="cl">        my_hmac.update(long_to_bytes(j))
</span></span><span class="line"><span class="cl">        a=int(my_hmac.hexdigest(),16)%n
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        T=(T*(pow(tags[i],a,n)))%n
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        block=bytes_to_long(F[i*b_size:(i+1)*b_size])%n
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        temp=temp+block*a
</span></span><span class="line"><span class="cl">    temp=pow(gs,temp,n)
</span></span><span class="line"><span class="cl">    my_sha1=hashlib.sha1()
</span></span><span class="line"><span class="cl">    my_sha1.update(str(temp).encode())
</span></span><span class="line"><span class="cl">    rho=int(my_sha1.hexdigest(),16)
</span></span><span class="line"><span class="cl">    return (T,rho)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">n,g,e,d,v=KeyGen()
</span></span><span class="line"><span class="cl">with open(&#34;./output/key.txt&#34;,&#39;w&#39;) as file:
</span></span><span class="line"><span class="cl">    file.write(str(n)+&#39;\n&#39;)
</span></span><span class="line"><span class="cl">    file.write(str(e)+&#39;\n&#39;)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">W,tags=TagBlock(n,g,d,v)
</span></span><span class="line"><span class="cl">with open(&#34;./output/W.txt&#34;,&#34;w&#34;) as file:
</span></span><span class="line"><span class="cl">    for i in W:
</span></span><span class="line"><span class="cl">        file.write(str(i))
</span></span><span class="line"><span class="cl">        file.write(&#39;\n&#39;)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">c,k1,k2,s,gs=GenProof(n,g)
</span></span><span class="line"><span class="cl">with open(&#34;./output/chal.txt&#34;,&#39;w&#39;) as file:
</span></span><span class="line"><span class="cl">    file.write(str(c)+&#39;\n&#39;)
</span></span><span class="line"><span class="cl">    file.write(str(k1)+&#39;\n&#39;)
</span></span><span class="line"><span class="cl">    file.write(str(k2)+&#39;\n&#39;)
</span></span><span class="line"><span class="cl">    file.write(str(s)+&#39;\n&#39;)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">T,rho=gen_proof(n,tags,c,k1,k2,gs)
</span></span><span class="line"><span class="cl">with open(&#34;./output/result.txt&#34;,&#39;w&#39;) as file:
</span></span><span class="line"><span class="cl">        file.write(str(T)+&#39;\n&#39;)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">flag_md5=hashlib.md5()
</span></span><span class="line"><span class="cl">flag_md5.update(str(rho).encode())
</span></span><span class="line"><span class="cl">print(b&#39;BaseCTF{&#39;+flag_md5.hexdigest().encode()+b&#39;}&#39;)
</span></span></code></pre></td></tr></table>
</div>
</div><p>思路：naby师傅的毕设，慢慢学
exp</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">from Crypto.Util.number import *
</span></span><span class="line"><span class="cl">from gmpy2 import *
</span></span><span class="line"><span class="cl">import hashlib
</span></span><span class="line"><span class="cl">import hmac
</span></span><span class="line"><span class="cl">from Crypto.Cipher import AES
</span></span><span class="line"><span class="cl">from Crypto.Util.Padding import pad
</span></span><span class="line"><span class="cl">from random import *
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">def CheckProff(n,e,W,c,k1,k2,s,T):
</span></span><span class="line"><span class="cl">    tau=pow(T,e,n)
</span></span><span class="line"><span class="cl">    block_count=len(W)
</span></span><span class="line"><span class="cl">    for j in range(c):
</span></span><span class="line"><span class="cl">        my_aes=AES.new(long_to_bytes(k1),mode=AES.MODE_ECB)
</span></span><span class="line"><span class="cl">        i=my_aes.encrypt(pad(long_to_bytes(j),AES.block_size))
</span></span><span class="line"><span class="cl">        i=bytes_to_long(i)%block_count
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        my_sha256=hashlib.sha256
</span></span><span class="line"><span class="cl">        my_hmac=hmac.new(long_to_bytes(k2),digestmod=my_sha256)
</span></span><span class="line"><span class="cl">        my_hmac.update(long_to_bytes(j))
</span></span><span class="line"><span class="cl">        a=int(my_hmac.hexdigest(),16)%n
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        Wi=str(W[i])
</span></span><span class="line"><span class="cl">        my_md5=hashlib.md5()
</span></span><span class="line"><span class="cl">        my_md5.update(Wi.encode())
</span></span><span class="line"><span class="cl">        hw=pow(int(my_md5.hexdigest(),16),a,n)
</span></span><span class="line"><span class="cl">        tau=(tau*invert(hw,n))%n
</span></span><span class="line"><span class="cl">    tau=pow(tau,s,n)
</span></span><span class="line"><span class="cl">    my_sha1=hashlib.sha1()
</span></span><span class="line"><span class="cl">    my_sha1.update(str(tau).encode())
</span></span><span class="line"><span class="cl">    tau=int(my_sha1.hexdigest(),16)
</span></span><span class="line"><span class="cl">    flag_md5=hashlib.md5()
</span></span><span class="line"><span class="cl">    flag_md5.update(str(tau).encode())
</span></span><span class="line"><span class="cl">    print(b&#39;BaseCTF{&#39;+flag_md5.hexdigest().encode()+b&#39;}&#39;)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">with open(&#34;./output/key.txt&#34;,&#39;r&#39;) as file:
</span></span><span class="line"><span class="cl">    n=int(file.readline())
</span></span><span class="line"><span class="cl">    e=int(file.readline())
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">W=[]
</span></span><span class="line"><span class="cl">with open(&#34;./output/W.txt&#34;,&#34;r&#34;) as file:
</span></span><span class="line"><span class="cl">    fl=file.readline()
</span></span><span class="line"><span class="cl">    while fl:
</span></span><span class="line"><span class="cl">        W.append(int(fl))
</span></span><span class="line"><span class="cl">        fl=file.readline()
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">with open(&#34;./output/chal.txt&#34;,&#39;r&#39;) as file:
</span></span><span class="line"><span class="cl">    c=int(file.readline())
</span></span><span class="line"><span class="cl">    k1=int(file.readline())
</span></span><span class="line"><span class="cl">    k2=int(file.readline())
</span></span><span class="line"><span class="cl">    s=int(file.readline())
</span></span><span class="line"><span class="cl">T=234286400251524464112670458144913694525518333434039777508421611102466502545441606446799021254782625175811569624228349681696143431027926557585053651139957429856785510525021542033961575674601192776283321921860155347475439442726331189839563865687519551977156169783131926796425661730777079164446161030078497564104
</span></span><span class="line"><span class="cl">CheckProff(n,e,W,c,k1,k2,s,T)
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">#BaseCTF{d198bce7a2f06ed24d3b043bddbd7512}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="总结">总结</h2>
<p>最后几周在写uctf什么的，就没有写完，最后两题是真的不会，新生赛但是很精彩，新生也都很强，感觉自己还是不够努力，只能继续加油。</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2025-07-15</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/basectf2024-crypto-wp/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://www.zhuangsanmeng.xyz/basectf2024-crypto-wp/" data-title="Basectf2024_crypto" data-hashtags="crypto"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://www.zhuangsanmeng.xyz/basectf2024-crypto-wp/" data-hashtag="crypto"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://www.zhuangsanmeng.xyz/basectf2024-crypto-wp/" data-title="Basectf2024_crypto"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://www.zhuangsanmeng.xyz/basectf2024-crypto-wp/" data-title="Basectf2024_crypto"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://www.zhuangsanmeng.xyz/basectf2024-crypto-wp/" data-title="Basectf2024_crypto"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/crypto/">Crypto</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/isctf2024_crypto/" class="prev" rel="prev" title="isctf2024_crypto"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>isctf2024_crypto</a>
            <a href="/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/" class="next" rel="next" title="2024DASCTF暑期—Crypto复现">2024DASCTF暑期—Crypto复现<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><div id="valine" class="comment"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src=''></script>

    <script type="text/javascript">
        new Valine({
            el: '#valine',
            appId: 'XiJ1G58psCdX6BgfE27O7IH9-MdYXbMMI',
            appKey: 'e9j5fWZui0l2YfNwupu7SDW2',
            notify: '',
            verify: '',
            avatar: 'mp',
            placeholder: '留下你的评论～',
            visitor: 'true'
        });
    </script></div></article></div>
            </main><footer class="footer">
    <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer"
                title="Hugo 0.147.4">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank"
                rel="noopener noreffer" title="LoveIt 0.3.0"><i class="far fa-kiss-wink-heart fa-fw"
                    aria-hidden="true"></i> LoveIt</a>
        </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2024 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a
                    href="/" target="_blank">Zsm</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span><span class="icp-splitter">&nbsp;|&nbsp;</span><br class="icp-br" />
            <span class="icp">豫ICP备2024048128号</span></div>
    
        
        <script async src=" //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js "></script>
    

    
        
            <section>
                
                    <span id="busuanzi_container_value_site_pv"><i class="far fa-eye fa-fw"></i>
                        
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                

                
                    &nbsp;|&nbsp;              
                

                
                    <span id="busuanzi_container_value_site_uv"><i class="fa fa-user"></i>
                        
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
            </section>
        

        
        
    

</div>
</footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/lightgallery/css/lightgallery-bundle.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="/lib/lightgallery/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/contrib/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"lightgallery":true,"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":50,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
